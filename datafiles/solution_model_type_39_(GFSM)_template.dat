685 DO NOT DELETE THIS LINE
                            ---------------------------------------------------------------------------

                             DO NOT USE TABS IN PERPLE_X DATA FILES, TAB CHARACTERS ARE NOT INTERPRETED AS 
                             BLANK SPACES AND CAUSE FORMATTING ERRORS.

                            ---------------------------------------------------------------------------

                             SUBDIVISION SCHEMES define the discreitization and range of compositions for a solution 
                             during a calculation. he discreitization and range of compositions for a solution 
                             during a calculation. In many cases, particularly for chemically complex solutions, 
                             this range is restricted to reduce the time and memory required for calculations. 
                             If such a restriction is encountered (**warning ver993**) during the exploratory 
                             stage of a calculation the restriction may have consequences for the final
                             auto-refine stage result. For this reason it is important for users to correct
                             the scheme (unless the restriction is intentional). A resume of warnings written
                             at the end of the exploratory stage is written to the *_auto_refine.txt file. 
                             This file should be examined before any results are accepted as final.

                             A brief description of how subdivision schemes follows (it reads worse than it is):

                             If the solution model has a simplicial composition space, then each scheme is
                             directly associated with an endmember (as identified in *_auto_refine.txt). For
                             a solution with N endmembers, there are thus N-1 subdivision schemes. In general
                             it is best to order the solution model endmembers so that the most important end-
                             member is listed last and therefore determined by difference. 

                             If the solution model has a prismatic composition space, then a scheme is
                             associated with the S-1 independent compositions of the T simplexes that comprise
                             the prism (as identified in *_auto_refine.txt). Thus for prismatic composition spaces
                             there are T*(S-1) subdivision schemes for the compositional variables X(1..T,1..S-1). 
                             X(1..T,S) is determined by difference and therefore then endmembers should be ordered 
                             so that X(1..T,S) corresponds to the most important compositional variable.

                             The subdivision scheme for each independent compositional variable is specified by 
                             four parameters, in order, XMIN, XMAX, XINC, IMOD:

                            IMOD - may be either 0 or 1:

                                IMOD = 0 - is the cartesian scheme, in which compositions are discretized with a
                                           regular spacing.
                                IMOD = 1 - is a non-linear scheme, in which compositions become more closely spaced 
                                           toward zero.

                            XINC - in most cases the value of XINC is equated to the first (exploratory stage) or
                                   second value of the initial_resolution keyword, which defaults to [1/16 1/48],
                                   i.e., the value of XINC specified within the solution model text here is irrelevant.
                                   The exceptions are if initial_resolution = [0 0] or if the solution model type = 20 
                                   (electrolytic_fluid). For these exceptions, the value of XINC is read from the model
                                   text here. XINC controls the resolution of the compositional discretization, i.e., 
                                   the number of compositions generated over the interval of interest is 1/XINC + 1 if 
                                   XINC < 0 and is XINC+1 if XINC > 0.

                            XMAX - is the maximum value of the compositional variable permitted by the scheme. This 
                                   value may be relaxed if the hard_limits option is TRUE (default).

                            XMIN - If IMOD = 0, XMIN is the minumum value of the compositional variable permitted by 
                                   the scheme. This value may be relaxed if the hard_limits option is TRUE (default).
                                   If IMOD = 1 and XMIN > 0, then XMIN is the smallest non-zero value of the compositon
                                   for statically generated compositions. Thus, the value of XMIN dictates the asymmetry
                                   of the discretization. XMIN is not relaxed if this composition becomes limiting.
                                   If IMOD = 1 and XMIN = 0, then XMIN has no significance and the asymmetry of the 
                                   discretization is specified by the stretch_factor option.

                             For convexhull minimization calculations (CONVEX) the resolution of a composition is dictated
                             entirely by the subdivision scheme and the initial_resolution option. For adaptive minimization
                             calculations (VERTEX) the resolution of statically generated compositions is controlled as in
                             convexhull calculations, but the compositional resolution for dynamically generated compositions
                             is limited by the final_resolution keyword. In particular for non-linear subdivision, this has
                             the consequence that the value of XMIN or stretch_factor should be viewed as the order of 
                             magnitude the poorest acceptable resolution. 

                            --------------------------------------------------------------------------- 
                           
                             Solution model types are:

                             2  - simplicial composition space
                             6  - order-disorder, simplicial composition space
                             7  - prismatic composition space (reciprocal when correct)
                             8  - order-disorder, prismatic composition space
                             9  - order-disorder, simplicial composition space with a prismatic vertex
                             10 - simplicial composition space with a prismatic vertex

                             Special model types:

                             0     - internal (fluid) EoS
                             20    - Electrolyte (charge balance) model
                             26    - Haefner H2O-CO2-NaCl
                             29    - BCC Fe-Si alloy, Lacaze & Sundman 1990.
                             30-33 - FeSiC alloys (BCC/FCC/CBCC/HCP), Lacaze & Sundman 1990.
                             39    - generic hybrid fluid EoS
                             40    - Silicate fluid (MRK)
                             41    - COH fluid (hybrid MRK)
                             42    - FeS liquid, Saxena & Eriksson 2015 with ECRG corrections
                            ---------------------------------------------------------------------------

                             Character data is format free.

                            ---------------------------------------------------------------------------

                             comments can be placed between models provided, nothing is written in the first 
                             10 columns. Comments may be placed after data if it is separated from the data 
                             by a '|' marker. Comments may be placed within the data in some cases without the 
                             '|' marker, but it is always safe to add a comment with the marker.
                            --------------------------------------------------------

begin_model                 | solution models begin/end with the begin_model/end_model tags

model_name                  | the name (<11 chars) used to identify the solution model 
abbreviation F              | an abbreviation used optionally for output (solution_names abb)
full_name  fluid            | a long name used to classify the model (e.g., liquid) and optionally for 
                            | output (solution_names ful)

39                          | model type: model_type_39, see perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html

N                           | number of species
name_1    name_2    
...       name_N            | species names, these must match the species names in thermodynamic data file

0 0 ... 0                   | N species flags, if 0 the pure species is treated as part of the solution.

                            | subdivision schemes (see above) for the first N-1 species
0 1 0.1 0                   | scheme for species name_1
...
0 1 0.1 0                   | scheme for species name_N-1

                            | type 39 solution models use an internal EoS to compute excess properties, this is 
                            | indicated by the ideal tag
ideal
                            | type 39 solution models use a molecular configurational entropy model, this is 
                            | indicated by setting the the number of identisites to zero.
0                           | the number of identisites (specify 0 for no model or a molecular entropy model)

                            | the configurational entropy data may be followed by several optional tags and/or sections:

reach_increment 0           | see www.perplex.ethz.ch/perplex_options_body.html#reach_increment

refine_endmembers           | see www.perplex.ethz.ch/perplex_options_body.html#refine_endmembers_solution_model_file

                            | currently no provision is made for DQF corrections or van Laar excess funcitons in GFSM
end_of_model
                            --------------------------------------------------------
begin_model
                            COH-Fluid+ Generic Hybrid Fluid EoS with non-linear Subdivision.

                            see COH-Fluid for the linear subdivision version of this model. 

                            See the header of this file for an explanation of non-linear
                            subdivision parameters.

                            See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                            for explanation of this type of fluid model.
                            --------------------------------------------------------
COH-Fluid+
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
7
CO2
CH4
H2S
SO2
H2
CO
H2O

0 0 0 0 0 0 0 0             | endmember flags

1e-5   3e-1      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1.        .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-3      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   2.5e-5    .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision

ideal

0

reach_increment 0 

end_of_model

























                      --------------------------------------------------------
begin_model
                      Cpx(H) - Holland et al (JPet, 2018) Clinopyroxene model.

                      Coded for Perple_X by Julien Cornet Sept 2018.

                      Re-formulated as a triple simplex prism. JADC, Dec 11, 2018.

                      NOTES:

                      to use this model, the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                      cenjh  = 1 en
                        DQF = 3500 - 2 * T + 0.048 * P 
                      cfsg  = 1 fs
                        DQF = 2100 - 2 * T + 0.045 * P
                      cessh = cats + acm - jd
                        DQF = -3450 
                      crdih = cats + kos - jd
                        DQF = -4900
                      mcbuf = cats + 1/2 per + 1/2 ru -1/2 cor
                        DQF = -1750 - 1.2 * T - 0.005 * P
                      kjdh = jd + san - abh
                        DQF = -3750 + 1.189 * P

                      9 compositionally independent endmembers
                      1 ordered endmember
                      15 dependent endmembers
                      16 fillers, 4 are utterly superfluous

                      this formulation limits the buf exchange to {MgTi}/2{Fe} - {FeTi}/2{MgFe}/2

                                           M1     M2     T
                                        ____________________________________

                         Multiplicity      1      1     1/2 <- fake T multiplicity
                                        ____________________________________
                           mkbuf_d         MgTi   K     Si    dependent 
                           mnbuf_d         MgTi   Na    Si    dependent
                           mcbuf           MgTi   Ca   AlSi 
                           mcbuf_d1        MgTi   Ca   AlSi   filler
                           ___
                           mkbuf_d1        MgTi   K     Si    filler 
                           mnbuf_d1        MgTi   Na    Si    filler
                           mbuf_d          MgTi   Mg   AlSi   dependent
                           mfbuf_d         MgTi   Fe   AlSi   dependent
                           _________
                           crkjd_d         Cr     K     Si    dependent
                           crjd_d          Cr     Na    Si    dependent
                           crdi            Cr     Ca   AlSi   
                           crdi_d1         Cr     Ca   AlSi   filler
                           ___
                           crkjd_d1        Cr     K     Si    filler
                           crjd_d1         Cr     Na    Si    filler
                           cren_d          Cr     Mg   AlSi   dependent
                           crfs_d          Cr     Fe   AlSi   dependent
                           _________
                           kess_d          Fe3+   K     Si    dependent
                           ness_d          Fe3+   Na    Si    dependent
                           cess            Fe3    Ca   AlSi
                           cess_d1         Fe3    Ca   AlSi   filler
                           ___
                           kess_d1         Fe3+   K     Si    filler
                           ness_d1         Fe3+   Na    Si    filler
                           mess_d          Fe3    Mg   AlSi   dependent 
                           fess_d          Fe3    Fe   AlSi   dependent
                           _________
                           kjdh            Al     K     Si  
                           jd              Al     Na    Si   
                           cats            Al     Ca   AlSi   
                           cats_d1         Al     Ca   AlSi   filler
                           ___
                           kjd_d1          Al     K     Si    filler
                           jd_d1           Al     Na    Si    filler
                           mats_d          Al     Mg   AlSi   dependent
                           fats_d          Al     Fe   AlSi   dependent
                           _________
                           kjd_d2          Al     K     Si    filler
                           jd_d2           Al     Na    Si    filler
                           di              Mg     Ca    Si
                           hed_d           Fe     Ca    Si    dependent
                           ___
                           kjd_d3          Al     K     Si    filler
                           jd_d3           Al     Na    Si    filler
                           cenjh           Mg     Mg    Si 
                           cfsg            Fe     Fe    Si
                           _______________________________________________

                    Ordered species:

                           cfm             Mg     Fe     Si independent


Cpx(H)
abbreviation Cpx
full_name    clinopyroxene

8                               | model type: prismatic

3                               | number of simplexes comprising the prism

4 2 5                           | 15 true dependent endmembers:

mkbuf_d   mnbuf_d   mcbuf   mcbuf_d1
mkbuf_d1  mnbuf_d1  mfbuf_d mbuf_d 

crkjd_d   crjd_d    crdih   crdi_d1
crkjd_d1  crjd_d1   crfs_d  cren_d 

kess_d    ness_d    cessh    cess_d1
kess_d1   ness_d1   fess_d   mess_d

kjd       jd        cats     cats_d1
kjd_d1    jd_d1     fats_d   mats_d

kjd_d2    jd_d2     hed_d    di    
kjd_d3    jd_d3     cfsg     cenjh

1                               | number of ordered species and definitions 

cfm   = 1/2 cenjh + 1/2 cfsg enthalpy_of_ordering  =  -4400 - 0.0008*P | DQF(cfm) - (DQF(ceng) + DQF(cfsg))/2

begin_limits

cfm = -2 + 2 cfsg + 1 cfm                          delta = 2 zm1fe
cfm =  0 - 2 di - 2 cenjh - 1 cfm                  delta = 2 zm1mg
cfm =  0 - 2 cfsg - 1 cfm                          delta = 2 zm2fe
cfm = -2 + 2 cenjh + 1 cfm                         delta = 2 zm2mgd

end_limits

31                              | number of dependent endmembers and definitions   
                                | 15 true dependent endmembers:
mkbuf_d   = -1 cats  + 1 mcbuf + 1 kjd
mnbuf_d   = -1 cats  + 1 mcbuf + 1 jd
mfbuf_d   = -1 di    + 1 mcbuf + 1 cfm
mbuf_d    = -1 di    + 1 mcbuf + 1 cenjh

crkjd_d   = -1 cats  + 1 crdih + 1 kjd
crjd_d    = -1 cats  + 1 crdih + 1 jd
cren_d    = -1 di    + 1 crdih + 1 cenjh
crfs_d    = -1 di    + 1 crdih + 1 cfm

kess_d    = -1 cats  + 1 cessh + 1 kjd
ness_d    = -1 cats  + 1 cessh + 1 jd
mess_d    = -1 di    + 1 cessh + 1 cenjh
fess_d    = -1 di    + 1 cessh + 1 cfm 

mats_d    = -1 di    + 1 cats  + 1 cenjh
fats_d    = -1 di    + 1 cats  + 1 cfm

hed_d     =  1 di    + 1 cfsg  - 1 cfm
                                | 12 useful dependent filler endmembers
mcbuf_d1  =  1 mcbuf
mkbuf_d1  = -1 cats  + 1 mcbuf + 1 kjd
mnbuf_d1  = -1 cats  + 1 mcbuf + 1 jd

crdi_d1   =  1 crdih
crkjd_d1  = -1 cats  + 1 crdih + 1 kjd
crjd_d1   = -1 cats  + 1 crdih + 1 jd

cess_d1   =  1 cessh
kess_d1   = -1 cats  + 1 cessh + 1 kjd
ness_d1   = -1 cats  + 1 cessh + 1 jd

cats_d1   =  1 cats
kjd_d1    =  1 kjd
jd_d1     =  1 jd
                                | 4 utterly useless dependent filler endmembers,
                                | these could be sawdust for all they do.
kjd_d2    =  1 kjd
jd_d2     =  1 jd
kjd_d3    =  1 kjd
jd_d3     =  1 jd
|                               | endmembers to make the Mg-free Ti exchange, these 
|                               | could replace utterly useless fillers to increase 
|                               | compositional converage

|fcbuf_d   = 1/2 cfsg + 1 mcbuf  - 1/2 cfm
|fbuf_d    = -1 di    + 1/2 cfsg + 1 mcbuf + 1/2 cfm
|fkbuf_d   = 1/2 cfsg - cats + mcbuf - 1/2 cfm + kjdh
|fnbuf_d   = 1/2 cfsg - 1 cats  + 1 mcbuf + jd - 1/2 cfm

0 0 0 0 0 0 0 0 0 0             | endmember flags
0 0 0 0 0 0 0 0 0 0             | endmember flags
0 0 0 0 0 0 0 0 0 0             | endmember flags
0 0 0 0 0 0 0 0 0 0             | endmember flags

                                | First (3d) simplex of the prism (Ca/Mg/Fe-Na-K)

0. .2 0.1  0                    | range and resolution of X(1,1) => Na
0. .3 0.1  0                    | range and resolution of X(1,2) => K
0. .6 0.1  0                    | range and resolution of X(1,3) => Fe

                                | Second (1d) simplex of the prism 

0.9 1. 0.1  0                    | range and resolution of (Fe+Mg)/(Ca+Fe+Mg)

                                | third (4d) simplex of the prism

0. .1 0.1  0                    | range and resolution of X("buf")
0. .1 0.1  0                    | range and resolution of X("cr")
0. .1 0.1  0                    | range and resolution of X("ess")
0. .1 0.1  0                    | range and resolution of X("ts")

begin_excess_function

W(di cfsg)     25.8d3 - 0.03 * p
W(di cats)       13d3 - 0.06 * p
W(di crdih)       8d3
W(di cessh)       8d3
W(di jd)         26d3
W(di cenjh)    29.8d3 - 0.03 * p
W(di cfm)      20.6d3 - 0.03 * p
W(di kjd)        26d3

W(cfsg cats)     25d3 - 0.1 * p
W(cfsg crdih)  38.3d3
W(cfsg cessh)  43.3d3
W(cfsg jd)       24d3
W(cfsg cenjh)   2.3d3
W(cfsg cfm)     3.5d3
W(cfsg kjd)      24d3

W(cats crdih)     2d3
W(cats cessh)     2d3
W(cats jd)        6d3
W(cats cenjh)    45.2d3 - 0.35 * p
W(cats cfm)      27d3 - 0.1 * p
W(cats kjd)       6d3

W(crdih cessh)    2d3
W(crdih jd)       3d3
W(crdih cenjh) 52.3d3
W(crdih cfm)   40.3d3
W(crdih kjd)      3d3

W(cessh jd)       3d3
W(cessh cenjh) 57.3d3   
W(cessh cfm)   45.3d3   
W(cessh kjd)      3d3

W(jd cenjh)      40d3   
W(jd cfm)        40d3   
W(jd kjd)        10d3   

W(cenjh cfm)      4d3  
W(cenjh kjd)     40d3   

W(cfm kjd)       40d3   

end_excess_function

3                                   | 3 site entropy model (M1, M2, T)

6 1                                 | 6 species on m1, mult = 1
z(m1,fe)   = 1 cfsg 
z(m1,mg)   = 1 di + 1 cenjh + 1/2 mcbuf + 1 cfm
z(m1,fe3+) = 1 cessh 
z(m1,Ti)   = 1/2 mcbuf
z(m1,Cr)   = 1 crdih

5 1                                 | 5 species on m2, mult. = 1
z(m2,na)   = 1 jd
z(m2,k)    = 1 kjd
z(m2,mg)   = 1 cenjh
z(m2,fe)   = 1 cfm  + 1 cfsg

2 0.5                              | 2 species on T, effective mult. = 1/4
z(Al,T) = 1/2 cats + 1/2 mcbuf + 1/2 crdih + 1/2 cessh 


begin_van_laar_sizes
alpha(di)     1.2
alpha(cenjh)  1
alpha(cfsg)   1
alpha(jd)     1.2
alpha(kjd)   1.2
alpha(cats)   1.9
alpha(mcbuf)  1.9
alpha(cessh)  1.9
alpha(crdih)  1.9
alpha(cfm)    1
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                      Augite(G) => Green et al (JMG, 2016) Augite model.

                      This model should not be used for "Na-rich" compositions.

                      NOTE: to use this the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                      cenjh = 1 en
                            DQF = 3500 - 2 * T + 0.048 * P 
                      cfsg  = 1 fs
                            DQF = 2100 - 2 * T + 0.045 * P

                      to avoid cluttering thermodynamic data files with the new plague of TC 
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(jd)   =  2000
                      dqf(acm)  = -5000
                      dqf(cats) =  3800  - 2.8816 * T  + 0.01  * P

                      For (nonsensical, but common) positive DFQ's this approach may lead to 
                      interference between the phase relations of the solution model and the 
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      The model composition space is formulated as prism composed of 3 simplexes
                      the first simplex is 2d (ternary) and represents divalent elements Ca-Mg-Fe (M cations), 
                      the second simplex is 1d (binary) and represents the exchange of the M cations for Na
                      and the third simplex is 2d (ternary) and represents the exchange of trivalent Al and Fe for Si.
                      Because some of the exchanges are not possible due to charge balance constraints, the impossible
                      vertices of the simplex are populated by replicating possible vertices (designated 
                      filler vertices below). Filler vertices must be chosen so that each exchange is dependent 
                      on only one prismatic. The use of filler vertices is undesireable because the same bulk 
                      composition may be replicated by different prismatic coordinates. They are employed here 
                      as interim method of forcing VERTEX/MEEMUM to visit every possible bulk composition of a 
                      solution. This unfortunate situation will be remedied in the future by modifying Perple_X
                      to allow compositions formed by the mixture of two or more prisms, for example the Augite(G)
                      compositional 5 dimensional prism with 18 vertices (of which 7 are filler vertices), can 
                      be represented by all possible mixtures of a 4x2 prism [(di-en-mats-macm)-(hed-fs-fats-
                      facm)] and a 2x2 prism [(cats-cacm)-(jd-acm)]. 

                      In the present model the independent prismatic variables (used for specifying) the subdivision
                      of the composition space are:

                         X(1,1) - Na/(Na+M) on M2
                         X(1,2) - Mg/(Na+M) on M2

                         X(2,1) - Ca/M on M2

                         X(3,1) - Fe(3+)/(Al+Fe+M) on M1 (i.e., Ferric-Tschermaks)
                         X(3,2) - Al/(Al+Fe+M) on M1 (i.e., Al-Tschermaks)

                                                                Sites
                                                        M1     M2    T1    T2
                                                     ____________________________________

                                      Mutliplicity      1      1     1      1   
                                                     ____________________________________
                                        _________
                                        Acmite          Fe3    Na    Si     Si             
                                        cacm            Fe3    Ca   AlSi   AlSi  filler
                                        cacm            Fe3    Ca   AlSi   AlSi  filler
                                        ___
                                        Acmite          Fe3    Na    Si     Si   filler 
                                        macm            Fe3    Mg   AlSi   AlSi            dependent 
                                        facm            Fe3    Fe   AlSi   AlSi            dependent
                                        _________
                                        Jadeite         Al     Na    Si     Si
                                        Cats            Al     Ca   AlSi   AlSi
                                        Cats            Al     Ca   AlSi   AlSi  filler
                                        ___
                                        Jadeite         Al     Na    Si     Si   filler
                                        Mats            Al     Mg   AlSi   AlSi            dependent
                                        fats            Al     Fe   AlSi   AlSi            dependent 
                                        _________
                                        Jadeite         Al     Na    Si     Si   utterly useless filler
                                        Diopside        Mg     Ca    Si     Si
                                        hed             Fe     Ca    Si     Si             dependent
                                        ___
                                        Jadeite         Al     Na    Si     Si   utterly useless filler
                                        cEnstatite      Mg     Mg    Si     Si
                                        cferrosilite    Fe     Fe    Si     Si
                                        _________
                                                     ___________________________________

                    Ordered species:    oCaTs           Al     Ca     Si    Al
                                        fmc             Mg     Fe     Si    Si
                      --------------------------------------------------------
                      The (future) dual prism model is:

                                        Prism I (4d)   ____________________________________

                                        Diopside        Mg     Ca    Si     Si
                                        cEnstatite      Mg     Mg    Si     Si
                                        Mats            Al     Mg   AlSi   AlSi dependent 
                                        macm            Fe3    Mg   AlSi   AlSi dependent 
                            Species: 
                                        hed             Fe     Ca    Si     Si  dependent
                                        cferrosilite    Fe     Fe    Si     Si
                                        fats            Al     Fe   AlSi   AlSi dependent 
                                        facm            Fe3    Fe   AlSi   AlSi dependent

                                        Prism II (2d)  ____________________________________

                                        Cats            Al     Ca   AlSi   AlSi
                                        cacm            Fe3    Ca   AlSi   AlSi dependent
                                        Jadeite         Al     Na    Si     Si
                                        Acmite          Fe3+   Na    Si     Si
                      --------------------------------------------------------
Augite(G)
abbreviation Cpx
full_name    clinopyroxene

8                            | model type: prism + orphan vertices

3                            | prism: 3 simplicies with a common vertex
3 2 3                        | 2d 1d 2d

                             | endmembers on the prism vertices


acm     cacm_d  cacm_dd              | (Fe3)-M
acm_d1  macm_d  facm_d

jd      cats    cats_d               | (Al)-M
jd_d1   mats_d  fats_d

jd_d2   di      hed_d                | M-M
jd_d3   cenjh   cfsg

2                            | number of ordered species and definitions

ocats = 1 cats               enthalpy_of_ordering  =  -3800  + 2.8816 * T  -0.01  * P | this undoes the DQF on cats
fmc   = 1/2 cenjh + 1/2 cfsg enthalpy_of_ordering  =  -4400 | DQF(fmc) - (DQF(cenjh) + DQF(cfs))/2

begin_limits

fmc = -2 + 2 cfsg + 1 fmc                        delta = 2 zm1fe
fmc =  0 - 2 di - 2 cenjh - 1 fmc                delta = 2 zm1mg
fmc =  0 - 2 cfsg - 1 fmc                        delta = 2 zm2fe
fmc = -2 + 2 cenjh + 1 fmc                       delta = 2 zm2mg

ocats =  0 - 1 cats                              delta = 2 zAlT2 | these assume p0_ocats = 0 as will be
ocats = -2 + 1 cats                              delta = 2 zAlT1 | true for the model as configured in PX

 | for testing against partially ordered initial configurations (e.g., a result from TC) the 
 | above limit expressions should be replaced with:
 | ocats =  0 - 1 cats  - 1 ocats               delta = 2 zAlT2
 | ocats = -2 + 1 cats  + 1 ocats               delta = 2 zAlT1

end_limits

12                            | number of dependent endmembers and definitions

jd_d1   = 1 jd
jd_d2   = 1 jd
jd_d3   = 1 jd

cats_d  = 1 cats

acm_d1  = 1 acm

cacm_dd = 1 acm   + 1 cats  - 1 jd

hed_d   = 1 di    + 1 cfsg  - 1 fmc 
cacm_d  = 1 acm   + 1 cats  - 1 jd 
mats_d  = 1 cats  + 1 cenjh - 1 di
macm_d  = 1 cats  + 1 cenjh - 1 di   + 1 acm - 1 jd
fats_d  = 1 cats  - 1 di    + 1 fmc
facm_d  = 1 cats  - 1 di    + 1 fmc  + 1 acm - 1 jd

0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 | endmember flags

                             | First (1d) simplex of the prism
0. .1 0.1  0                 | range and resolution of X(1,1) => Na
0. 1. 0.1  0                 | range and resolution of X(1,2) => Mg
                             | Second (1d) simplex of the prism
0. 1. 0.1  0                 | range and resolution of X(2,1) => (Fe+Mg)/Ca
                             | third (3d) simplex of the prisms
0. .3 0.1  0                 | range and resolution of X(3,1) - M-acm
0. .1 0.1  0                 | range and resolution of X(3,2) - M-Ts


begin_excess_function
W(di cenjh)               29.8d3   -0.03 * p
W(di cfsg)                25.8d3   -0.03 * p
W(di jd)                  26d3
W(di acm)                 21d3
W(di ocats)               12.3d3   -0.01 * p
W(di cats)                12.3d3   -0.01 * p
W(di fmc)                 20.6d3   -0.03 * p
W(cenjh cfsg)             2.3d3
W(cenjh jd)               50d3
W(cenjh acm)              62d3
W(cenjh ocats)            45.7d3   -0.29 * p
W(cenjh cats)             45.7d3   -0.29 * p
W(cenjh fmc)              4d3
W(cfsg jd)                60d3
W(cfsg acm)               58d3
W(cfsg ocats)             48d3
W(cfsg cats)              48d3
W(cfsg fmc)               3.5d3
W(jd acm)                 5d3
W(jd ocats)               40d3
W(jd cats)                40d3
W(jd fmc)                 40d3
W(acm ocats)              35d3
W(acm cats)               35d3
W(acm fmc)                60d3
W(ocats cats)             3.8d3   + 0.01 * p
W(ocats fmc)              50d3
W(cats fmc)               50d3
end_excess_function

4                                   | 4 site entropy model (M1, M2, T1, T2)

4 1                                 | 4 species on m1, mult = 1
z(m1,fe)   = 1 cfsg
z(m1,mg)   = 1 di + 1 fmc + 1 cenjh
z(m1,fe3+) = 1 acm 

4 1                                 | 4 species on m2, mult. = 1
z(m2,na)   = 1 acm  + 1 jd
z(m2,mg)   = 1 cenjh
z(m2,fe)   = 1 fmc  + 1 cfsg

2 0.25                              | 2 species on T1, effective mult. = 1/4
z(Al,T1) = 1/2 cats

2 0.25                              | 2 species on T2, effective mult. = 1/4
z(Al,T2) = 1/2 cats + 1 ocats

begin_van_laar_sizes
alpha(di)          1.2
alpha(cenjh)       1
alpha(cfsg)        1
alpha(jd)          1.2
alpha(acm)         1.2
alpha(ocats)       1.9
alpha(cats)        1.9
alpha(fmc)         1.0
end_van_laar_sizes

begin_dqf_corrections
dqf(jd)   =  2000
dqf(acm)  = -5000
dqf(cats) =  3800  - 2.8816 * T  + 0.01  * P
end_dqf_corrections

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model
                      cAmph(G) => Green et al. (JMG, 2016) clinoamphibole. 

                      Perple_X formulation reformulated as a triple-simplex prismatic 
                      composition space and adding M-parg, M-kparg, M-tts, and Ca-grk 
                      exchanges. JADC, November 3, 2018.

                      NOTE: to use this the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                         mrbG  = 1 gl - 1 gr + 1 andr
                            DQF = 0
                         kprg  = 1 mu - 1 pa + 1 parg
                            DQF = -7060 + 20 * T_K
                         tts   = -2 dsp + 2 ru + 1 ts
                            DQF =   95000

                      to avoid cluttering thermodynamic data files with the new plague of TC 
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                         DQF(gl)   = -3000
                         DQF(parg) = -10000
                         DQF(ts)   =  10000
                         DQF(grun) = -3000

                      For (nonsensical, but common) positive DFQ's this approach may lead to 
                      interference between the phase relations of the solution model and the 
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      The model composition space is formulated as prism composed of 3 simplexes
                      the first simplex is 1d (binary) and represents divalent Mg/(Fe+Mg), 
                      the second simplex is 1d (binary) and represents the exchange of divalent M (Fe and Mg) for Ca
                      and the third simplex is 7d (octary) and represents the generalized (M,Ca)-amphibole exchanges: 
                      (M,Ca)-Al_Tschermaks, (M,Ca)-Na_Pargasite, (M,Ca)-K_Pargasite, M-Riebeckite, M-Glaucophane,
                      (M,Ca)-Ti_Tschermaks, and (M,Ca)-Fe3+_tschermaks (Na-free riebeckite).
                      Because some of the exchanges are not possible due to charge balance constraints, the impossible
                      vertices of the simplex (Ca-riebeckite, Ca-glaucophane) are populated by replicating possible 
                      vertices. The current formulation is undesirable both because of these replicated vertices and
                      and because the dependent (M,Ca)-Fe3+_tschermaks adds a dimension to the composition space. 
                      See comments for the Augite(G) model for further discussion. 

                      In the present model the independent prismatic variables (used for specifying) the subdivision
                      of the composition space are:

                         X(1,1) - Mg/(Fe+Mg)

                         X(2,1) - Ca/M on M1, M = divalent Fe and Mg

                         X(3,1) - (M,Ca)-Al_Tschermak
                         X(3,2) - (M,Ca)-Na_Pargasite
                         X(3,3) - (M,Ca)-K_Pargasite
                         X(3,4) - M-Riebeckite
                         X(3,5) - M-Glaucophane
                         X(3,6) - (M,Ca)-Ti_Tschermaks
                         X(3,7) - (M,Ca)-Fe3+_tschermaks (Na-free riebeckite)
                      --------------------------------------------------------

                                                            Sites
                                            A    M1      M2      M4     T1     OH
                                            _______________________________________

                            Multiplicity    1     3      2       2     1(4)    2 
                                            _______________________________________

                              Ts            V     Mg     Al     Ca     SiAl    OH
                              fTs_d         V     Fe     Al     Ca     SiAl    OH
                              ffts_d        V     fe     Al     fe     SiAl    OH
                              mmts_d        V     mg     Al     mg     SiAl    OH

                              Parg          Na    Mg    MgAl    Ca     SiAl    OH
                              fParg_d       Na    Fe    FeAl    Ca     SiAl    OH
                              mpg_d         Na    Mg    mgAl    Mg     SiAl    OH
                              fpg_d         Na    Fe    feAl    fe     SiAl    OH

                              Kprg          K     Mg    MgAl    Ca     SiAl    OH
                              fkPrg         K     Fe    FeAl    Ca     SiAl    OH
                              mkpg_d        K     Mg    mgAl    Mg     SiAl    OH
                              fkpg_d        k     Fe    feAl    fe     SiAl    OH

                              Gl            V     Mg     Al     Na      Si     OH
                              fGl_d         V     Fe     Al     Na      Si     OH

                              mrbG          V     Mg     Fe3    Na      Si     OH
                              frb_d         V     Fe     Fe3    Na      Si     OH

                              Tts           V     Mg     Ti     Ca     SiAl    O
                              fcTts_d       V     Fe     Ti     Ca     SiAl    O
                              mTts_d        V     Mg     Ti     Mg     SiAl    O
                              fTts_d        V     Fe     Ti     Fe     SiAl    O

                              cmgrk_d       V     Mg     Fe3    Ca     SiAl    OH
                              cfgrk_d       V     Fe     Fe3    Ca     SiAl    OH
                              mgrk_d        V     Mg     Fe3    Mg     SiAl    OH
                              fgrk_d        V     Fe     Fe3    Fe     SiAl    OH

                              Tr            V     Mg     Mg     Ca      Si     OH
                              fTr_d         V     Fe     Fe     Ca      Si     OH
                              Cumm          V     Mg     Mg     Mg      Si     OH
                              Grun          V     Fe     Fe     Fe      Si     OH

                              A             V     Mg     Fe     Fe      Si     OH
                              B             V     Fe     Mg     Fe      Si     OH

           dependent exchange Mgrk          V     M      Fe3    M      SiAl     OH
           dependent exchange Mts           V     M       Al    M      SiAl     OH
           dependent exchange Mpg           Na    M      MAl    M      SiAl     OH
           dependent exchange MKpg          K     M      MAl    M      SiAl     OH
           dependent exchange MTts          V     M      Ti     M      SiAl     OH

           2 CaMg-1(M4) = (Tr-Cumm)
           3 FeMg-1(M1) = (grun - a)
           2 FeMg-1(M2) = (grun - b)
           2 FeMg-1(M4) = (-grun - cumm + a + b)

cAmph(G)
abbreviation Amph
full_name    clinoamphibole

8                           | model type: order-disorder, prismatic composition space
3                           | 3 simplex prismatic space
2 2 8                       | 1 binary + 1 binary + septary

                            | the first simplex variable is FeMg-1
                            | the second simplex second variable is CaM-1, M = Fe or Mg
                            | the third simplex variables are:

mts_d      fts_d            | M-Ca-Al_tschermaks
ts         fcts_d

mparg_d    fparg_d          | M-Ca-Na_parg
parg       fcparg_d

kmparg_d   kfparg_d         | M-Ca-K_parg
kprg       kfcprg_d

gl         fgl_d            | M-[Fe3]Na, redundant X(2,1)
gl_d       fgl_d1

mrbG       frb_d            | M-[Al]Na, redundant X(2,1)
mrbG_d     frb_d1

mtts_d     ftts_d           | M-Ca-Ti_tschermaks
tts        fctts_d

mgrk_d     fgrk_d           | M-Ca-Fe3+_tschermaks (Na-free riebeckite)
mcgrk_d    fcgrk_d

cumm       grun             | M-Ca
tr         ftr_d


2                            | ordered species definitions:

a     = 3/7 cumm + 4/7 grun  enthalpy_of_ordering  =   -9486  | = DQF(A) -4/7 DQF(Grun)
b     = 2/7 cumm + 5/7 grun  enthalpy_of_ordering  =  -11657  | = DQF(B) -5/7 DQF(Grun)

begin_limits                                                  

a = -7/4 + 7/4 grun + 1 a + 1/2 b + 5/4 b                           delta = 7/4 z(M1,Fe)
a = -7/3 grun - 4/3 a + 5/3 b - 5/3 b                               delta = 7/3 z(M2,Fe)
a = -7/3 + 7/3 tr + 7/6 parg + 7/6 kprg + 7/3 cumm + 1 a + 5/3 b + 2/3 b  delta = 7/3 z(M2,Mg) only 1 m2 equation can be independent 
a = -7/3 + 7/3 cumm + 1 a - 2/3 b + 2/3 b                           delta = 7/3 z(M4,Mg) only 1 m4 equation can be independent 
a = -7/3 grun - 4/3 a - 2/3 b - 5/3 b                               delta = 7/3 z(M4,Fe)

b = -7/2 grun + 2 a - 2 a - 5/2 b                                   delta = 7/2 z(M1,Fe)
b = -7/5 + 7/5 grun + 3/5 a + 4/5 a + 1 b                           delta = 7/5 z(M2,Fe)
b = -7/5 tr - 7/10 parg - 7/10 kprg - 7/5 cumm + 3/5 a - 3/5 a - 2/5 b  delta = 7/5 z(M2,Mg)
b = -7/2 + 7/2 cumm - 3/2 a + 3/2 a + 1 b                           delta = 7/2 z(M4,Mg)
b = -7/2 grun - 3/2 a - 2 a -5/2 b                                  delta = 7/2 z(M4,Fe)

end_limits

23                         | dependent endmember definitions:

fcts_d = 1 ts + 1 grun - 1 a
fts_d  = 1 ts - 1 tr + 1 b
mts_d  = 1 ts - 1 tr + 1 cumm

fcparg_d  = 1 parg  + 3/2 grun - 1 a - 1/2 b
fparg_d   = 1 parg  + 1/2 grun + 1/2 b - 1 tr
mparg_d   = 1 parg  - 1 tr     + 1 cumm

kfcprg_d  = 1 kprg  + 3/2 grun - 1 a - 1/2 b
kfparg_d  = 1 kprg  + 1/2 grun + 1/2 b - 1 tr
kmparg_d  = 1 kprg  - 1 tr + 1 cumm

mrbG_d   = 1 mrbG
gl_d     = 1 gl
fgl_d    = 1 gl    + 1 grun   - 1 a
fgl_d1   = 1 gl    + 1 grun   - 1 a
frb_d    = 1 mrbG  + 1 grun   - 1 a
frb_d1   = 1 mrbG  + 1 grun   - 1 a

fctts_d  = 1 tts   + 1 grun   - 1 a
ftts_d   = 1 tts   - 1 tr     + 1 b
mtts_d   = 1 tts   - 1 tr     + 1 cumm

mcgrk_d  = 1 mrbG  + 1 ts    - 1 gl
mgrk_d   = 1 mrbG  + 1 ts    - 1 gl     - 1 tr   + 1 cumm
fgrk_d   = 1 mrbG  + 1 ts    - 1 gl     - 1 tr   + 1 b
fcgrk_d  = 1 mrbG  + 1 ts    - 1 gl     - 1 a  + 1 grun

ftr_d    = 1 tr    + 2 grun   - 1 a - 1 b

0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 | endmember flags

                             | imod = 0 -> cartesian subdivision
                             | imod = 1 -> assymetric stretching subdivision
                             | First (1d) simplex of the prism
0. 1.   .1  0    0.43-0.7            | range and resolution for X(1,1) is X(Mg) for all quadrilaterals, imod = 0
                             | Second (1d) simplex of the prism
0. 1.   .1  0    0.05-0.95            | range and resolution for X(2,1) is variably X Ca or Al, imod = 0
                             | Third (7d) simplex of the prism
0. .5   .1  0     0.20           | range and resolution for X(3,1) on Ts-prism, imod = 0
0. .75  .1  0     0.63           | range and resolution for X(3,2) on Parg-prism, imod = 0
0. .5   .1  0     0.05           | range and resolution for X(3,3) on KParg-prism, imod = 0
0. .5   .1  0     0.10           | range and resolution for X(3,4) on Rb-prism, imod = 0
0. .5   .1  0     0.09           | range and resolution for X(3,5) on Gl-prism, imod = 0
0. .5   .1  0     0.12           | range and resolution for X(3,6) on TiTs-prism, imod = 0
0. .5   .1  0     0.29           | range and resolution for X(3,7) on Grk-prism, imod = 0

begin_excess_function

W(tr ts)                  20d3
W(tr parg)                25d3
W(tr gl)                  65d3
W(tr cumm)                45d3
W(tr grun)                75d3
W(tr a)                   57d3
W(tr b)                   63d3
W(tr mrbG)                52d3
W(tr kprg)                30d3
W(tr tts)                 85d3
W(ts parg)               -40d3
W(ts gl)                  25d3
W(ts cumm)                70d3
W(ts grun)                80d3
W(ts a)                   70d3
W(ts b)                 72.5d3
W(ts mrbG)                20d3
W(ts kprg)               -40d3
W(ts tts)                 35d3
W(parg gl)                50d3
W(parg cumm)              90d3
W(parg grun)           106.7d3
W(parg a)               94.8d3
W(parg b)               94.8d3
W(parg mrbG)              40d3
W(parg kprg)               8d3
W(parg tts)               15d3
W(gl cumm)               100d3
W(gl grun)             113.5d3
W(gl a)                  100d3
W(gl b)                111.2d3
W(gl kprg)                54d3
W(gl tts)                 75d3
W(cumm grun)              33d3
W(cumm a)                 18d3
W(cumm b)                 23d3
W(cumm mrbG)              80d3
W(cumm kprg)              87d3
W(cumm tts)              100d3
W(grun a)                 12d3
W(grun b)                  8d3
W(grun mrbG)              91d3
W(grun kprg)              96d3
W(grun tts)               65d3
W(a b)                    20d3
W(a mrbG)                 80d3
W(a kprg)                 94d3
W(a tts)                  95d3
W(b mrbG)                 90d3
W(b kprg)                 94d3
W(b tts)                  95d3
W(mrbG kprg)              50d3
W(mrbG tts)               50d3
W(kprg tts)               35d3

end_excess_function

6                                   | 6 site configurational entropy model (A, M1, M2, M4,T1, OH)

3 1                                 | 3 species on A, mult = 1
z(A,na)    = 1 parg 
z(A,k)     = 1 kprg 

2 3                                 | 2 species on M1, mult = 3
z(M1,fe)   = 1 grun + 1 b 

5 2                                 | 5 species on M2, mult = 2
z(M2,fe)   = 1 grun + 1 a
z(M2,fe3)  = 1 mrbG
z(M2,al)   = 1 ts + 1 gl + 1/2 kprg + 1/2 parg
z(M2,ti)   = 1 tts

4 2                                 | 4 species on M4, mult = 2
z(M4,mg)   = 1 cumm
z(M4,na)   = 1 gl + 1 mrbG
z(M4,fe)   = 1 grun + 1 a + 1 b

2 1                                 | 2 species on T1, fake mutiplicity = 1
z(T1,Al)   = 1/2 ts + 1/2 parg + 1/2 kprg + 1/2 tts

2 2                                 | 2 species on OH, mutiplicity = 2
z(OH,O)    = 1 tts

begin_van_laar_sizes

alpha(tr)          1
alpha(ts)          1.5
alpha(parg)        1.7
alpha(gl)          0.8
alpha(cumm)        1
alpha(grun)        1
alpha(a)           1
alpha(b)           1
alpha(mrbG)        0.8
alpha(kprg)        1.7
alpha(tts)         1.5

end_van_laar_sizes

begin_dqf_corrections

DQF(gl)   = -3000
DQF(parg) = -10000
DQF(ts)   =  10000
DQF(grun) = -3000

end_dqf_corrections

end_of_model
                           --------------------------------------------------------
begin_model
                      Universal melt, Holland et al., JPet, 2018. 

                      JADC 12/18

                      This model requires the following make definitions in the
                      thermodynamic data file make_definitions section:

                      foHL = 2 foL
                         dqf = 8.75d3  -0.133*Pbar

                      faHL = 2 faL
                         dqf = 13.9d3  - 0.056*Pbar

                      qHL = 4 qL
                         dqf =  0.07d3    -0.062*Pbar

                      jdL = 1 abL - 1 qL
                         dqf =  11.85d3 - 0.096*Pbar

                      hmL = 1/2 hemL
                         dqf =  4.05d3 - 0.077*Pbar

                      ekL = 1/2 eskL
                         dqf =  24.75d3   + 0.245*Pbar

                      tiL = 1 ruL
                         dqf =  5.6d3  0    -0.489*Pbar

                      kjL = 1 kspL - 1 qL
                         dqf =  12.35d3  0  -0.210*Pbar

                      to avoid cluttering thermodynamic data files with the new plague of TC 
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(silL) = 6.35d3  -0.320*Pbar
                      dqf(woL)  = -0.18d3  -0.118*Pbar
                      dqf(h2oL) = 3.24d3  -3.9*TK  0.00085*Pbar

                      For (nonsensical, but common) positive DFQ's this approach may lead to 
                      interference between the phase relations of the solution model and the 
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      WARNING 0: DQF'd endmembers (e.g., sil8L, ctjL) created for other thermocalc 
                      melt models (e.g., melt(W), melt(JH)) should be excluded (or deleted from the 
                      thermodynamic data file) from calculations with this model. 

melt(H)
abbreviation Melt
full_name    liquid

6                                   | model type: simplicial composition space with speciation

11                                  | number of endmembers

foHL     faHL
jdL      silL     kjL
woL      ekL      hmL
tiL      qHL      h2oL

1                                   | ordered species definition

                                    | H(ctL) = -108.3d3  +55*TK  +0.053*Pbar - dqfwol - dqfsil + dqfq/4

ctL = 1 woL + 1 silL - 1/4 qHL        Delta(enthalpy)   = -114452.5 + 55*TK + .4755*Pbar

1 1 1 1 1 1 1 1 1 1 1               | endmember flags

0.0 0.3  0.1  0                     | range and resolution of X(fo),  1 => asymmetric subdivision   
0.0 0.3  0.1  0                     | range and resolution of X(fa),  1 => asymmetric subdivision   
0.0 0.8  0.1  0                     | range and resolution of X(jd),  0 => cartesian subdivision   
0.0 0.4  0.1  0                     | range and resolution of X(sil), 1 => asymmetric subdivision  
0.0 0.6  0.1  0                     | range and resolution of X(kj), 1 => asymmetric subdivision   
0.0 0.4  0.1  0                     | range and resolution of X(wo),  1 => asymmetric subdivision
0.0 0.1  0.1  0                     | range and resolution of X(ek),  1 => asymmetric subdivision
0.0 0.1  0.1  0                     | range and resolution of X(hm),  1 => asymmetric subdivision
0.0 0.1  0.1  0                     | range and resolution of X(ti),  1 => asymmetric subdivision
0.0 0.6  0.1  0                     | range and resolution of X(q), 0 => cartesian subdivision  

begin_excess_function 

W(qHL  silL)    9.5d3   -0.1 * Pbar 
W(qHL  woL)   -10.3d3     
W(qHL  foHL)  -26.5d3   -3.12 * Pbar  
W(qHL  faHL)    -12d3   -0.55 * Pbar  
W(qHL  jdL)   -15.1d3   -0.13 * Pbar  
W(qHL  hmL)      20d3
W(qHL  tiL)    24.6d3
W(qHL  kjL)   -17.8d3   -0.05 * Pbar  
W(qHL  ctL)   -14.6d3   
W(qHL  h2oL)   17.9d3   -0.61 * Pbar   

W(silL  woL)  -26.5d3    0.85 * Pbar     
W(silL  foHL)   2.2d3    
W(silL  faHL)   2.5d3    
W(silL  jdL)   16.8d3    
W(silL  hmL)     -5d3   
W(silL  tiL)   15.2d3   -0.04 * Pbar        
W(silL  kjL)      7d3
W(silL  ctL)      4d3   
W(silL  h2oL)  23.7d3   -0.94 * Pbar  

W(woL  foHL)   25.5d3    0.11 * Pbar
W(woL  faHL)     14d3
W(woL  jdL)    -1.2d3
W(woL  tiL)      18d3
W(woL  kjL)    -1.1d3           
W(woL  ctL)     9.5d3           
W(woL  h2oL)   40.3d3   -0.86 * Pbar    

W(foHL  faHL)    18d3
W(foHL  jdL)    1.5d3
W(foHL  tiL)    7.5d3   
W(foHL  kjL)      3d3    
W(foHL  ctL)   -5.6d3   
W(foHL  h2oL)   9.4d3   -1.58 * Pbar
 
W(faHL  jdL)    7.5d3   -0.05 * Pbar
W(faHL  hmL)    -30d3    
W(faHL  tiL)    6.7d3    
W(faHL  kjL)     10d3    
W(faHL  ctL)   -6.5d3    
W(faHL  h2oL)   9.2d3   -1.58 * Pbar

W(jdL  hmL)      10d3    
W(jdL  tiL)    16.5d3    0.14 * Pbar
W(jdL  kjL)    -5.9d3   
W(jdL  ctL)     7.6d3   
W(jdL  h2oL)   -8.2d3   -0.06 * Pbar

W(hmL  kjL)      10d3   
W(hmL  h2oL)   60.2d3   -0.66  * Pbar

W(ekL  h2oL)   60.2d3   -0.66 * Pbar

W(tiL  kjL)       9d3
W(tiL  h2oL)   60.2d3   -0.6 * Pbar

W(kjL  ctL)    -5.6d3    
W(kjL  h2oL)   -0.2d3    0.22 * Pbar

W(ctL  h2oL)   17.3d3    0.05 * Pbar

end_excess_function 

3

2 2.                        | water-vacancy site 
z(H) = 1 h2oL

4 0.                        | M-site
n(Mg) = 4 foHL
n(Fe) = 4 faHL
n(Ca) = 1 woL
n(Al) = 1 silL

9 0.                        | F-site, decompositing "alsi2" here eliminates the necessity of the A-site
n(jdL)   = 1 jdL 
n(kjL)   = 1 kjL
n(alsi)  = 1 silL
n(si0)   = 1 woL
n(ol)    = 1 faHL + 1 foHL
n(q)     = 1 qHL
n(eq)    = 1 ekL
n(ctL)   = 1 ctL
n(hem)   = 1 hmL

begin_dqf_corrections
dqf(silL)  =  6.35d3          - 0.32   *Pbar
dqf(woL)   = -0.18d3          - 0.118  *Pbar
dqf(h2oL)  =  3.24d3  -3.9*TK + 0.00085*Pbar
end_dqf_corrections

end_of_model
                           --------------------------------------------------------
begin_model
                      Tonalitic melt, Green et al., JMG, 2016. 

                      JADC 9/16

                      reformulated as standard O/D model, 12/18, JADC

                      This model requires the following make definitions in the
                      thermodynamic data file make_definitions section:

                      foTL = 2 foL
                         dqf = -4d3 

                      faTL = 2 faL
                         dqf = -8.2d3  - 1.4 * P

                      q8L = 4 qL
                         dqf = 0

                      to avoid cluttering thermodynamic data files with the new plague of TC 
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(silL) = -7800
                      dqf(woL) = 1300

                      For (nonsensical, but common) positive DFQ's this approach may lead to 
                      interference between the phase relations of the solution model and the 
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      WARNING 0: DQF'd endmembers (e.g., sil8L, ctjL) created for other thermocalc 
                      melt models (e.g., melt(W), melt(JH)) should be excluded (or deleted from the 
                      thermodynamic data file) from calculations with this model. 

melt(G)
abbreviation Melt
full_name    liquid

6                                   | model type: simplicial composition space with speciation

8                                   | number of endmembers

foTL     faTL
abL      silL     kspL
woL      q8L      h2oL

1                                   | ordered species definition
                                    | H(oanL) = -46.5d3 - 0.25 * P - dqf(woL) 1300 - dqf(silL) -7800

oanL = 1 woL + 1 silL        Delta(enthalpy)   = -40000  - 0.25 * P

1 1 1 1 1 1 1 1                     | endmember flags

0.0 0.2  0.1  0                     | range and resolution of X(fo),  1 => asymmetric subdivision   
0.0 0.3  0.1  0                     | range and resolution of X(fa),  1 => asymmetric subdivision   
0.0 0.8  0.1  0                     | range and resolution of X(ab),  0 => cartesian subdivision   
0.0 0.4  0.1  0                     | range and resolution of X(sil), 1 => asymmetric subdivision  
0.0 0.6  0.1  0                     | range and resolution of X(ksp), 1 => asymmetric subdivision   
0.0 0.4  0.1  0                     | range and resolution of X(wo),  1 => asymmetric subdivision
0.0 0.6  0.1  0                     | range and resolution of X(q), 0 => cartesian subdivision  

begin_excess_function 

W(q8L abL)    =    12d3   - 0.4 * P
W(q8L kspL)   =   -2d3    - 0.5 * P
W(q8L woL)    =   -5d3      
W(q8L foTL)   =    42d3   + 1.0 * P
W(q8L h2oL)   =    18.1d3 - 0.68 * P
W(q8L oanL)   =   -29.5d3 - 0.1 * P
    
W(abL kspL)   =   -6d3    + 3.0 * P
W(abL woL)    =   -12d3   
W(abL silL)   =    10d3     
W(abL faTL)   =   -30d3   + 0.8 * P
W(abL foTL)   =   -47.3d3 + 0.3 * P
W(abL h2oL)   =   -4.4d3  - 0.17 * P
W(abL oanL)   =    8.6d3  +  0.4 * P

W(kspL woL)   =   -13d3    
W(kspL faTL)  =   -11.3d3    
W(kspL foTL)  =    6.8d3     
W(kspL h2oL)  =    10.4d3 - 0.39 * P
W(kspL oanL)  =   -16d3   - 0.25 * P

W(woL silL)   =   -1.6d3   
W(woL faTL)   =    6.5d3    
W(woL foTL)   =    4d3     
W(woL h2oL)   =    21d3    
W(woL oanL)   =    3.5d3   

W(silL faTL)  =    12d3
W(silL foTL)  =    12d3    
W(silL h2oL)  =    11d3   - 0.5 * P
W(silL oanL)  =    6.4d3   

W(faTL foTL)  =    18d3    
W(faTL h2oL)  =    29d3       
W(faTL oanL)  =   -43.5d3 - 0.95 * P 

W(foTL h2oL)  =    29d3   - 0.5 * P  
W(foTL oanL)  =   -26d3   - 0.6 * P  

W(h2oL oanL)  =    9.75d3 - 0.5 * P

end_excess_function 

3                           | Configurational entropy: two non-temkin sites (Water, Melt) 
                            | and one temkin site (olvine). HP assume a fsp = ab + or "molecule""
                            | with mixing on a temkin M site, but the math works out the same as 
                            | the endmembers are treated as separate endmembers and the M site
                            | dropped. 


2 1.                        | water-vacancy site 
z(H) = 1 h2oL

2 0.                        | temkin olivine site
n(Mg) = 4 foTL
n(Fe) = 4 faTL

8 0.                        | melt site, HP assume a fsp = ab + or "molecule"
                            | with mixing on the M site, but the math works out the same as 
                            | the endmembers are treated as separate endmembers and the M site
                            | dropped. 
z(q)     = 1 q8L
z(ksp)   = 1 kspL
z(ab)    = 1 abL
z(sil)   = 1 silL
z(an)    = 1 oanL
z(wo)    = 1 woL
z(ol)    = 1 faTL + 1 foTL  | this term was not counted prior to dec 12, 2018.
z(H)     = 1 h2oL


begin_dqf_corrections
dqf(silL) = -7800
dqf(woL)  =  1300
end_dqf_corrections

end_of_model
                    -------------------------------------------------------- 
begin_model                
                             CHLORITE, White et al JMG 32:261-286, 2014

                             NOTES:  

                             * This model will only function in the Al-free and
                               Mg-free limits if Al and Mg are retained as thermodynamic
                               components.

                             JADC 4/14

                             This model requires the following make definition for f3clin:

                                      f3clin = 1 clin - 1/2 gr + 1/2 andr
                                      2d3 0 0 

                             TJ 4/14

                             Mn endmembers entered, P.-H. Trapy, 5/16

                             Site limits corrected, JADC, 5/16

                                                      M1      M2+M3     M4     T2
                                                     ________________________________

                                      Mutliplicity    1         4       1      2 
                                                     ________________________________
  
                                      1 fames         Al        Fe      Al     Al_Al   dependent
                                      2 fafchl        Fe        Fe      Fe     Si_Si   dependent
                                      3 ff3cli        Fe        Fe      Fe3+   Al_Si   dependent
                                      4 daph          Fe        Fe      Al     Al_Si 
                                      5 f3clin        Mg        Mg      Fe3+   Al_Si   
                                      6 ames          Al        Mg      Al     Al_Al
                                      7 afchl         Mg        Mg      Mg     Si_Si
                                      8 clin          Mg        Mg      Al     Al_Si 

                                      9 mnchl         Mn        Mn      Al     Al_Si
                                                      _______________________________ 

                                     13 och1          Mg        Fe      Fe     Si_Si   ordered
                                     14 och2          Fe        Mg      Mg     Si_Si   ordered

Chl(W)
abbreviation Chl
full_name    chlorite

9                               | model type: order-disorder, prismatic vertex + orphan vertices

2                               | prismatic vertex:
4 2                             | quaternary + binary simplexes 
1                               | number of orphan vertices

                                | endmembers on the prismatic vertex
fames    fafchl   ff3cli   daph
ames     afchl    f3clin   clin
                                | orphan endmembers
mnchl

2                               | number of ordered species

och1 = 1 afchl  - 1 clin   + 1 daph      enthalpy_of_ordering = 3d3
och2 = 1 afchl  - 1/5 clin + 1/5 daph    enthalpy_of_ordering = 2.4d3 

begin_limits

och1 =  0                                                                             delta = 1   zFeM4 
och1 = -1   + 1 afchl + 1 och1   + 0 och2 + 1 och2                           delta = 1   zMgM4 
och1 = -1   + 1 daph  + 1 och1 + 4/5 och2 + 1/5 och2                                  delta = 1   zFeM1 
| this limit may never be active??
och1 =     - 1 afchl  - 1 clin - 1 f3clin + 4/5 och2 - 4/5 och2                       delta = 1   zMgM1 

och2 =      - 5/4 daph   + 5/4 och1   - 5/4 och1 - 1/4 och2                delta = 5/4 zFeM1 
och2 = -5/4 + 5/4 afchl  + 5/4 f3clin + 5/4 clin + 5/4 och1 + 1 och2         delta = 5/4 zMgM1 
och2 = -5   + 5 daph                  + 0   och1 + 5   och1 + 1 och2         delta = 5   zFeM2 
och2 =      - 5 ames - 5 f3clin - 5 clin -5 afchl - 4 och2                   delta = 5   zMgM2.

end_limits

3                               | 6 dependent endmembers 

fames  = 1 ames   + 1 daph - 1 och2 + 1 afchl - 1 clin
fafchl = 1 och1   + 1 och2 - 1 afchl
ff3cli = 1 f3clin + 1 daph - 1 clin

0 0 0 0 0 0 0 0 0 0 0 0         |endmember flags

                                | subdivision model for (quaternary) chemical mixing space
0. 1. .1 0                      | range and resolution of X(M-ames),   imod = 0 -> cartesian subdivision
0. 1. .1 0                      | range and resolution of X(M-afchl),  imod = 0 -> cartesian subdivision
0. 1. .1 0                      | range and resolution of X(M-f3clin), imod = 0 -> cartesian subdivision

                                | subdivision model for (ternary) chemical mixing space
0. 1. .1 0                      | range and resolution of X(Fe), imod = 0 -> cartesian subdivision 
0. 1. .1 0                      | range and resolution of X(Mg), imod = 0 => cartesian subdivision

begin_excess_function

W(clin afchl)             17d3           0.         0.
W(clin ames)              17d3           0.         0.
W(clin daph)              20d3           0.         0.
W(clin och1)              30d3           0.         0.
W(clin och2)              21d3           0.         0.
W(clin f3clin)             2d3           0.         0.
W(clin mnchl)             15d3           0.         0.
W(afchl ames)             16d3           0.         0.
W(afchl daph)             37d3           0.         0.
W(afchl och1)             20d3           0.         0.
W(afchl och2)              4d3           0.         0.
W(afchl f3clin)           15d3           0.         0.
W(afchl mnchl)            32d3           0.         0.
W(ames daph)              30d3           0.         0.
W(ames och1)              29d3           0.         0.
W(ames och2)              13d3           0.         0.
W(ames f3clin)            19d3           0.         0.
W(ames mnchl)             26d3           0.         0.
W(daph och1)              18d3           0.         0.
W(daph och2)              33d3           0.         0.
W(daph f3clin)            22d3           0.         0.
W(daph mnchl)             10d3           0.         0.
W(och1 och2)              24d3           0.         0.
W(och1 f3clin)          28.6d3           0.         0.
W(och1 mnchl)             25d3           0.         0.
W(och2 f3clin)            19d3           0.         0.
W(och2 mnchl)             31d3           0.         0.
W(f3clin mnchl)           17d3           0.         0.

end_excess_function

4                               | 4 site configurational entropy model:

4 1.                            | 4 species on 1 M1 site

z(al,M1)    = 1 ames 
z(fe,M1)    = 1 daph + 1 och2
z(mn,M1)    = 1 mnchl

3 4.                            | 3 species on 4 M2+M3 sites

z(fe,m2+m3) = 1 daph + 1 och1
z(mn,m2+m3) = 1 mnchl

4 1.                            | 4 species on 1 M4 site

z(fe3,m4)   = 1 f3clin
z(fe,m4)    = 1 och1
z(mg,m4)    = 1 afchl + 1 och2

2 2.                            | 2 species on 2 T2 sites 

z(al,T2)    = 1 ames + 1/2 clin + 1/2 daph + 1/2 f3clin + 1/2 mnchl

begin_dqf_corrections
dqf(mnchl) -13030  0 0
end_dqf_corrections

end_of_model  
                      --------------------------------------------------------
begin_model                         
                                      holland and powell '11 non-ideal cz-fep solution

                                      entered by Pierre-Henri Trapy, May 16, 2016

                                                      M1      M3     
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 cz            Al      Al       
                            Species:  2 fep           Fe      Fe      
                                                      _____________

                        Ordered Cpd:  3 ep            Al      Fe    

Ep(HP11)
abbreviation Ep
full_name    epidote

6                          | model type: speciation           
2                          | 2 endmembers
cz       fep               | endmember names 

1                          | ordered species definition

ep = 1/2 fep + 1/2 cz   Delta(enthalpy) = -12.5d3     
 
0 0 0                      | endmember flags
0. 1. 0.1  0               | range and resolution for X(cz), imod = 0 -> cartesian subdivision

begin_excess_function 
w(cz fep) 3d3 0. 0. 
w(fep ep) 1d3 0. 0.
w(cz ep) 1d3 0. 0. 
end_excess_function

2                          | 2 site (M1, M3) configurational entropy model

2 1.                       | 2 species on M1, 1 site per formula unit.
z(fe,m1) = 1 fep

2 1.                       | 2 species on M3, 1 site per formula unit.
z(al,m3) = 1 cz 

end_of_model               
                      --------------------------------------------------------
begin_model
                      Cpx(JH) => Jennings and Holland, J Pet, 56:869-892, 2015, intended for pressures of 0-60 GPa

                      NOTES:

                      The Cr/Fe3+-free version of this model is from Holland et al., 2013 or 
                      Green et al., 2012?
 
                      Pierre Bouilhol & JADC, 12/16/15 

                      Changed to true T site multiplicity, Oliver Shorttle, 3/16

                      Changed to fake T site multiplicity (1/4) with true Al site fraction, JADC 6/16

                      Changed to fake T site multiplicity (1/2) with true Al site fraction, Bob Myhill, 2/18

                      Formatted as prismatic model w/o Cr & Fe3+. Bob Myhill, 2/18

                      Reformatted as a prismatic + orphan vertex model, the scheme is less than desirable because
                      it explicitly includes ordered states that are computed implicitly by speciation and because 
                      it does not include acm (ncess) or crjd. JADC, 5/18

                      Corrected cess composition assumed in the model (mess was assumed previously). JADC, 6/18

                      reformatted as a 3-simplex prism to allow complete M-essenite exchange. JADC, 11/18.

                      to use this the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                      odi  = 1 di
                            DQF = -100 + 0.211 * T + 0.005 * P | NOTE entropy term incorrect in some perplex files?
                      cenjh  = 1 en
                            DQF = 3500 - 2 * T + 0.048 * P 
                      cfs  = 1 fs
                            DQF = 3800 - 3 * T + 0.03 * P

                      The model composition space is formulated as prism composed of 3 simplexes
                      the first simplex is 2d (ternary) and represents divalent elements Ca-Mg-Fe (M cations), 
                      the second simplex is 1d (binary) and represents the exchange of the M cations for Na
                      and the third simplex is 3d (quaternary) and represents the exchange of trivalent Al, Cr, and Fe 
                      for Si. Because some of the exchanges are not possible due to charge balance constraints, the 
                      impossible vertices of the simplex are populated by replicating possible vertices (designated 
                      filler vertices below). Filler vertices must be chosen so that each exchange is dependent 
                      on only one prismatic. The use of filler vertices is undesireable because the same bulk 
                      composition may be replicated by different prismatic coordinates. They are employed here 
                      as interim method of forcing VERTEX/MEEMUM to visit every possible bulk composition of a 
                      solution. This unfortunate situation will be remedied in the future by modifying Perple_X
                      to allow compositions formed by the mixture of two or more prisms, for example the Augite(G)
                      compositional 5 dimensional prism with 18 vertices (of which 7 are filler vertices), can 
                      be represented by all possible mixtures of a 4x2 prism [(di-en-mats-macm)-(hed-fs-fats-
                      facm)] and a 2x2 prism [(cats-cacm)-(jd-acm)]. 

                      In the present model the independent prismatic variables (used for specifying) the subdivision
                      of the composition space are:

                         X(1,1) - Na/(Na+M) on M2
                         X(1,2) - Mg/(Na+M) on M2

                         X(2,1) - Ca/M on M2

                         X(3,1) - Fe(3+)/(Al+Fe+M) on M1 (i.e., Ferric-Tschermaks)
                         X(3,2) - Al/(Al+Fe+M) on M1 (i.e., Al-Tschermaks)

                                                        M1     M2     T
                                                     ____________________________________

                                      Multiplicity      1      1     1/2 <- fake T multiplicity
                                                     ____________________________________
                                        crjd            Cr     Na    Si    dependent
                                        crdi            Cr     Ca   AlSi   independent
                                        crdi            Cr     Ca   AlSi   filler, independent
                                        ___
                                        crjd            Cr     Na    Si    filler, dependent
                                        cren_d          Cr     Mg   AlSi   dependent
                                        crfs_d          Cr     Fe   AlSi   dependent
                                        _________
                                        ness            Fe3+   Na    Si    dependent
                                        cess            Fe3    Ca   AlSi
                                        cess            Fe3    Ca   AlSi   filler, dependent
                                        ___
                                        ness            Fe3+   Na    Si    filler, dependent
                                        macm (mess)     Fe3    Mg   AlSi   dependent 
                                        facm (fess)     Fe3    Fe   AlSi   dependent
                                        _________
                                        Jadeite         Al     Na    Si   
                                        Cats            Al     Ca   AlSi   
                                        Cats            Al     Ca   AlSi   filler, dependent
                                        ___
                                        Jadeite         Al     Na    Si    filler, dependent 
                                        Mats            Al     Mg   AlSi   dependent
                                        fats            Al     Fe   AlSi   dependent
                                        _________
                                        Jadeite         Al     Na    Si    filler, dependent 
                                        di              Mg     Ca    Si    independent
                                        hed_d           Fe     Ca    Si    dependent
                                        ___
                                        Jadeite         Al     Na    Si    filler, dependent 
                                        cenjh           Mg     Mg    Si    independent
                                        cfs             Fe     Fe    Si    independent
                                                      ___________________________________

                    Ordered species:    cfm             Mg     Fe     Si
                      --------------------------------------------------------
                      The (future) dual prism model is:
                                                        M1     M2     T
                                                     ____________________________________

                                      Multiplicity      1      1     1/2 <- fake T multiplicity
                                                     ____________________________________
                    Prism I species:
                                        di              Mg     Ca    Si    independent
                                        cenjh           Mg     Mg    Si    independent
                                        mats_d          Al     Mg   AlSi   dependent 
                                        cren_d          Cr     Mg   AlSi   dependent 
                                        mcess_d         Fe3+   Mg   AlSi   dependent

                                        hed_d           Fe     Ca    Si    dependent
                                        cfs             Fe     Fe    Si    independent
                                        fats_d          Al     Fe   AlSi   dependent
                                        crfs_d          Cr     Fe   AlSi   dependent
                                        fcess_d         Fe3+   Fe   AlSi   dependent
                                                     ____________________________________
                    Prism II species:
                                        cats            Al     Ca   AlSi   independent
                                        crdi            Cr     Ca   AlSi   independent
                                        cess            Fe3+   Ca   AlSi   independent

                                        jd              Al     Na    Si    independent
                                        crjd            Cr     Na    Si    dependent
                                        ncess           Fe3+   Na    Si    dependent
                                                      ___________________________________

Cpx(JH)
abbreviation Cpx
full_name    clinopyroxene
  
8                               | model type: prismatic + orphan vertex, O/D
                                                                       
3                               | number of simplexes comprising the prism
3 2 4                           | number of vertexes on each simplex
                                | quadrilaterals:

crjd_d    crdi    crdi_d               | M-Cr
crjd_d1   cren_d  crfs_d

ness_d    cess    cess_d               | (Fe3)-M
ness_d1   mess_d  fess_d

jd        cats    cats_d               | (Al)-M
jd_d1     mats_d  fats_d

jd_d2     di      hed_d                | M-M
jd_d3     cenjh   cfs

1                               | number of ordered species and definitions 

cfm   = 1/2 cenjh + 1/2 cfs enthalpy_of_ordering  =  -6.65d3  2.5 - 0.039 | DQF(cfm) - (DQF(ceng) + DQF(cfs))/2
                                                           | -3.0 - (3.5 - 2T + 0.048P + 3.8 - 3T + 0.03)/2
                                                           | = -6.65 + 2.5T - 0.039P 

begin_limits

cfm = -2 + 2 cfs + 1 cfm                           delta = 2 zm1fe
cfm =  0 - 2 di - 2 cenjh - 1 cfm                  delta = 2 zm1mg
cfm =  0 - 2 cfs - 1 cfm                           delta = 2 zm2fe
cfm = -2 + 2 cenjh + 1 cfm                         delta = 2 zm2mg

end_limits

17                           | dependent endmember definitions

crjd_d = 1 crdi  + 1 jd   - 1 cats
crjd_d1 = 1 crdi  + 1 jd   - 1 cats
crdi_d = 1 crdi
cren_d = 1 cenjh + 1 crdi - 1 di
crfs_d = 1 cfm   + 1 crdi - 1 di

ness_d = 1 cess + 1 jd  - 1 cats
ness_d1 = 1 cess + 1 jd  - 1 cats
cess_d = 1 cess
mess_d = 1 cess - 1 di  + 1 cenjh
fess_d = 1 cess - 1 di  + 1 cfm 

cats_d = 1 cats 
jd_d1   = 1 jd
jd_d2   = 1 jd
jd_d3   = 1 jd

hed_d  = 1 di    + 1 cfs - 1 cfm
mats_d = 1 cats  + 1 cenjh - 1 di
fats_d = 1 cats  - 1 di   + 1 cfm

0 0 0 0 
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0    | endmember flags

                             | First (2d) simplex of the prism
0. .2 0.1  0                 | range and resolution of X(1,1) => Na
0. 1. 0.1  0                 | range and resolution of X(1,2) => Mg
                             | Second (1d) simplex of the prism 
0. 1. 0.1  0                 | range and resolution of X(2,1) => (Fe+Mg)/Ca
                             | third (3d) simplex of the prisms
0. .1 0.1  0                 | range and resolution of X(3,1) - M-Cr
0. .1 0.1  0                 | range and resolution of X(3,2) - M-acm
0. .1 0.1  0                 | range and resolution of X(3,3) - M-Ts

begin_excess_function
W(di cfs)       20d3  0   0  
W(di cats)     12.3d3  0  -0.1
W(di jd)         26d3  0   0    
W(di cenjh)     29.8d3  0  -0.03
W(di cfm)        18d3  0   0  
W(cfs cats)     25d3  0  -0.1
W(cfs jd)       36d3  0   0 
W(cfs cenjh)      7d3  0   0  
W(cfs cfm)       4d3  0   0  
W(cats jd)        6d3  0   0  
W(cats cenjh)   45.7d3  0  -0.29
W(cats cfm)      27d3  0  -0.1
W(jd cenjh)       40d3  0   0
W(jd cfm)        40d3  0   0
W(cenjh cfm)       4d3  0   0

W(di crdi)     8d3  
W(di cess)     8d3
W(cfs crdi)    34d3  
W(cfs cess)    34d3
W(cats crdi)   2d3 
W(cats cess)   2d3
W(crdi cess)   2d3  
W(crdi jd)     3d3  
W(crdi cenjh)  48d3  
W(crdi cfm)    36d3  
W(cess jd)     3d3  
W(cess cenjh)  58d3  
W(cess cfm)    36d3  
end_excess_function

3                                   | 3 site entropy model (M1, M2, T)

5 1                                 | 3 species on m1, mult = 1
z(m1,fe)   = 1 cfs
z(m1,al)   = 1 cats + 1 jd
z(m1,fe3)  = 1 cess
z(m1,cr)   = 1 crdi

4 1                                 | 4 species on m2, mult. = 1
z(m2,na)   = 1 jd
z(m2,mg)   = 1 cenjh
z(m2,fe)   = 1 cfs  + 1 cfm

2 0.5                               | 2 species on T, effective mult. = 1/2
z(t1,al) = 1/2 cats + 1/2 cess + 1/2 crdi

begin_van_laar_sizes
alpha(di)    =  1.2  
alpha(cfs)   =  1.0  
alpha(cats)  =  1.9  
alpha(crdi)  =  1.9  
alpha(cess)  =  1.9  
alpha(jd)    =  1.2  
alpha(cenjh) =  1.0 
alpha(cfm)   =  1.0 
end_van_laar_sizes

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15 

                             Temkin M-site added 3/16, Oliver Shorttle
Melt(JH)
abbreviation Melt
full_name    liquid

2
8
jdjL ctjL fojL fajL dijL hmjL ekjL qjL 

0 0 0 0 0 0 0 0 

0. .5  .1 0                 
0. .3 .1 0                 
0. 1   .1 0                 
0. .5   .1 0                 
0. 0.5 .1 0                 
0. 0.1 .1 0                 
0. 0.1 .1 0                 

begin_excess_function
W(qjL dijL)     26d3   0  -0.4
W(qjL jdjL)    -10d3   0   0 
W(qjL ctjL)    -10d3   0   0   
W(qjL fojL)    -25d3   0  -0.1  
W(qjL fajL)     -7d3   0   0  
W(dijL ctjL)    -2d3   0   0      
W(dijL fojL)    24d3   0   0.2  
W(dijL fajL)    17d3   0   0 
W(ctjL fojL)    -1d3   0   0.1
W(fojL fajL)     9d3   0   0  
end_excess_function

2               only 2 sites contribute to configurational entropy

3 0.            Temkin M-site has Fe, Mg, Ca
n(Ca) = 1 dijL
n(Mg) = 1 dijL + 2 fojL
n(Fe) = 2 fajL

7 1.            F site
z(jd) = 1 jdjL
z(di) = 1 dijL
z(ct) = 1 ctjL
z(ol) = 1 fojL + 1 fajL
z(q)  = 1 qjL
z(ek) = 1 ekjL

end_of_model
                      --------------------------------------------------------
begin_model      
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15
O(JH) 
abbreviation Ol
full_name    olivine 

2                                     model type: simplicial composition space
2                                     2 endmembers
fo       fa            
0  0                                | endmember flags

0.0 1.0  0.1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 9000. 0. 0.                 
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(fe) = 1 fa 

end_of_model              
                      --------------------------------------------------------           
begin_model               
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15 

                             Removed extraneous line in Sp(JH) excess 
                             definitions [which read w(sp herc) 7d2  0  0]
                             Added z(al)  = 2/3 sp + 2/3 herc definition to Sp(JH) 
                             configurational entropy site fractions.

                             Oliver Shorttle, 3/18/16

Sp(JH)                      
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space
4                          | 4 endmembers 
sp mt picr herc

0  0  0  0                 | endmember flags

0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
W(sp herc)     4d3  0  0
W(sp mt)      56d3  0  0
W(sp picr)    39d3  0  0
W(herc mt)    32d3  0  0
W(herc picr)  27d3  0  0
W(mt picr)    36d3  0  0 
end_excess_function 

1

5 3.                        cations disordered across all sites

z(al)  = 2/3 sp + 2/3 herc
z(mg)  = 1/3 sp + 1/3 picr
z(fe3) = 2/3 mt
z(cr)  = 2/3 picr

end_of_model               
                      --------------------------------------------------------
begin_model               
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15

Pl(JH)
abbreviation Pl
full_name    binary-feldspar

2                          | model type: simplicial composition space
2                          | 2 endmembers  
abh      an      
  1  0                     | endmember flags
0. 1. .1  0                | imod = 0 -> cartesian subdivision
begin_excess_function 
w(abh an) 22.4d3 0  0  
end_excess_function 

2                          | 2 sites (O, T) kerrick and darkens Al-avoidance model:
2 1.                       | 2 species on O site, multiplicity = 1.
z(Na) = 1 abh

2 2.                       | 2 species on T, mutiplicity = 2.
z(Al) = 1/2 + 1/2 an

begin_van_laar_sizes
alpha(abh)   1.0   0  0
alpha(an)    0.39  0  0
end_van_laar_sizes

end_of_model         
                      -------------------------------------------------------- 
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15 

                                                      X       Y 
                                                     _____________

                                      Mutliplicity    3       2     
                                                     _____________

                          Dependent:   fkho_d        Fe      Fe3+      
                          Dependent:   kho_d         Mg      Fe3+
                                       andr          Ca      Fe3+

                          Dependent:   fkno_d        Fe      Cr     
                                       knor          Mg      Cr
                          Dependent:   ckno_d        Ca      Cr
   
                                       alm           Fe      Al     
                                       py            Mg      Al     
                                       gr            Ca      Al          

Grt(JH)
abbreviation Gt
full_name    garnet

7
2
3 3 
alm     py     gr 
fkno_d  knor   ckno_d
fkho_d  kho_d  andr

4
fkno_d = 1 alm + 1 knor - 1 py  
ckno_d = 1 gr  + 1 knor - 1 py 
fkho_d = 1 alm + 1 andr - 1 gr
kho_d  = 1 py  + 1 andr - 1 gr

0 0 0 0 0 0 0 0 0

0. 1. .1   0
0. 1. .1   0
      
0. 1. .1   0
0. 1. .1   0
              
begin_excess_function                 
W(py alm)       4d3        0   0.1
W(py gr)       35d3        0   0.1    
W(py andr)     91d3      1.7   0.032 
W(py knor)      2d3        0   0
W(alm gr)       4d3        0   0.1
W(alm andr)    60d3      1.7   0.032
W(alm knor)     6d3        0   0.01
W(gr andr)      2d3        0   0
W(gr knor)     47d3    -33.8   0.221   
W(andr knor)  101d3    -32.1   0.153
end_excess_function 

2
3 3.
z(m1,fe) = 1 alm
z(m1,mg) = 1 py + 1 knor

3 2.
z(m2,cr)  = 1 knor
z(m2,fe3) = 1 andr

end_of_model 
                      -------------------------------------------------------- 
begin_model                
                             Jennings and Holland, J Pet, 56:869-892, 2015

                             originally from 

                             Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15 

                             T-site mixing added 3/16, O. Shorttle. 

                             T-site mixing corrected for a false multiplicity of 1/4,
                             with the fully disordered tetrahedral Al site fraction. 
                             JADC, 6/10/15

                             Changed fake T site multiplicity from 1/4 to 1/2 
                             with true Al site fraction. Bob Myhill, 2/18

                      NOTE: to use this the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                      odi  = 1 di
                            DQF = -100 + 0.211 * T + 0.005 * P | NOTE entropy term incorrect in some perplex files


                                                      M1      M2     T 
                                                     _____________________

                                      Mutliplicity    1       1      1/4
                                                     ______________________

                                        en            Mg      Mg     SiSi
                                        mgts          Al      Mg     SiAl 
                                        oen           Fe3+    Mg     SiAl   
                                        cren          Cr      Mg     SiAl   
      
                            Species:    fs            Fe      Fe     SiSi      
                                        tsfs          Al      Fe     SiAl      dependent
                                        ofs           Fe3+    Fe     SiAl      dependent  
                                        crfs          Cr      Fe     SiAl      dependent 

                            Species:    odi           Mg      Ca     SiSi       
                                        tsdi          Al      Ca     SiAl     dependent
                                        odif          Fe3+    Ca     SiAl     dependent  
                                        odicr         Cr      Ca     SiAl     dependent 
                                                      _____________

                           Internal:    opx           Mg      Fe     SiSi         

Opx(JH)
abbreviation Opx
full_name    orthopyroxene 

8                          | model type: Reciprocal with speciation

2                          | 2 independent composition spaces
3 4                        | 3 dimensions on first space, 4 on second

                           | endmembers: 
odif    oen     ofs     
odicr   cren    crfs   
tsdi    mgts    tsfs    
odi     en      fs     

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6d3          

begin_limits
opx =     - 2 fs - 1 opx                delta = 2 z(M2,Fe)
opx =  -2 + 2 fs + 1 opx                delta = 2 z(M1,Fe)
opx =     - 2 en - 1 opx                delta = 2 z(M1,Mg)
end_limits   

6                          | 6 dependent endmembers

tsfs  = 1 mgts   + 1 opx - 1 en
tsdi  = 1 odi    + 1 mgts - 1 en 

ofs   = 1 oen    + 1 opx - 1 en  
odif  = 1 odi    + 1 oen - 1 en 

crfs  = 1 cren   + 1 opx - 1 en  
odicr = 1 odi    + 1 cren - 1 en 
                                               
0 0 0 0 0 0 0 0 0 0 0 0    | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (ternary) site 1 (M1):
0. .2 .1   0                
0. 1. .1   0
                           | subdivision model for (quaternary) site 2 (M2):
0. 1. .1   0                
0. 1. .1   0
0. 1. .1   0

begin_excess_function                
W(en fs)        5.2d3  0   0
W(en opx)         4d3  0   0
W(en odi)    32.2d3  0   0.12 
W(en mgts)       13d3  0  -0.15
W(en cren)        8d3  0   0
W(en oen)         8d3  0   0
W(fs opx)         4d3  0   0
W(fs odi)      24d3  0   0
W(fs mgts)        7d3  0  -0.15
W(fs cren)       10d3  0   0
W(fs oen)        10d3  0   0
W(opx odi)     18d3  0   0
W(opx mgts)       2d3  0  -0.15
W(opx cren)      12d3  0   0
W(opx oen)       12d3  0   0
W(odi mgts)  75.4d3  0  -0.94
W(odi cren)    30d3  0   0   
W(odi oen)     30d3  0   0   
W(mgts cren)      2d3  0   0
W(mgts oen)       2d3  0   0
W(cren oen)       2d3  0   0
end_excess_function 

3                          | 2 site (M1, M2, T1) configurational entropy model

5 1.                       | 5 species on M1, 1 site per formula unit.
z(m1,fe)   = 1 fs 
z(m1,cr)   = 1 cren
z(m1,fe3+) = 1 oen
z(m1,al)   = 1 mgts 

3 1.                       | 3 species on M2, 1 site per formula unit. OS_EDIT-3/16 changed comment [2 species...]
z(m2,ca) = 1 odi
z(m2,fe) = 1 fs + 1 opx

2 0.5                      | 2 species on "1/2" T sites with true site fraction.
z(t,al) = 1/2 mgts + 1/2 cren + 1/2 oen


begin_van_laar_sizes
alpha(en)     1.0  0  0
alpha(fs)     1.0  0  0
alpha(opx)    1.0  0  0
alpha(odi)  1.2  0  0
alpha(mgts)   1.0  0  0
alpha(cren)   1.0  0  0
alpha(oen)    1.0  0  0
end_van_laar_sizes

end_of_model      
                                  --------------------------------------------------------
begin_model 

                                  Ca-Fe2+-Mg-Al-Fe3+ Garnet, White et al., JMG 32:261-286, 2014.

                                  * In calculations that use this model, the andradite endmember ("andr") in the Holland
                                  and Powell data base must be excluded. This model also requires the following make
                                  definition for khoharite in the thermodynamic data file:

                                      kho1 = 1 py - 1 gr + 1 andr
                                      27d3 0 0  

                                  * Mn added as in Gt(WPPH). JADC 4/14

                                  * Mn excess energy updated, alpha(kho1 & spss) reduced 
                                    to 1.0 (formerly 2.7). Felix Gervais, 1/28/2015.
    
                                                      X       Y 
                                                     _____________

                                      Mutliplicity    3       2     
                                                     _____________

                          Dependent:   fkho_i        Fe      Fe3+      
                          Dependent:   kho1          Mg      Fe3+
                          Dependent:   fmn_i         Mn      Fe3+
                                       andr_i        Ca      Fe3+
   
                                       spss          Mn      Al
                                       alm           Fe      Al     
                                       py            Mg      Al     
                                       gr            Ca      Al          

Gt(W) 
abbreviation Gt
full_name    garnet

7                            | model type: prismatic (reciprocal)
2                            | the number of independent subcompositions
4  2                         | 4 species on site 1, 2 species on site 2. 
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mn-Mg-Fe-Ca and the species that mix on 
                             | site 2 are Al-Fe3+.                                                                          

spss   alm      py     gr    | endmember names 
fmn_i  fkho_i   kho1  andr_i


3                                 | number of dependent endmembers 

andr_i = 1 kho1  - 1 py   +1 gr  
fkho_i = 1 kho1  + 1 alm  -1 py  
fmn_i  = 1 kho1  + 1 spss -1 py 

0  0  0  0  0  0  0  0            | endmember flags

0. .2   0.1  0                     | imod = 0 -> cartesian subdivision (xmn) on X
0. 1.   0.1  0                     | imod = 0 -> cartesian subdivision (xfe) on X
0. 1.   0.1  0                     | imod = 0 -> cartesian subdivision (xmg) on X

0. 1.   0.1  0                     | imod = 0 -> cartesian subdivision x(fe3+) on Y

begin_excess_function
W(py  alm)               2.5d3           0         0         | as given by Green et al 2016.
W(py  gr)                30.1d3          0         0.164
W(py  kho1)              5.4d3           0         0
W(py  spss)                2d3           0         0
W(alm gr)                  5d3           0         0
W(alm kho1)            21.63d3           0         0.168
W(alm spss)                2d3           0         0
W(gr  kho1)           -16.15d3           0         0.164
w(spss kho1)           28.43d3           0         0.168 
end_excess_function  

2                                     |2 site entropy model

4 3.                                  |4 species, site multiplicity 3
z(x,mn) = 1 spss 
z(x,fe) = 1 alm 
z(x,ca) = 1 gr

2 2.                                  |2 species, site multiplicity 2
z(y,al) = 1 spss + 1 alm + 1 py + 1 gr

begin_van_laar_sizes
alpha(py)       1.0    0.    0.
alpha(alm)      1.0    0.    0.
alpha(gr)       2.7    0.    0.
alpha(kho1)     1.0    0.    0.
alpha(spss)     1.0    0.    0.
end_van_laar_sizes

end_of_model
                              --------------------------------------------------------
begin_model
                                      Melt, White et al., JMG 32:261-286, 2014. 

                                      JADC 4/14

                                      reformulated as ordinary configurational entropy model. JADC 12/18.

                                      This model requires the following make definitions in the
                                      thermodynamic data file make_definitions section:

                                      sil8L = 8/5 silL
                                      -23d3 0 0 

                                      fo8L = 2 foL
                                      -10d3 0 0 

                                      fa8L = 2 faL
                                      -9d3 0 -1.3

                                      q8L = 4 qL
                                      0 0 0

                                      WARNING 3: the (stabilizing) dqf corrections made
                                      to the fo8L, fa8L, and sil8L enedmembers make the 
                                      haplogranite melt model inapplicable to melts where
                                      these endmembers are present in high concentrations,
                                      to model such situations or to reproduce the published
                                      fo-fa-q or sil-q melting phase relations, the dqf corrections
                                      (below) should be set to zero. 

                                      WARNING 5: The melt model incorrectly predicts a high 
                                      pressure-low temperature stability field for water-silica
                                      rich melts. at 10 kb this field extends to ca 750 K and 
                                      at 3 kb to ca 550 K. To eliminate this artifact set T_melt 
                                      in perplex_option.dat.

melt(W)
abbreviation Melt
full_name    liquid

2                                     model type: simplicial composition space.

8                                     number of endmembers

fo8L     fa8L
abL      sil8L    anL
kspL     q8L      h2oL

0 0 0 0 0 0 0 0 0                   | endmember flags.  

2d-3 0.1  0.1 1                      | range and resolution of X(fo),  1 => asymmetric subdivision   
2d-3 0.1  0.1 1                      | range and resolution of X(fa),  1 => asymmetric subdivision   
0.0  0.4  0.1 0                      | range and resolution of X(ab),  0 => cartesian subdivision   
2d-3 0.1  0.1 1                      | range and resolution of X(sil), 1 => asymmetric subdivision  
2d-3 0.2  0.1 1                      | range and resolution of X(an),  1 => asymmetric subdivision   
0.0  0.5  0.1 0                      | range and resolution of X(ksp), 0 => cartesian subdivision
0.0  0.6  0.1 0                      | range and resolution of X(q),   0 => cartesian subdivision  

begin_excess_function 

W(q8L abL)                 12d3           0      -0.4
W(q8L kspL)                -2d3           0      -0.5
W(q8L anL)                  5d3           0         0
W(q8L sil8L)               12d3           0         0
W(q8L fo8L)                12d3           0      -0.4
W(q8L fa8L)                14d3           0         0
W(q8L h2oL)                17d3           0      -0.5
W(abL kspL)                -6d3           0         3
W(abL sil8L)               12d3           0         0
W(abL fo8L)                10d3           0         0
W(abL fa8L)                 2d3           0         0
W(abL h2oL)              -1.5d3           0      -0.3
W(kspL anL)                 0d3           0        -1
W(kspL sil8L)              12d3           0         0
W(kspL fo8L)               12d3           0         0
W(kspL fa8L)               12d3           0         0
W(kspL h2oL)              9.5d3           0      -0.3
W(anL h2oL)               7.5d3           0      -0.5
W(sil8L fo8L)              12d3           0         0
W(sil8L fa8L)              12d3           0         0
W(sil8L h2oL)              11d3           0         0
W(fo8L fa8L)               18d3           0         0
W(fo8L h2oL)               11d3           0      -0.5
W(fa8L h2oL)               12d3           0         0

end_excess_function 

3                           | Configurational entropy: two non-temkin sites (Water, Melt) 
                            | and one temkin site (olvine).

2 1.                        | water-vacancy site 
z(H)     = 1 h2oL

2 0.                        | temkin olivine site
n(Mg)    = 4 fo8L
n(Fe)    = 4 fa8L

7 0.                        | melt species site, treating ksp and abl as separate species
n(q)     = 1 q8L            | accomplishes the same thing as adding them to form fsp and then
n(ksp)   = 1 kspL           | adding a fsp temkin site.
n(ab)    = 1 abL
n(sil)   = 1 sil8L
n(an)    = 1 anL
n(ol)    = 1 fo8L + 1 fa8L  | this term was not counted prior to dec 2018.
n(w)     = 1 h2oL

end_of_model
                      --------------------------------------------------------
begin_model
                             Mica(W), White et al., JMG 32:261-286, 2014.

                             This model requires the make definitions:

                                fmu = 1 mu + 1/2 andr - 1/2 gr
                                25d3 0 0 

                                ma1_dqf = 1 ma
                                6.5d3 0 0 

                             in the thermodynamic data file (e.g., hp11ver.dat), additionally the 
                             endmember "ma" must be exlcuded from any calculations that employ this
                             model.

                             In thermocalc, different dqf's are used for "muscovite", "margarite"
                             and "paragonite" described by this model. this treatment is clearly 
                             inconsistent and not followed here. The dqf's given above are for the
                             thermocalc "muscovite" phase. 

                             JADC, 4/14                                                           
                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _
                                      3 ma1_dqf       Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 fmu           K       Al      Fe3+  AlSi    _


Mica(W)
abbreviation Mica
full_name    white-mica

2                            | model type: simplex

6                            | 6 endmembers

mu pa ma1_dqf cel fmu fcel

0 0 0 0 0 0 0 0              | endmember flags

                             | subdivision model
0. 1.    .1 0                | range and resolution of X(mu),      imod = 0 -> cartesian subdivision
0. 1.    .1 0                | range and resolution of X(pa),      imod = 0 -> cartesian subdivision
0. 1.    .1 1                | range and resolution of X(ma1_dqf), imod = 0 -> cartesian subdivision
0. 1.    .1 0                | range and resolution of X(cel),     imod = 0 -> cartesian subdivision
0. .3    .1 0                | range and resolution of X(fmu), 
begin_excess_function

W(mu cel)                  0d3           0       0.2
W(mu fcel)                 0d3           0       0.2
W(mu pa)               10.12d3         3.4       0.353
W(mu ma1_dqf)             34d3           0         0
W(mu fmu)                  0d3           0         0
W(cel fcel)                0d3           0         0
W(cel pa)                 45d3           0       0.25
W(cel ma1_dqf)            50d3           0         0
W(fcel pa)                45d3           0       0.25
W(fcel ma1_dqf)           50d3           0         0
W(pa ma1_dqf)             18d3           0         0
W(pa fmu)                 30d3           0         0
W(ma1_dqf fmu)            35d3           0         0

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1.                        | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel + 1 fmu  
z(a,na) = 1 pa 

3 1.                        | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma1_dqf + 1 fmu
z(m2a,mg) = 1 cel

2 1.                        | 2 species on M2b, 1 site per formula unit.
z(m2b,fe) = 1 fmu

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 fmu + 1 ma1_dqf 

begin_van_laar_sizes                        
alpha(mu)      0.63 0. 0.                        
alpha(pa)      0.37 0. 0.                     
alpha(ma1_dqf) 0.63 0. 0.    
alpha(cel)     0.63 0. 0.
alpha(fmu)     0.63 0. 0.
alpha(fcel)    0.63 0. 0.
end_van_laar_sizes

end_of_model                  
                      --------------------------------------------------------
begin_model       
                             Fe3-Fe-Mg Ctd, White et al., JMG 32:261-286, 2014.

                             This model requires the make definitions:

                                ctdo = 1 mct + 1/4 andr - 1/4 gr
                                25d3 0 0 

                             JADC, 4/14

Ctd(W)
abbreviation Ctd
full_name    chloritoid

2                          | model type: simplicial composition space
3                          | 3 endmembers 
ctdo    fctd     mctd                 
  0  0  0                  | endmember flags

                           | Note restricted range on X(Mn)
              
0. .2 0.1 0                | range and resolution for X(Fe3), imod = 1 -> asymmetric transform subdivision
0. 1. 0.1 0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function 
W(mctd fctd)               4d3           0         0
W(mctd ctdo)               1d3           0         0
W(fctd ctdo)               5d3           0         0 
end_excess_function 

2                                     1 site entropy model

2 1.                                  2 species on M1b, site multiplicity = 1.
z(Fe) = 1 fctd

2 0.5                                2 species on M1a, site multiplicity = 0.5
z(Fe3) = 1 ctdo

end_of_model
                      --------------------------------------------------------
begin_model
                             Ti-Fe-Fe3-Mg-Mn Staurolite, White et al., JMG 32:261-286, 2014. 

                             This model requires the make definitions:

                             msto   = 1 andr  -1 gr  + 1 mst  
                             9d3 0  0
 
                             mstt   = 1 mst - 1 cor   +3/2   ru 
                             13d3 0 0

                             JADC, 4/14

                             Missing DQF for mst added by Mark Caddick. 
                             JADC, 1/26/2014

                             mnst added, vacancy on Al site disassociated 
                             from Ti, by Felix Gervais.  JADC, 1/26/2014

St(W)
abbreviation St
full_name    staurolite

2                                     model type: simplicial composition space
5                                     5 endmembers 

mstt   msto    fst    mnst   mst 

  0  0  0  0  0            | endmember flags

0. 0.1 0.1  0               | range and resolution for X(Ti),  imod = 1 -> asymmetric transform subdivision
0. 0.1 0.1  0               | range and resolution for X(Fe3), imod = 1 -> asymmetric transform subdivision
0. 1. 0.1   0                | range and resolution for X(Fe),  imod = 0 -> cartesian subdivision
0. 1. 0.1   0                | range and resolution for X(Mn),  imod = 0 -> cartesian subdivision 

begin_excess_function 
W(mst fst)                16d3           0         0
W(mst mnst)               12d3           0         0
W(mst msto)                2d3           0         0
W(mst mstt)               20d3           0         0
W(fst msto)               18d3           0         0
W(fst mnst)                8d3           0         0
W(fst mstt)               36d3           0         0
W(mnst msto)              14d3           0         0
W(mnst mstt)              32d3           0         0
W(msto mstt)              30d3           0         0
end_excess_function 

2                                     2 site entropy model

3 4.                                  3 species, site multiplicity of 4
z(Fe) = 1 fst
z(Mg) = 1 mst +1 mstt + 1 msto     | corrected from just 1 mst by Felix Gervais, 4/9/2015. JADC

4 2.                                  4 species, site multiplicity of 2, not clear if the vacancy is associated with Ti
z(Ti)  = 3/4 mstt
z(Fe3) =   1 msto
z(vac) =   1/4 mstt

begin_dqf_corrections
dqf(mst)  -8000 0 0  
dqf(mnst) -190 0 0                  | corrected from 0.19 by Felix Gervais, 4/9/2015. JADC
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model 

                             Fe2+-Fe3+-Mg-Al-Ca Orthopyroxene, White et al., JMG 32:261-286, 2014.  

                             This model requires the make definitions:

                             mots1    = 1 mgts + 1/2  andr  - 1/2   gr
                             2d3 0 0 

                             mnopx = 2 pxmn
                             6.68d3 0 0

                             JADC, 4/14

                             Al site fraction of T "corrected" to (mots1 + mgts)/8 by Mark Caddick. 

                             JADC, 1/26/2015

                             Mn added by Felix Gervais, 1/28/2015.

                             This model is as implemented in THERMOCALC. The implementation is 
                             irrational because Mn is assumed to remain disordered across M1 and 
                             M2, while Al, Fe, Fe3+ and Ca order. The model should only be used 
                             with the site_check set to true in perplex_option.dat

                             JADC, 1/28/2015

                             The correction on 1/26/15 was NOT what is done in thermocalc, 
                             apparently the correct form is to compute the true disordered
                             tetrahedral site fraction  (mots1 + mgts)/2, but apply a fake 
                             multiplicity of 1/4.

                             JADC, 6/10/2016

                             odi replaced by a internal dqf on di

                             JADC, 30/11/2016

                             reformulated as a prismatic + orphan vertex model.

                             JADC, 10/5/2018

                                       Site:          M1      M2      T
                                                     ____________________

                                      Mutliplicity:   1       1       1/4 <- fake
                                                     ____________________

                                      1 en            Mg      Mg      Si 
                            Species:  2 fs            Fe2+    Fe2+    Si 
                                      3 mnopx         Mn      Mn      Si    independent orphan

                                      4 mgts          Al      Mg      AlSi   
                                      5 fets          Al      Fe2+    AlSi  dependent

                                      7 mots1         Fe3+    Mg      AlSi
                                      8 feots         Fe3+    Fe2+    AlSi  dependent

                                     10 di            Mg      Ca      Si
                                     11 fdi           Fe      Ca      Si    dependent
                                                      ___________________

                           Internal: 13 opx           Mg      Fe2+    Si


                           Dependent: fets  = mgts  + opx - en
                                      feots = mots1 + opx - en 
                                      fdi   = di   + opx - en
                           ----------------------------------------------------

Opx(W)                       | solution name.
abbreviation Opx
full_name    orthopyroxene

9                            | model type: O/D, prismatic + orphan vertexes
2                            | prismatic vertex consists of two simplicies with a common vertex
2  4                         | 2 components {Fe2+, Mg} on simplex 1, 4 components {Al, Si, Fe3+, Ti} on simplex 2
1                            | number of orphan vertices

                             | endmembers on the prismatic vertex
mots1    feots 
di       fdi  
mgts     fets_d   
en       fs 
                             | endmembers on orphan vertices
mnopx

1                            | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3   

begin_limits
opx =     - 2 fs - 1 opx                delta = 2 z(M2,Fe)       
opx =  -2 + 2 fs + 1 opx                delta = 2 z(M1,Fe)
opx =     - 2 en - 2 di  - 1 opx        delta = 2 z(M1,Mg)
end_limits                

3                            | dependent endmembers

fets_d = 1 mgts  + 1 opx - 1 en
feots  = 1 mots1 + 1 opx - 1 en
fdi    = 1 di    + 1 fs  - 1 opx                        | corrected march 17, 2017, formerly di - opx + fs

0 0 0 0 0 0 0 0 0          | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for prism simplex 1:
0. 1. .1   0               | range and resolution of X(Mg), subdivision scheme: imod = 0 -> cartesian 

                           | subdivision model for prism simplex 2 
0. .2 .1   0               | range and resolution of X(Fe3+),  subdivision scheme: imod = 1 -> assymetric transform   
0. .2 .1   0               | range and resolution of X(un-Ts), subdivision scheme: imod = 1 -> assymetric transform     
0. .3 .1   0               | range and resolution of X(Ts),    subdivision scheme: imod = 1 -> assymetric transform     

                           | independent (1d) simplex
0. .1  .1 0                | range of mn on independent simplex

begin_excess_function                
W(en fs)                   7d3         0         0
W(en opx)                  4d3         0         0
W(en mgts)                13d3         0     -0.15
W(en mots1)               11d3         0     -0.15
W(en mnopx)                5d3         0         0 
W(en di)                32.2d3         0      0.12
W(fs opx)                  4d3         0         0
W(fs mgts)                13d3         0     -0.15
W(fs mots1)             11.6d3         0     -0.15
W(fs mnopx)              4.2d3         0         0
W(fs di)               25.54d3         0     0.084
W(opx mgts)               17d3         0     -0.15
W(opx mots1)              15d3         0     -0.15
W(opx mnopx)             5.1d3         0         0
W(opx di)              22.54d3         0     0.084
W(mgts mots1)              1d3         0         0
W(mgts mnopx)             12d3         0     -0.15
W(mgts di)              75.4d3         0     -0.94
W(mots1 mnopx)          10.6d3         0     -0.15
W(mots1 di)             73.4d3         0     -0.94
W(di mnopx)             24.54d3         0     0.084
end_excess_function 

3                          | 3 site (M1, M2, T) configurational entropy model

5 1.                       | 5 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 fs 
z(m1,al)   = 1 mgts   
z(m1,fe3+) = 1 mots1
z(m1,mn)   = 1 mnopx

4 1.                       | 4 species on M2, 1 site per formula unit.
z(m2,fe) = 1 fs + 1 opx
z(m2,ca) = 1 di 
z(m2,mn)   = 1 mnopx

2 0.25                     | 2 species on "1/4" T site
z(T,al) = 1/2 mgts + 1/2 mots1

begin_van_laar_sizes                        
alpha(en)       1.0    0.    0.
alpha(fs)       1.0    0.    0.
alpha(opx)      1.0    0.    0.
alpha(mgts)     1.0    0.    0.
alpha(mots1)    1.0    0.    0.
alpha(di)       1.2    0.    0.
alpha(mnopx)    1.0    0.    0.
end_van_laar_sizes

begin_dqf_corrections
dqf(di)  = -100    +   0.211 *T      0.005 *P
end_dqf_corrections

end_of_model 
                      --------------------------------------------------------
begin_model
                             BIOTITE model after White et al., JMG 32:261-286, 2014.

                             NOTE: this model requires make definitions for fbi and tbi
                             in the thermodynamic data file:

                             tbi = 1 phl - 1 br + 1 ru           
                             55e3 0 0 
                             fbi = 1 east - 1/2 gr + 1/2 andr   
                             -3e3 0 0


                             Modified model entered by Tim Johnson, Apr 7, 2014.

                             enthalpy of ordering for obi corrected, Mark Caddick, JADC 1/26/2015.

                             Mn added and Ti occupancy corrected by Felix Gervais, 1/28/2015.

                             This model is as implemented in THERMOCALC. The implementation is 
                             irrational because Mn is assumed to remain disordered across M1 and 
                             M2, while Al, Fe, Fe3+ and Ti order. The model should only be used 
                             with the site_check set to true in perplex_option.dat

                             JADC, 1/28/2015

                                                      M1      M2    T1     H
                                                     ____________________________

                                      Mutliplicity    1       2      2      2 
                                                     ____________________________

                          Dependent:    ffbi          Fe3+    Fe     AlAl   OH   
                                        fbi           Fe3+    Mg     AlAl   OH
                          
                          Dependent:    ftbi          Ti      Fe     AlSi   O
                                        tbi           Ti      Mg     AlSi   O
   
                          Dependent:    Sdph          Al      Fe     AlAl   OH
                                        East          Al      Mg     AlAl   OH

                            Species:    Ann           Fe      Fe     AlSi   OH
                                        Phl           Mg      Mg     AlSi   OH
                                        mnbi          Mn      Mn     AlSi   OH independent orphan
                                                      __________________________

                            Ordered:    Obi           Fe      Mg     AlSi   OH

Bi(W)                        | solution name.
abbreviation Bio
full_name    biotite

9                            | model type: O/D, prismatic + orphan vertexes

2                            | prismatic vertex consists of two simplicies with a common vertex
2  4                         | 2 components {Fe2+, Mg} on simplex 1, 4 components {Al, Si, Fe3+, Ti} on simplex 2
1                            | number of orphan vertices

                             | endmembers on the prismatic vertex
ffbi_i   fbi
ftbi_i   tbi
sdph_i   east
ann      phl
                             | endmembers on orphan vertices
mnbi

1                            | ordered species:

obi = 2/3 phl + 1/3 ann   enthalpy_of_ordering = -2d3

begin_limits
obi = -3   + 3   ann  + 1 obi                       delta = 3 z(M2,Fe) 
obi =      - 3   phl  - 3 tbi - 3 east - 2 obi      delta = 3 z(M2,Mg)
obi =      - 3/2 ann  - 1/2 obi                     delta = 3/2 z(M1,Fe)
obi = -3/2 + 3/2 phl  + 1 obi                       delta = 3/2 z(M1,Mg)
end_limits   

3                            | number of dependent endmembers

sdph_i = 1 east  + 1 ann - 1 obi 
ffbi_i = 1 fbi   + 1 ann - 1 obi
ftbi_i = 1 tbi   + 1 ann - 1 obi

0 0 0 0 0 0 0 0 0            | endmember flags: 0 -> endmember is considered to be part of the solution.

                             | subdivision model for first simplex of the prismatic vertex
0. 1.  .1  0                 | range and resolution of X(Fe)

                             | subdivision model for the second simplex of the prismatic vertex
0. .2  .1  0                 | range and resolution of X(Fe3+)
0. .3  .1  0                 | range and resolution of X(Ti)
0. 1.  .1  0                 | range and resolution of X(Al)

                             | independent (1d) simplex
0. .1  .1 0                  | range of mn on independent simplex

begin_excess_function

W(phl ann)   12d3 0. 0.     
W(phl obi)    4d3 0. 0.
W(phl east)  10d3 0. 0.  
W(phl tbi)   30d3 0. 0.  
W(phl fbi)    8d3 0. 0.
W(phl mnbi)   9d3 0. 0.    
W(ann obi)    8d3 0. 0.
W(ann east)  15d3 0. 0.  
W(ann tbi)   32d3 0. 0.
W(ann fbi)  136d2 0. 0.
W(ann mnbi)  63d2 0. 0.  
W(obi east)   7d3 0. 0.
W(obi tbi)   24d3 0. 0. 
W(obi fbi)  5.6d3 0. 0.
W(obi mnbi) 8.1d3 0. 0. 
W(east tbi)  40d3 0. 0.
W(east fbi)   1d3 0. 0.
W(east mnbi) 13d3 0. 0.
W(tbi fbi)   40d3 0. 0.
W(tbi mnbi)  30d3 0. 0.  
W(fbi mnbi) 116d2 0. 0.    
                
end_excess_function 

4                           | Configurational entropy: 4 sites, M1, M2, T1 H.

6 1.                        | 5 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 ann  + 1 obi   
z(m1,mg)   = 1 phl           
z(m1,Fe3+) = 1 fbi 
z(m1,mn)   = 1 mnbi
z(m1,Ti)   = 1 tbi  

3 2.                        | 2 species on M2, 2 sites per formula unit.

z(m2,fe)   = 1 ann                                                                                
z(m2,mn)   = 1 mnbi 
   
2 2.                        | 2 species on T1, 2 site per formula unit.

z(t1,al) = 1/2  + 1/2 east + 1/2 fbi 

2 2.                        | 2 species on H, 2 site per formula unit.

z(h,o) = 1 tbi 

begin_dqf_corrections
dqf(ann)  -3000  0 0
dqf(mnbi) -7890  0 0
end_dqf_corrections

end_of_model
                     --------------------------------------------------------
begin_model
                             non-ideal CORDIERITE model after White et al., JMG 32:261-286, 2014
                             with Mn added
   
                                                      M       H
                                                     ________________          

                                      Mutliplicity    2       1          
                                                     ________________         

                                      1 mncrd         Mn      Vac           
                            Species:  2 fcrd          Fe      Vac  
                                      3 crd           Mg      Vac         
                                      4 hmncrd        Mn      H2O    dependent       
                                      5 hfcrd         Fe      H2O    dependent
                                      6 hcrd          Mg      H2O         
                                                      _______________        

                            Dependent: hfcrd = hcrd + (fcrd - crd)

                            Modified model entered by Tim Johnson, Apr 7 2014.

                            w(fcrd hcrd) changed from w(crd hcrd), May 16, 2014. Felix Gervais.

                            w(mncrd ...)'s and mncrd DQF added. Felix Gervais, Jan 28, 2015.
                           
Crd(W) 
abbreviation Crd
full_name    cordierite

7                                 model type: reciprocal 
2                                 2 reciprocal sites
3  2                              3 species on site 1, 2 on site 2 
mncrd    fcrd     crd 
hmncrd_i hfcrd_i  hcrd

2                                 2 dependent endmembers 

hfcrd_i = 1 hcrd +  1 fcrd - 1 crd
hmncrd_i = 1 hcrd + 1 mncrd - 1 crd

1 0 0 1 0 0                | endmember flags

                           | Note restricted range on X(Mn)
 
0. .2 .1  0                | range and resolution for X(Mn) on M site, imod = 1 -> asymmetric transform subdivision
0. 1. .1  0                | range and resolution for X(Fe) on M site, imod = 0 -> cartesian subdivision

0. 1.  .1 0                | range and resolution for 1-X(H2O) on H site, imod = 0 -> cartesian subdivision  

begin_excess_function
W(crd fcrd)        8d3  0.  0. 
W(fcrd hcrd)       9d3  0.  0. 
W(crd mncrd)       6d3  0.  0. 
W(fcrd mncrd)      4d3  0.  0.
W(hcrd mncrd)      6d3  0.  0. 
end_excess_function

2                                       2 site entropy model.

3 2.                                    3 species on M, 2 sites per formula unit.
z(m,mg) = 1 crd + 1 hcrd
z(m,fe) = 1 fcrd 

2 1.                                    2 species on H, 1 sites per formula unit.
z(H,H2O) = 1 hcrd 

begin_dqf_corrections
dqf(mncrd)   -4210 0. 0.
end_dqf_corrections  

end_of_model                       
                      --------------------------------------------------------
begin_model                
                            Sapphirine, O/D non-ideal, Wheller & Powell (JMG, 32, 287299, 2014)

                            Modified JADC model entered by Tim Johnson, 7 April 2014.

                                                      1      2      3           
                                                      M3     M456   T     
                                                     _________________

                                      Mutliplicity    1      3     1
                                                     _________________

                                      1 spr4          Mg     Mg    Si
                            Species:  2 fspr          Fe     Fe    Si
                                      3 spr5          Al     Mg    Al
                                      4 fsp5_d        Al     Fe    Al        dependent
                                      5 ospr          Fe3+   Mg    Al
                                      6 fospr_d       Fe3+   Fe    Al        dependent 

                                      7 spro          Fe     Mg    Si        ordered

                                      Dependent endmember:

                                      FeMg-1_M456 = (fspr-spro)/3

                                      fsp5_d = spr5 +  fspr - spro
                                      fospro_d = ospr +  fspr - spro

Sa(WP)
abbreviation Sap
full_name    sapphirine

8                            | model type: order-disorder, prismatic composition space
2                            | 2 independent mixing sites
2  3                         | 2 components {Fe2+, Mg} for composition 1, 3 components {Al, Si, Fe3+} for composition 2. 
                             
                             | endmember names 
spr4     fspr        
spr5     fsp5_d
ospr     fospr_d

1                            | 1 ordered species:

spro = 3/4 spr4 + 1/4 fspr   enthalpy_of_ordering = -3.5d3

begin_limits
spro =    - 4/3 fspr - 4/3 ospr - 1/3 spro                 delta = 4/3 z(M3,Mg) 
spro =    - 4/3 fspr            - 1/3 spro                 delta = 4/3 z(M3,Fe) 
spro = -4 - 4   fspr +   1 ospr - 4 spr5     + 1 spro      delta = 4   z(M456,Mg)   
end_limits                

2                            | 2 dependent endmembers

fsp5_d   = 1 spr5 +  1 fspr - 1 spro
fospr_d  = 1 spr5 +  1 fspr - 1 spro

0 0 0 0 0 0                | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0. 1. .1   0               | range and resolution of X(Mg), subdivision scheme for site 1: imod = 0 -> cartesian 

                           | subdivision model for (ternary) site 2 
0. 1. .1   0               | range and resolution of X(Ts), subdivision scheme for site 3, species 1: imod = 0 -> cartesian   
0. 1. .1   0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian   

begin_excess_function 
W(spr4 spr5)              10d3       0.     -0.02
W(spr4 fspr)              16d3       0.      0.
W(spr4 spro)              12d3       0.      0.
W(spr4 ospr)               8d3       0.     -0.02
W(spr5 fspr)              19d3       0.     -0.02
W(spr5 spro)              22d3       0.     -0.02
W(spr5 ospr)               1d3       0.      0.
W(fspr spro)               4d3       0.      0.
W(fspr ospr)             17600       0.     -0.02
W(spro ospr)              20d3       0.     -0.02
end_excess_function 

3                          | 3 site (M3, M456, T) configurational entropy model

2 3.                       | 2 species on M46, 3 sites per formula unit
z(m456,fe) = 1 fspr

4 1.                       | 4 species on M3, 1 sites per formula unit.
z(m3,Al)  = 1 spr5 
z(m3,Fe3) = 1 ospr
z(m3,mg)  = 1 spr4

2 1.                       | 2 species on T, 1 sites per formula unit.
z(T,si) = 1 spr4 + 1 fspr + 1 spro

begin_dqf_corrections
dqf(fspr)   -2d3 0. 0.
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                             Orthopyroxene with compound formation, PH '99 Am Min. 
                             JADC 3/03

                             site population limits added Feb 20, 2011, JADC.

                             added ferric iron, Jul 24, 2012. JADC.

                             NOTES:  

                             * This model will only function for the FASH subsystem
                               if MGO is present as a component in VERTEX.

                                                      1       2             
                                                      M1      M2      
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 en            Mg      Mg       
                            Species:  2 fs            Fe2+    Fe2+     
                                      3 mgts          Al      Mg         
                                      4 fets          Al      Fe2+  
                                      5 mots          Fe3+    Mg
                                      6 feots         Fe3+    Fe2+  
                                                      _____________

                           Internal:  7 opx           Mg      Fe2+    


                           Dependent: fets  = mgts + opx - en
                                      feots = mots + opx - en 


Opx(HP)                    | solution name.
abbreviation Opx
full_name    orthopyroxene

8                          | model type: order-disorder, prismatic composition space
2                          | 2 independent composition spaces
2 3                        | 2 dimensions on first space, 3 on second
                           | endmembers: 
mgts     fets_d   
en       fs 
mots     feots 

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3   

begin_limits
opx =     - 2 fs - 1 opx                delta = 2 z(M2,Fe)       
opx =  -2 + 2 fs + 1 opx                delta = 2 z(M1,Fe)
opx =     - 2 en - 1 opx                delta = 2 z(M1,Mg)
end_limits                

2                          | 2 dependent endmembers

fets_d = 1 mgts + 1 opx - 1 en
feots  = 1 mots + 1 opx - 1 en

0 0 0 0 0 0                | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0. 1. .1                   | range and resolution of X(Mg)
0                          | subdivision scheme for site 1: imod = 0 -> cartesian 

                           | subdivision model for (ternary) site 2 
0. 1. .1   0               | range and resolution of X(Ts), subdivision scheme for site 3, species 1: imod = 0 -> cartesian   
0. 1. .1   0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian   

begin_excess_function                
w(en fs)     68d2 0. 0.  
w(fs mgts)   -1d3 0. 0.  
w(en opx)    45d2 0. 0. 
w(fs opx)    45d2 0. 0. 
w(mgts opx)  12d2 0. 0.  
w(en mots)  -14d3 0. 0. 
w(fs mots)    6d3 0. 0.
w(opx mots)   6d3 0. 0. 
end_excess_function 

2                          | 2 site (M1, M2) configurational entropy model

4 1.                       | 3 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 fs 
z(m1,al)   = 1 mgts 
z(m1,fe3+) = 1 mots

2 1.                       | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en + 1 mgts + 1 mots

end_of_model 
                      --------------------------------------------------------
begin_model

                             Ti-Fe3+ Biotite from Tajcmanova et al., JMG 2009;
                             extended for Mn solution after Tinkham et al. 2001.

                             Model entered by Lucie Tajcmanova, December, 2008.

                             NOTE this model requires the following make definitions 
                             in the thermodynamic data file:

                             tbit = 1 phl - 1 br + 1 ru           84e3 -11.5 0 
                             fbit = 1 east - 1/2 cor + 1/2 hem    6e3 0 0  

                             site population limits added Feb 20, 2011, JADC.

                             reformulated as a prismatic + orphan vertex model.

                             JADC, 10/5/2018


                                      Site:           M1      M2       T1     H
                                                     ____________________________

                                      Mutliplicity    1       2        2      2       

                                    endmember        ____________________________   type
                                    _________                                       _________


                                        ffbit         Fe3+   FeFe     AlAl    OH    dependent 
                                        fbit          Fe3+   MgMg     AlAl    OH
                          
                                        ftbit         Fe     TiFe     AlSi    O     dependent
                                        tbit          Mg     TiMg     AlSi    O
   
                                        sdph          Al     FeFe     AlAl    OH    dependent
                                        east          Al     MgMg     AlAl    OH

                                        mnbi          Mn     MnMn     AlSi    OH    independent orphan
                                        ann           Fe     FeFe     AlSi    OH
                                        phl           Mg     MgMg     AlSi    OH

                                        obi           Fe     MgMg     AlSi    OH    ordered

Bio(TCC)                     | model name
abbreviation Bio
full_name    biotite

9                            | model type: O/D with prism + orphan vertex composition space 

2                            | prismatic vertex consists of two simplexes with a common vertex
2  4                         | 2 components {Fe2+, Mg} on simplex 1, 4 components {Al, Si, Fe3+, Ti} on simplex 2
1                            | number of orphan vertices

                             | endmembers on the prismatic vertex
ffbit     fbit
ftbit     tbit
sdph      east
ann       phl
                             | orphan vertex
mnbi

1                            | number of ordered species:

obi = 2/3 phl + 1/3 ann   enthalpy_of_ordering = -6.8d3 

begin_limits
obi = -3   + 3   ann  + 1   obi                     delta = 3 z(M2,Fe) 
obi =      - 3   phl  - 3/2 tbit - 3 east - 2 obi   delta = 3 z(M2,Mg)
obi =      - 3/2 ann  - 1/2 obi                     delta = 3/2 z(M1,Fe)
obi = -3/2 + 3/2 tbit + 3/2 phl  + 1 obi            delta = 3/2 z(M1,Mg)
end_limits     

3                            | number of dependent endmembers 
                            
sdph    = 1 east + 1 ann    - 1 obi
ffbit   = 1 fbit + 1 ann    - 1 obi
ftbit   = 1 tbit + 1/2 ann  + 1/2 obi - 1 phl

0 0 0 0 0 0 0 0 0            | endmember flags

0. 1. .1  0                  | range and resolution of X(Mg, M2), mod = 0 -> cartesian subdivision  

0. 1. .1  0                  | range and resolution of X(Fe3+,*), mod = 0 -> cartesian subdivision    
0. .5 .1  0                  | range and resolution of X(Ti,  *), mod = 0 -> cartesian subdivision
0. 1. .1  0                  | range and resolution of X(Al,  *), mod = 0 -> cartesian subdivision  

0. .5 .1  0                  | range and resolution of mnbi, mod = 0 -> cartesian subdivision  

begin_excess_function
W(phl ann)   12000. 0. 0.    | excess parameters from Holland & Powell, JMG, 2006
W(phl east)  10000. 0. 0.  
W(phl obi)    4000. 0. 0. 
W(ann east)   3000. 0. 0.  
W(ann obi)    8000. 0. 0.
W(obi east)   7000. 0. 0. 
end_excess_function 

4                           | Configurational entropy: 4 sites, M1, M2, T1 H.

5 1.                        | 5 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 ann + 1 obi 
z(m1,mg)   = 1 phl + 1 tbit     
z(m1,mn)   = 1 mnbi 
z(m1,Fe3+) = 1 fbit

4 2.                        | 4 species on M2, 2 sites per formula unit.

z(m2,fe)   = 1 ann
z(m2,Ti)   = 1/2 tbit
z(m2,mn)   = 1 mnbi
    
2 2.                        | 2 species on T1, 2 site per formula unit.

z(t1,al)   = 1/2 + 1/2 east + 1/2 fbit 

2 2.                        | 2 species on H, 2 site per formula unit.

z(h,o)     = 1 tbit

end_of_model    
                    --------------------------------------------------------  
begin_model

                                  Ti-Biotite model after White, Powell & Holland (JMG, 2007)

                                  Model entered by Lucie Tajcmanova, May 11, 2007. 

                                  DQF corrections to annite added, Mark Caddick, Nov, 2007.

                                  NOTE: this model requires make defintions for fbi and tbi
                                  in the thermodynamic data file.

                                                      1       2      3      4
                                                      M1      M2     T1     H
                                                     ____________________________

                                      Mutliplicity    1       2      2      2 
                                                     ____________________________

                          Dependent:  1 ffbi          Fe3+    Fe     AlAl   OH  
                                      2 fbi           Fe3+    Mg     AlAl   OH
                          
                          Dependent:  3 ftbi          Ti      Fe     AlSi   O
                                      4 tbi1          Ti      Mg     AlSi   O
   
                          Dependent:  5 Sdph          Al      Fe     AlAl   OH
                                      6 East          Al      Mg     AlAl   OH

                            Species:  7 Ann           Fe      Fe     AlSi   OH
                                      8 Phl           Mg      Mg     AlSi   OH
                                                      __________________________

                            Ordered:  9 Obi           Fe      Mg     AlSi   OH

Bio(WPH)                     | solution name.
abbreviation Bio
full_name    biotite

8                            | model type: order-disorder, prismatic composition space
2                            | 
2  4                         | 2 species on site 1, 4 species on site 2. 
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mg-Fe and the species that mix on 
                             | site 2 are M2+, Al, Ti. Fe3+. The identity of M2+ on site 2 is determined by
                             | the identity of the M2+ cation on site 1
ffbi_i   fbi
ftbi_i   tbi1
sdph_i   east
ann      phl

1                            | ordered species:

obi = 2/3 phl + 1/3 ann   enthalpy_of_ordering = -10.73d3  

begin_limits
obi = -3   + 3   ann  + 1 obi                       delta = 3 z(M2,Fe) 
obi =      - 3   phl  - 3 tbi1 - 3 east - 2 obi     delta = 3 z(M2,Mg)
obi =      - 3/2 ann  - 1/2 obi                     delta = 3/2 z(M1,Fe)
obi = -3/2 + 3/2 phl  + 1 obi                       delta = 3/2 z(M1,Mg)
end_limits

3                            | 3 dependent endmembers 

sdph_i = 1 east  + 1 ann - 1 obi 
ffbi_i = 1 fbi   + 1 ann - 1 obi
ftbi_i = 1 tbi1  + 1 ann - 1 obi

0 0 0 0 0 0 0 0 0            | endmember flags: if 0 the endmember is considered to be part of the solution.

                             | subdivision model for (binary) site 1 (M2):

0. 1. .1  0                  | range and resolution of X(Fe)

                             | subdivision model for (quinary) site 2 (M1)
0. .2 .1  0                  | range and resolution of X(Fe3+,M1)
0. .2 .1  0                  | range and resolution of X(Ti,M1)
0. 1. .1  0                  | range and resolution of X(Al,M1)              

begin_excess_function
                             | current preferred thermocalc values, Caddick, Nov '07
W(phl ann)   9000. 0. 0.
W(phl east) 10000. 0. 0.  
W(phl obi)   3000. 0. 0. 
W(ann east) -1000. 0. 0.  
W(ann obi)   6000. 0. 0.
W(ann fbi)   8000. 0  0 
W(ann tbi1) 10000. 0  0
W(obi east) 10000. 0. 0. 
                             | values from White et al paper and earlier Perple_X verions.
                             | W(phl ann) 12000. 0. 0.       
                             | W(phl east) 10000. 0. 0.  
                             | W(phl obi) 4000. 0. 0. 
                             | W(phl fbi) 0.  0.  0.
                             | W(phl tbi1) 0.  0.  0.
                             | W(ann east)  3000. 0. 0.  
                             | W(ann obi) 8000. 0. 0.
                             | W(ann fbi)   8000.  0  0 
                             | W(ann tbi1)   10000.  0  0
                             | W(obi east)  7000.  0. 0. 
end_excess_function 

4                           | Configurational entropy: 4 sites, M1, M2, T1 H.

5 1.                        | 5 species on M1, 1 site per formula unit.

z(m1,fe) = 1 ann  + 1 obi   
z(m1,mg) = 1 phl           
z(m1,Fe3+) = 1 fbi 
z(m1,Ti) = 1 tbi1  

2 2.                        | 2 species on M2, 2 sites per formula unit.

z(m2,fe) = 1 ann 

2 2.                        | 2 species on T1, 2 site per formula unit.

z(t1,al) = 1/2  + 1/2 east + 1/2 fbi 

2 2.                        | 2 species on H, 2 site per formula unit.

z(h,o) = 1 tbi1

begin_dqf_corrections
dqf(ann) -3000 0 0
end_dqf_corrections

end_of_model
                  --------------------------------------------------------
begin_model                
                             Orthopyroxene with compound formation, PH '99 Am Min. 
                             JADC 3/03

                             Modified for ideal Cr, additionally a temperature 
                             dependence of -16 J/K has been assigned adhoc to W(mgts-en)
                             and W(mgts-opx) in order to increase the Al-content of opx
                             for upper mantle compositions and conditions. A better way
                             of accomplishing the same result would be to increase the
                             entropy of mgts. PGP Workshop 4/12/06. 
                             (folk.uio.no/ninasim/Cr_results.html)
                             
                             site population limits added Feb 20, 2011, JADC.

                             NOTES:  

                             * This model should not be used for crustal rocks/conditions! 

                             * This model will only function for the FASH subsystem
                               if MGO is present as a component in VERTEX.

                             * Added ferric iron. JADC, 3/29/13.

                                                      1       2             
                                                      M1      M2      
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 en            Mg      Mg       
                            Species:  2 fs            Fe2+    Fe2+     
                                      3 mgts          Al      Mg         
                                      4 fets          Al      Fe2+  
                                      5 mots          Fe3+    Mg
                                      6 feots         Fe3+    Fe2+  
                                      7 crts          Cr      Mg
                                      8 fcrts         Cr      Fe
                                                      _____________

                           Internal:  9 opx           Mg      Fe2+    

                           Dependent: fets  = mgts + opx - en
                                      feots = mots + opx - en 
                                      fcrts = crts + opx - en

CrOpx(HP)                  | solution name.
abbreviation Opx
full_name    orthopyroxene

8                          | model type: Reciprocal with speciation

2                          | 2 independent composition spaces
2 4                        | 2 dimensions on first space, 3 on second
                           | endmembers: 
crts     fcrts_d
mgts     fets_d
en       fs
mots     feots

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3   

begin_limits
opx =     - 2 fs - 1 opx                delta = 2 z(M2,Fe)       
opx =  -2 + 2 fs + 1 opx                delta = 2 z(M1,Fe)
opx =     - 2 en - 1 opx                delta = 2 z(M1,Mg)
end_limits                

3                          | 3 dependent endmembers

fets_d  = 1 mgts + 1 opx - 1 en
feots   = 1 mots + 1 opx - 1 en
fcrts_d = 1 crts - 1/2 en + 1/2 fs

0 0 0 0 0 0 0 0            | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0. 1. .1   0               | range and resolution of X(Mg),subdivision scheme for site 1: imod = 0 -> cartesian 

                           | subdivision model for (ternary) site 2 
0. 1. .1   0               | range and resolution of X(Cr), subdivision scheme for site 3, species 1: imod = 0 -> cartesian   
0. 1. .1   0               | range and resolution of X(Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian   
0. 1. .1   0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 3: imod = 0 -> cartesian   

begin_excess_function                
w(en fs)     68d2 0. 0.  
w(fs mgts)   -1d3 -14. 0.  
w(en opx)    45d2 0. 0. 
w(fs opx)    45d2 0. 0. 
w(mgts opx)  12d2 -14. 0.  
w(en mots)  -14d3 0. 0. 
w(fs mots)    6d3 0. 0.
w(opx mots)   6d3 0. 0. 
end_excess_function 

2                          | 2 site (M1, M2) configurational entropy model

5 1.                       | 5 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 fs 
z(m1,al)   = 1 mgts
z(m1,fe3+) = 1 mots
z(m1,cr)   = 1 crts

2 1.                       | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en + 1 mgts + 1 mots + 1 crts

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model                 
                                Mg-Fe-Ca-Al-Cr Garnet
                                Hybrid Holland & Powell + Simon/PGP Cr Workshop
                                (folk.uio.no/ninasim/Cr_results.html)
CrGt
abbreviation Gt
full_name    garnet

7                              | model type: reciprocal
2                              | 2 chemical site model
3 2                            | 3 endmembers mix on site 1, 2 endmembers mix on site 2

uv_d  fuv_d  knor 
gr    alm    py

2                              | 2 dependent endmembers 

uv_d = 1 gr +  1 knor  - 1 py 
fuv_d = 1 alm +  1 knor  - 1 py

0 0 0 0 0 0                    | endmember flags 0 include it   1 drop it    
        
0. 1. .1   0                | range and resolution for  XCa on A
0. 1. .1   0                | range and resolution for  XFe on A

0. 1. .1   0                | range and resolution for  XCr on B

begin_excess_function 
w(py gr) 33d3 0. 0.
w(py knor) 3d3 0 0          | corrected as in erratum to ziberna et al 2013 (2014)
 | w(py py gr) 59304. -10.5  .036   Ganguly excess paramters
 | w(py gr gr) 25860. -10.5  .174  
end_excess_function 
2                                     2 site entropy model
3 3.                                  3 species, site multiplicity of 3
z(Ca) = 1 gr + 1 uv_d 
z(Mg) = 1 py + 1 knor
2 2.                                  2 species, site multiplicity of 2
z(Al) = 1 gr + 1 alm + 1 py 

reach_increment 0

end_of_model
                      -------------------------------------------------------- 
begin_model
                             Garnet model of Malaspina et al. 2009

                             the andradite endmember should be excluded from calculations when
                             this model is use. JADC, 6/2010

                             Cr added as in Simon/PGP Cr Workshop,
                             folk.uio.no/ninasim/Cr_results.html. JADC, 3/29/13

                             For Cr garnet it's probably better to use CrGt. JADC, 23/1/15.

                                                      M1      M2      
                                                     _____________

                                      Mutliplicity    3       2     
                                                     _____________

                                       skiag         Fe      Fe3+      
                          Dependent:   kho           Mg      Fe3+
                          Dependent:   andr          Ca      Fe3+

                          Dependent:   fuv_d         Fe      Cr      
                                       knor          Mg      Cr
                          Dependent:   uv_d          Ca      Cr
   
                                       alm           Fe      Al     
                                       py            Mg      Al     
                                       gr            Ca      Al          

Gt(MPF) 
abbreviation Gt
full_name    garnet
    
7                                 | model type: macroscopic with dependent endmembers
2                                 | number of independent mixing sites, reciprocal solution
3  3                              | 3 species on site M1, 2 species on site M2.                                                                          

alm    py     gr                  | endmember names 
skiag  kho    andr
uv_d   fuv_d  knor 

4                                 | number of dependent endmembers 

andr  = 1 gr  + 1 skiag - 1 alm
kho   = 1 py  + 1 skiag - 1 alm
uv_d  = 1 gr  + 1 knor  - 1 py 
fuv_d = 1 alm + 1 knor  - 1 py

0  0  0  0  0  0  0  0  0         | endmember flags

0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xfe) on M1
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xmg) on M1

0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision x(al) on M2
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision x(fe3+) on M2

begin_excess_function
w(py knor) 30000. 0. 0.
w(alm gr) 15000. 0. 0.
w(py gr) 80000. 0. 0.             | HP (33000. 0. 0.)   
w(alm py) 2500.  0. 0.            | HP       
w(alm skiag) -37053.18  0. 0.     | Skiag 
end_excess_function  

2                                 |2 site entropy model

3 3.                              |3 species, site multiplicity 3
z(x,fe) = 1 alm + 1 skiag
z(x,Mg) = 1 py 

3 2.                              |2 species, site multiplicity 2
z(y,al) = 1 alm + 1 py + 1 gr
z(y,cr) = 1 knor

end_of_model 

                      -------------------------------------------------------- 
begin_model
                             ad hoc pumpellyite, assumes fe-mg occupy two 
                             octahedral (M1) sites and al-fe3 occupy 5 (M2). 
                                                       JADC, Sep 17, 2017

Pu
abbreviation Pu
full_name    pumpellyite
    
7                                 | model type: macroscopic with dependent endmembers
2                                 | number of independent mixing sites, reciprocal solution
2  2                              | 2 species on site M1, 2 species on site M2.                                                                          

mpm  fpm                          | endmembers 
mjgd jgd

1                                 | number of dependent endmembers 

mjgd  = 1 jgd  + 1 mpm - 1 fpm

0  0  0  0                        | endmember flags

0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xfe) on M1
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xmg) on M1

ideal

2                                 |2 site entropy model

2 1.                              |2 species, M1 site multiplicity 1
z(M1,Mg) = 1 mpm

2 5.                              |2 species, M2 site multiplicity 5
z(M2,Fe3) = 1 jgd

end_of_model 
                              --------------------------------------------------------
begin_model                
                                      Sack & Ghiorso (1989 CMP 102:41-68) for Fe-Mg olivine. 
                                      [an astoundingly complex presentation]
                                      JADC 7/03 
O(SG)
abbreviation Ol
full_name    olivine

2                                     model type macroscopic
2                                     2 endmembers

fo 
fa

0  0                               | endmember flags

0. 1. 0.1 0                        | range and resolution of X(mg), imod = 0 -> cartesian subdivision

begin_excess_function   
w(fo fa)  20314. 0. 3e-2    
end_excess_function

1                                     1 site entropy model (m)
2 2.                                  2 species on m2, mutiplicity = 2
z(m,mg) = 1 fo

end_of_model
                              --------------------------------------------------------             
begin_model
                                      Holland and Powell (2001) J.Petrol 426, 673-683 (KNCASH)
                                      White et al (2001) JMG 19: 139-153 (FM+KNCASH). Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      JADC 3/03

                                      Changed DQF terms to account for modifications of faL and foL 
                                      (White et al 2007). Mark Caddick, Nov, 07.

                                      Zr8L added. Jeff Marsh, Jan 10, 2012.

                                      reformulated as ordinary configurational entropy model. JADC 12/18.

                                      WARNING 2: the endmembers q8L, fa8L, fo8L, and
                                      sil8L must be "made" in the thermodynamic data
                                      file. See the header section of hp02ver.dat for
                                      details on the "make" structure.

                                      WARNING 3: the (stabilizing) dqf corrections made
                                      to the fo8L, fa8L, and sil8L enedmembers make the 
                                      haplogranite melt model inapplicable to melts where
                                      these endmembers are present in high concentrations,
                                      to model such situations or to reproduce the published
                                      fo-fa-q or sil-q melting phase relations, the dqf corrections
                                      (below) should be set to zero. 

                                      WARNING 4: different versions of the HP data base
                                      may result in significant variations in the predicted
                                      position of the wet-solidus (Powell, pers comm.).

                                      WARNING 5: The melt model incorrectly predicts a high 
                                      pressure-low temperature stability field for water-silica
                                      rich melts. at 10 kb this field extends to ca 750 K and 
                                      at 3 kb to ca 550 K. To eliminate this artifact set T_melt 
                                      in perplex_option.dat.
melt(HP)
abbreviation Melt
full_name    liquid

2                                     model type: simplicial composition space

9                                     number of endmembers

fo8L     fa8L
abL      sil8L    anL
kspL     zr8L     q8L
h2oL     

 0 0 0 0 0 0 0 0 0                  | endmember flags.

                                    | RESTRICTED(!) subdivision ranges and model
                                    | the ranges must be extended if calculations
                                    | are to be done in subsystems like fo-fa-h2o,
                                    | Ab-H2O etc etc; these numbers seem about right
                                    | for pelite melting.

0.0   0.1   0.1 0                   | range and resolution of X(fo),  0 => cartesian subdivision
0.0   0.1   0.1 0                   | range and resolution of X(fa),  0 => cartesian subdivision
0.0   0.4   0.1 0                   | range and resolution of X(ab),  0 => cartesian subdivision
0.0   0.2   0.1 0                   | range and resolution of X(sil), 0 => cartesian subdivision
0.0   0.1   0.1 0                   | range and resolution of X(an),  0 => cartesian subdivision
0.0   0.4   0.1 0                   | range and resolution of X(ksp), 0 => cartesian subdivision
1e-5 1e-4   0.4 1                   | max resolution, max concentration, 1/(no of points), X(zr),  1 => asymmetric subdivision
0.0   0.7   0.1 0                   | range and resolution of X(q), 0 => cartesian subdivision

begin_excess_function 
                                    | the excess parameters used for the haplo-
                                    | granite melt model vary between papers (notably w(an-sil)),
                                    | the values here are from the thermocalc
                                    | model file 'thdmloss.txt' and appear largely
                                    | consistent with the white et al paper.
w(q8L    anL) -10d3 0.  0.  
w(q8L  sil8L) 12d3  0.  0. 
w(q8L    abL) 12d3  0. -0.4
w(q8L   kspL) -2d3  0. -0.5
w(q8L   h2oL) 15d3  0.  0.  
w(q8L   fo8L) 12d3  0. -0.4  
w(q8L   fa8L) 14d3  0.  0.
w(abL  sil8L) 12d3  0.  0. 
w(abL   kspL) -6d3  0.  3.
w(abL   fo8L) 10d3  0.  0.
w(abL   fa8L)  2d3  0.  0.
w(abL   h2oL)  1d3  0. -0.2
w(kspL   anL)   0   0. -1.    
w(kspL sil8L) 12d3  0.  0.
w(kspL  h2oL) 11d3  0. -0.45     
w(kspL  fo8L) 12d3  0.  0.
w(kspL  fa8L) 12d3  0.  0.
                                    | w(anL sil8) is 12 kJ in the Holland & Powell J Pet paper
                                    | but appears to have accidentally been set to zero
                                    | for the calculations published in the White et al. JMG
                                    | paper. To restore this parameter delete the comment 
                                    | marker "|" on the following line:
                                    | w(anL sil8) 12d3  0.  0.            
w(anL   h2oL)  9d3 0. -0.85
w(sil8L fo8L) 12d3 0. 0.
w(sil8L fa8L) 12d3 0. 0. 
w(sil8L h2oL) 16d3 0. 0.     
w(fo8L  fa8L) 18d3 0. 0.
w(fo8L  h2oL) 11d3 0. -0.5
w(fa8L  h2oL) 12d3 0. 0. 

w(q8L   zr8L) 14d3  0.  0. 
w(abL   zr8L) 12d3  0.  0.  
w(kspL  zr8L) 12d3  0.  0.
w(zr8L  fo8L) 12d3  0.  0.
w(zr8L  fa8L) 12d3  0.  0. 
w(zr8L  h2oL) 25d3  0.  0.     

end_excess_function 

3                           | Configurational entropy: two non-temkin sites (Water, Melt) 
                            | and one temkin site (olvine). hp assume a fsp = ab + or "molecule""
                            | with mixing on a temkin M site, but the math works out the same as 
                            | the endmembers are treated as separate endmembers and the M site
                            | dropped. 

2 1.                        | water-vacancy site 
z(H) = 1 h2oL

2 0.                        | temkin olivine site
n(Mg) = 4 fo8L
n(Fe) = 4 fa8L

8 0.                        | silicate species site, HP assume a fsp = ab + or "molecule""
                            | with mixing on the M site, but the math works out the same as 
                            | the endmembers are treated as separate endmembers and the M site
                            | dropped. 
z(w)     = 1 h2oL
z(q)     = 1 q8L
z(ksp)   = 1 kspL
z(ab)    = 1 abL
z(sil)   = 1 sil8L
z(an)    = 1 anL
z(zr)    = 1 zr8L
z(ol)    = 1 fo8L + 1 fa8L   | there's a case to be made that zr8l should be incorporated in "olivine"

begin_dqf_corrections
dqf(fo8L)  -10d3 0 0 
dqf(fa8L)  -9d3 0 -1.3
dqf(sil8L) -10d3 0 0
                                     | pre-white et al '07 value: dqf(fo8L)  -15d3 0 0 
                                     | pre-white et al '07 value: dqf(fa8L)  -15d3 0 0
                                     | pre-white et al '07 value: dqf(sil8L) -10d3 0 0
end_dqf_corrections

end_of_model    
                                      --------------------------------------------------------
begin_model          

                                      Ghiorso et al (2002) G3 v. 3 (n. 5) model for mantle
                                      melting, 1-3 GPa. Read cautionary notes in Ghirso for
                                      applications beyond this pressure range. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the pMELTS model that excludes
                                      the Cr-, Ni-, Co-, and P-bearing melt components. The melt
                                      endmember names have been changed from those used in the pMELTS paper.

                                      This model should be applied with solid phase data 
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the 
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the pMELTS model, however using these files 
                                      will almost certainly result in inconsistencies with published
                                      pMELTS results.


                                      JADC 7/03

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the pMELT
                                      model. Check these ranges, and adjust them as 
                                      necessary before using this model.

                                      ====================================================
                                      Modified to use pure water at P and T standard
                                      state (the H2O endmember) as opposed to the h2oGL 
                                      endmember of Ghiorso et al. (2003), which so far 
                                      as I understand should  be equivalent. 

                                      NOTE: Use of H2O as an endmember requires the user
                                      specify an equation of state for H2O when running
                                      BUILD. To be strictly consistent with Ghiorso et al
                                      the Sterner and Pitzer EoS for water should be used 
                                      for this purpose, but it is not presently included
                                      in perplex. 

                                      JADC May 23, 2004.
                                      
                                      Added TiO2 endmember. JADC Feb 7, 2012. 

                                      converted to an ordinary temkin model. JADC, 12/18.
pMELTS(G)
abbreviation Melt
full_name    liquid

2                                    model type: ordinary simplicial

9                                    number of endmembers

H2O
foGL
faGL
woGL
kalGL
nasGL
coGL
tiGL
qGL

1 0 0 0 0 0 0 0 0                   | endmember flags  

                                    | NOTE restricted compositional ranges!                 

0.0 1.0   0.1  0                    | range and resolution of X(h2o), 0 => cartesian subdivision  
0.0 0.5   0.1  0                    | range and resolution of X(fo), 0 => cartesian subdivision    
0.0 0.2   0.1  0                    | range and resolution of X(fa), 0 => cartesian subdivision     
0.0 0.2   0.1  0                    | range and resolution of X(wo), 0 => cartesian subdivision  
0.0 0.6   0.1  0                    | range and resolution of X(kal), 0 => cartesian subdivision     
0.0 0.6   0.1  0                    | range and resolution of X(nas), 0 => cartesian subdivision    
0.0 0.2   0.1  0                    | range and resolution of X(co), 0 => cartesian subdivision  
0.0 0.2   0.1  0                    | range and resolution of X(Ti), 0 => cartesian subdivision 

begin_excess_function 
w( coGL  qGL  ) -296975.2 0. 0.
w( faGL  qGL  ) -18841.4  0. 0.
w( foGL  qGL  ) -33833.5  0. 0.
w( woGL  qGL  ) -34232.9  0. 0.
w( nasGL qGL  ) -59822.7  0. 0.
w( kalGL qGL  ) -102706.5 0. 0.
w( H2O   qGL  ) -45181.6  0. 0.
w( faGL  coGL ) -200788.1 0. 0.
w( foGL  coGL ) -192709.0 0. 0.
w( woGL  coGL ) -270700.8 0. 0.
w( nasGL coGL ) -205068.6 0. 0.
w( kalGL coGL ) -114506.5 0. 0.
w( H2O   coGL ) -161944.4 0. 0.
w( foGL  faGL ) -28736.4  0. 0.
w( woGL  faGL ) -28573.8  0. 0.
w( nasGL faGL ) -4723.9   0. 0.
w( kalGL faGL ) 22245.0   0. 0.
w( H2O   faGL ) 9769.4    0. 0.
w( woGL  foGL ) 574.1     0. 0.
w( nasGL foGL ) 9272.3    0. 0.
w( kalGL foGL ) 36512.7   0. 0.
w( H2O   foGL ) 24630.1   0. 0.
w( nasGL woGL ) 7430.3    0. 0.
w( kalGL woGL ) 19927.4   0. 0.
w( H2O   woGL ) -1583.7   0. 0.
w( kalGL nasGL) -1102.3   0. 0.
w( H2O   nasGL) 13043.1   0. 0.
w( H2O   kalGL) 35572.8   0. 0.

w(coGL  tiGL) 144804.9   0. 0.
w(faGL  tiGL) 9324.2     0. 0.
w(foGL  tiGL) 16355.6    0. 0.
w(woGL  tiGL) 9471.5     0. 0.
w(nasGL tiGL) 22194.2    0. 0.
w(kalGL tiGL) 3744.0     0. 0.

end_excess_function 
                                    | the configurational entropy for this model is unclear
                                    | eq 1 of ghiorso et al. (2002) is almost certainly wrong
                                    | the model below follows ghioro and sack 1995 & Nicholls 1980 CMP 74:211

2                                   | 2 sites

9 0                                 | melt site, 9 species
z(h2o)   = 1 H2O
z(foGL)  = 1 foGL
z(faGL)  = 1 faGL
z(woGL)  = 1 woGL
z(kalGL) = 1 kalGL
z(nasGL) = 1 nasGL
z(coGL)  = 1 coGL
z(tiGL)  = 1 tiGL
z(qGL)   = 1 qGL

2 1                                  | water vacancy site
z(h2o) = 1 H2O

end_of_model
                                      --------------------------------------------------------
begin_model

                                      mMELTS(G) is a chopped down version of pMELTS(G) with 
                                      Cr added to model lunar melting without changing dimensioning. 

                                      Ghiorso et al (2002) G3 v. 3 (n. 5) model for mantle
                                      melting, 1-3 GPa. Read cautionary notes in Ghirso for
                                      applications beyond this pressure range. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the pMELTS model that excludes
                                      the Cr-, Ni-, Co-, and P-bearing melt components. The melt
                                      endmember names have been changed from those used in the pMELTS paper.

                                      This model should be applied with solid phase data 
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the 
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the pMELTS model, however using these files 
                                      will almost certainly result in inconsistencies with published
                                      pMELTS results.


                                      JADC 7/03


                                      WARNING 1: This model can only be used for hydrous systems  
                                      if H2O is specified as a thermodynamic component
                                      (i.e., if H2O is specified as a saturated 
                                      component, VERTEX will reject the h2oG(L) endmember
                                      and the model will be applicable only to dry melts).

                                      WARNING 2: this model uses an internal routine to 
                                      compute the entropy of the melt that assumes 
                                      h2oG(l) is the first endmember.

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the pMELT
                                      model. Check these ranges, and adjust them as 
                                      necessary before using this model.

                                      ====================================================
                                      Modified to use pure water at P and T standard
                                      state (the H2O endmember) as opposed to the h2oGL 
                                      endmember of Ghiorso et al. (2003), which so far 
                                      as I understand should  be equivalent. 

                                      NOTE: Use of H2O as an endmember requires the user
                                      specify an equation of state for H2O when running
                                      BUILD. To be strictly consistent with Ghiorso et al
                                      the Sterner and Pitzer EoS for water should be used 
                                      for this purpose.

                                      JADC May 23, 2004.
                                      
                                      Added TiO2 endmember. JADC Feb 7, 2012

                                      reformulated as ordinary solutiub model. JADC 12/18.

mMELTS(G)
abbreviation Melt
full_name    liquid

2                                    model type: internal entropy routine

8                                     number of endmembers

H2O
foGL
faGL
woGL
crGL
coGL
tiGL
qGL

1 0 0 0 0 0 0 0 0                   | endmember flags  

                                    | NOTE restricted compositional ranges!                 

0.0 1.0   0.1  0                    | range and resolution of X(h2o), 0 => cartesian subdivision  
0.0 1.0   0.1  0                    | range and resolution of X(fo), 0 => cartesian subdivision    
0.0 1.0   0.1  0                    | range and resolution of X(fa), 0 => cartesian subdivision     
0.0 1.0   0.1  0                    | range and resolution of X(wo), 0 => cartesian subdivision  
0.0 1.0   0.1  0                    | range and resolution of X(kal), 0 => cartesian subdivision     
0.0 1.0   0.1  0                    | range and resolution of X(co), 0 => cartesian subdivision  
0.0 1.0   0.1  0                    | range and resolution of X(Ti), 0 => cartesian subdivision 

begin_excess_function 
w( coGL  qGL  ) -296975.2 0. 0.
w( faGL  qGL  ) -18841.4  0. 0.
w( foGL  qGL  ) -33833.5  0. 0.
w( woGL  qGL  ) -34232.9  0. 0.
w( H2O   qGL  ) -45181.6  0. 0.
w( faGL  coGL ) -200788.1 0. 0.
w( foGL  coGL ) -192709.0 0. 0.
w( woGL  coGL ) -270700.8 0. 0.
w( H2O   coGL ) -161944.4 0. 0.
w( foGL  faGL ) -28736.4  0. 0.
w( woGL  faGL ) -28573.8  0. 0.
w( H2O   faGL ) 9769.4    0. 0.
w( woGL  foGL ) 574.1     0. 0.

w( H2O   foGL ) 24630.1   0. 0.
w( H2O   woGL ) -1583.7   0. 0.

w(coGL  tiGL) 144804.9   0. 0.
w(faGL  tiGL) 9324.2     0. 0.
w(foGL  tiGL) 16355.6    0. 0.
w(woGL  tiGL) 9471.5     0. 0.

w(coGL  crGL) -269339.7   0. 0.
w(faGL  crGL) -74759.0     0. 0.
w(foGL  crGL) -3638.5    0. 0.
w(woGL  crGL)  48337.5     0. 0.
w(tiGL  crGL) -22455.8    0. 0.

end_excess_function 

                                    | the configurational entropy for this model is unclear
                                    | eq 1 of ghiorso et al. (2002) is almost certainly wrong
                                    | the model below follows ghioro and sack 1995 & Nicholls 1980 CMP 74:211

2                                   | 2 sites

8 0                                 | melt site, 8 species multiplicity 1
z(h2o)  = 1 H2O
z(foGL) = 1 foGL
z(faGL) = 1 faGL
z(crGL) = 1 crGL
z(woGL) = 1 woGL
z(coGL) = 1 coGL
z(tiGL) = 1 tiGL
z(qGL)  = 1 qGL

2 1                                  | water vacancy site
z(h2o) = 1 H2O


end_of_model
                                      --------------------------------------------------------
begin_model
                                      Ghiorso & Sack (1995) CMP 119:197-212 (the MELTS model)
                                      Read cautionary notes in Ghirso. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the MELTS model that excludes
                                      the Cr- and P-bearing melt components. The melt
                                      endmember names have been changed from those used 
                                      in the MELTS paper.

                                      This model should be applied with solid phase data 
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the 
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the MELTS model, however using these files 
                                      will almost certainly result in inconsistencies with published
                                      MELTS results.

                                      JADC 7/03

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the MELT
                                      model. Check these ranges, and adjust them as 
                                      necessary before using this model.
MELTS(GS)
abbreviation Melt
full_name    liquid

2                                     model type: simplicial

8                                     number of endmembers

h2oGM
foGM
faGM
woGM
kalGM
nasGM
coGM
qGM

0 0 0 0 0 0 0 0                  | endmember flags                  

0.0 0.3  0.04 0  
0.3 0.7  0.04 0 
0.0 0.3  0.04 0  
0.0 0.2  0.04 0
0.0 0.4  0.04 0  
0.0 0.2  0.04 0 
0.0 0.3  0.04 0                   | (restricted) subdivision ranges and model

begin_excess_function 
                   
w( coGM  qGM  ) -39120.   0. 0.
w( faGM  qGM  ) 23661.    0. 0.
w( foGM  qGM  ) 3421.     0. 0.
w( woGM  qGM  ) -864.     0. 0.
w( nasGM qGM  ) -99039.   0. 0.
w( kalGM qGM  ) -33922.   0. 0.
w( h2oGM qGM  ) 30967.    0. 0.
w( faGM  coGM ) -30509.   0. 0.
w( foGM  coGM ) -32880.   0. 0.
w( woGM  coGM ) -57918.   0. 0.
w( nasGM coGM ) -130785.  0. 0.
w( kalGM coGM ) -25859.   0. 0.
w( h2oGM coGM ) -16098.   0. 0.
w( foGM  faGM ) -37257.   0. 0.
w( woGM  faGM ) -12971.   0. 0.
w( nasGM faGM ) -90534.   0. 0.
w( kalGM faGM ) 23649.    0. 0.
w( h2oGM faGM ) 28874.    0. 0.
w( woGM  foGM ) -31732.   0. 0.
w( nasGM foGM ) -41877.   0. 0.
w( kalGM foGM ) 22323.    0. 0.
w( h2oGM foGM ) 35634.    0. 0.
w( nasGM woGM ) -13247.   0. 0.
w( kalGM woGM ) 17111.    0. 0.
w( h2oGM woGM ) 20375.    0. 0.
w( kalGM nasGM) 6523.     0. 0.
w( h2oGM nasGM) -96938.   0. 0.
w( h2oGM kalGM) 10374.    0. 0.
end_excess_function 


2

8 0.                                | melt site, 8 species, temkin multiplicity 1
z(h2o) = 1 h2oGM
z(fo)  = 1 foGM
z(fa)  = 1 faGM
z(wo)  = 1 woGM
z(kal) = 1 kalGM
z(nas) = 1 nasGM
z(co)  = 1 coGM
z(q)   = 1 qGM

2 1.                                 | water vacancy site
z(h2o) = 1 h2oGM

end_of_model
                  --------------------------------------------------------
begin_model                         
                                      holland and powell '98 non-ideal cz-fep solution

                                                      1       2           
                                                      M1      M3     
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 cz            Al      Al       
                            Species:  2 fep           Fe      Fe      
                                                      _____________

                        Ordered Cpd:  3 ep            Al      Fe    

Ep(HP)
abbreviation Ep
full_name    epidote

6                          | model type: speciation           
2                          | 2 endmembers                                        
cz       fep               | endmember names 

1                          | ordered species definition

ep = 1/2 fep + 1/2 cz Delta(enthalpy) = -13.05d3     
 
0 0 0                      | endmember flags
0. 1. 0.1  0               | range and resolution for X(cz), imod = 0 -> cartesian subdivision

begin_excess_function 
w(cz fep) 15400.0 0. 0. 
w(fep ep) 3000.0  0. 0. 
end_excess_function

2                          | 2 site (M1, M3) configurational entropy model

2 1.                       | 2 species on M1, 1 site per formula unit.
z(fe,m1) = 1 fep

2 1.                       | 2 species on M3, 1 site per formula unit.
z(al,m3) = 1 cz 

end_of_model               
                      --------------------------------------------------------
begin_model               
                             Phengite as http://www.esc.cam.ac.uk/astaff/holland/ds5/muscovites/mu.html 
                             This model assumes M2 (multiplicity 2) is split into 1 M2a site on
                             which tri- and di-valent cations mix, and an M2b site occupied
                             solely by Al.

                             JADC 2/03

                             config entropy corrected, D Tinkham, 5/6/03

                                                      A       M2a      T1
                                                     _________________________

                                      Mutliplicity    1       1         2 
                                                     _________________________

                                      1 mu            K       Al       Al_Si   
                            Species:  2 cel           K       Mg       Si_Si
                                      3 fcel          K       Fe       Si_Si  
                                      4 pa            Na      Al       Al_Si


                                      this model makes a dqf correction for paragonite 
                                      (meaning that this model is not valid for Na-rich 
                                      compositions).

Pheng(HP)                             | solution name 
abbreviation Mica
full_name    white-mica

2                                     | model type: endmember fractions
4                                     | 4 species 

pa                                    | endmember names 
cel      fcel        mu               | endmember names 


1 0 0 0                               | endmember flags

0. 1. 0.1 0                           | range and resolution for x(pa), imod = 0 -> cartesian subdivision
0. 1. 0.1 0                           | range and resolution for x(cel), imod = 0 -> cartesian subdivision  
0. 1. 0.1 0                           | range and resolution for x(fcel), imod = 0 -> cartesian subdivision  

begin_excess_function 
w(mu pa)   12d3  0.   0.4
w(cel pa)  14d3  0.   0.2
w(fcel pa) 14d3  0.   0.2
end_excess_function 

3                          | 3 sites (A, M2, T1) configurational entrpoy model

2 1.                       | 2 species on A, 1 site per formula unit.
z(A,Na) = 1 pa 

3 1.                       | 3 species on M2a, 1 sites per formula unit.
z(m2,Mg) = 1 cel
z(m2,Fe) = 1 fcel   

2  2.                      | 2 species on T1, 2 sites per formula unit.

z(T1,Si) = 1/2 mu + 1/2 pa

begin_dqf_corrections
                           | for endmember "name" the dqf correction is 
                           | entered as 
                           | dqf(name) num1 num2 num3
                           | where the dqf correction to the endmembers 
                           | Gibbs energy is computed as 
                           | Gdqf(J/mol) = num1 + T[K]*num2 + P[bar]*num3
dqf(pa) 1420 0 0.4 
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model               
                            Osumilite, ideal, Holland et al Contrib Mineral Petrol (1996) 124: 383-394
              
                                                      1      2     3           
                                                      M1     T1    T2   
                                                     _________________

                                      Mutliplicity    2      3     2
                                                     _________________
              
                            Species:            osm1  Mg    Al     Al   
                                                osm2  Mg    MgAl2  AlSi 
                                                fosm  Fe    Al     Al       

Osm(HP)
abbreviation Osm
full_name    osumilite

2                                     model type: endmember fractions. 
3                                     number of endmembers 
osm1     osm2      fosm               endmember names 
0  0  0                               endmember flags
0. 1.   0.1  0   | imod = 0 -> cartesian subdivision
0. 1.   0.1  0   | imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M1, T1, T2) configurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit
z(m1,fe) = 1 fosm

2 3.                       | 2 species on T1, 3 sites per formula unit.
z(t1,mg) = 1/3 osm2

2 2.                       | 2 species on T2, 2 sites per formula unit.
z(t2,si) = 1/2 osm2


end_of_model              
                      --------------------------------------------------------
begin_model                
                                      primitive non-inverse spinel model
                                      with gahnite end-member. Interaction
                                      parameters after Nichols et al.(1992), CMP
                                      111, 362-377. Jiri Konopasek
GaHcSp
abbreviation Sp
full_name    spinel

2                                     model type macroscopic
3                                     3 endmembers
gah      herc     sp                  endmember names - this order implies: x(1) = x(Zn),x(2) = x(Fe), x(3) = x(Mg)

0  0  0                               endmember flags

0.0 0.2 0.1  0            | range and resolution for X(Zn), imod = 1 -> asymmetric transform subdivision
0.0 1.  0.1  0            | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function 
w(gah herc) -3800. 0. 0.   
w(herc sp)   1960. 0. 0.
w(gah sp)   -2600. 0. 0.   
end_excess_function 

1                                     one site configurational entropy model

3 1.                                  3 species on M site with multiplicity 1
                                      
z(M,mg) = 1 sp
z(M,fe) = 1 herc

end_of_model      
                    --------------------------------------------------------  
begin_model
                                  | Fluid, Connolly & Trommsdorff CMP 1991.

                                  | The EoS used for this model is chosen by the user
                                  | when BUILD is run (the value of IFUG in the problem definition file).
                                  | If this choice is identified as a hybrid EoS, then the EoS used
                                  | for the individual species are controlled by the hybrid_EoS_XXX option.
F 
abbreviation F
full_name    fluid

0                                 | solution model type: internal EoS. See explanation in the header of 
                                  | this file for a list of model types

2                                 | number of endmembers

CO2
H2O

0 0                               | endmember flags, 1 -> the endmember composition is not considered part of the solution, otherwise 0 

0.0 1.0 0.1 0                     | subdivision scheme for CO2, see commentary in the header of this file

ideal                             | the ideal tag indicates excess properties are computed internally

0                                 | zero indicates a molecular configurational entropy model 

end_of_model
                    --------------------------------------------------------  
begin_model

F(salt)                    | H2O-CO2-NaCl Fluid from andreas's thesis
abbreviation F
full_name    fluid

26                         | model type internal EoS.
3                          | three endmembers  
hltL                                   
H2O  
CO2  
0  0  0                    
0.0 1.0 0.1 0              | range and increment for x(hlt), imod = 0 -> cartesian subdivision
0.0 1.0 0.1 0              | range and increment for x(H2O), imod = 0 -> cartesian subdivision

ideal                      | internal excess function
0                          | internal config entropy model

reach_increment 1

end_of_model               
                      --------------------------------------------------------
begin_model                
                             Scapolite. Presumably from Barbara Kuhn's thesis.

                                                      M       T2a       T2b   
                                                     ______________________

                                      Mutliplicity    4       1         2
                                                     ______________________

                                      1 me            Ca      Al       Al     independent
                            Species:  2 coma          Na3Ca   Si       Si     independent 
                                      _____________________________________

                                      3 mizz          NaCa3   Si       Al     ordered

                            enthalpy of ordering changed to match thermocalc phase eq, 
                            rather than the incorrect enthalpy that follows 
                            from table 6.4. JADC, Dec 30, 2013.

Scap                       | solution name 
abbreviation Scp
full_name    scapolite

6                          | model type: compound formation

2                          | 2 endmembers
me
coma 

1                          | ordered species definition

mizz = 2/3 me + 1/3 coma   enthalpy_of_ordering = -29000 

0 0                        | endmember flags
0.0 1. 0.1  0              

begin_excess_function 
w(me coma)   20000. 0. 0.   
w(me mizz)   20000. 0. 0.
w(coma mizz) 30000. 0. 0.   
end_excess_function 
3                          | 3 site (M1, T2a, T2b) conigurational entropy model

2 4.                       | 2 species on M, 4 sites per formula unit.

z(m,na) = 1/4 mizz  +  3/4 coma               
                
2 1.                       | 2 species on T2a, 1 site per formula unit.

z(t2a,al) = 1 me 

2 2.                       | 2 species on T2b, 1 site per formula unit.

z(t1a,si) = 1 coma

end_of_model               
                      --------------------------------------------------------
begin_model                

St(HP)                     | Mn-Fe-Mg Staurolite 
abbreviation St
full_name    staurolite
                                                            
2                                     model type: Ideal or macroscopic
3                                     3 endmembers 
mnst     fst      mst     
  1  0  0                  | endmember flags

              
0. 1. 0.1  0                | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0. 1. 0.1  0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function 
w(mst fst) -8d3 0. 0. 
end_excess_function 

1                                     1 site entropy model

3 4.                                  3 species, site multiplicity of 4
z(Fe) = 1 fst
z(Mg) = 1 mst

end_of_model
                      --------------------------------------------------------
begin_model

                             Mn-Fe-Mg Ctd

Ctd(HP)                
abbreviation Ctd
full_name    chloritoid
                                                                
2                          | model type: simplicial composition space
3                          | 3 endmembers 
mnctd    fctd     mctd                 
  1  0  0                  | endmember flags

                           | Note restricted range on X(Mn)
              
0. .2 .1  0                | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0. 1. .1  0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function 
w(mctd fctd) 1000. 0. 0. 
end_excess_function 

1                                     1 site entropy model

3 1.                                  3 species, site multiplicity = 1.
z(Fe) = 1 fctd
z(Mg) = 1 mctd

end_of_model               
                      --------------------------------------------------------
begin_model                

Carp                       | Carpholite
abbreviation Crp
full_name    carpholite
 
2                          | model type: simplicial composition space.
2                          | 2 endmembers 
mcar     fcar    
  0  0                     | endmember flags

0.     1.      0.1     0   | imod = 0 -> cartesian subdivision
ideal

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(Mg) = 1 mcar

end_of_model               
                      --------------------------------------------------------
begin_model               
                             ideal anhydrous/hydrous mg/fe HP cordierite model.
                             hfcrd_i stoichiometry corrected, L. Baumgartner, 5/6/03
   
                                                      M       H
                                                     ________________          

                                      Mutliplicity    2       1          
                                                     ________________         

                                      1 mncrd         Mn      Vac           
                            Species:  2 fcrd          Fe      Vac  
                                      3 crd           Mg      Vac         
                                      4 hmncrd        Mn      H2O    dependent       
                                      5 hfcrd         Fe      H2O    dependent
                                      6 hcrd          Mg      H2O         
                                                      _______________        

                            Dependent: hfcrd = hcrd + (fcrd - crd)
                           
hCrd
abbreviation Crd
full_name    cordierite
 
7                                 model type: reciprocal                                     
2                                 2 reciprocal sites
3  2                              3 species on site 1, 2 on site 2 
mncrd    fcrd     crd 
hmncrd_i hfcrd_i  hcrd

2                                 2 dependent endmembers 

hfcrd_i = 1 hcrd +  1 fcrd - 1 crd
hmncrd_i = 1 hcrd + 1 mncrd - 1 crd

1 0 0 1 0 0                | endmember flags

                           | Note restricted range on X(Mn)
 
0. .2 .1  0                | range and resolution for X(Mn) on M site, imod = 1 -> asymmetric transform subdivision
0. 1. .1  0                | range and resolution for X(Fe) on M site, imod = 0 -> cartesian subdivision

0. 1.  .1 0                | range and resolution for 1-X(H2O) on H site, imod = 0 -> cartesian subdivision  

ideal 

2                                       2 site entropy model.

3 2.                                    3 species on M, 2 sites per formula unit.
z(m,mg) = 1 crd + 1 hcrd
z(m,fe) = 1 fcrd 

2 1.                                    2 species on H, 1 sites per formula unit.
z(H,H2O) = 1 hcrd 

end_of_model                       
                      --------------------------------------------------------
begin_model                
                           | ideal model for mg-fe sudoite assuming
                           | mg fe and al are distributed over 
                           | 4 m1 sites. 
Sud(Livi)
abbreviation Sud
full_name    sudoite

2                          | Macroscopic

2                          | 2 endmembers
fsud     sud
  0  0                     | endmember flags
0. 1. 0.1  0               | imod = 0 -> cartesian subdivision

ideal

1                          | 1 independent mixing site, M1.

3 4.                       | 3 species on M1, 4 sites per formula unit.

z(Mg) = 1/2 sud
z(Fe) = 1/2 fsud

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | ideal model for mg-fe sudoite assuming
                           | mg and fe are distributed over 
                           | 2 sites.
Sud
abbreviation Sud
full_name    sudoite

2                          | model type: simplicial composition space

2                          | 2 endmembers
fsud     sud
  0  0                     | endmember flags
0. 1. 0.1  0               | imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(Mg) = 1 sud

end_of_model         
                      --------------------------------------------------------
begin_model
                              HP '98 Non-ideal amphibole
Cumm                                                                              
abbreviation Cumm
full_name    clinoamphibole

2                           | model type: macroscopic
2                                    
cumm     grun   
  0  0                      
0. 1. 0.1 0                 | imod = 0 -> cartesian subdivision

begin_excess_function 
W(cumm grun)  17500. 0. 0.  
end_excess_function

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 cumm

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      anthophyllite

Anth         
abbreviation oAmph
full_name    orthoamphibole

2                                   | model type: macroscopic
2                                     isp
fanth    anth     
  0  0                                endmember flags
0. 1. 0.1      0        subdivision ranges and model

ideal 

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 anth

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      "anthophyllite" a compromise
                                      model using the clinoamphibole
                                      Fe-endmember, cumm and fap should
                                      be excluded.
A
abbreviation oAmph
full_name    orthoamphibole

2                          | model type: Macroscopic
2                             
grun     ap      
  0  0                               
0. 1. 0.1      0           | subdivision ranges, imod = 0 -> cartesian subdivision

ideal 

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 ap

end_of_model               
                      --------------------------------------------------------
begin_model                

Gl                                                                                
abbreviation Gl
full_name    clinoamphibole

2                          | model type: Macroscopic
2                              
gl       fgl     
  0  0                                endmember flags
0. 1. 0.1      0           | subdivision ranges and model, imod = 0 -> cartesian subdivision

ideal 

1                                     1 site entropy model

2 3.                                  2 species, site multiplicity = 3
z(gl) = 1 gl

end_of_model              
                      --------------------------------------------------------
begin_model                

Tr                         | Tremolite        
abbreviation Tr
full_name    clinoamphibole
                                              
2                          | model type: Macroscopic
2                           
ftr      tr      
  0  0                                endmember flags

0. 1. 0.1      0           | subdivision ranges, imod = 0 -> cartesian subdivision

ideal 

1                                     1 site entropy model

2 5.                                  2 species, site multiplicity = 5.
z(mg) = 1 tr
                           
end_of_model
                      --------------------------------------------------------
begin_model                
                           | ternary feldsar (fuhrman & lindsley, am min, 1988)
                           | for binary plagioclse this model is identical
                           | to that of Newton et al. 1980, and for binary
                           | alkali feldspar it is identical to Haselton et al. (1983).

                             CORRECTED FOR TYPO IN ORIGINAL PAPER.

feldspar                   
abbreviation Fsp
full_name    ternary-feldspar

2                          | model type: simplicial composition space
3                          | 3 endmembers
abh      
an       
san      
0 0 0                      | endmember flags = 0 if the endmember is part of the solution.
0. 1. 0.1   0              | range and resolution for albite, imod = 0 -> cartesian subdivision
0. 1. 0.1   0              | range and resolution for anorthite, imod = 0 -> cartesian subdivision

begin_excess_function 
w(abh abh san) 27320.   -10.3  .394 
w(abh san san) 18810.   -10.3  .394 
w(an  an  san) 52468.      .0   .0   
w(an  san san) 47396.      .0  -.12  
w(an  an  abh) 28226.      .0   .0   
w(an  abh abh) 8471.       .0   .0   
w(an  abh san) 100045.5 -10.3 -0.76 
end_excess_function 

2                          | 2 site (O-site and T-site) entropy model

3 1.                       | 3 species on O-site, 1 site per formula unit.
z(Na) = 1 abh
z(Ca) = 1 an

2 2.                       | 2 species on T-site, 2. sites per formula (al-avoidance model)
z(Al) = 1/2 + 1/2 an 

reach_increment 3         

end_of_model        
                      --------------------------------------------------------
begin_model 
                           | ternary feldspar (Benisek et al, CMP 160:327-337, 2010)
                           | for T > 973 K. 

                           | Entered by Vratislav Hurai, May 10, 2011.

feldspar_B 
abbreviation Fsp
full_name    ternary-feldspar
2                          | model type: simplicial composition space
3                          | 3 endmembers

abh      
an       
san      

0 0 0                      | endmember flags = 0 if the endmember is part of the solution.

0. 1. .1  0                | range and resolution for albite, cartesian subdivision
0. 1. .1  0                | range and resolution for anorthite, cartesian subdivision
 

begin_excess_function 
w(abh abh san) 17711.  -10.3   .461 
w(abh san san) 22945.  -10.3   .327 
w(an an san) 90600.      0.0  -.257  
w(an san san) 60300.     0.0  -.21   
w(an an abh) 40000.    -16.4   .069  
w(an abh abh) 14000.    -4.7  -.049  
w(an abh san) 210078. -114.75 -.2965 
end_excess_function 

2                          | 2 site (O-site and T-site) entropy model

3 1.                       | 3 species on O-site, 1 site per formula unit.
z(Na) = 0 + 1 abh
z(Ca) = 0 + 1 an

2 2.                       | 2 species on T-site, 2. sites per formula (al-avoidance model)
z(Al) = 1/2 + 1/2 an

reach_increment 3 

end_of_model        
                      --------------------------------------------------------
begin_model               

Pl(h)                      | Newton et al 1981 
abbreviation Pl
full_name    binary-feldspar

2                          | model type: simplicial composition space
2                          | 2 endmembers  
abh      an      
  1  0                     | endmember flags
0. 1. .1  0                | imod = 0 -> cartesian subdivision
begin_excess_function 
w(abh abh an) 8477.00 0. 0. 
w(an an abh) 28246.0 0. 0. 
end_excess_function 

2                          | 2 sites (O, T) kerrick and darkens Al-avoidance model:
2 1.                       | 2 species on O site, multiplicity = 1.
z(Na) = 1 abh

2 2.                       | 2 species on T, mutiplicity = 2.
z(Al) = 1/2 + 1/2 an

reach_increment 3  

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | Waldbaum and Thompson 1968. This model is just the San 
                           | model with the low structural state endmembers.
Kf                         
abbreviation Mic
full_name    binary-feldspar

2                          | model type: Macroscopic 
2                          | 2 endmembers

mic      ab     

  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(mic ab ab)  32098.0     -16.1356     0.469020
w(mic mic ab)  26470.0     -19.3810     0.387020 
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 ab

reach_increment 3 

end_of_model              
                      --------------------------------------------------------
begin_model                

San                        | Waldbaum and Thompson 1968.
abbreviation San
full_name    binary-feldspar

2                          | model type: Macroscopic 
2                          | 2 endmembers
san      abh     

  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(san abh abh)  32098.0     -16.1356     0.469020
w(san san abh)  26470.0     -19.3810     0.387020 
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 abh

reach_increment 3 

end_of_model    
                      --------------------------------------------------------
begin_model                

San(TH)                    | Thompson and Hovis 1979.
abbreviation San
full_name    binary-feldspar

2                          | model type: Macroscopic 
2                          | 2 endmembers
san      abh     

  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(san abh abh)  17062.4       0.         0.360661
w(san san abh)  30978.3     -21.7568     0.360661
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 abh

reach_increment 3 

end_of_model
                      --------------------------------------------------------
begin_model
                                      Connolly and Cesare C-O-H Fluid
                                      this model is for X(O) = 0-1

                                  | The EoS used for this model is chosen by the user
                                  | when BUILD is run (the value of IFUG in the problem definition file).
                                  | If this choice is identified as a hybrid EoS, then the EoS used
                                  | for the individual species are controlled by the hybrid_EoS_XXX option.

GCOHF
abbreviation F
full_name    fluid

0                          | model type: Internal EoS
2                                  
O2       H2     
  0  0                                endmember flags
1d-5 0.999999 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision


ideal
0

reach_increment 3 

end_of_model
                      --------------------------------------------------------
begin_model
                           | Ternary C-O-H Fluid 
                           | see: perplex.ethz.ch/perplex/faq/calculations_with_unbuffered_COH_fluids.txt
COHF   
abbreviation F
full_name    fluid

41                         | model type: Internal EoS
3                                  
gph      O2       H2 
 1  0  0                   | endmember flags

1d-5 0.67      0.1    0    | subdivision ranges, imod = 0 -> cartesian subdivision
1d-5 0.999999  0.1    0    | subdivision ranges, imod = 0 -> cartesian subdivision

ideal
0

reach_increment 0 

end_of_model
                      --------------------------------------------------------
begin_model
                                      Non-ideal margarite-paragonite
                                      to fit field data of Bucher-Nurminen et al (1983)
                                      and Frank (1983), critical T = 972 K, X(Ma) = 33%.
                                      JADC, 4/08.
                                      


MaPa                       | margarite-paragonite                                          
abbreviation Ma
full_name    white-mica

2                          | macroscopic
2
pa       ma      
  0  0                                endmember flags
0. 1. 0.1 0                           subdivision ranges and model

begin_excess_function 
w(pa pa ma) 18201. 0. 0.
w(ma ma pa) 9101.  0. 0.
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 pa

reach_increment 3 

end_of_model              
                      --------------------------------------------------------
begin_model                
                           | non-ideal hybrid model for K-Na phengitic mica
                           | mixes Chaterjee and Froese (1975) with ideal phengite model

                           | this configurational entropy is that of HP '98, see Phen(HP)

                             config entropy corrected, D Tinkham, 5/6/03
   
                                                      A        M2a      T 
                                                     _________________________

                                      Mutliplicity    1         1       2 
                                                     _________________________

                            Species:  1 cel           K        Mg     Si_Si
                                      2 fcel          K        Fe     Si_Si 
                                      3 mu            K        Al     Al_Si     
                                      4 pa            Na       Al     Al_Si     

Mica(CF)                   | solution name 
abbreviation Mica
full_name    white-mica

2                          | model type: simplicial composition space

4                          | endmembers

cel
fcel
mu
pa

0 0 0 0                    | endmember flags

                           | subdivision schemes for cel, fcel, and pa, 
                           | see commentary in the header of this file for further explanation

0. 0.1 0.1 0               | cel  subdivision range
0. 0.1 0.1 0               | fcel subdivision range
0. 1.0 0.1 0               | pa   subdivision range

begin_excess_function 
W(mu pa pa) 19456.0      1.65440     -.456100 
W(mu mu pa) 12230.0     0.710440     0.665300     
end_excess_function

3                          | 3 site (M2a, T2, A) entropy model

3 1.                       | 3 species on M2a, 1 sites per formula unit.
z(m,mg) = 1 cel 
z(m,fe) = 1 fcel 

2 2.                       | 2 species on T2, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa

2 1.                       | 2 species on A, 1 site per formula unit.
z(a,k) = 1 mu + 1 cel + 1 fcel

reach_increment 0 3 

end_of_model               
                      --------------------------------------------------------
begin_model                
                             Mica(CHA1): Reciprocal version of white mica model Mica(CHA) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             Coggon & Holland model orginally entered by Mark Caddick, Aug 30, 2005.

                             This model allows Tschermaks and Ti substitution in both the Na
                             and Ca mica subsytems. When these substitutions are insignificant, 
                             use of the reduced version of the model used in Mica(CHA)  
                             is much more efficient.

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip). 

                             MODIFICATION/CORRECTION HISTORY:

                             1) van laar size terms added Nov 25, 2005. JADC.

                             2) ma t12 site occupancy corrected from AlSi to AlAl, D. Dolejs. Mar 23, 2006

                             3) endmember order corrected from: mu pa ma cel npa nfpa fcel nfma nma
                                                            to: mu pa ma cel npa nma  fcel nfpa nfma
                                                            JADC, May 4, 2006.

                             4) van Laar size terms for potassic endmembers corrected from 0.67 to 0.63. 
                                                             L. Tajcmanova, Jan 6, 2010.

                             5) extended from Mica(CH1) to include Ti-substitution afer Auzanneau et al (2010).
                                               

                             N.B., the Coggon and Holland mica model predicts a significantly narrower
                             mu-pa solvus than Chatterjee and Froese's model (1975), so far as I know both 
                             models are based on Chartterjee and Froese's experimental determination of 
                             the solvus. 

                             JADC, 5/17/13

                                                      A       M2a    M2b    T12    M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _      
                                      3 ma            Ca      Al      Al    AlAl    _

                                      4 cel           K       Mg      Al    SiSi    _ 
                                      5 npa           Na      Mg      Al    SiSi    _    dependent
                                      6 nma           Ca      Mg      Al    AlSi    _    dependent
                                    
                                      7 fcel          K       Fe      Al    SiSi    _
                                      8 nfpa          Na      Fe      Al    SiSi    _    dependent
                                      9 nfma          Ca      Fe      Al    SiSi    _    dependent

                                     10 tip           K       Mg      Ti    AlSi    _
                                     11 ntip          Na      Mg      Ti    AlSi    _    dependent
                                     12 ctip          Ca      Mg      Ti    AlAl    _    dependent

                                     13 ftip          K       Fe      Ti    AlSi    _    dependent
                                     14 nftip         Na      Fe      Ti    AlSi    _    dependent
                                     15 cftip         Ca      Fe      Ti    AlAl    _    dependent
                                                     ___________________________________
Mica(CHA1)                    
abbreviation Mica
full_name    white-mica

7                            | model type: Macroscopic
2                            | number of independent mixing sites
3  5                         | 3 species on site 1, 5 species on site 2.

cel npa nma 
fcel nfpa nfma
tip ntip ctip
ftip nftip cftip
mu pa ma 

9                            | dependent end-members

nma   = 1 cel + 1 ma - 1 mu
npa   = 1 cel + 1 pa - 1 mu
nfpa  = 1 fcel + 1 pa - 1 mu
nfma  = 1 fcel + 1 ma - 1 mu
ntip  = 1 tip + 1 pa - 1 mu
ctip  = 1 tip + 1 ma - 1 mu
ftip  = 1 tip + 1 fcel - 1 cel
nftip = 1 tip + 1 fcel - 1 cel + 1 pa - 1 mu
cftip = 1 tip + 1 fcel - 1 cel + 1 ma - 1 mu

0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0                | endmember flags

                             | subdivision model, site 1 (A):
0. 1.   .1  0                | range and resolution of X(K)
0. 1.   .1  0                | range and resolution of X(Na)

                             | subdivision model, site 2 (M2)
0. .8   .1   0               | range and resolution of X(MgAl,M2)
0. .5   .1   0               | range and resolution of X(FeAl,M2)
0. .5   .1   0               | range and resolution of X(MgTi,M2)
0. .3   .1   0               | range and resolution of X(FeTi,M2)

begin_excess_function

W(mu pa)    10120. 3.4 0.353  
W(mu ma)    30000. 0. 0. 
W(mu cel)   0. 0. 0.2
W(mu fcel)  0. 0. 0.2
W(pa ma)    14500. 0. 0. 
W(pa cel)   52000. 0. 0. 
W(pa fcel)  52000. 0. 0. 
W(ma cel)   30000. 0. 0.2
W(ma fcel)  30000. 0. 0.2
W(tip cel)  10000. 0. 0.
W(tip fcel) 10000. 0. 0.
W(tip pa)   80000. 0. 0.

 | W(prl mu)   20000. 0. 0.2
 | W(prl pa)   20000. 0. 0.2
 | W(prl ma)   30000. 0. 0.2
 | W(prl cel)  25000. 0. 0.2
 | W(prl fcel) 25000. 0. 0.2
 | W(prl tip)  40000. 0. 0.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1.                        | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel   
z(a,na) = 1 pa 

3 1.                        | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma 
z(m2a,mg) = 1 cel + 1 tip

2 1.                        | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma 

begin_van_laar_sizes                        
alpha(mu)     0.63 0. 0.                        
alpha(pa)     0.37 0. 0.                     
alpha(ma)     0.37 0. 0.    
alpha(cel)    0.63 0. 0.
alpha(tip)    0.63 0. 0.
alpha(fcel)   0.63 0. 0.
 | alpha(prl)    0.5  0. 0.
 | alpha(phl)    0.63 0. 0.
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model                
                             Mica(CHA): Non-reciprocal version of white mica model Mica(CHA1) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             The non-reciprocal version does not allow tschermaks or Ti substutions
                             in the Ca- and Na-subsystems. If these substitutions are important use 
                             the more costly model Mica(CHA1)

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip).

                             This version does not include the prl and phl endmembers considered by
                             both Coggon & Holland (2002) and Auzanneau et al. (2010) (the data is commented
                             below) as solution of these endmembers is usually unimportant.

                             JADC, 1/18/10

                             N.B., the Coggon and Holland mica model predicts a significantly narrower
                             mu-pa solvus than Chatterjee and Froese's model (1975), so far as I know both 
                             models are based on Chartterjee and Froese's experimental determination of 
                             the solvus. 

                             JADC, 5/17/13

                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _      
                                      3 ma            Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _                                      
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 tip           K       Mg      Ti    AlSi    _

                             not included:
                                                     ___________________________________
                                      7 prl           _       Al      Al    SiSi    _
                                      8 phl           K       Mg      Mg    AlSi    Mg
                                                     ___________________________________
Mica(CHA)                    
abbreviation Mica
full_name    white-mica

2                            | model type: macroscopic.

6                            | 6 endmembers

mu pa ma cel tip fcel        | prl phl

0 0 0 0 0 0 0 0              | endmember flags

                              | subdivision model
0. 1.   .1  0                 | range and resolution of X(mu),  imod = 0 -> cartesian subdivision
0. 1.   .1  0                 | range and resolution of X(pa),  imod = 0 -> cartesian subdivision
0. 1.   .1  0                 | range and resolution of X(ma),  imod = 0 -> cartesian subdivision
0. 1.   .1  0                 | range and resolution of X(cel), imod = 0 -> cartesian subdivision
0. 0.3  .1  0                 | range and resolution of X(tip), imod = 1 -> asymmetric transform subdivision

begin_excess_function

W(mu pa)    10120. 3.4 0.353  
W(mu ma)    30000. 0. 0. 
W(mu cel)   0. 0. 0.2
W(mu fcel)  0. 0. 0.2
W(pa ma)    14500. 0. 0. 
W(pa cel)   52000. 0. 0. 
W(pa fcel)  52000. 0. 0. 
W(ma cel)   30000. 0. 0.2
W(ma fcel)  30000. 0. 0.2
W(tip cel)  10000. 0. 0.
W(tip fcel) 10000. 0. 0.
W(tip pa)   80000. 0. 0.

 | W(prl mu)   20000. 0. 0.2
 | W(prl pa)   20000. 0. 0.2
 | W(prl ma)   30000. 0. 0.2
 | W(prl cel)  25000. 0. 0.2
 | W(prl fcel) 25000. 0. 0.2
 | W(prl tip)  40000. 0. 0.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1.                        | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel   
z(a,na) = 1 pa 

3 1.                        | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma 
z(m2a,mg) = 1 cel + 1 tip

2 1.                        | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma 

begin_van_laar_sizes                        
alpha(mu)     0.63 0. 0.                        
alpha(pa)     0.37 0. 0.                     
alpha(ma)     0.37 0. 0.    
alpha(cel)    0.63 0. 0.
alpha(tip)    0.63 0. 0.
alpha(fcel)   0.63 0. 0.
 | alpha(prl)    0.5  0. 0.
 | alpha(phl)    0.63 0. 0.
end_van_laar_sizes

end_of_model         
                                  --------------------------------------------------------         
begin_model                
                             Mica+(CHA): Non-reciprocal version of white mica model Mica(CHA1) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             extended from Mica(CHA) to allow the pyrophyllite substitution, renamed
                             to prevent unintentional use.

                             The non-reciprocal version does not allow tschermaks or Ti substutions
                             in the Ca- and Na-subsystems. If these substitutions are important use 
                             the more costly model Mica(CHA1)

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip).

                             This version does not include the prl and phl endmembers considered by
                             both Coggon & Holland (2002) and Auzanneau et al. (2010) (the data is commented
                             below) as solution of these endmembers is usually unimportant.

                             JADC, 1/18/10

                             N.B., the Coggon and Holland mica model predicts a significantly narrower
                             mu-pa solvus than Chatterjee and Froese's model (1975), so far as I know both 
                             models are based on Chartterjee and Froese's experimental determination of 
                             the solvus. 

                             JADC, 5/17/13

                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _      
                                      3 ma            Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _                                      
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 tip           K       Mg      Ti    AlSi    _
                                      7 prl           _       Al      Al    SiSi    _

                             not included:
                                                     ___________________________________
                                      8 phl           K       Mg      Mg    AlSi    Mg
                                                     ___________________________________

Mica+(CHA)
abbreviation Mica
full_name    white-mica
          
2                            | model type: macroscopic.

7                            | # of endmembers

mu pa ma cel tip prl fcel    | phl

0 0 0 0 0 0 0 0              | endmember flags

                             | subdivision model
0. 1.   .1  0                 | range and resolution of X(mu),  imod = 0 -> cartesian subdivision
0. 1.   .1  0                 | range and resolution of X(pa),  imod = 0 -> cartesian subdivision
0. 1.   .1  0                 | range and resolution of X(ma),  imod = 0 -> cartesian subdivision
0. 1.   .1  0                 | range and resolution of X(cel), imod = 0 -> cartesian subdivision
0. 0.3  .1  0                 | range and resolution of X(tip), imod = 1 -> asymmetric transform subdivision
0. 0.3  .1  0                 | range and resolution of X(prl), imod = 1 -> asymmetric transform subdivision

begin_excess_function

W(mu pa)    10120. 3.4 0.353  
W(mu ma)    30000. 0. 0. 
W(mu cel)   0. 0. 0.2
W(mu fcel)  0. 0. 0.2
W(pa ma)    14500. 0. 0. 
W(pa cel)   52000. 0. 0. 
W(pa fcel)  52000. 0. 0. 
W(ma cel)   30000. 0. 0.2
W(ma fcel)  30000. 0. 0.2
W(tip cel)  10000. 0. 0.
W(tip fcel) 10000. 0. 0.
W(tip pa)   80000. 0. 0.
W(prl mu)   20000. 0. 0.2
W(prl pa)   20000. 0. 0.2
W(prl ma)   30000. 0. 0.2
W(prl cel)  25000. 0. 0.2
W(prl fcel) 25000. 0. 0.2
W(prl tip)  40000. 0. 0.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

4 1.                        | 3 species on A, 1 site per formula unit.

z(a,k)  = 1 mu  + 1 cel + 1 fcel   
z(a,na) = 1 pa 
z(a,V)  = 1 prl

3 1.                        | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma + 1 prl
z(m2a,mg) = 1 cel + 1 tip

2 1.                        | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma 

begin_van_laar_sizes                        
alpha(mu)     0.63 0. 0.                        
alpha(pa)     0.37 0. 0.                     
alpha(ma)     0.37 0. 0.    
alpha(cel)    0.63 0. 0.
alpha(tip)    0.63 0. 0.
alpha(fcel)   0.63 0. 0.
alpha(prl)    0.5  0. 0.
 | alpha(phl)    0.63 0. 0.
end_van_laar_sizes

end_of_model
                                  --------------------------------------------------------
begin_model                
                                      HP '98 olivine solution.


O(HP)                     
abbreviation Ol
full_name    olivine
                                                          
2                                     model type: simplicial composition space

3                                     3 endmembers
teph     fo       fa        
0  0   0                            | endmember flags

                                    | NOTE restricted compositional range for Mn 

0.0 1.0  0.1   0                    | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0.0 1.0  0.1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 8400. 0. 0.                | corrected from 4.2 kJ Nov 15, 2004.          
end_excess_function 

1                                     1 site entropy model

3 2.                                  3 species, site multiplicity = 2.

z(mg) = 1 fo
z(fe) = 1 fa 

end_of_model              
                                  --------------------------------------------------------
begin_model                
                                      ad hoc stilpnomelane

Stlp                     
abbreviation Stlp
full_name    stilpnomelane
                                                          
2                                     model type: simplicial composition space

2                                     endmembers
mstp fstp    
0  0                                | endmember flags

0.0 1.0  0.1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 5.                                  3 species, site multiplicity = 2.

z(mg) = 1 mstp

end_of_model              
                                  --------------------------------------------------------
begin_model                
                                      HP '98 olivine solution with an approximation to the
                                      T Kawasaki (J Min Pet Sci, 96:54-66, 2001) symetric fo-monticellite 
                                      excess function, this is probably adequate a first order 
                                      model for Ca solution in olivine. To reproduce the solvus
                                      or evaluate pressure effects refer to Kawasaki or Warner
                                      and Luth 1973 or find more recent work. JADC, Jul 10, 2016. 
O(HPK)                     
abbreviation Ol
full_name    olivine
                                                          
2                                     model type: simplicial composition space

4                                     3 endmembers
mont     teph     fo       fa        
  0  0  0   0                       | endmember flags

                                    | NOTE restricted compositional range for Mn 
0.0 1.0  0.1   0                    | range and resolution for X(Ca), imod = 0
0.0 1.0  0.1   0                    | range and resolution for X(Mn), imod = 0 
0.0 1.0  0.1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 8400. 0. 0.                | corrected from 4.2 kJ Nov 15, 2004.
W(fo mont) 34050. 0. 0.             
end_excess_function 

                                    | this model is not incorrect because Ca partitions onto M1, i.e., 
                                    | the model should be an o/d model, such a model has been published
                                    | (probably by Ghiorso or coworkers). 

1                                     1 site entropy model

4 2.                                  4 species, site multiplicity = 2
z(mn) = 1 teph
z(mg) = 1 fo
z(fe) = 1 fa 

end_of_model              
                      --------------------------------------------------------
begin_model                
                                      "Ordered" Jadeite-Diopside-Hedenbergite-CaTs,
                                      as: 1) Gasparik '85 (GCA) in the jd/di limit.
                                          2) HP'98 in the di/hed limit
                                          3) Assuming nonideality in the
                                             jd/hed limit is the same as for jd/di. 
                                          4) No ternary interactions.
                                          5) Gasparik '85 (CMP) in the jd/cats limit. 
                                      This should be Gaspariks preferred model. 
                                      JADC Apr. 99.

                                      the configurational entropy model has been
                                      constructed to take into account that Gasparik
                                      uses an X^2 molecular model for CaTs-Di and an
                                      X molecular model for Jd-Di. This implies that
                                      there is no disorder associated with placing Na
                                      on M2 (i.e., it is associated with Al on M1), 
                                      whereas Al on M1 is not assocated with Al on T.
                                      To get Gasparik's molecular formulation it is
                                      necessary to specify that Al mixes on only one
                                      of the two T-sites.
Cpx(l)  
abbreviation Cpx
full_name    clinopyroxene

2                                  | model type: simplicial composition space

4                                  | 4 endmembers

di
hed      
cats                  
jd  

0  0  0  0                         | endmember flags

0. 1. 0.1  0
0. 1. 0.1  0
0. 1. 0.1 0                        | subdivision ranges and model

begin_excess_function 
w(cats jd) 14810.      -7.15        0.          
w(cats cats jd) -5070.       0.00  0.            
w(cats jd jd)   5070.       0.00  0.           
w(cats cats cats jd)  -3350.       0.00  0.     
w(cats cats jd jd)   6700.       0.00  0.               
w(cats jd jd jd)   -3350.       0.00  0.              
w(di jd jd)    12600.  -7.6 0.                   
w(di di jd)   -12600.   7.6 0.           
w(di jd jd jd)  -21400.      16.2   0.    
w(di di jd jd)    42800.     -32.4   0.         
w(di di di jd)   21400.     -16.2   0.           
w(di jd)   12600.      -9.45  0.
         
w(di hed)    2500.       0.0   0.         
w(hed hed jd)    -12600.       7.6   0.           
w(hed jd jd jd)  -21400.      16.2   0. 
          
w(hed jd)   12600.      -9.45  0.         
w(hed jd jd)   12600.      -7.6   0.       
w(hed hed jd jd)   42800.     -32.4   0.      
w(hed hed hed jd) -21400.      16.2   0.
   
end_excess_function 

2                                     wierd entropy model, see above (maybe it's right).

3 1.                                  M1, Al-Mg-Fe, 1 site

z(fe,m1) = 1 hed 
z(mg,m1) = 1 di  

2 1.                                  T, Al-Si, this is fake to get gasparik's model.
z(al,t) = 1 cats

end_of_model             
                      --------------------------------------------------------
begin_model                
                                      "disordered" Jadeite-Diopside-Hedenbergite-CaTs,
                                      as: 1) Gasparik '85 (GCA) in the jd/di limit.
                                          2) HP'98 in the di/hed limit
                                          3) Assuming nonideality in the
                                             jd/hed limit is the same as for jd/di. 
                                          4) No ternary interactions.
                                          5) Gasparik '85 (CMP) in the jd/cats limit. 
                                      JADC Apr. 99.

                                      the configurational entropy model has been
                                      constructed to take into account that Gasparik
                                      uses an X^2 molecular model for CaTs-Di and 
                                      Jd-Di. See comments for Cpx(l) above.

Cpx(h)   
abbreviation Cpx
full_name    clinopyroxene

2                                  
4                                  
di       
hed      
cats             
jd  

0  0  0  0                         | endmember flags

0. 1. 0.1  0 
0. 1. 0.1  0 
0. 1. 0.1  0                       | subdivision ranges and model


begin_excess_function 
w(cats jd) 14810.      -7.15        0.          
w(cats cats jd) -5070.       0.00  0.            
w(cats jd jd)   5070.       0.00  0.           
w(cats cats cats jd)  -3350.       0.00  0.     
w(cats cats jd jd)   6700.       0.00  0.               
w(cats jd jd jd)   -3350.       0.00  0.              
w(di jd jd)   12430.      -6.21  0.               
w(di di jd)  -12430.       6.21  0.         
w(di jd jd jd)  -22290.      23.19   0.  
w(di di jd jd)   44580.     -46.38   0.        
w(di di di jd)  -22290.      23.19   0.         
w(di jd)   12540.      12.63  0.         
w(di hed)    2500.       0.0   0.         
w(hed hed jd)  -12430.       6.21  0.       
w(hed jd jd jd) -22290.      23.19   0.            
w(hed jd)  12540.      12.63  0.           
w(hed jd jd)  12430.      -6.21  0.     
w(hed hed jd jd)  44580.     -46.38   0.     
w(hed hed hed jd) -22290.      23.19   0.     
end_excess_function 

3                                     msite
3 1.                                  M1, Al-Mg-Fe, 1 site

z(Fe,m1) = 1 hed
z(Mg,m1) = 1 di 

2 1.                                  M2, Ca-Na, 1 site

z(na,m2) = 1 jd

2 1.                                  T, Al-Si, this is fake to get gasparik's model.
z(al,t) = 1 cats

end_of_model               
                      --------------------------------------------------------
begin_model
                                      HP '98 dolomite-ankerite solution
Do(HP)  
abbreviation Do
full_name    carbonate
 
2                          | macroscopic

2                          | 2 endmembers                     
dol      ank     
  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(dol ank) 3000.0 0. 0. 0. 0.
end_excess_function 

1                          | 1 site entropy model
2 1. 
z(Mg) = 1 dol

end_of_model               
                     -------------------------------------------------------- 
begin_model               
                                      HP '98 Magnesite/siderite modified by DMH 
                                      to include rhc 
M(HP)      
abbreviation Mag
full_name    carbonate

2                                     model type: simplicial composition space

3                                     number of endmembers 
rhc    mag     sid                    endmember names 

  0  0  0                        | endmember flags

0. 1. 0.1  0                       | range X(Mn), imod = 1 -> asymmetric transform subdivision
0. 1. 0.1  0                       | range X(Fe), imod = 0 -> cartesian subdivision               

begin_excess_function
w(mag sid) 4000. 0. 0.          | hp '98 give 4 kJ
end_excess_function  

1                                     1 site entropy model

3 1.                                  3 species, site multiplicity 1
z(Fe) = 1 sid
z(Mg) = 1 mag

end_of_model               
                     -------------------------------------------------------- 
begin_model                
                   A solution model for Dolomite from Anovitz & Essene 
                   1987 J Pet 28:389-414; this model requires fictive
                   do-structure endmembers that have a standard state
                   G 20920 j > than the cc-structure endmember, these 
                   are made here by a "DQF" correction.
Do(AE)
abbreviation Do
full_name    carbonate

2                          | model type: simplicial composition space

3                          | 3 endmembers    
cc       
mag
sid 
1 1 1                      | endmember flags
0. 1. 0.1 0                | subdivision range X(cc), imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | subdivision range X(mag), imod = 0 -> cartesian subdivision
begin_excess_function 
w(mag mag cc) -96850   36.23  0
w(mag cc cc) -55480   -22.85  0  
w(sid sid cc) -155523  141.5  0  | this is a linearization of -1040 -T*(212.4  - 0.2027*T) at 873 K, JADC 5/08.
w(sid cc cc)  -16746   -89.2  0  | this is a linearization of -86740-T*(-71.18+.9184e-1*T) at 873 K, JADC 5/08.
w(sid cc mag) -293520 -121.6  0  | this is a linearization of -185450-T*(369.2-.1418*T) at 873 K, JADC 5/08. 
end_excess_function 
1                          | 1 site entropy model
3 1.                       | 2 species, site multiplicity of 1? should check against source
z(Mg) = 1 mag
z(Fe) = 1 sid

begin_dqf_corrections
dqf(cc) 20920 0 0 
dqf(mag) 20920 0 0 
dqf(sid) 20920 0 0 
end_dqf_corrections

end_of_model               
                      --------------------------------------------------------
begin_model              
                   A solution model for Magnesite from Anovitz & Essene 
                   1987 J Pet 28:389-414.
Cc(AE)          
abbreviation Cc
full_name    carbonate

2                          | model type: simplicial composition space

3                          | 2 endmembers  
mag      
cc
sid
0  0  0                                endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(cc cc mag)  24300 -7.743 0        
w(cc mag mag) 23240  0.    0  
w(sid sid cc) 28404 -2.5   0 | this is a linearization of 27313.2-5.9651e-6/T-1.43147e-3*T^2 at T = 873. JADC, 5/08.
w(sid cc cc)  20624 -7.533 0 | this is a linearization of -70751.4 + 91.8848*T + 2.79244e7/T - 3.59552e-2 * T^2 at T = 873. JADC, 5/08.
                             | missing the ternary interaction parameter estimated by Anovitz & Essene. 
end_excess_function

1
3 1.
z(mg) = 1 mag
z(fe) = 1 sid
end_of_model  
                      --------------------------------------------------------
begin_model               
                             Magnesioferrite/magnetite (inverse)

MF                                                                               
abbreviation Mt
full_name    spinel

2                          | model type: simplicial composition space

2  1                                isp(1), ist(1) 
mt       mft    
  0  0                                endmember flags
0.    1.  .1     0         subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(mt mft)  8368. 0. 0.     | Sack & Ghiorso, W_FeMg, CMP, 1991. 
end_excess_function

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity of 2
z(Fe) = 1 mt

reach_increment 3

end_of_model
                      --------------------------------------------------------

begin_model

Sp(JR)                      Jamieson and Roeder '85 (iron + ol,1300 C)                          
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers 
sp       herc    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(sp herc) -3102. 0. 0. 
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity of 2
z(Fe) = 1 herc

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ghiorso 1991, gives similar W=8638

Sp(GS)                                Ganguly and Saxena '87 (ol, 1200-1300 C, 1-5 kb)
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers 
sp       herc    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(sp herc) 7703. 0. 0. 
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity of 2
z(Fe) = 1 herc

end_of_model               
                      --------------------------------------------------------
begin_model

Sp(HP)                                 HP '98:
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers 
sp       herc    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(sp herc) 7d2 0. 0. 
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity of 1
z(Fe) = 1 herc

end_of_model               
                      --------------------------------------------------------
begin_model                
                            valid for T>800C<1300C

Mt(W)                                 Wood et al 1991
abbreviation Mt
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers          
usp      mt
  0  0                                endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(usp mt mt) 42110.      0. 0. 
w(usp usp mt) 10580.      0. 0. 
end_excess_function   


2                          | 2 site model
 
3 2.                       | 3 species on O, 2 sites per formula unit.

z(Ti,O) = 1/2 usp
z(Fe3+,O) = 1/2 mt

2 1.                       | 2 species on T, 1 site per formula unit.
z(Fe3+,T) = 1 mt

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      The Andersen and Lindsley models
                                      (Am Min v 73, p 714, 1988)
                                      are for ilmenite coexisiting with
                                      magnetite, its performance at high 
                                      T (ca 1200) has been criticized by
                                      Ghiorso, but this is probably the
                                      best model for T<800 C

                                      Jury-rigged for geik, JADC, 2/14/13    

                                      Ti only on B, Fe3+ disordered                    


IlHm(A)                           
abbreviation Ilm
full_name    ilmenite

2                            | macroscopic

3                            | 3 endmembers 
ilm      hem     geik
  0  0  0                    | endmember flags
0. 1. 0.1 0                  | subdivision range, imod = 0 -> cartesian subdivision
0. 1. 0.1 0                  | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(ilm hem hem) 126342.5 -100.6 0. term 1
w(ilm ilm hem) 44204.8 -12.274 0. term 2
w(geik hem hem) 126342.5 -100.6 0. term 1
w(geik geik hem) 44204.8 -12.274 0. term 2
end_excess_function

2

2 1.                         | B-site, Fe3+ and Ti 
z(Ti,B) = 1 ilm + 1 geik

3 1.                         | A-site, Fe2+, Fe3+ and Mg
z(Mg,A)   = 1 geik
z(Fe2+,A) = 1 ilm

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ideal ilmenite-geikielite-pyrophanite solution
IlGkPy
abbreviation Ilm
full_name    ilmenite

2                          | model type: simplicial composition space

3                          | 3 endmembers
pnt      geik     ilm      
0 0 0                      | endmember flags

                           | restricted mn range! 

0. .2 0.1    0             | imod = 1 -> asymmetric transform subdivision
0. 1. 0.1    0             | imod = 0 -> cartesian subdivision
ideal

1                          | 1 site entropy model

3 1.                       | 3 species, site multiplicity of 1
z(Mn) = 1 pnt
z(Mg) = 1 geik

end_of_model               
                      --------------------------------------------------------
begin_model                

MtUl(A)                    | Andersen and Lindsley 1988, Akimoto model
abbreviation Mt
full_name    spinel
                           | assumes Ti is only octahedral, Mg and Fe2+ 
                           | jury rigged for magnesio-ferrite, JADC 2/14/13

2                          | model type: simplicial composition space

3                          | 3 species
usp     mt     mft
  0  0  0                  | endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(usp mt mt) 46175. -23.077 0. 
w(usp usp mt) 15748.      0. 0. 
w(usp mft mft) 46175. -23.077 0. 
w(usp usp mft) 15748.      0. 0. 
end_excess_function   

2                          | 2 site model, assumes Fe3+ is disorderd
 
4 2.                       | 4 species on O, 2 sites per formula unit.

z(Ti,O) = 1/2 usp
z(Fe3+,O) = 1/2 mt + 1/2 mft
z(Mg,O) = 1/2 mft

3 1.                       | 2 species on T, 1 site per formula unit.
z(Fe3+,T) = 1 mt + 1 mft
z(Fe2+,T) = 1 usp

end_of_model               
                      --------------------------------------------------------
begin_model                

Neph(FB)                              Ferry and Blencoe '78        
abbreviation Neph
full_name    feldspathoid
                                       
2                          | macroscopic

2                          | 2 endmembers
ne       kals    
  0  0                                endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(ne kals kals) 85057.0     -20.0500     -.550000
w(ne ne kals) 35945.0      23.7800     0.69 
end_excess_function 

1                          | 1 site model
 
2 1.                       | 2 species, 1 sites per formula unit.
z(na) = 1 ne

reach_increment 3 

end_of_model               
                      --------------------------------------------------------
begin_model

Gt(B)                           Grossular-pyrope-almandine-spessartine, Berman '90,
abbreviation Gt
full_name    garnet

2                          | macroscopic

4                          | 4 endmembers
gr       py       alm      
spss   
  0  0  0  0                          endmember flags

  0.0 1. 0.1 0             | imod = 0 -> cartesian subdivision
  0.0 1. 0.1 0             | imod = 0 -> cartesian subdivision
  0.0 1. 0.1 0             | imod = 0 -> cartesian subdivision  

begin_excess_function 
w(gr gr py) 21560.0     -18.79       0.100000     term 1
w(gr py py)  69200.0     -18.79         0.10       term 2
w(gr gr alm)   20320         -5.08        0.17       term 3
w(gr alm alm)  2620.0        -5.08        0.09       term 4
w(py py alm)   230.0      0.     0.01               term 5
w(py alm alm) 3720.0    0.     0.06               term 6
w(gr py alm)  58825.        -23.87       0.265       term 7
w(gr py spss)  45424.     -18.7900     0.100000      term 8
w(gr alm spss)  11470.0     -18.7900     0.130000     term 9
w(py alm spss) 1975.00  0.     0.035000             term 10
end_excess_function 

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model               
                      --------------------------------------------------------
begin_model                
                                  Grossular-pyrope-almandine-spessartine garnet

                                  Ganguly, Cheng & Tirrone (1996) Contrib Mineral Petrol 126:137-151

                                  The expansion of the Cheng & Ganguly (1994) GCA 58:3763-3767
                                  model to the Perple_X excess function is in Maple file 
                                  garnet_jiba_96.mws

                                  JADC Nov 23, 2010.
Gt(GCT)
abbreviation Gt
full_name    garnet
                              
2                          | model type: simplicial composition space

4                          | endmembers
gr       
py       
alm               
spss   

  0  0  0  0               | endmember flags

  0.0  1. 0.1 0            | imod = 0 -> cartesian subdivision
  0.0  1. 0.1 0            | imod = 0 -> cartesian subdivision
  0.0  1. 0.1 0            | imod = 0 -> cartesian subdivision

begin_excess_function
w(gr py )         47191.395  -17.34  .105
w(gr alm)         11468.955   -5.07  .045
w(alm spss)        1616.925    0.    .075
w(gr spss)        1616.925    0.    .075
w(py alm)          4217.895    0.    .105
w(py spss)        36248.895  -23.01  .105

w(gr gr py )     -17689.569    0.    .069
w(py py gr)       17689.569    0.   -.069 
w(gr gr alm)       8849.955    0.    .045 
w(alm alm gr)     -8849.955    0.   -.045 
w(py py alm)      -2132.895    0.   -.105
w(alm alm py)      2132.895    0.    .105

                                  | these could be deleted:

w(py py spss)     .15e-1       0.   -.015 
w(spss spss py)  -.15e-1       0.    .015
w(alm alm spss)   .45e-1       0.   -.045 
w(spss spss alm) -.45e-1       0.    .045 
w(gr gr spss)     .45e-1       0.   -.045 
w(spss spss gr)  -.45e-1       0.    .045 
end_excess_function

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model    
                      --------------------------------------------------------
begin_model                
                                      hp '98 quaternary garnet model
Gt(HP) 
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space
4                                     number of endmembers 
spss     alm      py       gr         endmember names 

  1  0  0  0                        | endmember flags

0. 0.2  0.1 0              | imod = 1 -> asymmetric transform subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
                           | NOTE restricted subdivision range on Mn (Species 1)!

begin_excess_function
w(py gr) 33000. 0. 0.  
w(alm py)  2500.  0. 0.               | hp '98 give 2.4 kJ
w(py spss) 4500.  0. 0.  
w(alm spss)  240.   0. 0.
end_excess_function  

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model               
                      --------------------------------------------------------
begin_model
                             Mg-Fe-Ca-Al-Fe3 Garnet
                             Hybrid Holland & Powell + Engi & Wersin
                             The Engi & Wersin terms for the excess energy 
                             are suspect and should probably be set to zero.
Gt(EWHP)
abbreviation Gt
full_name    garnet

7                              | model type: reciprocal
2                              | 2 chemical site model
3 2                            | 3 endmembers mix on site 1, 2 endmembers mix on site 2
gr   alm  py   
andr FA_d MA_d      

2                              | 2 dependent endmembers 
MA_d = -1 gr +  1 py  + 1 andr 
FA_d = -1 gr +  1 alm + 1 andr

0  0  0 0 0 0                  | endmember flags   0 include it   1 drop it            
0. 1. .1 0                     | range and resolution for XCa on A
0. 1. .1 0                     | range and resolution for XFe on A

0. 1. .1 0                     | range and resolution for XAl on B, imod = 0 -> cartesian

begin_excess_function 
w(py gr) 33d3 0. 0.
w(gr andr andr) 25812 0. -0.52  | eliminate this terms to make Fe3+ - Al exchange ideal
w(andr gr gr)  -93820 0. -0.11  | eliminate this terms to make Fe3+ - Al exchange ideal
end_excess_function 
2                                     2 site entropy model
3 3.                                  3 species, site multiplicity of 3
z(Ca) = 1 gr + 1 andr 
z(Mg) = 1 py 
2 2.                                  2 species, site multiplicity of 2
z(Al) = 1 gr + 1 alm + 1 py 
end_of_model                  
                              --------------------------------------------------------
begin_model 
                                  Ca-Fe2+-Mg-Al-Fe3+ Garnet model after White, Powell & Holland (JMG, 2007, 25:511-527)

                                  Model entered by Lucie Tajcmanova, May 11, 2007.

                                  w(alm py) value and reference corrected, Thomas Wagner, June 22, 2007.

                                  Interaction parameters (W terms) updated to the current THERMOCALC "preferred"
                                  values, Van Laar size parameters, added spessartine, Mark Caddick, Nov, 07.

                                  Deleted the unused kho_i interaction term, JADC, Nov 07.

                                  alphas and w's updated to current TC values, Lucie Tajcmanova, April 14, 2010. 

                                  NOTE: the more recent Smye et al. (2011) models [Mica(SGH),  Carp(SGH), and 
                                  Ctd(SGH)]are calibrated in terms of the Gt(WPPH) model for garnet. JADC, Oct 27, 2011.

                                                      X       Y 
                                                     _____________

                                      Mutliplicity    3       2     
                                                     _____________

                          Dependent:   fkho_i        Fe      Fe3+      
                          Dependent:   kho_i         Mg      Fe3+
                          Dependent:   fmn_i         Mn      Fe3+
                                       andr          Ca      Fe3+
   
                                       spss          Mn      Al
                                       alm           Fe      Al     
                                       py            Mg      Al     
                                       gr            Ca      Al          
                                                      ____________ 
Gt(WPH) 
abbreviation Gt
full_name    garnet

7                            | model type: simplicial composition space
2                            | the number of independent subcompositions, reciprocal solution if > 1.
4  2                         | 4 species on site 1, 2 species on site 2. 
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mn-Mg-Fe-Ca and the species that mix on 
                             | site 2 are Al-Fe3+.                                                                          

          
spss   alm      py     gr    | endmember names 
fmn_i  fkho_i   kho_i  andr

3                                 | number of dependent endmembers 

fmn_i = 1 andr + 1 spss -1 gr
fkho_i = 1 andr + 1 alm -1 gr    
kho_i = 1 andr + 1 py -1 gr  

0  0  0  0  0  0  0  0            | endmember flags

0. .2   0.1 0                     | imod = 0 -> cartesian subdivision (xmn) on X
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xfe) on X
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xmg) on X

0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision x(fe3+) on Y

begin_excess_function
                                  | commented values are from White et al. (2007):
w(alm gr) 10000. 0. 0.            | w(alm gr)    15000.  0. 0.
w(py gr) 45000. 0. 0.             | w(py gr)     33000.  0. 0.   
w(alm py)  2500.  0. 0.           | w(alm py)     2500.  0. 0.       
w(py andr) 90000.  0. 0.          | w(py andr)  160000.  0. 0. 
w(alm andr)  75000.  0. 0.        | w(alm andr) 135000.  0. 0.   
end_excess_function  

2                                     |2 site entropy model

4 3.                                  |4 species, site multiplicity 3
z(x,mn) = 1 spss 
z(x,fe) = 1 alm 
z(x,Mg) = 1 py 

2 2.                                  |2 species, site multiplicity 2
z(y,al) = 1 spss + 1 alm + 1 py + 1 gr

begin_van_laar_sizes     
                                  | commented values are from White et al. (2007):        
alpha(py)     1    0.0    0.0                      
alpha(alm)    1    0.0    0.0                      
alpha(spss)   1    0.0    0.0
alpha(gr)     3    0.0    0.0 | 9
alpha(andr)   3    0.0    0.0 | 9
end_van_laar_sizes

end_of_model      
                      --------------------------------------------------------
begin_model                
                                  berman and brown 1984, cao-al2o3-sio2 melt
                                  model. reformulated as macroscopic Aug 21, 2007.
casmelt
abbreviation Melt
full_name    liquid

2                          | model type: macroscopic
3                          | 3 species 
SIO2     AL2O3    CAO      | endmember names 
  0  0  0                  | endmember flags
0. 1. 0.1 0                | cartesian
0. 1. 0.1 0          

begin_excess_function
w(SIO2 AL2O3 AL2O3 AL2O3)  63617.2     -23.7400  0. term 1
w(SIO2 SIO2 AL2O3 AL2O3)  0.164266d7 -763.870  0. term 2
w(SIO2 SIO2 SIO2 AL2O3)   -106635.      28.1300  0. term 3
w(SIO2 CAO CAO CAO)       -898693.      240.770  0. term 4
w(SIO2 SIO2 CAO CAO)      -350208.     -48.6200  0. term 5
w(SIO2 SIO2 SIO2 CAO)     -14081.8     -35.4900  0. term 6
w(AL2O3 CAO CAO CAO)      -455634.      2.47000  0. term 7
w(AL2O3 AL2O3 CAO CAO)    -725166.      255.390  0. term 8
w(AL2O3 AL2O3 AL2O3 CAO)  -240215.      26.7000  0. term 9
w(SIO2 SIO2 AL2O3 CAO)    -.284791d7  1046.35  0. term 10
w(SIO2 AL2O3 AL2O3 CAO)   -.214904d7  641.840  0. term 11
w(SIO2 AL2O3 CAO CAO)       209109.     -313.360  0. term 12
end_excess_function

1                                     1 site molecular entropy model

3 1.                                  3 species, site multiplicity 1
z(SIO2) = 1 SIO2          
z(AL2O3) = 1 AL2O3

end_of_model
                      --------------------------------------------------------
begin_model

A-phase                               ideal phase A
abbreviation phA
full_name    alphabet-phase

2                          | macroscopic
2
phA      fphA      
  0  0                                endmember flags
 0.  1.  0.1  0            | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal 

1                          | 1 site entropy model 
2 7.                       | 2 species, 7 sites pfu
z(mg) = 1 phA

end_of_model
                      --------------------------------------------------------
begin_model

Chum
abbreviation Chu
full_name    clinohumite

2                          | macroscopic
2
chum     fchum     
  0  0                                endmember flags
 0.  1.  0.1   0           | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal 

1                          | 1 site entropy model 
2 9.                       | 2 species, 9 sites pfu
z(mg) = 1 chum

end_of_model
                      --------------------------------------------------------
begin_model

B
abbreviation Br
full_name    brucite

2                          | macroscopic

2                                isp(1)
br       fbr      
  0  0                                endmember flags
 0.  1. 0.1  0             | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal 

1                          | 1 site entropy model 
2 1.                       | 2 species, 1 site pfu
z(mg) = 1 br

end_of_model                      
                      --------------------------------------------------------
begin_model                
                             Ternary feldspars (Holland and Powell, 2003, CMP, p.492-501) 
                             Van Laar Versions. 

                             USE THIS MODEL WITH EXTREME CAUTION (AND DON'T USE THE 
                             MODEL IF YOU DON'T UNDERSTAND THE IMPLICATIONS OF THIS
                             WARNING):

                             The model has the following difficulties for the Ab-An
                             binary and they undoubtedly cause problems in the ternary:

                             1) The I1/C1 models are not (and cannot be used to) predict
                                the stable structural state, the I1 model is always more
                                stable than the C1; thus the "stable" state is supposed
                                to be chosen by assuming the C1 model is valid at 
                                X(Ab) > 1 - (0.12+0.00038*TK).

                             2) The model assigns a large positive interaction term for
                                I1 plagioclase, as a result the I1 model gives a solvus
                                that closes at ~ 910 K. At temperatures below the critical
                                temperature plagioclases in vicinity of the prescribed
                                I1/C1 transition (as defined in 1, above), that in principle 
                                is supposed to be stable, is metastable with respect to 
                                a mixture of I1 and C1 plagioclase.

                             JADC 1/04
                             
                             MORE NOTES:  

                             * These models use the asymmetric formalism as outlined by H & P.

                             * They are complicated by the C1/I1 transition across the plag. join.
                                           
                             * Model parameters for the C1 field (Ab-rich plag. component)
                                 Wabsan = 25100 - 10.8*T + 0.343*P
                                 Wansan = 40000 
                                 Wanab  = 3100
                                 a-san  = 1.0
                                 a-ab   = 0.643
                                 a-an   = 1.0
                                 Ian    = 7030 - 4.66*T

                             * Model parameters for the I1 field (An-rich plag. component)
                                 Wabsan = 25100 - 10.8*T + 0.343*P
                                 Wansan = 40000 
                                 Wanab  = 15000
                                 a-san  = 1.0
                                 a-ab   = 0.643
                                 a-an   = 1.0
                                 Iab    = 570 - 4.12*T

                             D.Tinkham, 12-18-2003

                             reformatted and compositional ranges chosen given the following
                             considerations (JADC 12/03):
                                
                             * On the Ab-An join C1 is not stable below ~ 800 K,
                               and has X(An) < 0.4 and I1 is not stable for 
                               X(An) < 0.6 

                             * On the Ab-Or join C1 is always stable, with critical
                               composition X(Ab) ~ 0.34
                        
                             * The above considerations suggest the I1 model could be effectively represented
                               by a binary An-Ab (with X(Ab)>0.2) model; and the C1 model
                               should be split into a model with X(ab) < 0.33 with 
                               extensive ternary solution; and a model with X(Ab) > 0.33
                               with very limited ternary solution. Assuming these relationships
                               are valid the ternary feldspar phase relations are well 
                               represented by three solutions models. When these conditions are
                               not met, the HP feldpsar models should not be used. 


Pl(I1,HP)                    | solution name.
abbreviation Pl
full_name    ternary-feldspar

2                            | model type
3                            | number of endmembers

san    
abh     
an

 0  0  0                     | endmember flags

 0. 1.  0.1  0              | compositional range and resolution of san
 0. 1.  0.1  0              | compositional range and resolution of abh

begin_excess_function 
w(san abh)         25100.  -10.8  0.343
w(san an)          40000.    0.   0. 
w(abh an)          15000.    0.   0. 
end_excess_function  

1                            | 1 site entropy model 
3 1.                         | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san            | van laar volumes follow:

                             
begin_van_laar_sizes                        
alpha(san)     1.0    0.0    0.0                      
alpha(abh)     0.643  0.0    0.0                      
alpha(an)      1.0    0.0    0.0
end_van_laar_sizes

begin_dqf_corrections
dqf(abh) 570 -4.12 0
end_dqf_corrections

end_of_model                
                      --------------------------------------------------------
begin_model                  
                             | See WARNING above for HP ASF Ternary Feldspar

Fsp(C1)
abbreviation Fsp
full_name    ternary-feldspar

2                            | model type
3                            | number of endmembers

an 
san
abh

 0  0  0                     | endmember flags

0.    1.0  0.1   0           | compositional range and resolution of an
0.    1.0  0.1   0           | compositional range and resolution of san 

begin_excess_function 
w(san abh)  =   25100.  -10.8 * TK +  0.343 * Pb
w(san an)   =   40000.   
w(abh an)   =    3100.    
end_excess_function  

1                            | 1 site entropy model 
3 1.                         | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san            
                           
begin_van_laar_sizes                        
alpha(san)  =   1.0                        
alpha(abh)  =   0.643                      
alpha(an)   =   1.0   
end_van_laar_sizes

begin_dqf_corrections
dqf(an) = 7030 - 4.66 * T_K
end_dqf_corrections

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model                
                                      HP '03 CMP van Laar
                                      Calcite-Magnesite with Dolomite
                                      compound formation.
oCcM(HP)
abbreviation Do
full_name    carbonate

2                                     model type 
3                                     number of endmembers
cc       mag      odo
  0  0  0                             endmember flags
0. 1. 0.1  0                        | range and increments on X(cc)
0. 1. 0.1  0                        | range and increments on X(mag)

begin_excess_function             
w(cc mag) 35000. 0. 0. 
w(cc odo) 10250. 0. 0. 
w(mag odo) 14950. 0. 0.
end_excess_function  

2                                     2 site (m1  m2) entropy model 

2 0.5                                 2 species on m2, mutiplicity = 1/2
z(m2,Ca) = 1 cc + 1 odo 

2 0.5                                 2 species on m1, mult. = 1/2
z(m1,Ca) = 1 cc                 

begin_van_laar_sizes                        
alpha(cc)     0.5 0.000546 0.0                      
alpha(mag)    1.0 0.       0.0                     
alpha(odo)    0.7 0.       0.0 
end_van_laar_sizes

end_of_model               
                      --------------------------------------------------------
begin_model 
                            Tourmaline model with no Li formulated as a hexary
                            solution.

                            NOTE: ffoit, mfoit, drav and shrl are linearly dependent

                                                             1       2          3      
                                                             x       y          z
                                                          _________________________
    
                                             Mutliplicity    1       3          6 
                                                          _________________________

                            Species:         1 drav          Na      Mg3        Al6   
                                             2 uvit          Ca      Mg3        MgAl5
                                             3 mfoit         vac     Mg2Al      Al6
                                             4 shrl          Na      Fe3        Al6
                                             5 olen          Na      Al3        Al6  
                                             6 ffoit         vac     Fe2Al      Al6
                                                           ________________________

                                         Vincent van Hinsberg <v.j.vanHinsberg@bristol.ac.uk> 

Tour(V)                      | solution name.
abbreviation Tour
full_name    tourmaline

2                            | model type: simplicial composition space
6                            | 6 species mix on the chemical mixing site

drav   uvit   mfoit          | endmember names
shrl   olen   ffoit          | 
0 0 0 0 0 0                  | endmember flags, indicate if the endmember is part of the solution.

0. 1. .1  0                 | range drav
0. .2 .1  0                 | restricted range uvit
0. 1. .1  0                 | range mfoit
0. 1. .1  0                 | range shrl
0. 1. .1  0                 | range olen

ideal

3                            | configurational entropy: 3 sites

3 1.                         | 3 species on X, 1 site per formula unit.
z(na,x) = 1 drav  + 1 shrl + 1 olen   
z(ca,x) = 1 uvit           


3 3.                         | 3 species on Y, 3 sites per formula unit.
z(mg,y) = 1 drav + 1 uvit + 2/3 mfoit
z(al,y) = 1/3 mfoit + 1 olen + 1/3 ffoit 
     

2 6.                         | 2 species on Z, 6 site per formula unit.
z(al,z) = 1 drav + 5/6 uvit + 1 mfoit + 1 shrl + 1 olen + 1 ffoit 

end_of_model 
                      --------------------------------------------------------
begin_model
                                      dolomite order disorder model

                                                         Site:
                                                       1      2      
                                                       M1     M2
                                                     ____________

                                      Mutliplicity     1     1      
                                                     ____________

                                      1 adol           Ca     Mg   
                            Species:  2 bdol          CaMg   CaMg  
                                                      ___________
DoDo    
abbreviation Do
full_name    carbonate

2                                     model type simplicial composition space
2                                     number of endmembers
adol
bdol   
  0  0                              endmember flags
0. 1. 0.1   0                     | range and increments on X(cc)

ideal 

2                                     2 site (m1  m2) entropy model 

2 0.5                                 2 species on m2, mutiplicity = 1/2
z(m2,Ca) = 1/2 bdol

2 0.5                                 2 species on m1, mult. = 1/2
z(m1,Mg) = 1/2 bdol                 

end_of_model

begin_model                
                                      magnesio-wuestite solution, after fabrichnaya '99

Wus(fab)
abbreviation Wus
full_name    wuestite
                                                                               
2                                     model type: simplicial composition space
2                                     2 endmembers
per       wus            
  0  0                           | endmember flags
0.0 1.0  0.1 0                   | subdivision range, imod = 0 -> cartesian subdivision
  

begin_excess_function
W(per wus)  24d3 -0. 0.          | was 24d3   
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      akimotoite (ilmenite-structure) solution, after fabrichnaya '99

Aki(fab)
abbreviation Aki
full_name    ilmenite

2                                     model type: simplicial composition space
3                                     number of endmembers
cor   aki   faki           
  1  0  0                           | endmember flags
0. 1.  .1  0                        | subdivision range, imod = 0 -> cartesian subdivision
0. 1.  .1  0                        | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(aki cor)  60000.0 0. 0. 
W(faki cor) 60000.0 0. 0.
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | perovskite solution, after fabrichnaya '99
Pv(fab)
abbreviation Pv
full_name    perovskite
                                                                               
2                                     model type: simplicial composition space

3                                    3 endmembers
aperov   perov   fperov            
  0  0  0                           | endmember flags

0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision
0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
W(perov aperov)   49000.0 0. 0. 
W(fperov aperov)  49000.0 0. 0.              
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 perov
z(fe) = 1 fperov

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 aperov

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | perovskite solution, after oganov. the fppv and 
                           | appv endmembers are henry's law ss. 
Ppv(og)
abbreviation Ppv
full_name    postperovskite

2                                     model type: simplicial composition space
3                                     number of endmembers
appv  ppv   fppv            
  0  0  0                           | endmember flags

0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

ideal 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 ppv
z(fe) = 1 fppv

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 appv

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      olivine solution
O(stx) 
abbreviation Ol
full_name    olivine
                                                                              
2                                     model type: simplicial composition space
2                                     2 endmembers
fo       fa            
  0  0                     | endmember flags
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 14400.0 0. 0.     | was 7200.
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model               
                      --------------------------------------------------------
begin_model               

Wad(stx)
abbreviation Wad
full_name    wadleysite

2                          | model type: simplicial composition space
2                          | 2 endmembers
wad       fwad            
  0  0                     | endmember flags
0. 1. .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) 3000. 0. 0.            | was 1500.
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model               
                      --------------------------------------------------------
begin_model                

Ring(stx)
abbreviation Ring
full_name    ringwoodite
                                                                               
2                                     model type: simplicial composition space

2                                     2 endmembers
ring       fring            
  0  0                     | endmember flags

0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 7800.  0. 0.          | was 3900.
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Spinel solution, fixed order! 
Sp(stx)
abbreviation Sp
full_name    spinel
                    
2                                     model type: simplicial composition space

2                                     2 endmembers
sp       herc            
  0  0                     | endmember flags
0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 28800.  0. 0.            | was 7200.
end_excess_function 

2                                     2 site entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears the B site should be split into two M-sites
                                      for the 05 paper.
Gt(stx)
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space
4                                     4 endmembers
gr   alm  maj  py             
 0  0  0  0                         | endmember flags
0. 1. .1   0               | range and resolution for X(gr), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(alm), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(py), imod = 0 -> cartesian subdivision

ideal

3                                     3 site entropy model

3 3.                                  3 species, A site multiplicity = 3.
z(A,ca) = 1 gr
z(A,fe) = 1 alm

2 1.                                  2 species, M1 site multiplicity = 1.
z(M1,Mg) = 1 maj 

2 1.                                  2 species, M2 site multiplicity = 1.
z(M1,Si) = 1 maj 

end_of_model               
                      --------------------------------------------------------
begin_model                

C2/c(stx)
abbreviation C2/c
full_name    C2/c-pyroxene
 
2                                     model type: simplicial composition space
2                                     2 endmembers
c2/c      fc2/c            
  0  0                     | endmember flags
0. 1. .1  0                | subdivision range, imod = 0 -> cartesian subdivision
ideal

1                                     1 site entropy model

2 4.                                  2 species, site multiplicity = 4.
z(mg) = 1 c2/c

end_of_model              
                      --------------------------------------------------------
begin_model                
                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears disorder is assumed across all 4 M sites,
                                      for the 05-07 papers.
Opx(stx)        
abbreviation Opx
full_name    orthopyroxene
 
2                                     model type: simplicial composition space
3                                     3 endmembers
en   fs   ts        
 0  0  0                            | endmember flags
0. 1. .1  0                         | range and resolution for X(en)
0. 1. .1  0                         | range and resolution for X(fs)

ideal

1                                     1 site entropy model

3 4.                                  3 species, M site multiplicity = 4.
z(M,al) = 1/2 ts
z(M,fe) = 1 fs
end_of_model                        
                      --------------------------------------------------------
begin_model                
                                      Cpx solution, entropy model not specified
                                      by stixrude, additionally there is some 
                                      ambiguity about his excess term, here i
                                      assume its Gex = X(M1,Ca)*X(M1,M)*W.
Cpx(stx)
abbreviation Cpx
full_name    clinopyroxene
  
2                                     model type: simplicial composition space
3                                     3 endmembers
di  hed  mdi        
 0  0  0                            | endmember flags

0. 1. .1  0                         | range and resolution for X(di)
0. 1. .1  0                         | range and resolution for X(hed)

begin_excess_function
W(mdi di)   52000.0 0. 0.            
W(mdi hed)  52000.0 0. 0.           
end_excess_function 

2                                     2 site entropy model

2 2.                                  2 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi

2 2.                                  2 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed

end_of_model   
                      --------------------------------------------------------
begin_model                
                                      Stixrude pers com (10/07) indicates
                                      Gex = X(M1,Ca)*X(M1,Mg)*W.
                                      JADC 12/07

                                      Corrected excess function to include 
                                      W(mdi hed), 9/08, JADC.
Cpx(stx7)
abbreviation Cpx
full_name    clinopyroxene

2                                     model type: simplicial composition space
3                                     3 endmembers
di  hed  mdi        
 0  0  0                            | endmember flags

0. 1. .1  0                         | range and resolution for X(di)
0. 1. .1  0                         | range and resolution for X(hed)

begin_excess_function
W(mdi di)    52600.0 0. 0.
W(mdi hed)   52600.0 0. 0.           
end_excess_function 

2                                     2 site entropy model

2 2.                                  2 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi

2 2.                                  2 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed

end_of_model                        
                              --------------------------------------------------------
begin_model 
                                      HP '96 Am Min, Non-ideal quasi ordered omphacite,
                                      i.e., compound formation only occurs for omph.
                                      The value of wdh appears discrepant 
                                      with the value in HP '98.

                                      The interaction parameters here are from the
                                      Omphacite model distributed with the '00 
                                      Thermocalc program. JADC 2/03

                                      Added ideal acm+cats, JADC, 1/06. 

                                      CORRECTIONS:

                                      enthalpy of ordering corrected from -16 kJ to
                                      -3.5 kJ. JADC, Aug 20, 2003.

                                      Modified for non-ideal cats after 
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17. 
                                      T. Wagner 2/18/06. 


                                                         Site:
                                                       1      2      3      4    5
                                                      M2a    M2b    M1a    M1b   T1   
                                                     ____________________________________

                                      Mutliplicity    1/2    1/2    1/2    1/2    1
                                                     ____________________________________

                                      1 Diopside      Ca     Ca     Mg     Mg    Si
                            Species:  2 Jadeite       Na     Na     Al     Al    Si
                                      3 Hedenbergit   Ca     Ca     Fe2+   Fe2+  Si
                                      4 Ca-Tschermaks Ca     Ca     Al     Al    Al
                                      5 Acmite        Na     Na     Fe3+   Fe3+  Si
                                                      ___________________________________

                        Ordered Cpd:  6 Omphacite     Na     Ca     Al     Mg    Si

Omph(HP)     
abbreviation Cpx
full_name    clinopyroxene

6                                     model type: o/d, simplicial composition space 
5                                     number of disordered endmembers

di       
jd  
cats  
acm   
hed

1                             | ordered species definition

omph = 1/2 jd + 1/2 di enthalpy_of_ordering = -35d2 

0  0  0  0  0                 | endmember flags

0. 1. 0.1  0                  | range and resolution of X(di)
0. 1. 0.1  0                  | range and resolution of X(jd)
0. 1. 0.1  0                  | range and resolution of X(cats) 
0. 1. 0.1  0                  | range and resolution of X(acm) 

begin_excess_function   
w(di jd)    26000. 0. 0.  
w(omph jd)  16000. 0. 0.  
w(omph di)  16000. 0. 0. 
w(omph hed) 17000. 0. 0. 
w(hed jd)   24000. 0. 0. 
w(di hed)   4000.  0. 0.       | hp 98 give 2.5 kJ
w(cats di)    7d3 0. 0.
w(cats hed)   4d3 0. 0.
end_excess_function

5                                   | 4 site entropy model (m1a, m1b, m2b, m2a)

2 0.5                               | 2 species on m2a, mutiplicity = 1/2

                                    | WARNING! fractions can only be used in the site
                                    | fraction definitions, do not use fractions to specify
                                    | site multiplicities in the above line.


z(m2a,ca) = 1 di + 1 hed + 1 cats

2 0.5                                 2 species on m2b, mult. = 1/2
z(m2a,na) = 1 jd + 1 acm

4 0.5                                 4 species on m1a, mult = 1/2
z(m1a,mg) = 1 di 
z(m1a,fe2+) = 1 hed
z(m1a,fe3+) = 1 acm

4 0.5                                 4 species on m1b, mult = 1/2
z(m1b,al) = 1 jd + 1 cats
z(m1a,fe2+) = 1 hed
z(m1a,fe3+) = 1 acm

2 1.0                                 2 species on T1 (perhaps Al should be disordered over T1-T2?)
z(t1,al)  = 1 cats

end_of_model               
                      --------------------------------------------------------
begin_model             
                                      HP '96 Am Min, Non-ideal disordered cpx
                                      Note HP '98 give Wdh = 2500 j/mol.

                                      Configurational entropy model changed
                                      (corrected) from 1 site two 2 site model
                                      and model reformatted. D. Tinkham, 1/04.

                                      Added ideal acm+cats, JADC, 1/06. 

                                      Modified for non-ideal cats after 
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17. 
                                      T. Wagner 2/18/06. 

                                      Added ideal Cr, PGP Workshop 4/12/06.
                                      (folk.uio.no/ninasim/Cr_results.html)

                                      Corrected    z(m1,al) = 1 jd
                                      to   z(m1,al) = 1 jd + 1 cats
                                      M. Caddick, 5/8/08.
Cpx(HP)
abbreviation Cpx
full_name    clinopyroxene

2                                   | model type
7                                   | number of endmembers
esn
ccrts 
cats 
jd
acm
hed          
di

0 0  0  0  0  0  0              | endmember flags

                             | NOTE RESTRICTED RANGES:
0. 1.  .1  0                 | range and resolution of X(esn): imod = 1 -> assymmetric stretching
0. 1.  .1  0                 | range and resolution of X(ccrts): imod = 1 -> assymmetric stretching
0. 1.  .1  0                 | range and resolution of X(cats): imod = 1 -> assymmetric stretching 
0. 1.  .1  0                 | range and resolution of X(jd)
0. 1.  .1  0                 | range and resolution of X(acm): imod = 1 -> assymmetric stretching
0. 1.  .1  0                 | range and resolution of X(hed)

begin_excess_function
w(jd di)     26d3 0. 0.
w(jd hed)    24d3 0. 0.
w(di hed)     4d3 0. 0.
w(cats di)    7d3 0. 0.
w(cats hed)   4d3 0. 0.
end_excess_function

3                             | 3 site (M1, M2, T1) configurational entropy model

5 1.                          | 5 species on M1, 1 site per formula unit.
z(m1,fe) = 1 hed
z(m1,al) = 1 jd + 1 cats
z(m1,fe3+) = 1 acm + 1 esn
z(m1,cr) = 1 ccrts

2 1.                          | 2 species on M2, 1 site per formula unit.
z(m2,na) = 1 jd + 1 acm

2 1.                          | 2 species on T1, ccrts not counted intentionally.
z(t1,al) = 1 cats + 1 esn

reach_increment 0

end_of_model
                           --------------------------------------------------------
begin_model  
                                      Chromite/Spinel, Klemme et al. 2010.
                                      
                                      To use this model, the fcrm endmember must be
                                      excluded from thermodynamic stability calculations.
                                               
                                                      A       B     
                                                     _____________

                                      Mutliplicity    1       2
                                                     _____________

                                      1 sp            Mg      Al       
                            Species:  2 herc          Fe      Al    
                                      3 mcrm          Mg      Cr         
                                      4 fcrm_d        Fe      Cr 
                                      5 mft           Fe3+    MgFe3+
                                      6 mt            Fe3+    FeFe3+

                                      Ad-hoc incorporation of Fe3+ made here by assuming
                                      Mt remains inverse and the associated divalent Mg
                                      and Fe is disordered on B. An alternative model would
                                      be to assume the divalent B cation is associated with
                                      Fe3+. Model lacks excess function for mt-crm, which 
                                      could be estimated if the solvus is known. 

                                                                    JADC, 3/29/13

CrSp                       | solution name.
abbreviation Sp
full_name    spinel

7                          | model type: Reciprocal 
2                          | 2 independent subcompositions
2 3                        | 2 dimensions on each site

mcrm     fcrm_d  
sp       herc 
mft      mt               
                   
1                          | 1 dependent endmember

fcrm_d = 1 herc + 1 mcrm - 1 sp

0 0 0 0 0 0                | endmember flags, indicate if the endmember is part of the solution.

                           | subdivision model for (binary) site 1 (A):
0. 1. .1  0                | range and resolution of X(Mg): imod = 0 -> cartesian 

                           | subdivision model for (binary) site 2 (B)
0. 1. .1  0                | range and resolution of X(Cr): imod = 0 -> cartesion
0. 1. .1  0

begin_excess_function                
w(sp herc)      7d2 0 0 
w(mcrm sp sp)   4208. 1.501  .321e-1 | from Oka et al CMP '84
w(mcrm sp)      19686 0.463 0.0183   | 19686 + 0.0183*P + 0.463*T;
w(mcrm herc)    20d3  0. 0.          | guessed solvus
end_excess_function 

2                          | 2 site (a, b) configurational entropy model

3 1.                       | 3 species on a, 1 site per formula unit.

z(a,fe)   = 1 herc
z(a,mg) =   1 sp + 1 mcrm 
  
5 2.                       | 5 species on b, 2 site per formula unit.
z(b,cr)   = 1 mcrm
z(b,al)   = 1 sp + 1 herc
z(b,fe3+) = 1/2 mt + 1/2 mft
z(b,mg)   = 1/2 mft 

reach_increment 3

end_of_model 
                  --------------------------------------------------------
begin_model               
                               Eskolaite from Chaterjee et al '82 Am Min.
                               added at PGP Workshop on 4/12/06
                               (folk.uio.no/ninasim/Cr_results.html).

                               notes:

                               w(esk cor cor) corrected to w(esk esk cor). this error was noted by 
                               J. A. Padron-Navarta, 3/30/12, but left uncorrected until 11/24/2015;
                               the thermodynamic data in cr_hp02ver.dat as used by Klemme et al. 2009 and
                               Ziberna et al. 2013; to reproduce the calculations in those papers the 
                               error must be reinstated. 

                               added ideal hem. JADC, 3/29/13

Eskol(C)
abbreviation Esk
full_name    ilmenite

2                          | model type: simplicial composition space
3                          | number of endmembers 
esk cor hem                | endmember names 

0  0  0                    | endmember flags

0. 1. .1  0                | X(Cr), cartesian
0. 1. .1  0                | X(Al), cartesian  

begin_excess_function
w(esk esk cor)   -5755. .385 -.38e-1       | Chattejee et al '82 Am Min
w(esk cor)       37484  4.334  0.0386      | Chattejee et al '82 Am Min
end_excess_function  

1                                     1 site entropy model

3 2.                                  2 species, site multiplicity 2
z(Al) = 1 cor
z(Cr) = 1 esk

end_of_model              

                      --------------------------------------------------------
begin_model                
                                      magnesio-wuestite solution, stixrude EPSL 07 also xu et al EPSL 08
Wus(stx7)  
abbreviation Wus
full_name    wuestite

2                                     model type: simplicial composition space
2                                     2 endmembers
per       wus            
  0  0                           | endmember flags
0.0 1.0  0.1 0                   | subdivision range, imod = 0 -> cartesian subdivision
  

begin_excess_function
W(per wus)  13d3 0. 0.            
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model                
                      --------------------------------------------------------
begin_model                
                                      akimotoite (ilmenite-structure) solution, stixrude EPSL 07
Aki(stx7)
abbreviation Aki
full_name    ilmenite

2                                     model type: simplicial composition space
3                                    3 endmembers
cor   aki   faki           
  1  0  0                           | endmember flags
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
                                 | Stixrude pers com (10/07) states 
                                 |     Gex = X(One_Site,Al)*X(One_Site,Mg)*W
                                 | JADC 12/07                                                  

W(aki cor)  66000.  0. 0. 
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | perovskite solution, stixrude epsl 07 also xu et al epsl 08
Pv(stx7)
abbreviation Pv
full_name    perovskite

2                                    model type: simplicial composition space
3                                    3 endmembers
aperov   perov   fperov            
  0  0  0                           | endmember flags

0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision
0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
                                 | Stixrude pers com (10/07) 
                                 |     Gex = X(Big_Site,Al)*X(Big_Site,Mg)*W
                                 | JADC 12/07
W(perov aperov)   12000 0. 0.            
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 perov
z(fe) = 1 fperov

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 aperov

end_of_model               
                      --------------------------------------------------------
begin_model                

O(stx7)
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space
2                                     2 endmembers
fo       fa            
  0  0                     | endmember flags
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 10.6d3 0 0. 0.    | was 5.3 kJ/molar site
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model               
                      --------------------------------------------------------
begin_model               

Wad(stx7) 
abbreviation Wad
full_name    wadleysite

2                          | model type: simplicial composition space
2                          | 2 endmembers
wad       fwad            
  0  0                     | endmember flags
0. 1. .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) 12.2d3 0. 0.            | 6.1 kJ/site
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model               
                      --------------------------------------------------------
begin_model 

Ring(stx7)
abbreviation Ring
full_name    ringwoodite

2                                     model type: simplicial composition space, macroscopic

2                                     2 endmembers
ring       fring            
  0  0                     | endmember flags

0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 7d3  0. 0.          | 3.5 kJ/site
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Spinel solution, fixed order! 
Sp(stx7)
abbreviation Sp
full_name    spinel

2                                     model type: simplicial composition space, macroscopic

2                                     2 endmembers
sp       herc            
  0  0                     | endmember flags
0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 20d3  0. 0.            | was 5 kJ/site
end_excess_function 

2                                     2 site entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model                             
                      --------------------------------------------------------
begin_model               
                      Spinel after White, RW, Powell, R & Clarke, GL (JMG, 2002)

                      This model has two fake sites, each with a mulitplicity of one.
                      Fe3+ Al and Ti mix on the fake A site, and Mg-Fe2+ mix on the fake B site

                      Replaces Sp(WPH), JADC Mar 5, 2009. 
                                              
                                                      A       B     
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 sp            Al      Mg        
                            Species:  2 herc          Al      Fe2+    
                                      3 usp           Ti      Fe2+         
                                      4 mt            Fe3+    Fe2+    

Sp(WPC)
abbreviation Sp
full_name    spinel

2                                 | model type: simplicial composition space

4                                 | 4 endmembers 
sp       
herc       
usp      
mt       

0  0  0  0                        | endmember flags

0. 1. .1 0                        | X(sp) subdivision range,   imod = 0 -> cartesian 
0. 1. .1 0                        | X(herc) subdivision range, imod = 1 -> assymmetric stretching
0. 1. .1 0                        | X(usp) subdivision range,  imod = 1 -> assymmetric stretching
             
begin_excess_function 
W(herc mt)    18.5d3 0  0
W(herc usp)   27d3   0  0
W(sp mt)      40d3   0  0
W(sp usp)     30d3   0  0 
end_excess_function 

2                                     2 site entropy model, see comments above

3 1.                                  3 species, site multiplicity of 1
z(a,Fe3+) =  1 mt
z(a,Ti)   =  1 usp

2 1.                                  2 species, site multiplicity of 1
z(b,Mg)   =  1 sp

end_of_model  
                     --------------------------------------------------------
begin_model

                                      CPX in CMASCH marbles (di-en-cats),
                                      hence enstatite endmember added.

                            Entered by A Proyer, Aug 27, 2008.

                                      based on:
                                      HP '96 Am Min, Non-ideal disordered cpx
                                      Note HP '98 give Wdh = 2500 j/mol.

                                      Configurational entropy model changed
                                      (corrected) from 1 site two 2 site model
                                      and model reformatted. D. Tinkham, 1/04.

                                      Modified for non-ideal cats after 
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17. 
                                      T. Wagner 2/18/06. 
Cpx(m)
abbreviation Cpx
full_name    clinopyroxene

2                                   | model type sf.

3                                   | number of endmembers
en 
cats 
di

0  0  0                      | endmember flags

                             | NOTE RESTRICTED RANGES

0. 1.  .1  0                 | range and resolution of X(en): imod = 1 -> assymmetric stretching
0. 1.  .1  0                 | range and resolution of X(cats): imod = 1 -> assymmetric stretching 

begin_excess_function
w(en cats)   24d3 0. 0.
w(en di)     24d3 0. 0.
w(cats di)    7d3 0. 0.
end_excess_function

2                             | 2 site (M1, M2) configurational entropy model

2 1.                          | 2 species on M1, 1 site per formula unit.
z(m1,al) = 1 cats

2 1.                          | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en

begin_dqf_corrections
dqf(en) 8100 -4.5 0 
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model                
                            Olivine in marble; from TC-solution model: Ca only on M2
                            Entered by A Proyer, Aug 27, 2008.
Ol(m)
abbreviation Ol
full_name    olivine

2                          | model type: simplicial composition space
2                          | 2 endmembers 
fo       mont    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(fo mont) 24000. 0. 0. 
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity of 1
z(Ca) = 1 mont

end_of_model               
                      --------------------------------------------------------
begin_model               

Pl(stx8)                   | Xu et al. EPSL 08, to be used with the stx08ver.dat data generated from that paper. 
abbreviation Pl
full_name    binary-feldspar

2                          | model type: simplicial composition space 
2                          | # of endmembers  
ab       an      

  0  0                     | endmember flags

0. 1. .1  0                | imod = 0 -> cartesian subdivision

begin_excess_function 
w(an ab) 26d3 0. 0. 
end_excess_function 

1                          | 1 site molecular model:
2 1.                       
z(Na) = 1 ab

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Spinel solution, fixed order! 
Sp(stx8)                    
abbreviation Sp
full_name    spinel

2                                     model type: simplicial composition space
2                                     2 endmembers
sp       herc            
  0  0                     | endmember flags
0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 29.6d3  0. 0.            
end_excess_function 

2                                     2 site configurational entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model                             

begin_model                
                      --------------------------------------------------------
Po(HP)                    
abbreviation Po
full_name    pyrrhotite 

2                                     model type: simplicial composition space

2                                     2 endmembers
trov trot          
  0  0                     | endmember flags
0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(trov trot) = -3190
end_excess_function 

1                                     1 site configurational entropy model

2 1.                                  2 species (Fe, V), site multiplicity = 1.
z(M2,V) = 1/8 trov

end_of_model        
                      --------------------------------------------------------
begin_model

O(stx8)                                                                               
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space

2                                     2 endmembers
fo       fa            
  0  0                     | endmember flags
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 9d3 0 0. 0.   
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model               
                      --------------------------------------------------------
begin_model

Wad(stx8)           
abbreviation Wad
full_name    wadleysite

2                          | model type: simplicial composition space

2                          | 2 endmembers
wad       fwad            
  0  0                     | endmember flags
0. 1. .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) -8.6d3 0. 0.     
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model               
                      --------------------------------------------------------
begin_model

Ring(stx8)
abbreviation Ring
full_name    ringwoodite

2                                     model type: simplicial composition space

2                                     2 endmembers
ring       fring            
  0  0                     | endmember flags

0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 8d3  0. 0.          
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model               
                      --------------------------------------------------------
begin_model
                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears disorder that in the '08 papers the M sites
                                      are now split.
Opx(stx8)
abbreviation Opx
full_name    orthopyroxene
 
2                                     model type: simplicial composition space
4                                     4 endmembers
odi  en   fs   ts        
0  0  0  0                            | endmember flags
0. 1. .1  0                         | range and resolution for X(odi)
0. 1. .1  0                         | range and resolution for X(en)
0. 1. .1  0                         | range and resolution for X(fs)

begin_excess_function
W(odi ts) 43.8d3  0. 0.    
W(odi en) 43.8d3  0. 0.      
end_excess_function 

2                                    |2 site entropy model, Al on M2 is associated with Mg on M1 and 
                                     |Ca on M1 is associated with Mg on M2, so reduce M2 site model to
                                     |a two species model?

3 2.                                  3 species, M1 site multiplicity = 2.
z(M1,Ca) = 1 odi
z(M1,Fe) = 1 fs
3 2.                                  3 species, M2 site multiplicity = 2.
z(M2,Al) = 1 ts
z(M2,Fe) = 1 fs

end_of_model                        
                      --------------------------------------------------------
begin_model                

Cpx(stx8)
abbreviation Cpx
full_name    clinopyroxene

2                                     model type: simplicial composition space

5                                     # of endmembers
jd  di  hed  mdi cts       
0  0  0  0  0                         endmember flags

0. 1. .1  0                         | range and resolution for X(jd)
0. 1. .1  0                         | range and resolution for X(di)
0. 1. .1  0                         | range and resolution for X(hed)
0. 1. .1  0                         | range and resolution for X(mdi)

begin_excess_function
W(mdi di)    49d3  0. 0.            | Mg-Ca
W(mdi hed)   49d3  0. 0.
W(mdi cts)   49d3  0. 0.
W(jd  di)    486d2 0. 0.            | Na-Ca
W(jd  hed)   486d2 0. 0. 
W(jd  cts)   486d2 0. 0. 
end_excess_function 

2                                     2 site entropy model

3 2.                                  3 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi
z(M1,Na) = 1 jd

3 2.                                  3 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed
z(M2,Al) = 1 jd + 1 cts

end_of_model                        
                      --------------------------------------------------------
begin_model                
                                     akimotoite (ilmenite-structure) solution
Aki(stx8)
abbreviation Aki
full_name    ilmenite

2                                    model type: simplicial composition space

3                                    3 endmembers
cor   aki   faki           
  1  0  0                           | endmember flags
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function                                                
W(aki cor)  42000.  0. 0. 
W(faki cor)  52000.  0. 0. 
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Garnet solution, from Xu et al '08.
Gt(stx8)
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space
5                                     # of endmembers
gr   alm  maj  py jmaj          
0  0  0  0  0                         endmember flags
0. 1. .1   0               | range and resolution for X(gr), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(alm), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(maj), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(py), imod = 0 -> cartesian subdivision

begin_excess_function                                                
W(gr maj)  45000.  0. 0. 
W(gr py)   45000.  0. 0. 
end_excess_function 

2                                     # of sites for configurational entropy model

4 0.                                  4 independent species, A site multiplicity = 0 => variable multiplicity, means need molar amounts of all species 
n(A,ca) = 3 gr
n(A,fe) = 3 alm
n(A,na) = 2 jmaj
n(A,mg) = 3 py + 3 maj

3 2.                                  3 species, B site multiplicity = 2, this is a peculiarity in stixrude's model because he sets r[Al,jmj,B]=2
z(B,Mg) = 1/2 maj 
z(B,Si) = 1/2 maj 

end_of_model       
                      --------------------------------------------------------
begin_model                

Ppv(stx8)
abbreviation Ppv
full_name    postperovskite

2                                     model type: simplicial composition space

3                                    3 endmembers
appv  ppv   fppv            
  0  0  0                           | endmember flags

0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function                                                
W(ppv appv)  21000.  0. 0.  
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 ppv
z(fe) = 1 fppv

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 appv

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ca-Ferrite solution.
CF(stx8)
abbreviation CF
full_name    calcium-ferrite

2                                     model type: simplicial composition space
3                                     3 endmembers
mfer ffer nfer             
0  0  0                           
0. 1. .1   0               
0. 1. .1   0              

ideal

2                                     number of sites for the entropy model

3 1.                                  3 species, A site multiplicity = 1.
z(A,fe) = 1 ffer
z(A,mg) = 1 mfer
                                      
2 1.                                  al-si mixing on only one "T" site.
z(M,Si) = 1 nfer

end_of_model               
                      --------------------------------------------------------
begin_model                
                                    Fe2+-Fe3+-Mg pumpellyite 
                                    Massonne & Willner (EJM, 2008) Ideal 
Pu(M)
abbreviation Pu
full_name    pumpellyite

2                                 | model type: simplicial composition space
3                                 | 3 endmembers 
pump     fpum     ffpu                 
0  0  0                           | endmember flags
      
0. 1. 0.1  0                      | range and resolution for X(Mg)
0. 1. 0.1  0                      | range and resolution for X(Fe2), 0 -> cartesian

ideal

1                                     1 site entropy model

3 1.                                  3 species, site multiplicity = 1.
z(Fe) = 1 fpum
z(Mg) = 1 pump

end_of_model  
                      --------------------------------------------------------
begin_model                
                           Low Temperature Amphibole from 
                           Massonne & Willner (EJM, 2008) 
Act(M)
abbreviation Amph
full_name    clinoamphibole

2                          | model type: simplicial composition space
4                          | 4 endmembers 
tr     acti
gl     mrie

  0  0  0  0               | endmember flags

0. 1. 0.1  0               | range and resolution for X(Mn)
0. 1. 0.1  0               | range and resolution for X(Fe)
0. 1. 0.1  0               | range and resolution for X(Al)

begin_excess_function 
w(tr gl)    27000. 0. 0.
w(acti gl)  27000. 0. 0.
w(tr mrie)  15000. 0. 0.
w(gl mrie)  15000. 0. 0.
end_excess_function 

1                                     1 site entropy model

4 2.                                  4 species, site multiplicity = 2.
z(Fe) = 0 + 1 acti
z(Mg) = 0 + 1 tr
z(Al) = 0 + 1 gl

end_of_model               
                      --------------------------------------------------------
begin_model                
                            Fe2-Mg-Mn Stilpnomelane from 
                            Massonne & Willner (EJM, 2008)
Stlp(M)
abbreviation Stlp
full_name    stilpnomelane

2                          | model type: simplicial composition space
3                          | 3 endmembers 
stlp     mstl     mnsp                 
  0  0  0                  | endmember flags

0. 1. 0.1 0                | range and resolution for X(Mg)
0. 1. 0.1 0                | range and resolution for X(Fe2)

ideal

1                                     1 site entropy model

3 48.                                  3 species, site multiplicity = 48.
z(Fe) = 0 + 1 stlp
z(Mg) = 0 + 1 mstl

end_of_model              
                      --------------------------------------------------------
begin_model                
                             Margarite-Muscovite-Paragonite from 
                             Massonne & Willner (EJM, 2008)
Mica(M)
abbreviation Mica
full_name    white-mica


2                          | model type: simplicial composition space
3                          | 3 endmembers 
ma    mu    pa              
  0  0  0                  | endmember flags

0.  1. 0.1 0               | range and resolution for X(Ca)
0.  1. 0.1 0               | range and resolution for X(K)

begin_excess_function 
w(ma ma pa)   18200. 0. 0. 
w(pa pa ma)   10000. 0. 0.
W(mu pa pa) 19456.0      1.65440     -.456100   
W(mu mu pa) 12230.0     0.710440     0.665300    
w(ma mu)      35000. 0. 0.
end_excess_function 

1                                     1 site entropy model

3 1.                                  2 species, site multiplicity = 1.
z(Ca) = 0 + 1 ma
z(K)  = 0 + 1 mu

end_of_model               
                      --------------------------------------------------------
begin_model                
                             Mn-Fe-Mg Carpholite from 
                             Massonne & Willner (EJM, 2008)
Carp(M)                
abbreviation Carp
full_name    carpholite
                                                                
2                          | model type: simplicial composition space
3                          | 3 endmembers 
mnca    fcar     mcar                 
  0  0  0                  | endmember flags

0. 1. 0.1 0                | range and resolution for X(Mn)
0. 1. 0.1 0                | range and resolution for X(Fe)

ideal

1                                     1 site entropy model

3 1.                                  3 species, site multiplicity = 1.
z(Fe) = 0 + 1 fcar
z(Mg) = 0 + 1 mcar

end_of_model               
                      --------------------------------------------------------
begin_model                
                             fe-mg sudoite from 
                             Massonne & Willner (EJM, 2008)
Sud(M)                 
abbreviation Sud
full_name    sudoite
                                                               
2                          | model type: simplicial composition space
2                          | 2 endmembers 
fsud    sud              
  0  0                     | endmember flags

0. 1. 0.1 0                | range and resolution for X(Fe)

ideal

1                                     1 site entropy model

2 3.                                  2 species, site multiplicity = 3.
z(Fe) = 0 + 1 fsud

end_of_model               
                      --------------------------------------------------------
begin_model                
                             Magnesite-Siderite-Calcite-Rhodochrosite

Carb(M)                   
abbreviation Cc
full_name    carbonate
                                                             
2                          | model type: simplicial composition space
4                          | 4 endmembers 
cc     mag
sid    rhc
  0  0  0  0               | endmember flags
0.  1.  0.1   0            | range and resolution for X(Ca)
0.  1.  0.1   0            | range and resolution for X(Mg)
0.  1.  0.1   0            | range and resolution for X(Fe)

begin_excess_function 
w(cc mag) 35000. 0. 0.
w(cc cc sid) 13500. 0. 0.
w(cc sid sid) 21000. 0. 0. 
w(mag sid) 4000. 0. 0.          | hp '98 give 4 kJ
w(mag rhc) 20000. 0. 0.
w(sid rhc) 4000. 0. 0.
end_excess_function 

1                                     1 site entropy model

4 1.                                  4 species, site multiplicity = 1.
z(Ca) = 0 + 1 cc
z(Mg) = 0 + 1 mag
z(Fe) = 0 + 1 sid

end_of_model             
                    --------------------------------------------------------  
begin_model

                             Ti-Fe-Mg-Mn-Biotite with compound formation, Powell and Holland '99 
                             Am Min, extended for Mn-solution.

                             reformulated as a prismatic + orphan vertex model.

                             JADC, 10/5/2018

                             NOTES: 

                             * This model will only function for the MnASH and FASH subsystems
                               if MGO is also used as a component.

                             * Limits added 5/6/2011. JADC.

                                                      1       2      3      
                                                      M1      M2     T2
                                                     _________________________

                                      Mutliplicity    1       2      2 
                                                     _________________________

                          Dependent:  2 ftbi          Ti      FeV    AlSi
                                      3 tbi           Ti      MgV    AlSi

                          Dependent:  5 Sdph          Al      Fe     AlAl
                                      6 East          Al      Mg     AlAl

                                      7 MnBi          Mn      Mn     AlSi   
               Species:               8 Ann           Fe      Fe     AlSi
                                      9 Phl           Mg      Mg     AlSi 
                                                      ________________________

                        Ordered Cpd: 10 Obi           Fe      Mg     AlSi



                             | Comments can be placed before character data within a solution 
                             | model as long as they are preceded by the comment marker "|", 
                             | in general comments should not be placed before numerica data, 
                             | but they can be written following numeric data on the same line.

Bio(HP)                      | solution name.
abbreviation Bio
full_name    biotite

9                            | model type: O/D, prism + orphan vertex composition space 

2                            | prismatic vertex consists of two simplexes with a common vertex
2  3                         | 2 components {Fe2+, Mg} on simplex 1, 4 components {Al, Si, Fe3+, Ti} on simplex 2
1                            | number of orphan vertices
                             | endmembers on the prismatic vertex
ftbi_i   tbi
sdph_i   east
ann      phl
                             | orphan vertex endmember
mnbi

1                            | ordered species:

                             | model types 6 and 8 require data defining the
                             | properties of an ordered "species". this species
                             | is defined as a stoichiometric combination of
                             | two independent endmembers and the enthalpy of
                             | formation of the ordered species from the
                             | these independent endmbers. the format for this
                             | data is

                             | name = num_1 * name_1 + num_2 * name_2 text = enthalpy

                             | where name is the arbitrary name of the ordered
                             | species, num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the 
                             | name of a valid endmember. text is arbitrary and
                             | enthalpy is the enthalpy of formation of the ordered species.

obi = 2/3 phl + 1/3 ann   enthalpy_of_ordering = -10.73d3  

begin_limits
obi = -3   + 3 ann    + 1 obi                     delta = 3   z(M2,Fe) 
obi =      - 3 phl    - 3/2 tbi  -3 east -2 obi   delta = 3   z(M2,Mg)
obi =      - 3/2 ann  - 1/2 obi                   delta = 3/2 z(M1,Fe)
obi = -3/2 + 3/2 tbi  + 3/2 phl  +1 obi           delta = 3/2 z(M1,Mg)
end_limits 

2                            | number of dependent endmembers 

                             | model types 7 and 8 (reciprocal solutions) use
                             | internal endmembers that are defined as a 
                             | stoichiometric combination of the other endmembers.
                             | the names of these endmembers are arbitrary, but 
                             | here dependent endmembers are highlighted by the 
                             | suffix "_i", this also serves to distinguish the
                             | endmembers from real equivalents that may be 
                             | present in the thermodynamic data file.

                             | the format of this data is

                             | name = num_1 * name_1 + num_2 * name_2

                             | where num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the 
                             | name of a valid endmember.

sdph_i = 1 east + 1 ann - 1 obi 
ftbi_i = 1 tbi  + 1/2 ann - 1/2 obi

0 0 0 0 0 0 0                | endmember flags: if 0 the endmember is considered to be part of the solution.
                   
                             | subdivision model for simplex 1 (M2):
0. 1. .1  0                  | range and resolution of X(Fe)

                             | subdivision model for simplex 2 (M1)
0. 1. .1   0                 | range and resolution of X(Ti,M1)
0. 1. .1   0                 | range and resolution of X(Al,M1)

0. .2 .1   0                  | range and resolution of mnbi, mod = 0 -> cartesian subdivision  

                             | the foregoing lines define the pseudocompound compositions generated
                             | on each "chemical" mixing site of the solution (Sect 4 [READ 6] vdoc.pdf).
                             | for each site the compositional "range" of c-1 species (c is the number of 
                             | species on the site as defined in READ 3) is specified as well as a scheme 
                             | for interpreting the range. each range is defined by 3 numbers XMIN, XMAX, 
                             | and XINC, and the scheme is specified by an integer (IMD) written after the 
                             | c-1 ranges. The simplest scheme is cartesian, in which case IMD = 0 and the
                             | the XMIN, XMAX, and XINC indicate the range of compositions (from XMIN to XMAX) 
                             | of the respective c-1 species and the compositional spacing (XINC) of the 
                             | pseudocompounds. As entered above, the subdivision scheme will generate 
                             | pseudocompounds with X(Mn) on site 1 from 0 to 0.20 mol at 0.01 mol increments
                             | for each X(Mn) isopleth, compounds will be generated with X(Fe) from 0 to 1-X(Mn),
                             | where "0" and "1" correspond to XMIN and XMAX in the range for the second species
                             | on site 1, and X(Mg) = 1 - X(Fe) - X(Mn).

                             | Alternative subdivision shemes detailed in vdoc.pdf, may be useful for specialized
                             | applications, e.g., creating models with variable compositional resolution.

                             | By restricting the ranges specified in a model it is possible to focus pseudocompounds
                             | over a particular portion of a solutions composition space, such focusing can be 
                             | computationally advantageous when it is known a priori that only a limited range of
                             | compositions can be stable, but it should be undertaken with caution because the 
                             | results are not always easy to anticipate. 

                             | The primary difficulty in restricting compositional ranges is that the user 
                             | can explicitly control the composition of only c-1 compositions since the 
                             | cth composition is determined by difference. Additionally the subdivision ranges
                             | are applied sequentially, with compositions that violate mass balance (sum of
                             | compositions > 1) eliminated as they occur. Thus, in general, users have the greatest
                             | control on the composition of the first species on a site and no direct control
                             | on the composition of the last species. Since in most cases it is desired to 
                             | restrict the composition of dilute species, endmembers should be specified 
                             | (READ 4) so that the dilute species is not the last species.

begin_excess_function

                             | format is W(e1 e1 e2 ...) num1 num2 num3
                             | where the excess parameter = num1 + num2*T + num3*P
                             | and is multiplied by y(e1)*y(e1)*y(e2)...

W(phl ann) 9000. 0. 0.  
W(phl east) 10000. 0. 0.  
W(phl obi) 3000. 0. 0. 
W(phl tbi)  -10000.  0.  0.
W(ann east)  -1000. 0. 0.  
W(ann obi) 6000. 0. 0. 
W(ann tbi)   12000.  0  0
W(obi east)  10000.  0. 0. 

end_excess_function 

3                           | Configurational entropy: 3 sites, M1, M2, T1.

5 1.                        | 4 species on M1, 1 site per formula unit.

                            | If a mixing site involves n species, VERTEX
                            | expects to find n-1 site fraction definitions 
                            | in terms of the endmember fractions. These
                            | definitions have the general format:
                            | text = num + num1 * name1 + num2 * name2
                            | where num is a number or fraction (i.e., two
                            | numbers separated by a '/') and name is the 
                            | name of a valid endmember.
                              
                            | WARNING! fractions can only be used in the site
                            | fraction definitions, do not use fractions to specify
                            | site multiplicities in the above line.

z(m1,fe) = 1 ann  + 1 obi   
z(m1,mg) = 1 phl           
z(m1,mn) = 1 mnbi
z(m1,al) = 1 east 

4 2.                        | 4 species on M2, 2 sites per formula unit.

z(m2,fe) = 1 ann 
z(m2,mn) = 1 mnbi 
z(m2,vac) = 1/2 tbi     

2 2.                        | 2 species on T1, 2 site per formula unit.
z(t1,al) = 1/2  + 1/2 east 

end_of_model        
               
                      --------------------------------------------------------
begin_model                
                             Mica(SGH): Non-reciprocal version of white mica model Mica(SGH1) after:

                                Smye et al (JMG, 2011, 28:753-768)

                             This model requires the make definition:

                                fmu = 1 mu + 1/2 hem - 1/2 cor
                                  -30d3 0 0 
                                ma_dqf = 1 ma
                                    3d3 0 0

                             in the thermodynamic data file (e.g., hp02ver.dat), additionally the 
                             endmember "ma" must be exlcuded from any calculations that employ this
                             model.

                             WARNING! The computed phase relations in Fig 1 of Smye et al (2011) were 
                             computed by imposing the tetrahedral silica content. Thus it is unlikely 
                             that the model accurately predicts silica content.

                             JADC, 19/09/11

                                                           
                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _      
                                      3 ma_dqf        Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _                                      
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 fmu           K       Al      Fe3+  AlSi    _
Mica(SGH) 
abbreviation Mica
full_name    white-mica

2                            | model type: simplex

6                            | 6 endmembers

mu pa ma_dqf cel fmu fcel        

0 0 0 0 0 0 0 0              | endmember flags
                   
                             | subdivision model
0. 1.   .1 0                 | range and resolution of X(mu),      imod = 0 -> cartesian subdivision
0. 1.   .1 0                 | range and resolution of X(pa),      imod = 0 -> cartesian subdivision
0. 1.   .1 0                 | range and resolution of X(ma_dqf),  imod = 0 -> cartesian subdivision
0. 1.   .1 0                 | range and resolution of X(cel),     imod = 0 -> cartesian subdivision
0. 0.3  .1 0                 | range and resolution of X(fmu)

begin_excess_function

W(mu pa)         10120. 3.4 0.353  
W(mu ma_dqf)     35000. 0. 0. 
W(mu cel)        0. 0. 0.2
W(mu fcel)       0. 0. 0.2

W(pa cel)        45000. 0. 0.25
W(ma_dqf cel)    40000. 0. 0.
 
W(pa fcel)       45000. 0. 0.25 
W(ma_dqf fcel)   40000. 0. 0.

W(pa ma_dqf)     15000. 0. 0. 
W(pa fmu)        30000. 0. 0. 

W(ma_dqf fmu)    35000. 0. 0. 

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1.                        | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel + 1 fmu  
z(a,na) = 1 pa 

3 1.                        | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma_dqf + 1 fmu
z(m2a,mg) = 1 cel

2 1.                        | 2 species on M2b, 1 site per formula unit.
z(m2b,fe) = 1 fmu

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 fmu + 1 ma_dqf 

begin_van_laar_sizes                        
alpha(mu)     0.63 0. 0.                        
alpha(pa)     0.37 0. 0.                     
alpha(ma_dqf) 0.63 0. 0.    
alpha(cel)    0.63 0. 0.
alpha(fmu)    0.63 0. 0.
alpha(fcel)   0.63 0. 0.

end_van_laar_sizes

end_of_model                  
                                  --------------------------------------------------------
begin_model               
       
                                    Mn-Fe-Mg-Fe3+ Chloritoid after:

                                       Smye et al (JMG, 2011, 28:753-768)

                                    This model requires the make definition:

                                       octd = 1 fctd + 1/4 hem - 1/4 cor
                                         125d2 0 0 

                                    in the thermodynamic data file (e.g., hp02ver.dat).

                                    NOTE: this version is formulated with 5 Oxygen formula unit, NOT the 
                                    10 oxygen formula unit used by Smye et al (2011).
                                    JADC, 19/09/11
                                                           
                                                      M1a     M1b    
                                                     _______________

                                      Mutliplicity    1/2      1     
                                                     _______________

                                          mctd         Al     Mg
                                          fctd         Al     Fe
                                          mnctd        Al     Mn
                                          octd         Fe3+   Fe
Ctd(SGH)               
abbreviation Ctd
full_name    chloritoid

2                          | model type 

4                          | endmembers 

octd 
mnctd    
fctd
mctd 
                
0  0  0  0                 | endmember flags

0. 1. 0.1 0                | range and resolution for X(Fe3+), imod = 0 -> cartesian subdivision              
0. 1. 0.1 0                | range and resolution for X(Mn),   imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | range and resolution for X(Fe),   imod = 0 -> cartesian subdivision

begin_excess_function 
w(mctd fctd ) 500. 0. 0. 
w(mctd mnctd) 500. 0. 0. 
w(fctd mnctd) 500. 0. 0. 
end_excess_function 

2                                     2 site entropy model

2 .5                                  2 species on M1a, site multiplicity = 1/2
z(Fe) = 1 octd

3 1.                                  3 species on M1b, site multiplicity = 1
z(Mn) = 1 mnctd
z(Mg) = 1 mctd

end_of_model               
                                  -------------------------------------------------------- 
begin_model                
       
                                    Mn-Fe-Mg-Fe3+ Carpholite after:

                                       Smye et al (JMG, 2011, 28:753-768)

                                    This model requires the make definitions:

                                       ocar  = 1 fcar + 1/2 hem - 1/2 cor
                                         45d3 0 0 
                                       mncar = 1 mcar + 1 mang - 1/2 cor
                                         30d3 0 0 

                                    in the thermodynamic data file (e.g., hp02ver.dat).

                                    JADC, 19/09/11
                                                           
                                                      M2      M1     
                                                     _______________

                                      Mutliplicity     1       1     
                                                     _______________

                                          mcar         Al     Mg
                                          fcar         Al     Fe
                                          mncar        Al     Mn
                                          ocar         Fe3+   Fe
Carp(SGH)
abbreviation Crp
full_name    carpholite

2                          | model type

4                          | endmembers 

mncar    
ocar 
fcar
mcar

0 0 0 0                    | endmember flags

0.     1.      0.1     0   | imod = 0 -> cartesian subdivision
0.     1.      0.1     0   | imod = 0 -> cartesian subdivision
0.     1.      0.1     0   | imod = 0 -> cartesian subdivision

begin_excess_function 
w(mcar fcar )  1d3 0. 0. 
w(mcar mncar)  1d3 0. 0. 
w(fcar mncar)  1d3 0. 0. 
end_excess_function 

2                                     2 site entropy model

2 .5                                  2 species on M2, site multiplicity = 1
z(Fe) = 1 ocar

3 1.                                  3 species on M1, site multiplicity = 1
z(Mn) = 1 mncar
z(Mg) = 1 mcar

end_of_model               
                                  --------------------------------------------------------
begin_model 

                                  Ca-Fe2+-Mg-Al-Fe3+ Garnet model after White, Pomroy, Powell & Holland (JMG, 2005)

                                  In calculations that use this model, the andradite endmember ("andr") in the Holland
                                  and Powell data base must be excluded. This model also requires the following make
                                  definition for khoharite in the thermodynamic data file:

                                      kho = 1 py - 1 gr + 1 andr
                                      40d3 0 0  

                                                      1       2      
                                                      X       Y 
                                                     _____________

                                      Mutliplicity    3       2     
                                                     _____________

                          Dependent:   fkho_i        Fe      Fe3+      
                          Dependent:   kho           Mg      Fe3+
                          Dependent:   fmn_i         Mn      Fe3+
                                       andr_i        Ca      Fe3+
   
                                       spss          Mn      Al
                                       alm           Fe      Al     
                                       py            Mg      Al     
                                       gr            Ca      Al          
                                                      ____________             
                                      
                                  When originally entered 9/20/11, this model was formulated (incorrectly) in terms of 
                                  andradite, it was corrected to use the khoharite endmember 10/24/11. JADC

                                  definition of andr_i corrected from 1 kho + 1 py - 1 gr to 1 kho - 1 py + 1 gr on
                                  1/4/13. JADC 
Gt(WPPH) 
abbreviation Gt
full_name    garnet

7                            | model type
2                            | the number of independent subcompositions, reciprocal solution if > 1.

4  2                         | 4 species on site 1, 2 species on site 2. 
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mn-Mg-Fe-Ca and the species that mix on 
                             | site 2 are Al-Fe3+.                                                                          

          
spss   alm      py     gr    | endmember names 
fmn_i  fkho_i   kho    andr_i


3                                 | number of dependent endmembers 

andr_i = 1 kho  - 1 py   +1 gr  
fkho_i = 1 kho  + 1 alm  -1 py  
fmn_i  = 1 kho  + 1 spss -1 py 

0  0  0  0  0  0  0  0            | endmember flags

0. .2   0.1 0                     | imod = 0 -> cartesian subdivision (xmn) on X
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xfe) on X
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xmg) on X


0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision x(fe3+) on Y

                            
begin_excess_function
w(alm py)    2.5d3 0. 0.
w(alm kho)  22.5d3 0. 0.
w(py gr)     33d3 0. 0.
w(gr kho)   -7d3 0. 0. 
w(spss kho) 20d3 0. 0. 
end_excess_function  

2                                     |2 site entropy model

4 3.                                  |4 species, site multiplicity 3
z(x,mn) = 1 spss 
z(x,fe) = 1 alm 
z(x,ca) = 1 gr

2 2.                                  |2 species, site multiplicity 2
z(y,al) = 1 spss + 1 alm + 1 py + 1 gr

end_of_model      
                      --------------------------------------------------------
begin_model               
                      CLINOAMPHIBOLE: Diener et al, JMG 2011 25:631-656, modified from Diener et al, JMG 2008.
                      --------------------------------------------------------
                      corrections/revisions 

                        10/07   z(m2a,al) corrected. Y Y. Podladchikov
                         3/08   z(m1a,mg),z(m4,ca),z(m4,mg), and fged corrected, 
                                T1 multiplicity reduced to 1. 
                                Enthalpies of ordering corrected. JADC.
                         6/08   z(m1,mg) corrected to include mrb, second limit
                                equations for cammo1 and cammo2 corrected accordingly.   
                                corrected enthalpies for cammo1 and cammo2.    
                       8/31/11 2011 DP model revisions entered by MJC.
                       1/24/17 fgrk-grk exchange added
                       3/ 8/18 dqfs for cumm and grun moved from model to data file
                       11/2/18 reformulated as 2x2x5 prism, adding Ca-free parg and Ts, and
                               Ca-bearing grk exchanges. JADC.
                      --------------------------------------------------------

                      NOTE to use this model the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                          ts_dqf 
                          parg_dqf
                          gl_dqf
                          cumm_dqf
                          grun_dqf

                       additionally the following endmembers should be excluded in the 
                       computational option file:

                          ts
                          parg
                          gl
                          cumm
                          grun

                      The model composition space is formulated as prism composed of 3 simplexes
                      the first simplex is 1d (binary) and represents divalent Mg/(Fe+Mg), the 
                      second simplex is 1d (binary) and represents the exchange of divalent M (Fe and Mg) for Ca
                      and the third simplex is 5d (hexary) and represents the generalized (M,Ca)-amphibole exchanges: 
                      (M,Ca)-Al_Tschermaks, (M,Ca)-Na_Pargasite, M-Riebeckite, M-Glaucophane, and 
                      (M,Ca)-Fe3+_tschermaks (Na-free riebeckite).

                      Because some of the exchanges are not possible due to charge balance constraints, the impossible
                      vertices of the simplex (Ca-riebeckite, Ca-glaucophane) are populated by replicating possible 
                      vertices. The current formulation is undesirable both because of these replicated vertices and
                      and because the dependent (M,Ca)-Fe3+_tschermaks adds a dimension to the composition space. 
                      See comments for the Augite(G) model for further discussion. 

                      In the present model the independent prismatic variables (used for specifying) the subdivision
                      of the composition space are:

                         X(1,1) - Mg/(Fe+Mg)

                         X(2,1) - Ca/M on M1, M = divalent Fe and Mg

                         X(3,1) - (M,Ca)-Al_Tschermak
                         X(3,2) - (M,Ca)-Na_Pargasite
                         X(3,3) - M-Glaucophane
                         X(3,4) - M-Riebeckite
                         X(3,5) - (M,Ca)-Fe3+_tschermaks (Na-free riebeckite)
                      --------------------------------------------------------

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       1(4)*
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si      independent
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si      dependent
                             3 ts_dqf        Vac       Mg      Al     Ca      Al_Si      independent
                             4 fts           Vac       Fe      Al     Ca      Al_Si      dependent
                             5 parg_dqf      Na        Mg      Mg_Al  Ca      Al_Si      independent
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si      dependent
                             7 gl_dqf        Vac       Mg      Al     Na      Si_Si      independent
                             8 fgl           Vac       Fe      Al     Na      Si_Si      dependent
                             9 cumm_dqf      Vac       Mg      Mg     Mg      Si_Si      independent
                            10 grun_dqf      Vac       Fe      Fe     Fe      Si_Si      independent
                            11 mrb           Vac       Mg      Fe3+   Na      Si_Si      independent
                            12 frb           Vac       Fe      Fe3+   Na      Si_Si      dependent

                            13 cammo1        Vac       Mg      Fe     Fe      Si_Si      ordered
                            14 cammo2        Vac       Fe      Mg     Fe      Si_Si      ordered

           dependent exchange grk            V         M      Fe3     M       Si_Al

                        *T1 has a true multiplicity of 4, H&P previously used an effective multiplicity of 2;
                        however in Diener et al. '07 the multiplicity has been reduced to 1. JADC 9/07. 

                      ---------------------------------------------

cAmph(DP)                    | solution name 
abbreviation Amph
full_name    clinoamphibole

8                            | model type: prismatic, two ordering parameters
3                            | 3 simplices
2 2 6                        | 2 binary and 1 hexary

ts_dqf     fcts_d
mts_d      fts_d             | new 

parg_dqf   fcparg_d
mparg_d    fparg_d           | new 

gl_dqf     fgl_d
gl_d       fgl_d1

mrb        frb_d
mrb_d      frb_d1

mcgrk_d     fcgrk_d          | new
mgrk_d      fgrk_d 

tr          ftr_d
cumm_dqf    grun_dqf

2                            | 2 ordered species:

cammo1 = 3/7 cumm_dqf + 4/7 grun_dqf   enthalpy_of_ordering = -9.5d3   
cammo2 = 2/7 cumm_dqf + 5/7 grun_dqf   enthalpy_of_ordering = -11.7d3    | these enthalpies differ from the published values
                                                                         | becuase Thermocalc reactions are specified in terms of the 
                                                                         | endmember without "DQF" corrections, while in Perple_X
                                                                         | endmember include any DQF corrections. 

begin_limits

cammo1 = -7/3 grun_dqf - 4/3 cammo1 + 5/3 cammo2 - 5/3 cammo2                               delta = 7/3 z(M2,Fe)       
cammo1 = -7/4 + 7/4 grun_dqf + 1  cammo1 + 1/2 cammo2 + 5/4 cammo2                          delta = 7/4 z(M1,Fe)
cammo1 = -7/3 + 7/3 tr + 7/6 parg_dqf + 7/3 cumm_dqf + 1 cammo1 + 5/3 cammo2 + 2/3 cammo2   delta = 7/3 z(M2,Mg)
cammo1 = -7/3 + 7/3 cumm_dqf + 1 cammo1 - 2/3 cammo2 + 2/3 cammo2                           delta = 7/3 z(M4,Mg)
cammo1 = -7/3 grun_dqf - 4/3 cammo1 - 2/3 cammo2 - 5/3 cammo2                               delta = 7/3 z(M4,Fe)

cammo2 = -7/5 + 7/5 grun_dqf + 3/5 cammo1 + 4/5 cammo1 + 1 cammo2                           delta = 7/5 z(M2,Fe)
cammo2 = -7/2 grun_dqf + 2 cammo1 - 2 cammo1 - 5/2 cammo2                                   delta = 7/2 z(M1,Fe)
cammo2 = -7/5 tr - 7/10 parg_dqf - 7/5 cumm_dqf + 3/5 cammo1 - 3/5 cammo1 - 2/5 cammo2      delta = 7/5
cammo2 = -7/2 + 7/2 cumm_dqf - 3/2 cammo1 + 3/2 cammo1 + 1 cammo2                           delta = 7/2
cammo2 = -7/2 grun_dqf - 3/2 cammo1  - 2 cammo1 - 5/2 cammo2                                delta = 7/2

end_limits

17                           | # of dependent endmembers 

ftr_d    = 1 tr       + 2 grun_dqf    - 1 cammo1 - 1 cammo2

fcparg_d = 1 parg_dqf + 3/2 grun_dqf  - 1 cammo1   - 1/2 cammo2
fparg_d  = 1 parg_dqf + 1/2 grun_dqf  + 1/2 cammo2 - 1 tr
mparg_d  = 1 parg_dqf - 1 tr          + 1 cumm_dqf

fcts_d   = 1 ts_dqf   + 1 grun_dqf    - 1 cammo1
fts_d    = 1 ts_dqf - 1 tr            + 1 cammo2
mts_d    = 1 ts_dqf - 1 tr            + 1 cumm_dqf

gl_d     = 1 gl_dqf
fgl_d1   = 1 gl_dqf   + 1 grun_dqf    - 1 cammo1
mrb_d    = 1 mrb
frb_d1   = 1 mrb      + 1 grun_dqf    - 1 cammo1

fgl_d    = 1 gl_dqf   + 1 grun_dqf    - 1 cammo1
frb_d    = 1 mrb      + 1 grun_dqf    - 1 cammo1

mcgrk_d  = 1 mrb      + 1 ts_dqf  - 1 gl_dqf 
mgrk_d   = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 tr         + 1 cumm_dqf
fgrk_d   = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 tr         + 1 cammo2
fcgrk_d  = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 cammo1     + 1 grun_dqf

0 0 0 0 
0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0        | endmember flags.

0. 1.  .1  0               | range and resolution for X(1,1)
0. 1.  .1  0               | range and resolution for X(2,1)

0. 1.  .1  0               | range and resolution for X(3,1) => ts quadrilateral
0. 1.  .1  0               | range and resolution for X(3,2) => parg quadrilateral
0. 1.  .1  0               | range and resolution for X(3,3) => rb quadrilateral
0. 1.  .1  0               | range and resolution for X(3,4) => gl quadrilateral
0. 1.  .1  0               | range and resolution for X(3,5) => grk quadrilateral

begin_excess_function
w(mrb tr)          52e3   0. 0.  
w(mrb ts_dqf)      20e3   0. 0. 
w(mrb parg_dqf)        40e3   0. 0. 

w(mrb cumm_dqf)        80e3   0. 0. 
w(mrb grun_dqf)        91e3   0. 0. 
w(mrb cammo1)      80e3   0. 0.
w(mrb cammo2)      90e3   0. 0.
 
w(cammo2 tr)          63e3   0. 0. 
w(cammo2 ts_dqf)     72.5e3  0. 0.    
w(cammo2 parg_dqf)   94.8e3  0. 0. 
w(cammo2 gl_dqf)   111.2e3   0. 0. 
w(cammo2 cumm_dqf)        23e3   0. 0. 
w(cammo2 grun_dqf)         8e3   0. 0. 
w(cammo2 cammo1)      20e3   0. 0.

w(cammo1 tr)         57e3   0. 0.
w(cammo1 ts_dqf)     70e3   0. 0.
w(cammo1 parg_dqf)  94.8e3  0. 0.
w(cammo1 gl_dqf)    100e3   0. 0.
w(cammo1 cumm_dqf)       18e3   0. 0.
w(cammo1 grun_dqf)       12e3   0. 0.

w(grun_dqf tr)          75e3   0. 0.
w(grun_dqf ts_dqf)      80e3   0. 0.
w(grun_dqf parg_dqf)  106.7e3  0. 0.
w(grun_dqf gl_dqf)   113.5e3   0. 0.
w(grun_dqf cumm_dqf)        33e3   0. 0.

w(cumm_dqf tr)          45e3   0. 0.
w(cumm_dqf ts_dqf)      70e3   0. 0.
w(cumm_dqf parg_dqf)     90e3  0. 0.
w(cumm_dqf gl_dqf)     100e3   0. 0.

w(gl_dqf tr)        65e3   0. 0.
w(gl_dqf ts_dqf)    25e3   0. 0.
w(gl_dqf parg_dqf)   50e3  0. 0.

w(parg_dqf tr)      25e3   0. 0.
w(parg_dqf ts_dqf) -40e3   0. 0.

w(ts_dqf tr)        20e3   0. 0.
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) =    1 parg_dqf  
              
2 3.                       | 2 species on M1, 3 sites per formula unit
z(M1,fe)   = 1 grun_dqf + 1 cammo2

4 2.                       | 4 species on M2, 2 sites pfu
z(M2,fe)   = 1 grun_dqf + 1 cammo1
z(m2,al) =   1 ts_dqf + 1/2 parg_dqf + 1 gl_dqf 
z(m2,fe3+) = 1 mrb 

4 2.                       | 4 species on M4, 2 sites pfu
z(m4,na) =   1 gl_dqf + 1 mrb 
z(m4,mg) =   1 cumm_dqf
z(m4,fe) =   1 grun_dqf + 1 cammo1 + 1 cammo2  

2 1.                       | 2 species on T1, fake site multiplicity of 1.
z(T1,Al) =   1/2 ts_dqf  + 1/2 parg_dqf  

begin_van_laar_sizes
alpha(tr)       1.0
alpha(parg_dqf) 1.7
alpha(ts_dqf)   1.5
alpha(gl_dqf)   0.8
alpha(cumm_dqf) 1.0
alpha(grun_dqf) 1.0
alpha(cammo1)   1.0
alpha(cammo2)   1.0
alpha(mrb)      0.8
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model 
                      ORTHOAMPHIBOLE: Diener et al, JMG 2011 25:631-656, modified from Diener et al, JMG 2008

                      corrections/revisions

                        10/07   z(m2a,al) corrected. Y. Podladchikov.
                         3/08   z(m1a,mg),z(m4,ca),z(m4,mg), and fged corrected, 
                                T1 multiplicity reduced to 1. 
                                Enthalpies of ordering corrected. JADC.
                         8/08   Enthalpy of ordering corrected for HP dqfs.
                     10/31/11   2011 DP revisions entered by MJC.
                     11/ 2/2018 reformulated as a 2x2x6 prism adding Na-free riebeckite (grk)
                                      ---------------------------------------------

                      NOTE to use this the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                              mpa       = 1 parg - 1 tr +1 anth dqf(25d3)
                              ged_dqf   = dqf(ged)   20000. 0. 0.
                              ogl_dqf  = dqf(gl)    15000. 0. 0. 
                              fanth_dq = dqf(fanth)  7000. 0. 0.
                              omrb_dqf = 1 gl -2 jd -2 acm dqf(33d3)

                       additionally the following endmembers should be excluded in the 
                       computational option file if they interfere with calculated 
                       phase relations:

                              ged 
                              fanth 
                              gl

                      The model composition space is formulated as prism composed of 3 simplexes
                      the first simplex is 1d (binary) and represents divalent Mg/(Fe+Mg), the 
                      second simplex is 1d (binary) and represents the exchange of divalent M (Fe and Mg) for Ca
                      and the third simplex is 5d (hexary) and represents the generalized (M,Ca)-amphibole exchanges: 
                      (M,Ca)-Al_Tschermaks, (M,Ca)-Na_Pargasite, M-Riebeckite, M-Glaucophane, and 
                      (M,Ca)-Fe3+_tschermaks (Na-free riebeckite).

                      Because some of the exchanges are not possible due to charge balance constraints, the impossible
                      vertices of the simplex (Ca-riebeckite, Ca-glaucophane) are populated by replicating possible 
                      vertices. The current formulation is undesirable both because of these replicated vertices and
                      and because the dependent (M,Ca)-Fe3+_tschermaks adds a dimension to the composition space. 
                      See comments for the Augite(G) model for further discussion. 

                      In the present model the independent prismatic variables (used for specifying) the subdivision
                      of the composition space are:

                         X(1,1) - Mg/(Fe+Mg)

                         X(2,1) - Ca/M on M1, M = divalent Fe and Mg

                         X(3,2) - (M,Ca)-Na_oPargasite
                         X(3,1) - (M,Ca)-Al_Tschermak (Gedrite)
                         X(3,3) - M-oGlaucophane
                         X(3,4) - M-oRiebeckite
                         X(3,5) - (M,Ca)-Fe3+_oTschermaks (Na-free ortho-riebeckite)
                      --------------------------------------------------------

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       1(4)*
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si      independent
                             3 ged_dqf       Vac       Mg      Al     Mg      Al_Si      independent
                             5 mpa           Na        Mg      Mg_Al  Mg      Al_Si      independent
                             7 ogl_dqf       Vac       Mg      Al     Na      Si_Si      independent
                             9 anth          Vac       Mg      Mg     Mg      Si_Si      independent
                            10 fanth_dq      Vac       Fe      Fe     Fe      Si_Si      independent
                            11 omrb_dqf      Vac       Mg      Fe3+   Na      Si_Si      independent

                            13 ammo1         Vac       Mg      Fe     Fe      Si_Si      ordered
                            14 ammo2         Vac       Fe      Mg     Fe      Si_Si      ordered 

                        *T1 has a true multiplicity of 4, H&P previously used an effective multiplicity of 2;
                        in Diener et al '07 the multiplicity has been reduced to 1.  

                        JADC 9/07. 

                        (AlMg-1,M2)  = ged - anth
                        (CaNa-1,M4)  = tr + (ged - anth) - gl
                        (CaMg-1,M4)  = tr - anth
                        (MgNa-1,M4)  = ged - ogl
                        (Fe3Al-1,M2) = mrb - ogl
                        FeMg-1(M4) = (-fanth - anth + ammo1 + ammo2)


oAmph(DP)                   | model name 
abbreviation oAmph
full_name    orthoamphibole

8                            | model type
3                            | 3 simplex prism
2 2 6                        | 2 binary and 1 hexary

cmpa_d        cfpa_d         | new 
mpa           fpa_d

cmged_d       cfged_d        | new 
ged_dqf       fged_d

ogl_dqf       fgl_d
ogl_d         fgl_d1

omrb_dqf      frb_d
omrb_d        frb_d1

mcgrk_d       fcgrk_d        | new 
mgrk_d        fgrk_d         | new 

tr            ftr_d
anth          fanth_dq

2                            | 2 ordered species:

ammo1 = 3/7 anth + 4/7 fanth_dq  enthalpy_of_ordering = -9.5d3
ammo2 = 2/7 anth + 5/7 fanth_dq   enthalpy_of_ordering = -11.7d3 | these enthalpies differ from the published values
                                                                 | becuase Thermocalc reactions are specified in terms of the 
                                                                 | endmember without "DQF" corrections, while in Perple_X
                                                                 | endmember include any DQF corrections. 

begin_limits
ammo1 = -7/4 + 7/4 fanth_dq + 1 ammo1 + 1/2 ammo2 + 5/4 ammo2                               delta = 7/4
ammo1 = -7/3 + 7/3 tr + 7/6 mpa  + 7/3 anth + 1 ammo1 + 5/3 ammo2 + 2/3 ammo2               delta = 7/3
ammo1 = -7/3 + 7/3 mpa  + 7/3 anth + 7/3 ged_dqf  + 1 ammo1  - 2/3 ammo2 + 2/3 ammo2        delta = 7/3
ammo1 =      - 7/3 fanth_dq - 4/3 ammo1 - 2/3 ammo2 - 5/3 ammo2                             delta = 7/3
ammo1 =      - 7/3 fanth_dq - 4/3 ammo1 + 5/3 ammo2 - 5/3 ammo2                             delta = 7/3

ammo2 = -7/2 fanth_dq + 2 ammo1 - 2 ammo1 - 5/2 ammo2                                       delta = 7/2
ammo2 = -7/5 tr - 7/10 mpa  - 7/5 anth + 3/5 ammo1 - 3/5 ammo1 - 2/5 ammo2                  delta = 7/5
ammo2 = -7/2 + 7/2 anth + 7/2 mpa  + 7/2 ged_dqf  - 3/2 ammo1 + 3/2 ammo1 + 1 ammo2         delta = 7/2
ammo2 =      - 7/2 fanth_dq - 3/2 ammo1 - 2 ammo1 - 5/2 ammo2                               delta = 7/2
ammo2 = -7/5 + 7/5 fanth_dq + 3/5 ammo1 + 4/5 ammo1 + 1 ammo2                               delta = 7/5
end_limits

17                          | number of dependent endmembers 

ftr_d   = 1 tr + 2 fanth_dq - 1 ammo1 - 1 ammo2

fpa_d   = 1 mpa  + 1/2 fanth_dq + 1/2 ammo2 - 1   anth
cfpa_d  = 1 mpa  + 1 tr         + 3/2 fanth_dq -   1 ammo1 - 1/2 ammo2 - 1 anth
cmpa_d  = 1 mpa  + 1 tr         - 1 anth 

cmged_d = 1 ged_dqf  - 1 anth + 1 tr
cfged_d = 1 ged_dqf  - 1 anth + 1 tr + 1 fanth_dq - 1 ammo1

mgrk_d   = 1 omrb_dqf  + 1 ged_dqf  - 1 ogl_dqf
mcgrk_d  = 1 omrb_dqf  + 1 ged_dqf  - 1 anth     - 1 ogl_dqf   + 1 tr
fcgrk_d  = 1 omrb_dqf  + 1 ged_dqf  - 1 ogl_dqf  + 1 fanth_dq  - 1 ammo1
fgrk_d   = 1 omrb_dqf  + 1 ged_dqf  - 1 ogl_dqf  - 1 anth      + 1 ammo2

fged_d  = 1 ged_dqf  - 1 anth + 1 ammo2

ogl_d    = 1 ogl_dqf
fgl_d1   = 1 ogl_dqf +  1 fanth_dq - 1 ammo1

omrb_d   = 1 omrb_dqf
frb_d1   = 1 omrb_dqf + 1 fanth_dq - 1 ammo1

fgl_d   = 1 ogl_dqf +  1 fanth_dq - 1 ammo1
frb_d   = 1 omrb_dqf + 1 fanth_dq - 1 ammo1

0 0 0 0 
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 | endmember flags.


0. 1.  .1  0               | range and resolution for X(1,1)
0. 1.  .1  0               | range and resolution for X(2,1)

0. 1.  .1  0               | range and resolution for X(3,1) => ged quadrilateral
0. 1.  .1  0               | range and resolution for X(3,2) => parg quadrilateral
0. 1.  .1  0               | range and resolution for X(3,3) => rb quadrilateral
0. 1.  .1  0               | range and resolution for X(3,4) => gl quadrilateral
0. 1.  .1  0               | range and resolution for X(3,5) => grk quadrilateral

begin_excess_function
W(anth ged_dqf )      25d3
W(anth mpa )          25d3
W(anth ogl_dqf)       65d3
W(anth tr)            45d3
W(anth fanth_dq)      33d3
W(anth omrb_dqf)      52d3
W(anth ammo1)         18d3
W(anth ammo2)         23d3

W(ged_dqf  mpa )          -40d3
W(ged_dqf  ogl_dqf)        25d3
W(ged_dqf  tr)             70d3
W(ged_dqf  fanth_dq)     38.5d3
W(ged_dqf  omrb_dqf)       20d3
W(ged_dqf  ammo1)          29d3
W(ged_dqf  ammo2)        34.6d3

W(mpa  ogl_dqf)       50d3  0  0
W(mpa  tr)            90d3  0  0
W(mpa  fanth_dq)      45d3  0  0
W(mpa  omrb_dqf)      40d3  0  0 
W(mpa  ammo1)       33.2d3  0  0
W(mpa  ammo2)         36d3  0  0

W(ogl_dqf tr)            65d3  0  0
W(ogl_dqf fanth_dq)    81.2d3  0  0
W(ogl_dqf ammo1)       65.5d3  0  0
W(ogl_dqf ammo2)       78.4d3  0  0

W(tr fanth_dq)        75d3 0  0
W(tr omrb_dqf)       52d3  0  0 
W(tr ammo1)          57d3  0  0
W(tr ammo2)          63d3  0  0

W(fanth_dq omrb_dqf)     65d3  0  0 
W(fanth_dq ammo1)        12d3  0  0
W(fanth_dq ammo2)         8d3  0  0

W(omrb_dqf ammo1)        52d3  0  0 
W(omrb_dqf ammo2)        63d3  0  0 

W(ammo1 ammo2)            20d3  0  0
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na)    = 1 mpa  
              
2 1.                       | 2 species on T1, fake site multiplicity of 1.
z(T1,Al)   = 1/2 ged_dqf  + 1/2 mpa  

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,fe)   = 1 fanth_dq + 1 ammo2

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,fe)   = 1 fanth_dq + 1 ammo1
z(m2,al)   = 1 ged_dqf  + 1/2 mpa   + 1 ogl_dqf  
z(m2,fe3+) = 1 omrb_dqf 

4 2.                       | 4 species on M4, 2 sites pfu
z(m4,ca)   = 1 tr      
z(m4,mg)   = 1 mpa      + 1 anth + 1 ged_dqf 
z(m4,na)   = 1 ogl_dqf + 1 omrb_dqf 

begin_van_laar_sizes                        
alpha(tr)          1.0    0.    0.
alpha(ged_dqf )    1.5    0.    0.
alpha(mpa )        1.7    0.    0.
alpha(ogl_dqf)     0.8    0.    0.
alpha(anth)        1.0    0.    0.
alpha(fanth_dq)    1.0    0.    0.
alpha(ammo1)       1.0    0.    0.
alpha(ammo2)       1.0    0.    0.
alpha(omrb_dqf)    0.8    0.    0.
end_van_laar_sizes

end_of_model   
                      --------------------------------------------------------
begin_model
                                      Green, ECR, Holland, TJB & Powell, R (2007) An order-disorder model for
                                      omphacitic pyroxenes in the system jadeite-diopside-hedenbergite-acmite,
                                      with applications to eclogite rocks. American Mineralogist, 92, 1181-1189.

                                      Originally this model had no DQF corrections.

                                      To use this model with ds5 versions (pre-2011) of the THERMOCALC data base, the 
                                      DQF on acmite should be -4000 J/mol as specified by Diener & Powell (2011), entered by MJC, Oct 31, 2011.

                                      To use this model with ds6 versions (2011+) of the THERMOCALC data base, the 
                                      DQF [specified at the end of this model] on acmite should be -7000 J/mol
                                      as specified by Green et al (2016) and noted by Felix Gervais. 

                                      The DQF specification for acm moved from this solution model to the
                                      thermodynamic data file. March 7, 2018. JADC.
                                      ---------------------------------------------

                                      WARNING: The choice of independent ordered species (here, cfm, om, jac)
                                      has the conseqence that this model CANNOT be used for the following
                                      subcompositions:

                                          jd-hed, hed-acm, di-acm, hed-acm-jd, hed-acm-di

                                      to work in these joins either fom, hac, or dac must replace either 
                                      om or/and cfm.

                                                         Site:
                                                       1      2      3      4    
                                                      M2a    M2b    M1a    M1b     
                                                     ____________________________________

                                      Mutliplicity    1/2    1/2    1/2    1/2   
                                                     ____________________________________

                                      1 Diopside      Ca     Ca     Mg     Mg    
                            Species:  2 Jadeite       Na     Na     Al     Al    
                                      3 Hedenbergite  Ca     Ca     Fe2+   Fe2+ 
                                      4 Acmite        Na     Na     Fe3+   Fe3+  
                                                      ___________________________________

                        Ordered Cpd:  5 om            Na     Ca     Al     Mg   
                                      6 cfm           Ca     Ca     Mg     Fe 
                                      7 jac           Na     Na     Fe3+   Al

Omph(GHP)     
abbreviation Cpx
full_name    clinopyroxene

6                           | model type 
4                           | disordered endmembers

di       
jd   
acm_dqf
hed

3                            | number of ordered species 

om   = 1/2 jd + 1/2 di       enthalpy_of_ordering  =  -2.9d3 
cfm  = 1/2 di + 1/2 hed      enthalpy_of_ordering  =  -1.5d3
jac  = 1/2 jd + 1/2 acm_dqf  enthalpy_of_ordering  =  -1d3      | this differs from the published value of -3d3 J/mol
                                                            | because Thermocalc reactions are specified in terms of the 
                                                            | endmember without "DQF" corrections, while in Perple_X
                                                            | endmember include any DQF corrections. 

begin_limits
om = -2 + 2 di + 2 hed   delta = 2
om = -2 + 2 jd + 2 acm_dqf   delta = 2 
om = -2 + 2 di + 1 cfm   delta = 2 
om = -2 + 2 jd + 1 jac   delta = 2 
om = -2 + 2 acm_dqf + 2 jd + 2 hed + 1 cfm delta = 2
om = -2 + 2 acm_dqf + 2 di + 2 hed + 1 jac delta = 2


cfm = -2 di + 1 om       delta = 2
cfm = -2 + 2 hed         delta = 2
cfm = -2 hed             delta = 2
cfm = -2 jd - 2 hed - 2 acm_dqf + 1 om      delta = 2

jac = -2 acm_dqf             delta = 2
jac = -2 jd + 1 om       delta = 2
jac = -2 + 2 acm_dqf         delta = 2
jac = -2 acm_dqf - 2 di - 2 hed + 1 om      delta = 2
end_limits
 

0  0  0  0                   | endmember flags

0. 1. 0.1  0                 | range and resolution of X(di)
0. 1. 0.1  0                 | range and resolution of X(jd)
0. 1. 0.1  0                 | range and resolution of X(acm) 

begin_excess_function   
W(jd di)       26d3
W(jd hed)      24d3
W(jd acm_dqf)  5d3
W(jd om)       15.5d3
W(jd cfm)      25.2d3
W(jd jac)      3d3
W(di hed)      4d3
W(di acm_dqf)  21d3
W(di om)       15.75d3
W(di cfm)      2d3
W(di jac)      24.65d3
W(hed acm_dqf) 20.8d3
W(hed om)      17.2d3
W(hed cfm)     2d3
W(hed jac)     24.6d3
W(acm_dqf om)  16.4d3
W(acm_dqf cfm) 22.2d3
W(acm_dqf jac) 3d3
W(om cfm)      18.45d3
W(om jac)      19.5d3
W(cfm jac)     24.55d3

end_excess_function

4                                   | 4 site entropy model (m1a, m1b, m2b, m2a)

4 0.5                               | 4 species on m1b, mult = 1/2
z(m1b,al)   = 1 jd + 1 jac 
z(m1b,fe2+) = 1 hed + 1 cfm 
z(m1b,fe3+) = 1 acm_dqf 

2 0.5                               | 2 species on m2a, mutiplicity = 1/2
z(m2a,ca)   = 1 di + 1 hed + 1 cfm

2 0.5                               | 2 species on m2b, mult. = 1/2
z(m2b,na)   = 1 jd + 1 acm_dqf + 1 jac 

4 0.5                               | 4 species on m1a, mult = 1/2
z(m1a,mg)   = 1 di + 1 cfm 
z(m1a,fe2+) = 1 hed 
z(m1a,fe3+) = 1 acm_dqf + 1 jac 

reach_increment 0 3

end_of_model        
                      --------------------------------------------------------
begin_model                
                           | preliminary BCC iron solution model
FeSi(BCC) 
abbreviation BCC
full_name    alloy

2                          | model type: simplicial composition space.
2                          | 2 endmembers 
iron     Si    
  0  0                     | endmember flags

0.     1.      0.1     0   | imod = 0 -> cartesian subdivision

begin_excess_function   
W(iron Si)       -100d3  0  0
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(Fe) = 1 iron

reach_increment 3

end_of_model          
                      --------------------------------------------------------
begin_model                
                           | FCC Fe-Si alloy after Lacaze and Sundman (1990) Metal. Trans 22A:1991-2211
FeSi(fcc)
abbreviation FCC
full_name    alloy

2                          | model type: simplicial composition space.
2                          | 2 endmembers 
Fe-FCC
Si-FCC
  0  0                     | endmember flags

0.     1.      0.1     0   | imod = 0 -> cartesian subdivision

begin_excess_function   
W(Fe-FCC Si-FCC)               -125247.7 41.116 0d0 
W(Fe-FCC Fe-FCC Si-FCC)        -142707.6 0d0 0d0 
W(Fe-FCC Si-FCC Si-FCC)         142707.6 0d0 0d0 
W(Fe-FCC Fe-FCC Fe-FCC Si-FCC)   89907.3 0d0 0d0
W(Fe-FCC Fe-FCC Si-FCC Si-FCC) -179814.6 0d0 0d0
W(Fe-FCC Si-FCC Si-FCC Si-FCC)   89907.3 0d0 0d0
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(Fe) = 1 Fe-FCC

reach_increment 3

end_of_model          
                            --------------------------------------------------------
begin_model 
                           | BCC Fe-Si alloy after Lacaze and Sundman (1990) Metal. Trans 22A:1991-2211
                           | because the order/disorder formulation implemented in this model is thermodynamically
                           | inconsistent, the model is implemented internally in Perple_X (function gbccfesi).
                           | The information provided below is a stub for the internal implementation and should
                           | not be modified (the compositional limits and subdivision scheme are an exception in 
                           | this regard). 
oFeSi(bcc)
abbreviation BCC
full_name    alloy

29

2

Fe-BCC
Si-BCC

0 0

0.   1.   0.1 0            | compositional limits and subdivision scheme

ideal

0

end_of_model 
                            --------------------------------------------------------
begin_model 

FeSi_liq
abbreviation Liq
full_name    liquid
2

2
Fe_LIQ 
Si_LIQ
0 0 

0. 1. 0.1 0

begin_excess_function
w(Fe_LIQ Si_LIQ)                      -164434.600  41.9773 0.
w(Fe_LIQ Fe_LIQ Si_LIQ)                   0.000  -21.523 0.
w(Fe_LIQ Si_LIQ Si_LIQ)                   0.000   21.523 0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)         -18821.542   22.070 0.
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ)          37643.080  -44.14  0. 
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)         -18821.542   22.07 0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)   9695.8    0.    0.   | 9695.8
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ)   -29087.4 0.    0.
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)   29087.4  0.   0.
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ Si_LIQ)   -9695.8  0.   0. | 9695.8
end_excess_function

1
2 1.
z(Fe) = 1 Fe_LIQ


end_of_model
                            --------------------------------------------------------
begin_model
                            | Entered by Jeff Marsh, Jan 10, 2012. 

ZrRu                        | zr in rutile after Tomkins et al., 07
abbreviation Ru
full_name    ilmenite


2                           | model type 2
2                           | number of endmembers
zrru  ru

0 0                         | endmember flags

1e-5 1e-4 0.1 1             | non-linear resolution of zrru

begin_excess_function
w(ru zrru)   10000  0  0
end_excess_function 

1                            | 1 site configurational entropy model
2 1.                         | 2 species, site multiplicity = 1.
z(Ti) = 1 ru

end_of_model
                      --------------------------------------------------------  
begin_model
                             | Entered by Jeff Marsh, Jan 10, 2012. 
ZrGt(KP)                     | addition of Ca3Al2[Si2Zr]O12 end-mem after Kelsey & Powell '10
abbreviation Gt
full_name    garnet

2                            | model type: simplicial composition space
                                                                            
4                            | number of endmembers 

zrg     alm      py     gr   | endmember names 

  0  0  0  0                 | endmember flags 

1e-5  1e-4 0.1 1                | imod = 1 -> non-linear subdivision
0.    1.   0.1 0                | imod = 0 -> cartesian subdivision
0.    1.   0.1 0                | imod = 0 -> cartesian subdivision

begin_excess_function
w(py gr)   45000.  0. 0.
w(alm py)   2500.  0. 0.
w(alm gr)  10000.  0. 0.
end_excess_function  

2                                     2 site entropy model
3 3.                                  3 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py

2 2.                                  |2 species, site multiplicity 2
z(Zr) = 1 zrg

end_of_model     
                      --------------------------------------------------------
begin_model                
                                      Silica Fluid

                                      this is a hybrid EoS, the EoS used for the
                                      individual species are controlled by the 
                                      hybrid_EoS_XXX option.

Si-Fluid 
abbreviation F
full_name    fluid

0                          | model type: Internal EoS
2                                  
O        SIO     
  0  0                                endmember flags
0.0 1.0 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision

ideal
0

reach_increment 3 

end_of_model
                      --------------------------------------------------------
begin_model                
                      COH-Fluid Generic Hybrid Fluid EoS with linear Subdivision,
                      see COH-Fluid+ for the non-linear subdivision version of this model.

                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
                      --------------------------------------------------------

COH-Fluid
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
9
CO2
CH4
H2S
SO2
H2
CO
N2
NH3
H2O


0 0 0 0 0 0 0 0 0          | endmember flags

0. 1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision

ideal                      | the fluid is non-ideal, this tag means only no excess function

0

reach_increment 0 

end_of_model
                      --------------------------------------------------------
begin_model
                      COH-Fluid+ Generic Hybrid Fluid EoS with non-linear Subdivision.

                      see COH-Fluid for the linear subdivision version of this model. 

                      See the header of this file for an explanation of non-linear
                      subdivision parameters.

                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
                      --------------------------------------------------------
COH-Fluid+
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
7
CO2
CH4
H2S
SO2
H2
CO
H2O


0 0 0 0 0 0 0 0             | endmember flags

1e-5   3e-1      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1.        .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-3      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   2.5e-5    .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision

ideal

0

reach_increment 0 

end_of_model           
                      --------------------------------------------------------
begin_model                
                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
WADDAH 
abbreviation F
full_name fluid

39                          | model type: Generic Hybrid EoS
1
H2O 

0                           | endmember flags

ideal

0                           | ideal configurational entropy

end_of_model                 
                      --------------------------------------------------------
begin_model                
                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
C-H-Fluid 
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
3
C2H6
CH4
H2 

  0  0  0                              endmember flags

0.0 1.0 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0.0 1.0 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision

ideal

0                          | ideal configurational entropy

reach_increment 3 

end_of_model              

                      --------------------------------------------------------
begin_model                
                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
HOS-Fluid 
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
4
H2S
SO2
H2
H2O

0  0  0  0                 | endmember flags

0.0 1.0 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0.0 1.0 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0.0 1.0 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision

ideal

0                           | ideal configurational entropy

reach_increment 3 

end_of_model              


                      --------------------------------------------------------
begin_model                
                                      majoritic garnet from stixrude '11
                                    

Maj  
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space                                                                       

4                                     number of endmembers 
maj     alm      py       gr         endmember names 

  1  0  0  0                        | endmember flags

0. 0.2  0.1 0              | imod = 1 -> asymmetric transform subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
                           | NOTE restricted subdivision range on Mn (Species 1)!

begin_excess_function
w(py gr) 33000. 0. 0.  
w(alm py)  2500.  0. 0.               | hp '98 give 2.4 kJ
W(gr maj)  58d3   0. 0. 
W(py maj)  21.3d3 0. 0.
end_excess_function  

2                                     2 site entropy model

3 3.                                  3 species, A site multiplicity 3
z(Fe) = 1 alm
z(Ca) = 1 gr

3 2.                                  2 species, B site multiplicity 2
z(Mg) = 1/2 maj
z(Si) = 1/2 maj

reach_increment 4

end_of_model  
                      --------------------------------------------------------
begin_model               

Wad
abbreviation Wad
full_name    wadleysite

2                                 | model type: simplicial composition space
2                                 | 2 endmembers
mwd       fwd            
  0  0                            | endmember flags
0. 1. .1    0                     | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(mwd fwd) 16.5d3 0. 0.     
end_excess_function 
1                                     1 site entropy model
2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 mwd
end_of_model               
                      --------------------------------------------------------
begin_model                

Ring
abbreviation Ring
full_name    ringwoodite

2                                 | model type: simplicial composition space
2                                 | 2 endmembers
mrw       frw            
  0  0                            | endmember flags
0. 1. .1   0                      | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(mrw frw) 9.1d3 0. 0.          
end_excess_function 
1                                     1 site entropy model
2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 mrw

reach_increment 4

end_of_model
                      --------------------------------------------------------
begin_model                

Wus  
abbreviation Wus
full_name    wuestite
                                                          
2                                     model type: simplicial composition space
2                                     2 endmembers
per       fper            
  0  0                           
0.0 1.0  0.1 0                   
  
begin_excess_function
W(per fper)  13d3 0. 0.            
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(mg) = 1 per

reach_increment 4

end_of_model                           
                      --------------------------------------------------------
begin_model                
                                  | akimotoite (ilmenite-structure) solution
Aki                  
abbreviation Aki
full_name    ilmenite
                                                                               
2                                 | model type: simplicial composition space
3                                 | 3 endmembers
cor   mak   fak           
  0  0  0                         | endmember flags
0.0 1.  0.1  0                    | subdivision range, imod = 0 -> cartesian subdivision
0.0 1.  0.1  0                    | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function                                                
W(mak cor)  66d3  0. 0. 
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 mak
z(fe) = 1 fak

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model               
                      --------------------------------------------------------
begin_model                

Pv                
abbreviation Pv
full_name    perovskite
                                                               
2                                 | model type: simplicial composition space
3                                 | 3 endmembers
apv   mpv   fpv            
  0  0  0                          
0. 1.  0.1 0              
0. 1.  0.1 0             

begin_excess_function
W(mpv apv)   116d3 0. 0.            
end_excess_function 

2                                     2 site entropy model
3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 mpv
z(fe) = 1 fpv
2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 apv

begin_van_laar_sizes                        
alpha(mpv)     1.0    0.0    0.0                      
alpha(apv)    0.39   0.0    0.0                      
alpha(fpv)    1.0    0.0    0.0
end_van_laar_sizes

reach_increment 4

end_of_model                                                             
                ------------------------------------------------ 
begin_model

FeSiC_liq
abbreviation Liq
full_name    liquid

2

3
Fe_LIQ
Si_LIQ
C_LIQ
0 0 0

0. 1. 0.1 0
0. 1. 0.1 0

begin_excess function
w(Fe_LIQ Si_LIQ C_LIQ)             995155.5667  -495.31  0.
w(Fe_LIQ C_LIQ)                    -124320.0      28.5   0.
w(Fe_LIQ Fe_LIQ C_LIQ)              -19300.0       0.    0.
w(Fe_LIQ C_LIQ C_LIQ)                19300.0       0.    0.
w(Fe_LIQ Fe_LIQ Fe_LIQ C_LIQ)        49260.0     -19.    0.
w(Fe_LIQ Fe_LIQ C_LIQ C_LIQ)        -98520.0      38.    0.
w(Fe_LIQ C_LIQ C_LIQ C_LIQ)          49260.0     -19.    0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)      -18821.542    22.07  0.
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ)       37643.084   -44.14  0.
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)      -18821.542    22.07  0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)  9695.8      0.    0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ) -29087.4     0.    0.
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)  29087.4     0.    0.
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ Si_LIQ)  -9695.8     0.    0.
w(Si_LIQ C_LIQ)                      -133000.0    30.97  0.
w(Fe_LIQ Si_LIQ)                   -164434.6    41.9773  0.
w(Fe_LIQ Fe_LIQ Si_LIQ)                   0.   -21.523   0.
w(Fe_LIQ Si_LIQ Si_LIQ)                   0.    21.523   0.
w(Fe_LIQ Si_LIQ C_LIQ C_LIQ)      -549415.5667   495.31  0.
w(Fe_LIQ Fe_LIQ Si_LIQ C_LIQ)  -0.1001220867d7  495.98   0.
w(Fe_LIQ Si_LIQ Si_LIQ C_LIQ)   0.1550636433d7  -955.29  0.
end_excess_function  

1
3 1.
z(Fe) = 1 Fe_LIQ
z(Si) = 1 Si_LIQ

reach_increment 6

end_of_model
                      --------------------------------------------------------
begin_model                
                            Sapphirine, O/D non-ideal, Taylor-Jones & Powell (JMG, 2010, 28, 615-633)

                            * requires the kel04ver.dat thermodynamic data file (for endmember spr5)

                            Entered June 26, 2013. JADC.


                                                      1      2      3           
                                                      M3     M456   T     
                                                     _________________

                                      Mutliplicity    1      3     1
                                                     _________________

                                      1 spr4          Mg     Mg    Si
                            Species:  2 fspr          Fe     Fe    Si
                                      3 spr5          Al     Mg    Al
                                      4 fsp5_d        Al     Fe    Al        dependent
                                      5 ospr          Fe3+   Mg    Al
                                      6 fospr_d       Fe3+   Fe    Al        dependent 

                                      7 spro          Fe     Mg    Si        ordered

                                      Dependent endmember:

                                      FeMg-1_M3456 = (fspr-spro)/3
 
                                      fsp5_d = spr5 +  fspr - spro
                                      fospro_d = spr5 +  fspr - spro
Sapp(TP)
abbreviation Sap
full_name    sapphirine

8                            | model type, should be 9
2                            | 2 independent mixing sites, reciprocal solution 

2  3                         | 2 components {Fe2+, Mg} for composition 1, 3 components {Al, Si, Fe3+} for composition 2. 
                             
                             | endmember names 
spr4     fspr        
spr5     fsp5_d
ospr     fospr_d

1                            | 1 ordered species:

spro = 3/4 spr4 + 1/4 fspr   enthalpy_of_ordering = -10d3

begin_limits
spro =    - 4/3 fspr - 4/3 ospr - 1/3 spro                 delta = 4/3 z(M3,Mg) 
spro =    - 4/3 fspr            - 1/3 spro                 delta = 4/3 z(M3,Fe) 
spro = -4 - 4   fspr +   1 ospr - 4 spr5     + 1 spro      delta = 4   z(M456,Mg)   
end_limits                

2                            | 2 dependent endmembers

fsp5_d   = 1 spr5 +  1 fspr - 1 spro
fospr_d  = 1 spr5 +  1 fspr - 1 spro

0 0 0 0 0 0                | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0. 1. .1   0               | range and resolution of X(Mg), subdivision scheme for site 1: imod = 0 -> cartesian 

                           | subdivision model for (ternary) site 2 
0. 1. .1   0               | range and resolution of X(Ts), subdivision scheme for site 3, species 1: imod = 0 -> cartesian   
0. 1. .1   0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian   


begin_excess_function 
W(spr4 spr5)              10d3         0         0
W(spr4 fspr)              16d3         0         0
W(spr4 spro)               4d3         0         0
W(spr4 ospr)              10d3         0         0
W(spr5 fspr)              22d3         0         0
W(spr5 spro)              10d3         0         0
W(fspr spro)              12d3         0         0
W(fspr ospr)              22d3         0         0
W(spro ospr)              10d3         0         0
end_excess_function 

3                          | 3 site (M3, M456, T) configurational entropy model

2 3.                       | 2 species on M46, 3 sites per formula unit
z(m456,fe) = 1 fspr

4 1.                       | 4 species on M3, 1 sites per formula unit.
z(m3,Al)  = 1 spr5 
z(m3,Fe3) = 1 ospr
z(m3,mg)  = 1 spr4

2 1.                       | 2 species on T, 1 sites per formula unit.
z(T,si) = 1 spr4 + 1 fspr + 1 spro

begin_dqf_corrections
dqf(fspr)   -3d3 0. 0.
end_dqf_corrections      

end_of_model               

                      --------------------------------------------------------
begin_model                
                                      |Calcite-Magnesite with Dolomite/Ankerite compound formation.
                                      |Franzolin, Schmidt and Poli (2011) CMP 161:213-227, DOI: 10.1007/s00410-010-0527-x

                                      | WARNINGS:

                                      | This model requires make definitions in the thermodynamic data file for the 
                                      | odo_ef and oank endmembers.  JADC, 3/26/2012. 
oCcM(EF) 
abbreviation Do
full_name    carbonate

2                                     |model type
5                                     |number of endmembers
mag      cc     odo   sid   oank    
0  0  0   0   0                       |endmember flags
0. 1. 0.1  0                          |range and increments on X(cc)
0. 1. 0.1  0
0. 1. 0.1  0
0. 1. 0.1  0                          |range and increments on X(mag)

begin_excess_function
w(mag cc)  28000 0 0
w(cc odo) 11200 0 0.0 
w(mag odo)  14000 0 0
W(cc sid)  20503 0 0
w(oank sid) 73650 -50 0
w(oank cc) 12730 -10 0
w(mag sid) 10000 0 0
w(sid odo) 51190 -30 0
w(oank odo) -5000 0 0
w(oank mag) 30000 0 0 
end_excess_function  

3                                     |3 site (m1  m2a  m2b) entropy model 

3 0.5                                 |3 species on m1, mutiplicity = 1/2
z(m1,ca) =   1 cc + 1 odo + 1 oank
z(m1,mg) =   1 mag 

3 0.25                                 |3 species on m2a, mult. = 1/4
z(m2a,ca) =  1 cc  
z(m2a,mg) =  1 mag + 1 odo 

3 0.25                                 |3 species on m2b, mult. = 1/4
z(m2b,ca) =  1 cc  
z(m2b,mg) =  1 mag + 1 odo + 1 oank

begin_van_laar_sizes                        
alpha(cc)     0.25 0.000929 0                      
alpha(mag)    1 0. 0.0                     
alpha(odo)    0.95 0.0 0 
alpha(sid)    0.01 0.000666 0
alpha(oank)   0.929 0 0
end_van_laar_sizes

end_of_model
                                  --------------------------------------------------------	
begin_model
                                      |Magnesite-Siderite melt, nathan kang, 4/2015. 
LIQ(NK)
abbreviation Liq
full_name    liquid

2                                     |model type
2                                     |number of endmembers
MGCO3L FECO3L
  0  0                                |endmember flags
0. 1. 0.1  0                          |range and increments on X(Fe) 

begin_excess_function
W(FECO3L MGCO3L MGCO3L)      -7600. 0. 0. |W_sid-mag = W12
W(MGCO3L FECO3L FECO3L)      -7600. 0. 0. |W_mag-sid = W21
end_excess_function 

1                                     |1 site entropy model

2 1                                   |2 species, multiplicity = 1
z(fe) = 1 FECO3L 
end_of_model    
                      --------------------------------------------------------
begin_model                

LIQ(EF)
abbreviation Liq
full_name    liquid

2                                     |model type
3                                     |number of endmembers
CACO3L MGCO3L FECO3L
  0  0  0                             |endmember flags
0. 1. 0.1  0 
0. 1. 0.1  0                          | range and increments on X(cc)

begin_excess_function
W(CACO3L CACO3L FECO3L)  -65000 0. 0.
W(CACO3L FECO3L FECO3L)  2000 0. 0.
W(MGCO3L MGCO3L CACO3L)  491900 -300. 0.
W(MGCO3L CACO3L CACO3L)  -142000. 0. 1.2
W(MGCO3L MGCO3L FECO3L)  -5594.2 0. 0.
W(MGCO3L FECO3L FECO3L)  -5594.2 0. 0.
W(CACO3L FECO3L MGCO3L) 0. 0. 0.
end_excess_function 

1                                    

3 1                                 
z(ca) = 1 CACO3L 
z(fe) = 1 FECO3L
 
end_of_model
                           --------------------------------------------------------
begin_model                
                                      |EF disordered ternary carb
dis(EF)     
abbreviation Cc
full_name    carbonate

2                                     |model type 
3                                     |number of endmembers
mag      cc      sid    
  0  0  0                             | endmember flags
0. 1. 0.1  0                          | range and increments on X(cc)
0. 1. 0.1  0

begin_excess_function             
w(mag cc)  28000 0 0
W(cc sid)  20503 0 0
w(mag sid) 10000 0 0
end_excess_function  

1                                     |1 site entropy model 

3 1                                   |3 species on m, mutiplicity = 1

z(ca) = 1 cc 
z(mg) = 1 mag 
              

begin_van_laar_sizes                        
alpha(cc)     0.25 0.000929 0                      
alpha(mag)    1 0. 0.0                     
alpha(sid)    0.01 0.000666 0
end_van_laar_sizes

end_of_model
                          --------------------------------------------------------
begin_model 
                                  Silicate gas, Lewis and Randal (Ideal) Mixing, the
                                  EoS used for the pure species is determined by the 
                                  EoS flag specified for the species in the thermodynamic
                                  data file
Si-vapor
abbreviation gas
full_name    gas

2

7                                     number of endmembers
                                 
                                    | ENDMEMBER NAMES:                               
SiO2                                
SiO
Si
O2
O
MgO
| Mg commented out so entropy model can be read without changing parameter m11
FeO
| Fe

0 0 0 0 0 0 0 0 0                   | endmember flags.  

0.0 1.0  0.1 0                      | range and resolution of X(SiO2), 0 => cartesian subdivision/1 => asymmetric subdivision   
0.0 0.5  0.1 0                      | range and resolution of X(SiO)  
0.0 0.5  0.1 0                      | range and resolution of X(Si)   
0.0 0.5  0.1 0                      | range and resolution of X(O2)  
0.0 0.5  0.1 0                      | range and resolution of X(O)   
0.0 0.5  0.1 0                      | range and resolution of X(MgO)
| 0.0 0.5  0.1 0                      | range and resolution of X(Mg)
|0.0 0.5  0.1 0                      | range and resolution of X(FeO)

ideal

  1                                 | molecular configurational entropy model 
7 1.                                | 6 species, multiplicity 1

z(SiO2)  = 1 SiO2 
z(SiO)   = 1 SiO
z(O2)   = 1 O2
z(O)   = 1 O
| z(Mg)  = 1 Mg
| z(Fe)  = 1 Fe
z(FeO) = 1 FeO
z(MgO) = 1 MgO

end_of_model
                          --------------------------------------------------------
begin_model 
                                  Silicate gas, Lewis and Randal (Ideal) Mixing, the
                                  EoS used for the pure species is determined by the 
                                  EoS flag specified for the species in the thermodynamic
                                  data file
CCO-vapor
abbreviation gas
full_name    gas

2 

7                                    number of endmembers
                                    | ENDMEMBER NAMES:                               
CO2                                
CO
O2
| xO(g)
xMgO(g)
xMg(g)
xFeO(g)
xFe(g)

0 0 0 0 0 0 0 0 0                   | endmember flags.  

0.0 1.0  0.1 0                      | range and resolution of X(CO2), 0 => cartesian subdivision/1 => asymmetric subdivision   
0.0 1.0  0.1 0                      | range and resolution of X(CO)  
0.0 0.5  0.1 1                      | range and resolution of X(O2)  
|0.0 0.5  0.1 1                      | range and resolution of X(O)   
0.0 0.5  0.1 1                      | range and resolution of X(MgO)
0.0 0.5  0.1 1                      | range and resolution of X(Mg)
0.0 0.5  0.1 1                      | range and resolution of X(FeO)

ideal

  1                                 | molecular configurational entropy model 
7 1.                                | 6 species, multiplicity 1

z(CO2)  = 1 CO2 
z(CO)   = 1 CO
z(O2)   = 1 O2
| z(O)   = 1 xO(g)
z(Mg)  = 1 xMg(g)
z(Fe)  = 1 xFe(g)
z(FeO) = 1 xFeO(g)

end_of_model
                          --------------------------------------------------------
begin_model 
                                  Formally this need not be an ideal gas, but it assumes Lewis and Randall
                                  (Ideal) mixing, the EoS (e.g., ideal gas) used for the pure species is 
                                  determined by the EoS flag specified for the species in the thermodynamic
                                  data file                                  
ideal_gas
abbreviation gas
full_name    gas
                                    
2                                   | model type 
6                                   | number of species
                                    | species
O2(g)  
O(g)                              
Mg(g)
Fe(g)
FeO(g)
MgO(g)

0 0 0 0 0 0                         | endmember flags.  

0.0 1.   0.1 0                      | range and resolution of X(O2), 0 => cartesian subdivision/1 
0.0 1.   0.1 0                      | range and resolution of X(O)  
0.0 1.   0.1 0                      | range and resolution of X(Mg)   
0.0 1.   0.1 0                      | range and resolution of X(Fe)  
0.0 1.   0.1 0                      | range and resolution of X(MgO)  

ideal

  1                                 | molecular configurational entropy model 
6 1.                                | 6 species, multiplicity 1

z(O2)  = 1 O2(g)  
z(O)   = 1 O(g)                              
z(Mg)  = 1 Mg(g)
z(Fe)  = 1 Fe(g)
z(FeO) = 1 FeO(g)

end_of_model
                                  --------------------------------------------------------
begin_model
FeSiC-BCC
abbreviation BCC
full_name    alloy
30                                | model type: special prismatic (Lacaze & Sundman, 1991)
2                                 | number of independent mixing sites, reciprocal solution
2  2                              | Fe-Si on site 1, Vacancy-C on site 2
Fe-BCC Si-BCC                     | endmember names 
FeC-BCC SiC-BCC
0                                 | number of dependent endmembers 
0  0  0  0                        | endmember flags
0.  1.   0.1  0                   | imod = 0 -> Fe fraction on site 1
0.  1.   0.1  0                   | imod = 0 -> vacancy fraction on site 2
ideal                             | internal excess model
0                                 | 0 site entropy model -> internal model
reach_increment 3
end_of_model 
                           --------------------------------------------------------
begin_model  
FeSiC-FCC
abbreviation FCC
full_name    alloy
31                                | model type: special prismatic (Lacaze & Sundman, 1991)
2                                 | number of independent mixing sites, reciprocal solution
2  2                              | Fe-Si on site 1, Vacancy-C on site 2
Fe-FCC Si-FCC                     | endmember names 
FeC-FCC SiC-FCC
0                                 | number of dependent endmembers 
0  0  0  0                        | endmember flags
0.  1.   0.1  0                   | imod = 0 -> Fe fraction on site 1
0.  1.   0.1  0                   | imod = 0 -> vacancy fraction on site 2
ideal                             | internal excess model
0                                 | 0 site entropy model -> internal model
reach_increment 3
end_of_model 
                           --------------------------------------------------------
begin_model
                           |FeCr-liquid solution model after Xiong et al., 2011
                           |G. Helffrich, April 2016
FeCr(liq)
abbreviation Liq
full_name    liquid
2                          |model type: simplicial composition space.
2                          |2 endmembers 
Fe_LIQ
Cr_LIQ
  0  0                     |endmember flags
0.     1.      0.1     0   |imod = 0 -> cartesian subdivision
begin_excess_function   
Wk(Cr_LIQ Fe_LIQ)
w0 = 0. wT = -5.983
w0 = -384.41
end_excess_function
1                                     1 site entropy model
2 1.                                  2 species, site multiplicity = 1.
z(Fe) = 1 Fe_LIQ
reach_increment 3
end_of_model
                           --------------------------------------------------------
begin_model                
                           |FeCr-FCC solution model after Xiong et al., 2011
                           |G. Helffrich, April 2016
FeCr-FCC
abbreviation FCC
full_name    alloy
2                          |model type: simplicial composition space.
2                          |2 endmembers 
Fe-FCC
Cr-FCC
0  0                       |endmember flags
0.     1.      0.1     0   |imod = 0 -> cartesian subdivision
begin_excess_function   
Wk(Cr-FCC Fe-FCC)
w0 = 28871.89 wT = -22.318
w0 = 32711.42 wT = -18.180
end_excess_function 
1                            1 site entropy model
2 1.                         2 species, site multiplicity = 1.
z(Fe) = 1 Fe-FCC
reach_increment 3
end_of_model
                           --------------------------------------------------------
begin_model 
                           |BCC Fe-Cr alloy after Xiong et al., 2011, with the contribution from magnetic ordering
FeCr-BCC 
abbreviation BCC
full_name    alloy
32                         |special solution model
2                          |2 end-members
Fe-BCC
Cr-BCC
0 0
0.   1.   0.1 0            |compositional limits and subdivision scheme
ideal
0
reach_increment 3
end_of_model 
                           --------------------------------------------------------
begin_model
                           |FeCr-sigma solution model after Andersson & Sundman,
                           |1987, which is based on 30 sites and mixing on 18.
                           |This source defines no excess mixing for the soln.,
                           |but it is needed to stabilize the sigma phase.  One
                           |cause might be use of the Xiong et al. (2011) for
                           |BCC Fe-Cr.  As it is, this frankenstein-like mix
                           |of parts from Andersson & Sundman '87 and Xiong
                           |et al. '11 works concisely to reproduce the
                           |subsolidus and melting relations.
                           |                        G. Helffrich, ELSI, 8 Apr. 2016.
FeCr-s
abbreviation Sigma
full_name    alloy
2                          |solution model type
2                          |2 endmembers 
FeCr_sig 
CrFe_sig 
0  0                       |endmember flags
0.     1.      0.1     0   |imod = 0 -> cartesian subdivision
begin_excess_function   
W(FeCr_sig CrFe_sig)       -1936.273 -0.5671667 0 | original from Nastia: -11617.64  -3.403  0
end_excess_function 
1                          |1 site entropy model 
| Nastia's version: 2 0.5333                   |2 species, 1 site multiplicity = 16/30
2 0.6                      |2 species, 1 site, multiplicity = 18/30
z(Fe) = 1. FeCr_sig 
reach_increment 3
end_of_model
                           --------------------------------------------------------
begin_model
                           |solution model parameters after Brosh, 2013
FeCliq
abbreviation Liq
full_name    liquid
2                          |solution model type: simplicial composition space
2                          |2 end-members
Feliq
Cliq
0 0                        |end-member flags
0. 1. 0.1 0                |imod = 0 -> cartesian subdivision scheme
begin_excess_function
Wk(Feliq Cliq)
w0 = -124320. wT = 28.5  wP = -1.53d-1 wP1 = 6d4 wP2 = 2.3d-1
w0 = 19300.   
w0 = 49260.   wT = -19.
end_excess_function
1                          |one site entropy model
2 1.                       |two end-members mixing on one site and site multiplicity
z(Fe) = 1 Feliq            |site fraction of Fe on this site in terms of end-members

reach_increment 10

end_of_model
                           --------------------------------------------------------
begin_model 
                           | solution model parameters after Brosh, 2013
FeCfcc
abbreviation FCC
full_name    alloy
2
2
FeA1
FeCA1
0 0 
0. 1. 0.1 0
begin_excess_function
Wk(FeA1 FeCA1)
w0 = -34671. 
end_excess_function
1
2 1.
z(C) = 1 FeCA1

reach_increment 10

end_of_model
                           --------------------------------------------------------
begin_model
                           |solution model parameters after Brosh, 2013 
FeCbcc
abbreviation BCC
full_name    alloy
2
2
FeA2
FeCA2
0 0 
0. 1. 0.1 0
begin_excess_function
Wk(FeA2 FeCA2)
w0 = 0. wT = -190. 
end_excess_function
1
2 3.
z(c) = 1 FeCA2
end_of_model
                    --------------------------------------------------------
begin_model        

                    Ilmenite after White, RW, Powell, R, Holland, TJB & Worley, BA (2000, JMG), modified
                    as described by White et al (2014).

                    Green et al (2016) remark this modification "may be suspect" and use the original 2000 model, 
                    i.e., that obtained by excluding geikielite.

                                                      A                B     
                                                     _____________________

                                      Mutliplicity    1                1
                                                     _____________________

                                      1 oilm          Fe                Ti       
                            Species:  2 dilm          TiFe              TiFe   
                                      3 hem           Fe3+              Fe3+  
                                      4 pnt           Mn                Ti  
                                      5 geik          Mg                Ti       
                                                           
                     Previously present as a brute force model which did not allow the anti-ordered 
                     ilmenite configuration. Re-formulated as standard o/d model to remove this 
                     limitation, JADC Jan 14, 2017.

                                  NOTES:
                                  
                                  Requires that the endmember ilm_nol be created from the endmember ilm
                                  in the thermodynamic data file by eliminating the Landau transition from 
                                  the ilm endmember, additionally the following make definitions must be
                                  present in the thermodynamic file.

                                  dilm = 1 ilm_nol  
                                        | 1993  -2.1 0 => the TC DQF coeffecients, the values below are
                                        | smax*tc0*(q0^2-1/3*q0^6), -smax*q0^2, vmax*q0^2 + {DH,R*ln(4),0} 
                                         15789.27763 -12.19977769  .1836386612d-1

                                  The ilm and ilm_nol endmembers should be excluded from calculations
                                  to avoid conflicts with this model.

                                  For Mg and Mn solution this model differs from the Thermocalc version in 
                                  that Mg and Mn are confined to the A-site, in contrast in Thermocalc the 
                                  "equipartition" assumption is used to allocate Mg and Mn to the B-site in
                                  proportion to the Ferrous iron intersite partitioning. Consequently, this
                                  model predicts lower Mn and Mg solubility in ilmenite than the Thermocalc
                                  version of the model. 
                                  
                                                                       JADC, Oct 29, 2011.

                                  Added W(pnt oilm). Felix Gervais, Oct 29, 2011. 

                                  Corrected to count Ti in A-site configurational entropy. JADC, Jun 16, 2013. 

                                  Make definitions corrected from the raw thermocalc versions. JADC, Jun 19, 2013.

Ilm(WPH)
abbreviation Ilm
full_name    ilmenite

6                          | model type
4                          | 4 endmembers
pnt 
geik
hem
dilm

1                            | 1 ordered species:

oilm = 1 dilm   enthalpy_of_ordering = -15600 + 11.52565132 T_K

begin_limits
oilm =    -2 + 1 dilm                   delta = 2 z(A,Ti) 
end_limits

0 0 0  0                   | endmember flags

0. .2 0.1 0                | subdivision range, X(pnt), imod = 1 -> assymetric
0. .2 0.1 0                | subdivision range, X(geik), imod = 1 -> assymetric
0. 1. 0.1 0                | subdivision range, X(hem), imod = 0 -> cartesian subdivision


begin_excess_function
W(oilm dilm)    15600
W(oilm hem)     26600
W(dilm hem)     11000
W(oilm pnt)      1760
end_excess_function

2                          | 2 site model
 
5 1.                       | A - Fe2+ Mn Fe3+ Mg Ti
z(A,Mg)   = 1 geik
z(A,mn)   = 1 pnt
z(A,fe3+) = 1 hem
z(A,ti)   = 1/2 dilm

3 1.                       | B - Fe3+ Ti4+ Fe2+
z(b,fe3+) = 1 hem
z(b,fe2+) = 1/2 dilm

refine_endmembers

end_of_model
                      --------------------------------------------------------
begin_model

        Majoritic garnet, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        * originally entered by Bob Myhill, 2018/02/13

        * reformulated as a prismatic + orphan (nagt) vertex model. JADC, May 10, 2018

        * added cnagt and fnagt and changed the orphan to maj. JADC, Nov 2, 2018.

                                                      M1           M2   
                                                     ____________

                                      Multiplicity    3            2
                                                     ___________________

                                        nagt          Mg2/3Na1/3   AlSi   independent
                                        fnagt         Fe2/3Na1/3   AlSi   dependent
                                        cnagt         Ca2/3Na1/3   AlSi   dependent

                                        py            Mg           AlAl   independent   
                                        alm           Fe           AlAl   independent
                                        gr            Ca           AlAl   independent

                                        fmaj_d        Fe           FeSi   dependent
                                        cmaj_d        Ca           MgSi   dependent
                                        cfmaj_d       Ca           FeSi   dependent
                                                     ___________________

                         Orphan         maj           Mg           MgSi   independent
                                                     ___________________

                                     13 gfm           Mg           FeSi   ordered (same as gfm_d, above)

           alternative dual prism 5d target formulation => 
                                                     ___________________
                           Prism I    5 maj           Mg           MgSi   independent
                                      7 cmaj_d        Ca           MgSi   dependent

                                      6 fmaj_d        Fe           FeSi   dependent
                                     11 cfmaj_d       Ca           FeSi   dependent
                                                     ___________________
                           Prism II   3 gr            Ca           AlAl   independent
                                      1 py            Mg           AlAl   independent
                                      2 alm           Fe           AlAl   independent

                                      4 cnagt         Ca2/3Na1/3   AlSi   dependent
                                      4 nagt          Mg2/3Na1/3   AlSi   independent
                                      4 fnagt         Fe2/3Na1/3   AlSi   dependent
                                                     ___________________

                                     13 gfm           Mg           FeSi   ordered (same as gfm_d, above)

Gt(H)
abbreviation Gt
full_name    High pressure garnet

9                               | model type: prism + orphan
2                               | number of simplexes in prism
3 3                             | number of vertices on each simplex
1                               | number of orphan vertices

                                | endmembers on the prismatic vertex
cnagt_d  fnagt_d     nagt       | ternary 1
fmaj_d   cfmaj_d     cmmaj_d    | ternary 2
gr       alm         py         | ternary 3

maj                             | the orphan

1                               | ordered species definition

gfm = 1 maj - 1/3 py + 1/3 alm  enthalpy_of_ordering = -10d3

begin_limits
gfm = - 3 py - 2 nagt - 3 maj - 2 gfm                             delta = 3 (limits for Mg on X)
gfm = -3 + 3 alm + 1 gfm                                          delta = 3 (limits for Fe on X)
gfm = -2 + 1 maj + 1 gfm                                          delta = 2 (limits for Mg on Y)
end_limits

5                               | number of dependent endmembers

fnagt_d = 1 nagt + 2/3 alm - 2/3 py
cnagt_d = 1 nagt + 2/3 gr  - 2/3 py

fmaj_d   = 1 gfm  + 1 alm   - 1 py
cmmaj_d  = 1 maj  + 1 gr    - 1 py
cfmaj_d  = 1 gfm  + 1 gr    - 1 py

0  0  0  0 0 0 0 0 0 0 0 0    | endmember flags

0. 1. 0.1  0                  | range and resolution of X(1,1) => X(Ca) in the ternaries
0. 1. 0.1  0                  | range and resolution of X(1,2) => X(Fe) in the ternaries

0. 1. 0.1  0                  | range and resolution of X(2,1) => X(M-nagt)
0. 1. 0.1  0                  | range and resolution of X(2,2) => X(non-Mg-Ts)

0. 1. 0.1  0                  | range and resolution of X(3,1) => X(maj), the orphan

begin_excess_function
w(py alm)      3d3 0. 0.  
w(py gr)      33d3 0. 0.  
w(py maj)     15d3 0. 0.  
w(py gfm)   13.5d3 0. 0.  
w(py nagt)    14d3 0. 0.  
w(alm gr)      5d3 0. 0.  
w(alm maj)    18d3 0. 0.  
w(alm gfm)  16.5d3 0. 0.  
w(alm nagt) 11.2d3 0. 0.  
w(gr maj)     48d3 0. 0.  
w(gr gfm)   46.5d3 0. 0.  
w(gr nagt)    30d3 0. 0.  
w(maj gfm)   0.5d3 0. 0.  
w(maj nagt)  8.5d3 0. 0.  
w(gfm nagt)  7.0d3 0. 0.  
end_excess_function  

2                                     2 site entropy model

4 3.                                  4 species, X site multiplicity 3
z(Fe) = 1 alm
z(Ca) = 1 gr
z(Na) = 1/3 nagt

4 2.                                  4 species, Y site multiplicity 2
z(Mg) = 1/2 maj
z(Fe) = 1/2 gfm
z(Si) = 1/2 maj + 1/2 gfm + 1/2 nagt

end_of_model  
                      --------------------------------------------------------
begin_model               
        Ferropericlase, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035 
        [Bob Myhill, 2018/02/13]     

        Notes:
        This model consists of symmetric mixing of Mg-Fe on 1 site with a multiplicity of 1 

Fper(H)  
abbreviation Fper
full_name    ferropericlase
                                                          
2                                     model type: Margules, macroscopic
2                                     2 endmembers
per       fper            
  0  0                           
0.0 1.0  0.1 0                   
  
begin_excess_function
W(per fper)  18d3 0. 0.            
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model
                      --------------------------------------------------------
begin_model                

        MgSi perovskite, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        [Bob Myhill, 2018/02/13]
          
        Notes:
        Identical to CaSi perovskite, but with different dqfs for all the endmembers

        Requires the following make definitions in the endmember data file:
             mfpv = 1 fpv
                  DQF(J/mol) = -9500 0 0
             mcpv = 1 cpv
                  DQF(J/mol) = 60000 0 0
             mnpv = 1 npv
                  DQF(J/mol) = 16000 0 0
        
        This model consists of symmetric mixing on 2 sites, each with a multiplicity of 1:

                                                      1           2             
                                                      M1          M2      
                                                     ________________

                                      Multiplicity    1           1
                                                     ________________

                                      1 mpv           Mg           Si       
                            Species:  2 mfpv          Fe2+         Si
                                      3 mcpv          Ca           Si 
                                      4 apv           Al           Al 
                                      5 mnpv          Na1/2Al1/2   Si
                                      
Mpv(H)                
abbreviation Mpv
full_name    MgSi Perovskite

2                                 | model type: Margules, macroscopic
5                                 | 5 endmembers

mpv mfpv mcpv apv mnpv
  0   0   0   0   0               | endmember flags

0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision

begin_excess_function
w(mpv mfpv)    12d3   0. 0.  
w(mpv mcpv)    15d3   0. 0.               
W(mpv apv)     20d3   0. 0. 
W(mpv mnpv)    22d3   0. 0.
w(mfpv mcpv) 10.5d3   0. 0.               
W(mfpv apv)    14d3   0. 0. 
W(mfpv mnpv) 15.4d3   0. 0.            
W(mcpv apv)     5d3   0. 0. 
W(mcpv mnpv)  7.5d3   0. 0.
W(apv mnpv)   2.5d3   0. 0.
end_excess_function  

2                                     2 site entropy model

5 1.                                  5 species, M1 site multiplicity 1
z(Mg) = 1 mpv
z(Fe) = 1 mfpv
z(Ca) = 1 mcpv
z(Na) = 1/2 mnpv

2 1.                                  2 species, M2 site multiplicity 1
z(Al) = 1 apv

end_of_model
                      --------------------------------------------------------
begin_model                
        CaSi perovskite
        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035
        [Bob Myhill, 2018/02/13]

        Notes:
        Identical to MgSi perovskite, but with different dqfs for all the endmembers

        Requires the following make definitions in the endmember data file:
             cmpv = 1 mpv
                    DQF(J/mol) = 35000 0 0
             cfpv = 1 fpv
                    DQF(J/mol) = 24000 0 0
             capv = 1 apv
                    DQF(J/mol) = 45000 0 0
             cnpv = 1 npv
                    DQF(J/mol) = 25000 0 0

                                                      1           2             
                                                      M1          M2      
                                                     ________________

                                      Multiplicity    1           1
                                                     ________________

                                      1 cmpv          Mg           Si       
                            Species:  2 cfpv          Fe2+         Si
                                      3 cpv           Ca           Si 
                                      4 capv          Al           Al 
                                      5 cnpv          Na1/2Al1/2   Si
                                      
Cpv(H)                
abbreviation Cpv
full_name    CaSi Perovskite

2                                 | model type: Margules, macroscopic
5                                 | 5 endmembers

cmpv cfpv cpv capv cnpv
  0   0   0   0   0               | endmember flags

0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision

begin_excess_function
W(cmpv cfpv)    12d3   0. 0.  
W(cmpv cpv)     15d3   0. 0.               
W(cmpv capv)    20d3   0. 0. 
W(cmpv cnpv)    22d3   0. 0.
W(cfpv cpv)   10.5d3   0. 0.               
W(cfpv capv)    14d3   0. 0. 
W(cfpv cnpv)  15.4d3   0. 0.            
W(cpv capv)      5d3   0. 0. 
W(cpv cnpv)    7.5d3   0. 0.
W(capv cnpv)   2.5d3   0. 0.
end_excess_function  

2                                     2 site entropy model

5 1.                                  5 species, M1 site multiplicity 1
z(Mg) = 1 cmpv
z(Fe) = 1 cfpv
z(Ca) = 1 cpv
z(Na) = 1/2 cnpv

2 1.                                  2 species, M2 site multiplicity 1
z(Al) = 1 capv

end_of_model
                      --------------------------------------------------------
begin_model                
        Corundum
        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035      
        [Bob Myhill, 2018/02/13]

        Notes:
        Requires the following make definition in the endmember data file:
             fcor = 1 mcor + 1 fak - 1 mak  
                    DQF(J/mol) = -15d3 0 0

                                                      1       2             
                                                      M       T      
                                                     _____________

                                      Multiplicity    1       1
                                                     _____________

                                      1 cor           Al      Al       
                            Species:  2 mcor          Mg      Si
                                      3 fcor          Fe2+    Si 
Cor(H)                
abbreviation Cor
full_name    Corundum
                                                               
2                                 | model type: Margules, macroscopic
3                                 | 3 endmembers
cor   mcor   fcor           
  0  0  0                          
0. 1.  0.1 0              
0. 1.  0.1 0             

begin_excess_function
W(cor mcor)     12d3 0. 0.
W(cor fcor)     10d3 0. 0.
W(mcor fcor)    4d3 0. 0.            
end_excess_function 

2                                     2 site entropy model
3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 mcor
z(fe) = 1 fcor
2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model

        High pressure calcium-ferrite structure phase, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035  

        Notes:

        * originally entered by Bob Myhill, 2018/02/13.

        * reformulated as a prismatic + orphan vertex model. JADC, 10/5/2018

        * eliminated ordered dependent endmembers. JADC, 10/2018

        * Requires the following make definition in the endmember data file
             nacfb = 1 nacf
                   DQF(J/mol) = -9000 0 0
          This dqf was presumably added by Holland et al. as a free parameter
          during inversion, and not reintegrated into their data table.

        * The M2 site has a fake multiplicity of 1 (true multiplicity would be 2).

                                                      M3      M2
                                                     ____________

                                      Multiplicity    1       1(2)
                                                     ____________

                        Prism I:      1 macf          Mg      Al1/2Al1/2  independent
                                      5 mscf          Mg      Mg1/2Si1/2  independent
                                      7 cscf_d        Ca      Mg1/2Si1/2  dependent

                                      2 facf_d        Fe      Al1/2Al1/2  dependent
                                     10 fscf          Fe      Fe1/2Si1/2  independent
                                     11 cfscf_d       Ca      Fe1/2Si1/2  dependent
                                                     ____________
                        Orphans:
                                      3 cacf          Ca      Al1/2Al1/2  independent
                                      4 nacfb         Na      Al1/2Si1/2  independent (orphan)
                                                     ____________

                            Ordered: 13 oscf          Fe2+    Mg1/2Si1/2  (same as oscf_d above)

CFer(H)     
abbreviation CFer
full_name    Ca-ferrite type

9                               | model type: prismatic + orphan vertices, O/D
                                                                       
2                               | number of simplexes comprising the prism
3 2                             | vertices on each prism
2                               | number of orphan vertices
                                | endmembers on the prismatic vertex
macf    cscf_d   mscf
facf_d  cfscf_d  fscf
                                | endmembers on the orphan vertices
nacfb
cacf

1                               | ordered species definition

oscf = 1/2 mscf + 1/2 fscf enthalpy_of_ordering = -3.5d3

begin_limits
oscf = -2 + 2 macf + 2 mscf + 1 oscf                              delta = 2 (limits for Mg on M3)
oscf = -2 fscf - 1 oscf                                           delta = 2 (limits for Fe on M3)
oscf = -2 mscf - 1 oscf                                           delta = 4 (limits for Mg on M2)
oscf = -4 + 2 fscf + 1 oscf                                       delta = 4 (limits for Fe on M2)
end_limits

3                               | number of dependent endmembers

facf_d  = 1 macf + 1 oscf - 1 mscf
cscf_d  = 1 cacf + 1 mscf - 1 macf
cfscf_d = 1 cacf + 1 fscf - 1 macf - 1 oscf + 1 mscf


0  0  0  0  0  0  0  0  0  0    | endmember flags

0. 1. 0.1  0                  | range and resolution of X(AlAl)
0. 1. 0.1  0                  | range and resolution of X(CaM)

0. 1. 0.1  0                  | range and resolution of X(Mg)

0. 1. 0.1  0                  | range and resolution of nacfb
0. 1. 0.1  0                  | range and resolution of cacf

begin_excess_function
w(macf cacf)       11d3
w(macf mscf)      7.5d3
w(macf fscf)    10.75d3
w(macf oscf)     11.5d3
w(macf nacfb)    24.5d3

w(cacf mscf)     18.5d3
w(cacf fscf)    14.45d3
w(cacf oscf)     15.2d3
w(cacf nacfb)    18.5d3

w(mscf fscf)        5d3
w(mscf oscf)        4d3
w(mscf nacfb)    15.5d3

w(fscf oscf)        1d3
w(fscf nacfb)    9.95d3

w(oscf nacfb)    10.7d3
end_excess_function


2                                   | 2 site entropy model (M1, M2)

4 1.                                | 4 species on M1, site multiplicity of 1
z(m1,ca) = 1 cacf
z(m1,fe) = 1 fscf + 1 oscf
z(m1,na) = 1 nacfb

4 1.                                | 4 species on M2, (fake) site multiplicity of 1
z(m2,al) = 1 macf + 1 cacf + 1/2 nacfb
z(m2,mg) = 1/2 mscf + 1/2 oscf
z(m2,fe) = 1/2 fscf

end_of_model
                      --------------------------------------------------------
begin_model

        NAL phase, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        Notes:
                      Originally entered by Bob Myhill, 2018/02/13.
 
                      The M1 site has a fake multiplicity of 3 (6 apfu)

                      Eliminated ordered dependent endmembers. JADC, 10/2018.

                                                      M3      M2      M1
                                                     ___________________

                                      Multiplicity    1       2       3*(6)
                                                     ___________________

                                      1 nanal          Na      Mg     Al5/6Si1/6     independent
                                      3 canal          Ca      Mg     Al             independent
                                      5 manal          Mg      Mg     Al             independent
                                      9 msnal          Mg      Mg     Mg1/2Si1/2     independent

                                      2 nfnal_d        Na      Fe2+   Al5/6Si1/6     dependent
                                      4 cfnal_d        Ca      Fe2+   Al             dependent
                                      8 fanal_d        Fe2+    Fe2+   Al             dependent
                                     16 fsnal          Fe2+    Fe2+   Fe1/2Si1/2     independent
                                                     ___________________

                            Ordered:  9 o1nal          Fe2+    Mg     Mg1/2Si1/2      ordered
                                     10 o2nal          Fe2+    Fe2+   Mg1/2Si1/2      ordered

NAl(H)
abbreviation NAl
full_name    New aluminous phase

8                            | prismatic composition space
2                            | 2 simplices
2 4                          | 1 binary and 1 quaternary

nanal    nfnal_d
canal    cfnal_d
manal    fanal_d
msnal    fsnal

2                            | number of ordered species:

o1nal = 5/6 msnal + 1/6 fsnal  enthalpy_of_ordering = 2d3
o2nal = 1/2 msnal + 1/2 fsnal  enthalpy_of_ordering = 6.5d3

begin_limits
o1nal = -6/5 + 6/5 manal + 6/5 msnal + 1 o1nal - 3/5 o2nal + 3/5 o2nal delta = 6/5 (limits for Mg on M3)
o1nal = - 6/5 fsnal - 1/5 o1nal - 3/5 o2nal - 3/5 o2nal                delta = 6/5 (limits for Fe on M3)
o1nal = -6 + 6 fsnal + 1 o1nal + 3 o2nal + 3 o2nal                     delta = 6 (limits for Fe on M2)
o1nal = - 6 msnal - 5 o1nal - 3 o2nal - 3 o2nal                        delta = 12 (limits for Mg on M1)
o1nal = -12 + 6 fsnal + 1 o1nal - 3 o2nal + 3 o2nal                    delta = 12 (limits for Fe on M1)

o2nal = -2 + 2 manal + 2 msnal - 5/3 o1nal + 5/3 o1nal + 1 o2nal       delta = 2 (limits for Mg on M3)
o2nal = - 2 fsnal - 5/3 o1nal - 1/3 o1nal - 1 o2nal                    delta = 2 (limits for Fe on M3)
o2nal = - 2 fsnal + 1/3 o1nal - 1/3 o1nal - 1 o2nal                    delta = 2 (limits for Fe on M2)
o2nal = - 2 msnal - 1/3 o1nal - 5/3 o1nal - 1 o2nal                    delta = 4 (limits for Mg on M1)
o2nal = -4 + 2 fsnal - 1/3 o1nal + 1/3 o1nal + 1 o2nal                 delta = 4 (limits for Fe on M1)
end_limits

3                            | number of dependent endmembers

nfnal_d   = 1 nanal - 1 o1nal + 1 o2nal     | NM - FM + FF = NF
cfnal_d   = 1 canal - 1 o1nal + 1 o2nal     | CM - FM + FF = CF
fanal_d   = 1 manal - 1 msnal + 1 o2nal     | MM - MM + FF = FF


0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0      | endmember flags

0. 1.  .1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.  .1  0              | range and resolution for X(nanal) on site 2, imod = 0 -> cartesian subdivision
0. 1.  .1  0              | range and resolution for X(canal) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  .1  0              | range and resolution for X(manal) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(nanal canal)          14.2d3  0  0
W(nanal manal)          20.2d3  0  0
W(nanal msnal)          20.2d3  0  0
W(nanal fsnal)          21.2d3  0  0
W(nanal o1nal)          15.4d3  0  0
W(nanal o2nal)          23.4d3  0  0
W(canal manal)            11d3  0  0
W(canal msnal)          33.5d3  0  0
W(canal fsnal)            36d3  0  0
W(canal o1nal)          30.2d3  0  0
W(canal o2nal)          38.2d3  0  0
W(manal msnal)          22.5d3  0  0
W(manal fsnal)          32.2d3  0  0
W(manal o1nal)          26.5d3  0  0
W(manal o2nal)          34.5d3  0  0
W(msnal fsnal)            15d3  0  0
W(msnal o1nal)             4d3  0  0
W(msnal o2nal)            12d3  0  0
W(fsnal o1nal)            11d3  0  0
W(fsnal o2nal)             3d3  0  0
W(o1nal o2nal)             8d3  0  0
end_excess_function

3                          | 3 site (M3, M2, M1) entropy model
                           | (note: occupancies should not include dependent endmembers,
                           |  but does include ordered endmembers) 

4 1.                       | 4 species on M3, site multiplicity of 1
z(m3,na)    = 1 nanal
z(m3,ca)    = 1 canal
z(m3,mg)    = 1 manal + 1 msnal

2 2.                       | 2 species on M2, site multiplicity of 2
z(m2,fe)   = 1 fsnal + 1 o2nal

4 3.                       | 4 species on M1, (fake) site multiplicity of 3 (true multiplicity = 6)
z(m1,mg)   = 1/2 msnal + 1/2 o1nal + 1/2 o2nal
z(m1,fe)   = 1/2 fsnal
z(m1,al)   = 5/6 nanal + 1 canal + 1 manal

end_of_model
                      --------------------------------------------------------
begin_model

        Akimotoite, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        [Bob Myhill, 2018/02/13]  

        mixing on 2 sites, each with a fake site multiplicity of 1/2 (Al-avoidance). 
        Note that this is different to the corundum model, which is assumed to mix on 
        two independent sites.
        The properties of the aak endmember are assumed identical to corundum (cor):

                                                      1       2             
                                                      M       T      
                                                     _____________

                                      Multiplicity    1/2*(1)  1/2*(1)
                                                     _____________

                                      1 cor           Al      Al       
                            Species:  2 mak           Mg      Si
                                      3 fak           Fe2+    Si 
Aki(H)                
abbreviation Aki
full_name    Akimotoite
                                                               
2                                 | model type: Margules, macroscopic
3                                 | 3 endmembers
cor   mak   fak            
  0  0  0                          
0. 1.  0.1 0              
0. 1.  0.1 0             

begin_excess_function
W(cor mak)    8d3 0. 0.
W(cor fak)    6d3 0. 0.
W(cor fak)    4d3 0. 0.            
end_excess_function 

2                                     2 site entropy model
3 0.5                                  3 species on M site with fake multiplicity = 1/2
z(mg) = 1 mak
z(fe) = 1 fak
2 0.5                                  2 species on T site with fake multiplicity = 1/2
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model

        Wadsleyite

        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035   
        [Bob Myhill, 2018/02/13]   

        Notes:
        mixing of Mg-Fe on 1 site with a multiplicity of 2

Wad(H)
abbreviation Wad
full_name    wadsleyite

2                                     model type: Margules, macroscopic
2                                     2 endmembers
mwd       fwd            
0  0                                | endmember flags

0.0 1.0  0.1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(mwd fwd) 13000. 0. 0.                 
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(fe) = 1 fwd 

end_of_model
                      --------------------------------------------------------
begin_model

        Ringwoodite

        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035
        [Bob Myhill, 2018/02/13]

        Notes:
        mixing of Mg-Fe on 1 site with a multiplicity of 2

Ring(H) 
abbreviation Ring
full_name    ringwoodite

2                                     model type: Margules, macroscopic
2                                     2 endmembers
mrw       frw            
0  0                                | endmember flags

0.0 1.0  0.1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(mrw frw) 4000. 0. 0.                 
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(fe) = 1 frw 
                                            
end_of_model
                      --------------------------------------------------------
begin_model

        High pressure C2/c clinopyroxene, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        Notes:

                      Originally entered by Bob Myhill, 2018/02/13

                      Eliminated ordered dependent endmembers. JADC, 10/2018.

                      To use this the following endmembers must be specified with make 
                      definitions in the endmember data file

                      hmgts  = 1 mgts + 1 hen - 1 en
                            DQF = -1000
                      odi  = 1 di
                            DQF = -100 + 0.211 * T_K + 0.005 * P_bar

                                                      M1      M2     T 
                                                     _____________________

                                      Multiplicity    1       1      1/2
                                                     _____________________

                                        hen           Mg      Mg     SiSi      independent
                            Species:    odi           Mg      Ca     SiSi      independent
                                        hmgts         Al      Mg     SiAl      independent

                            Species:    hfs           Fe      Fe     SiSi      independent
                                        tsfs_d        Al      Fe     SiAl      dependent
                                        ofdi_d        Fe      Ca     SiSi      dependent
                                                      _____________________

                           Internal:    hfm           Mg      Fe     SiSi         

Hpx(H)
abbreviation Hpx
full_name    HP_clinopyroxene 

8                          | model type: Reciprocal with speciation

2                          | 2 independent composition spaces
3 2                        | 3 dimensions on first space, 2 on second

                           | endmembers: 
hen    odi      hmgts
hfs    tsfs_d   ofdi_d

1                          | ordered species definition

hfm = 1/2 hen + 1/2  hfs  Delta(enthalpy) = -6d3          

begin_limits
hfm =     - 2 hfs - 1 hfm                delta = 2 z(M2,Fe)
hfm =  -2 + 2 hfs + 1 hfm                delta = 2 z(M1,Fe)
hfm =     - 2 hen - 1 hfm                delta = 2 z(M1,Mg)
end_limits   

2                          | dependent endmember definitions

ofdi_d  = 1 odi   + 1 hfs   - 1 hfm
tsfs_d  = 1 hmgts + 1 hfm   - 1 hen

                                 
0 0 0 0 0 0 0 0 0          | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

0. 1. .1   0               | subdivision model for (ternary) site 1 (X_en):
0. 1. .1   0               | subdivision model for (ternary) site 1 (X_di):

0. 1. .1   0               | subdivision model for (binary) site 2 (XMg):

begin_excess_function                
W(hen hfs)        5.2d3  0   0
W(hen hfm)          4d3  0   0
W(hen odi)       32.2d3  0   0.12 
W(hen hmgts)       13d3  0  -0.15

W(hfs hfm)          4d3  0   0
W(hfs odi)         24d3  0   0
W(hfs hmgts)        7d3  0  -0.15

W(hfm odi)         18d3  0   0
W(hfm hmgts)        2d3  0  -0.15

W(odi hmgts)    75.4d3  0  -0.94
end_excess_function 

3                        | 3 site (M1, M2, T) configurational entropy model

3 1.                     | 3 species on M1, 1 site per formula unit.
z(m1,fe)   = 1 hfs 
z(m1,al)   = 1 hmgts 

3 1.                     | 3 species on M2, 1 site per formula unit. 
z(m2,ca) = 1 odi
z(m2,fe) = 1 hfs + 1 hfm

2 0.5                    | 2 species on 0.5 T sites (true multiplicity = 2)
z(t,al) = 1/2 hmgts 


begin_van_laar_sizes
alpha(hen)     1.0  0  0
alpha(hfs)     1.0  0  0
alpha(hfm)     1.0  0  0
alpha(odi)    1.2  0  0
alpha(hmgts)   1.0  0  0
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model

                              Pyrrhotite, Saxena & Eriksson 2015
                              ECRG, 5/2018

Po(SE)                       | solution name.
abbreviation Po
full_name    hT-pyrrhotite

2                            | model type: Compound energy formalism
2                            | number of endmembers
APyrr
SVa

0 0                          | endmember flags

0. 1. .1 0                   | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
Wk(APyrr SVa) 
w0 = -225830.67  wT = 26.357836  wP0 = -0.400228
end_excess_function 
                             | wP0 is a coefft of P
1                            | 1 site entropy model
2 1.                         | 2 species, site multiplicity of 1
z(SVa) = 1 SVa

end_of_model
                      --------------------------------------------------------
begin_model                
                              FeS-S fluid, Saxena & Eriksson 2015
                              ECRG, 5/2018
FeS_liq
abbreviation Melt
full_name    liquid

42                          | model type: modified QC with composition-dependent coordination, binary only.
2                                 | no. independent end-members
FeLiq SLiq                        | endmember names

0 0                          | endmember flags

0. 1. .1 0                   | subdivision range, imod = 0 -> cartesian subdivision

                             | dummy excess function
begin_excess_function
w(FeLiq SLiq) 0. 0. 0.
end_excess_function 

0                               0 site entropy model    | entropy function is hard-wired

end_of_model
                      --------------------------------------------------------
begin_model
                      Green, ECR, et al. (JMG, 2016). 

                      NOTE: to use this the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                         mrbG  = 1 gl - 1 gr + 1 andr
                            DQF = 0
                         kprg  = 1 mu - 1 pa + 1 parg  
                            DQF = -7060 + 20 * T_K
                         tts   = -2 dsp + 2 ru + 1 ts    
                            DQF =   95000

                      to avoid cluttering thermodynamic data files with the new plague of TC 
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                         DQF(gl)   = -3000
                         DQF(parg) = -10000
                         DQF(ts)   =  10000
                         DQF(grun) = -3000

                      For (nonsensical, but common) positive DFQ's this approach may lead to 
                      interference between the phase relations of the solution model and the 
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                                                            Sites
                                            A    M1      M2      M4     T1     OH
                                            _______________________________________

                            Multiplicity    1     3      2       2     1(4)    2 
                                            _______________________________________
                              Tr            V     Mg     Mg     Ca      Si     OH
                              Ts            V     Mg     Al     Ca     SiAl    OH
                              Parg          Na    Mg    MgAl    Ca     SiAl    OH
                              Gl            V     Mg     Al     Na      Si     OH
                              Cumm          V     Mg     Mg     Mg      Si     OH
                              Grun          V     Fe     Fe     Fe      Si     OH
                              mrbG          V     Mg     Fe3    Na      Si     OH
                              Kprg          K     Mg    MgAl    Ca     SiAl    OH
                              Tts           V     Mg     Ti     Ca     SiAl    O

                              A             V     Mg     Fe     Fe      Si     OH
                              B             V     Fe     Mg     Fe      Si     OH

           dependent exchange Mgrk          V     M      Fe3    M      SiAl     OH
           dependent exchange Mts           V     M       Al    M      SiAl     OH
           dependent exchange Mpg           Na    M      MAl    M      SiAl     OH
           dependent exchange MKpg          K     M      MAl    M      SiAl     OH
           dependent exchange MTts          V     M      Ti     M      SiAl     OH

           2 CaMg-1(M4) = (Tr-Cumm)
           3 FeMg-1(M1) = (grun - a)
           2 FeMg-1(M2) = (grun - b)
           2 FeMg-1(M4) = (-grun - cumm + a + b)

cAmph(G)_I
abbreviation Amph
full_name    clinoamphibole

8                           | model type: order-disorder, prismatic composition space
2                           | 2 site reciprocal space
2 9 |13                     | 1 binary + 1 nonary

ts      fcts_d

|mts_d   fts_d
|mprg_d  fprg_d
|mkprg_d fkprg_d
|mtts_d  ftts_d

parg    fcparg_d
gl      fgl_d
cumm    grun
mrbG    frb_d
kprg    fckprg_d
tts     fctts_d
grk_d   fgrk_d
tr      ftr_d

2                            | ordered species definitions:

a     = 3/7 cumm + 4/7 grun  enthalpy_of_ordering  =   -9486  | = DQF(A) -4/7 DQF(Grun)
b     = 2/7 cumm + 5/7 grun  enthalpy_of_ordering  =  -11657  | = DQF(B) -5/7 DQF(Grun)

begin_limits                                                  

a = -7/4 + 7/4 grun + 1 a + 1/2 b + 5/4 b                           delta = 7/4 z(M1,Fe)
a = -7/3 grun - 4/3 a + 5/3 b - 5/3 b                               delta = 7/3 z(M2,Fe)
a = -7/3 + 7/3 tr + 7/6 parg + 7/6 kprg + 7/3 cumm + 1 a + 5/3 b + 2/3 b  delta = 7/3 z(M2,Mg) only 1 m2 equation can be independent 
a = -7/3 + 7/3 cumm + 1 a - 2/3 b + 2/3 b                           delta = 7/3 z(M4,Mg) only 1 m4 equation can be independent 
a = -7/3 grun - 4/3 a - 2/3 b - 5/3 b                               delta = 7/3 z(M4,Fe)

b = -7/2 grun + 2 a - 2 a - 5/2 b                                   delta = 7/2 z(M1,Fe)
b = -7/5 + 7/5 grun + 3/5 a + 4/5 a + 1 b                           delta = 7/5 z(M2,Fe)
b = -7/5 tr - 7/10 parg - 7/10 kprg - 7/5 cumm + 3/5 a - 3/5 a - 2/5 b  delta = 7/5 z(M2,Mg)
b = -7/2 + 7/2 cumm - 3/2 a + 3/2 a + 1 b                           delta = 7/2 z(M4,Mg)
b = -7/2 grun - 3/2 a - 2 a -5/2 b                                  delta = 7/2 z(M4,Fe)

end_limits

9 |17                         | dependent endmember definitions:

ftr_d    = 1 tr    + 2 grun   - 1 a - 1 b
fcts_d   = 1 ts    + 1 grun   - 1 a
fcparg_d = 1 parg  + 3/2 grun - 1 a - 1/2 b
fgl_d    = 1 gl    + 1 grun   - 1 a
frb_d    = 1 mrbG  + 1 grun   - 1 a
fckprg_d = 1 kprg  + 3/2 grun - 1 a - 1/2 b
fctts_d  = 1 tts   + 1 grun   - 1 a
grk_d    = 1 mrbG  + 1 ts    + 1 cumm   - 1 gl - 1 tr
fgrk_d   = 1 mrbG  + 1 ts    - 1 gl     - 1 tr + 1 b

|mts_d    = 1 ts    + 1 cumm   - 1 tr
|fts_d    = 1 ts    + 1 b      - 1 tr
|mprg_d   = 1 parg  + 1 cumm   - 1 tr 
|fprg_d   = 1 parg  + 1/2 grun + 1/2 b   - 1 tr
|mkprg_d  = 1 kprg  + 1 cumm   - 1 tr 
|fkprg_d  = 1 kprg  + 1/2 grun + 1/2 b   - 1 tr
|mtts_d   = 1 tts  + 1 cumm   - 1 tr 
|ftts_d   = 1 tts  + 1 b      - 1 tr

0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0  | endmember flags

                             | imod = 0 -> cartesian subdivision
                             | imod = 1 -> assymetric stretching subdivision

0. 1.  .1  0                 | range and resolution for X(Mg) on site 1, imod = 0

0. 1.  .1  0        .25         | range and resolution for X(ts)   on site 2, imod = 0

|0. .1  .1  0                 | range and resolution for X(Mts)  on site 2, imod = 0
|0. .1  .1  0                 | range and resolution for X(MPg)  on site 2, imod = 0
|0. .1  .1  0                 | range and resolution for X(MKPg) on site 2, imod = 0
|0. .1  .1  0                 | range and resolution for X(MTts) on site 2, imod = 0

0. 1.  .1  0        .62         | range and resolution for X(pg)   on site 2, imod = 0
0. 1.  .1  0        0.05         | range and resolution for X(gl)   on site 2, imod = 1
0. 1.  .1  0        .85         | range and resolution for X(cumm) on site 2, imod = 0
0. 1.  .1  0        .14         | range and resolution for X(mrb)  on site 2, imod = 1
0. .1  .1  0        .05         | range and resolution for X(kprg) on site 2, imod = 1
0. .2  .1  0        .12         | range and resolution for X(tts)  on site 2, imod = 1
0. .4  .1  0       .28          | range and resolution for X(grk)  on site 2, imod = 1

begin_excess_function   

W(tr ts)                  20d3
W(tr parg)                25d3
W(tr gl)                  65d3
W(tr cumm)                45d3
W(tr grun)                75d3
W(tr a)                   57d3
W(tr b)                   63d3
W(tr mrbG)                52d3
W(tr kprg)                30d3
W(tr tts)                 85d3
W(ts parg)               -40d3
W(ts gl)                  25d3
W(ts cumm)                70d3
W(ts grun)                80d3
W(ts a)                   70d3
W(ts b)                 72.5d3
W(ts mrbG)                20d3
W(ts kprg)               -40d3
W(ts tts)                 35d3
W(parg gl)                50d3
W(parg cumm)              90d3
W(parg grun)           106.7d3
W(parg a)               94.8d3
W(parg b)               94.8d3
W(parg mrbG)              40d3
W(parg kprg)               8d3
W(parg tts)               15d3
W(gl cumm)               100d3
W(gl grun)             113.5d3
W(gl a)                  100d3
W(gl b)                111.2d3
W(gl kprg)                54d3
W(gl tts)                 75d3
W(cumm grun)              33d3
W(cumm a)                 18d3
W(cumm b)                 23d3
W(cumm mrbG)              80d3
W(cumm kprg)              87d3
W(cumm tts)              100d3
W(grun a)                 12d3
W(grun b)                  8d3
W(grun mrbG)              91d3
W(grun kprg)              96d3
W(grun tts)               65d3
W(a b)                    20d3
W(a mrbG)                 80d3
W(a kprg)                 94d3
W(a tts)                  95d3
W(b mrbG)                 90d3
W(b kprg)                 94d3
W(b tts)                  95d3
W(mrbG kprg)              50d3
W(mrbG tts)               50d3
W(kprg tts)               35d3

end_excess_function

6                                   | 6 site configurational entropy model (A, M1, M2, M4,T1, OH)

3 1                                 | 3 species on A, mult = 1
z(A,na)    = 1 parg 
z(A,k)     = 1 kprg 

2 3                                 | 2 species on M1, mult = 3
z(M1,fe)   = 1 grun + 1 b 

5 2                                 | 5 species on M2, mult = 2
z(M2,fe)   = 1 grun + 1 a
z(M2,fe3)  = 1 mrbG
z(M2,al)   = 1 ts + 1 gl + 1/2 kprg + 1/2 parg
z(M2,ti)   = 1 tts

4 2                                 | 4 species on M4, mult = 2
z(M4,mg)   = 1 cumm
z(M4,na)   = 1 gl + 1 mrbG
z(M4,fe)   = 1 grun + 1 a + 1 b

2 1                                 | 2 species on T1, fake mutiplicity = 1
z(T1,Al)   = 1/2 ts + 1/2 parg + 1/2 kprg + 1/2 tts

2 2                                 | 2 species on OH, mutiplicity = 2
z(OH,O)    = 1 tts

begin_van_laar_sizes

alpha(tr)          1
alpha(ts)          1.5
alpha(parg)        1.7
alpha(gl)          0.8
alpha(cumm)        1
alpha(grun)        1
alpha(a)           1
alpha(b)           1
alpha(mrbG)        0.8
alpha(kprg)        1.7
alpha(tts)         1.5

end_van_laar_sizes

begin_dqf_corrections

DQF(gl)   = -3000
DQF(parg) = -10000
DQF(ts)   =  10000
DQF(grun) = -3000

end_dqf_corrections

end_of_model
                           --------------------------------------------------------
                      --------------------------------------------------------
begin_model                
                             Talc, ideal.

                                                      1       2           
                                                      M1      M2       T2   
                                                     ______________________

                                      Mutliplicity    2       1         2
                                                     ______________________

                                      1 en            Mg      Mg       SiSi
                            Species:  2 fs            Fe      Fe       SiSi
                                      3 mgts          Mg      Al       AlSi
                                                      ______________________

                             reformulated from relict equipartion (model type 7) to simplicial 
                             composition space (model type 2).

                             JADC 5/10/2018

T                          | solution name 
abbreviation Tlc
full_name    talc

2                          | model type: simplicial, equipartition relict
3                          | number of independent endmembers
ta    fta    tats          | endmember names
0 0 0                      | endmember flags, indicate if the endmember is part of the solution.
0.0 1. 0.1  0              | range and resolution for ta, imod = 0 -> cartesian subdivision
0.0 1. 0.1  0              | range and resolution for fta, imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M1, M2, T2) conigurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit.

z(m1,mg) = 1 ta + 1 tats                 
                
2 2.                       | 2 species on T2, 2 sites per formula unit.

z(t2,al) = 1/2 tats 

3 1.                       | 3 species on M2, 1 site per formula unit.

z(m2,mg) = 1 ta 
z(fe,m2) = 1 fta

end_of_model
                      --------------------------------------------------------
begin_model
                             Antigorite with Tschermak's substitution (Padrn-Navarta et al., 2013, Lithos)

                             reformulated from relict equipartion (model type 7) to simplicial 
                             composition space (model type 2).

                             JADC 5/10/2018

                                                      M0      M1       T1  
                                                     ______________________

                                      Mutliplicity    44       4         8
                                                     ______________________

                                      1 atg          Mg      Mg       SiSi
                            Species:  2 fatg         Fe      Fe       SiSi
                                      3 atgts        Mg      Al       AlSi
                                                      ______________________


                             This model requires the following make definition in the thermodynamic data file:

                                atgts = 4 clin + 9/17 atg - 24/17 br
                                -2e3. 46.1 0

Atg(PN)                    | solution name
abbreviation Atg
full_name    serpentine

2                          | model type: simplicial composition space, equipartition relict
3                          | number of endmembers
atg      fatg   atgts      | endmember names, this order implies:
0 0 0                      | endmember flags, indicate if the endmember is part of the solution.

0. 1. .1  0                | range and resolution for atg, imod = 0 -> cartesian subdivision
0. 1. .1  0                | range and resolution for ftag, imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M0, M1, T1) configurational entropy model

2 44.                      | 2 species on M0, 2 sites per formula unit.

z(m1,mg) = 1 atg + 1 atgts

2 8.                       | 2 species on T1, 2 sites per formula unit.

z(t2,al) = 1/2 atgts

3 4.                       | 3 species on M1, 1 site per formula unit.

z(m2,mg) = 1 atg
z(fe,m2) = 1 fatg

reach_increment 0

end_of_model
                      --------------------------------------------------------
                      --------------------------------------------------------
begin_model                
                            Amphibole from Massonne & Willner (EJM, 2008)
                            See notes for TrTsPg (above).        
GlTrTsMr            
abbreviation Amph
full_name    clinoamphibole
        
7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quaternary                
tr       ftr      
mrie     fmrie_i  
ts       fts_i  
gl       fgl_i  

3                          | number of dependent endmembers 

fmrie_i = 1 mrie + 3/5 ftr  - 3/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr

0 0 0 0 0 0 0 0            | endmember flags.

0. 1.0 0.1 0               | range and resolution for X(Mg) on site 1

0. 1.0 0.1 0               | range and resolution for X(tr) on site 2
0. 1.0 0.1 0               | range and resolution for X(pg) on site 2 
0. 1.0 0.1 0               | range and resolution for X(ts) on site 2

begin_excess_function 
W(gl tr)     77d3 0. 0. 
W(gl ftr)    83d3 0. 0. 
W(ts tr)     20d3 0. 0. 
W(ts ftr)   -38d3 0. 0. 
W(tr ftr)    10d3 0. 0. 
end_excess_function

4                          | 4 site (M1, M2, M4, T1) entropu model 

2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 0 + 1 ts 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 0 + 1 tr + 1 ts + 1 mrie + 1 gl

3 2.                       | 3 species on M2, 2 sites pfu
z(m2,mg) = 0 + 1 tr  
z(m2,fe) = 0 + 1 ftr 

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 0 + 1 gl 

begin_dqf_corrections
dqf(ts) 10000 0 0 
end_dqf_corrections

site_check_override

end_of_model              
                      --------------------------------------------------------
begin_model
                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without Na, K, Ti or Mn solution.

                             See Amph(DHP) or bAmph(DHP) for Na-Ca amphibole
 
                                      JADC 5/5/06. 
                        
                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts           Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets         Vac       Fe      Fe3+   Ca      Al_Si
                             
                             fparg = parg + 4/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr) 

Ca-Amph(D)                 | solution name 
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quinary                
tr       ftr      
parg     fparg_i  
ts       fts_i  
mfets    ffets_i

3                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr 

0 0 0 0 0 0 0 0            | endmember flags.

0. 1.0 0.1                | range and resolution for X(Mg) on site 1
0                         | subdivision scheme : imod = 0 -> cartesian for site 1

0. 1.0 0.1 0              | range and resolution for X(tr) on site 2
0. 1.0 0.1 0              | range and resolution for X(pg) on site 2 
0. 1.  0.1 0              | range and resolution for X(ts) on site 2

begin_excess_function
W(parg tr)  29.3d3 0. 0.
W(parg ts)  18.2d3 0. 0. 
W(parg ftr) 11.4d3 0. 0.  
W(ts tr)    20.8d3 0. 0. 
W(tr ftr)   11.4d3 0. 0.
end_excess_function

4                          | 4 site (A, M1, M2, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg  
              
2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg) = 1 tr + 1/2 parg 
z(m2,fe) = 1 ftr  
z(m2,fe3+) = 1 mfets 

begin_dqf_corrections
dqf(ts) 10000 0 0 
end_dqf_corrections

site_check_override

end_of_model               
                      --------------------------------------------------------
begin_model 
                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without Ca, K, Ti or Mn solution.

                             This model requires a fgl endmember, created as 
                             decribed by Powell's mdep paper.

                             See Amph(DHP) for Na-Ca amphibole
 
                                      JADC 5/5/06. 

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________
  
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl           Vac       Fe      Al     Na      Si_Si
                            12 mrieb         Vac       Mg      Fe3+   Na      Si_Si
                            11 rieb          Vac       Fe      Fe3+   Na      Si_Si

                             mrieb_i = 1 rieb + 3/5 tr - 3/5 ftr        

Na-Amph(D)                 | solution name 
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules

2                          | 2 site reciprocal solution

2 2                        | 2 binaries     
           
gl       fgl  
mrieb_i  rieb

1                          | number of dependent endmembers 

mrieb_i = 1 rieb + 1 gl - 1 fgl

0 0 0 0                    | endmember flags.

0. 1.0 0.1                | range and resolution for X(Mg) on site 1
0                          | subdivision scheme : imod = 0 -> cartesian for site 1

0. 1.0 0.1                | range and resolution for X(Al) on site 2
0                          | subdivision scheme : imod = 0 -> cartesian for site 2

ideal

2                          | 2 site (M1, M2) entropy model 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 gl 

2 2.                       | 2 species on M2, 2 sites pfu

z(m2,fe3+) = 1 rieb

site_check_override

end_of_model 

begin_model                
                      --------------------------------------------------------
begin_model 
                             Ideal orthoamphibole, this model assumes Al is present
                             on only two tetrahedral sites and all five M2 sites. 
                             I have no idea if this is correct! 

                             fgedr endmember stoichiometry corrected, T. Wagner 2/18/06. 

                                                                 
                                                      M1      M2        T    
                                                     ______________________

                                      Mutliplicity    2       5         2
                                                     ______________________

                                      1 anth          Mg      Mg       SiSi
                            Species:  2 fanth         Fe      Fe       SiSi
                                      3 ged           Mg      Mg3Al2   AlAl
                                      4 fged          Fe      Fe3Al2   AlAl
                                                      ______________________


                           Dependent: fged = ged + 5/7*(fanth - anth)


o-Amph                     | solution name 
abbreviation oAmph
full_name    orthoamphibole

7                          | model type: reciprocal, macroscopic

2                          | 2 site reciprocal solution

2  2                       | 2 species on each site

anth     fanth             | endmember names, this order implies: 
ged      fged_i            | x(11)=x(mg); x(12) = x(fe); x(21) = x(si,t); x(22) = x(Al,t) 

1                          | 1 dependent endmember:

fged_i = 1 ged + 5/7 fanth - 5/7 anth

0 0 0 0                    | endmember flags, indicate if the endmember is part of the solution.
0. 1. .1             | range and resolution for X(Mg) on site 1
0                          | subdivision scheme on site 2: imod = 0 -> cartesian
0. 1. .1              | range and resolution for 1-X(Tschermaks) on site 2
0                          | subdivision scheme on site 2: imod = 0 -> cartesian

ideal

3                          | 3 site (M1, M2, T) conigurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit.

z(m1,mg) = 1 anth + 1 ged              
                
2 2.                       | 2 species on T, 2 sites per formula unit.

z(t,al) = 1 ged 

3 1.                       | 3 species on M2, 1 site per formula unit.

z(m2,mg) = 1 anth + 3/5 ged
z(m2,fe) = 1 fanth

site_check_override

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      tr-ts-parg non-ideal model for
                                      holland and powell. assumes 2 M2 sites are 
                                      coupled to 4 T1 sites. site multiplicity 
                                      of the T1 site is reduced to 2, this is 
                                      suggested by HP98 to account for charge 
                                      balance constraints. but doesn't make a lot
                                      of sense for the tr-parg mixing. assume
                                      Na on the A-site is coupled to Al on M2.

                                      JADC Nov, 98. 

                                      HP Am Min 99, 84:1-14
                                      Oli Jagoutz revised april 9, 2002

                                      in contrast to the earlier version of TrTsPg
                                      this version assumes the A site is decoupled from M2
 
                                      JADC 4/03. 

                             fparg = parg + 4/5 (ftr  - tr)
                             fgl   = gl   + 3/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)         


GlTrTsPg                   | solution name 
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quaternary                
tr       ftr      
parg     fparg_i  
ts       fts_i  
gl       fgl_i  

3                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr

0 0 0 0 1 0 0 0           | endmember flags.

0. 1.0 0.1 0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.0 0.1 0              | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.0 0.1 0              | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  0.1 0              | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
                            | interaction parameters from
                            | White, Powell & Phillips (2003, JMG)
                            | and Wei, Powell, & Zhang (2003, JMG) 
                            | compiled by D. Tinkham. JADC 11/03 
W(parg gl)  80d3 0. 0. 
W(parg tr)  30d3 0. 0. 
W(parg ftr) 38d3 0. 0.  
W(gl tr)    77d3 0. 0. 
W(gl ftr)   83d3 0. 0. 
W(ts tr)    20d3 0. 0. 
W(ts ftr)  -38d3 0. 0. 
W(tr ftr)   10d3 0. 0.
                            | earlier versions used (provenance unknown)

                            | W(ts parg) -25000. 0. 0. 
                            | W(tr parg)  20000. 0. 0. 
                            | W(tr ts)    38000. 0. 0.  
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg  
              
2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl

3 2.                       | 3 species on M2, 2 sites pfu
z(m2,mg) = 1 tr + 1/2 parg 
z(m2,fe) = 1 ftr 

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl 

begin_dqf_corrections
dqf(ts) 10000 0 0 
end_dqf_corrections

site_check_override

end_of_model             
                      --------------------------------------------------------
begin_model               
                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts           Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl           Vac       Fe      Al     Na      Si_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets         Vac       Fe      Fe3+   Ca      Al_Si

                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without K, Ti or Mn solution.
 
                                      JADC 9/05. 

                             fparg = parg + 4/5 (ftr  - tr)
                             fgl   = gl   + 3/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)

Amph(DHP)                  | solution name 
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 5                        | 1 binary and 1 quinary
tr       ftr      
parg     fparg_i  
ts       fts_i  
gl       fgl_i  
mfets    ffets_i

4                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr 

0 0 0 0 1 0 0 0 0 0        | endmember flags.

0. 1.0 0.1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.0 0.1  0              | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.0 0.1  0              | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  0.1  0              | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision
0. 1.  0.1  0              | range and resolution for X(gl) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(parg gl)  84.5d3 0. 0. 
W(parg tr)  29.3d3 0. 0.
W(parg ts)  18.2d3 0. 0. 
W(parg ftr) 11.4d3 0. 0.  
W(gl tr)    35.3d3 0. 0.  
W(ts tr)    20.8d3 0. 0. 
W(tr ftr)   11.4d3 0. 0.
W(gl ftr)   15d3 0. 0. 
W(gl ts)    15d3 0. 0.
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg  
              
2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets  

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg)   = 1 tr + 1/2 parg 
z(m2,fe)   = 1 ftr 
z(m2,fe3+) = 1 mfets 

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl 

begin_dqf_corrections
dqf(ts) 10000
end_dqf_corrections

reach_increment 1

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model                
                             Dale et al, JMG 2005 23:771-791 amphibole model.

                             JADC, 11/05.

                             Margules parameters corrected from  
                                      W(gl ftr)     393d3  0. 0.
                                      W(gl mfets)   459d3  0. 0.
                                      W(ftr mfets)  125d3  0. 0.
                             to current values. 

                             M. Racek, 2/10/06.

                                             A         M13     M2     M4      T1*
                                            _________________________________________

                             Mutliplicity    1         3       2      2       4(1)
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts_d         Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg_d       Na        Fe      Fe_Al  Ca      Al_Si
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl_d         Vac       Fe      Al     Na      Si_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets_d       Vac       Fe      Fe3+   Ca      Al_Si

                             fparg_d = 1 parg + 4/5 ftr  - 4/5 tr 
                             fts_d   = 1 ts   + 3/5 ftr  - 3/5 tr 
                             fgl_d   = 1 gl   + 3/5 ftr  - 3/5 tr
                             ffets_d = 1 mfets + 3/5 ftr  - 3/5 tr        

                           *Dale et al compute amphibole T1 site fractions assuming 
                            a site multiplicity of 4, but compute activities for a
                            T1 site multiplicity of 1. In previous models H&P computed
                            activities for a T1 site multiplicity of 2.

Amph(DPW)                  | solution name 
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 5                        | 1 binary and 1 quinary                
tr       ftr      
parg     fparg_i  
ts       fts_i  
gl       fgl_i  
mfets    ffets_i

4                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr 

0 0 0 0 1 0 0 0 0 0        | endmember flags.

0. 1.0 0.1 0               | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.0 0.1 0               | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.0 0.1 0               | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  0.1 0               | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision
0. 1.  0.1 0               | range and resolution for X(gl) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(tr ts)      20d3   0. 0. 
W(tr parg)    33d3   0. 0.
W(tr gl)      65d3   0. 0. 
W(tr ftr)     10d3   0. 0.  
W(tr mfets)   20d3   0. 0.  
W(ts parg)   -385d2  0. 0. 
W(ts gl)      25d3   0. 0.
W(ts ftr)     125d2  0. 0. 
W(parg gl)    50d3   0. 0.
W(parg ftr)  -19d2   0. 0.
W(parg mfets) -385d2  0. 0.
W(gl ftr)     393d2  0. 0.
W(gl mfets)   459d2  0. 0.
W(ftr mfets)  125d2  0. 0.
end_excess_function

5                          | 5 site (A, M13, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg 
              
2 1.                       | 2 species on T1, fake site multiplicity of 1.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg)   = 1 tr + 1/2 parg 
z(m2,fe)   = 1 ftr 
z(m2,fe3+) = 1 mfets 

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl 


begin_van_laar_sizes                        
alpha(tr)     1.0    0.    0.                      
alpha(ts)     1.5    0.    0.                      
alpha(parg)   1.7    0.    0.
alpha(gl)     0.8    0.    0.
alpha(ftr)    1.0    0.    0.
alpha(mfets)  1.5    0.    0.
end_van_laar_sizes

begin_dqf_corrections
dqf(gl)   5d3 0 0 
dqf(ts)   1d4 0 0 
dqf(parg) 15d3 0 0 
end_dqf_corrections

site_check_override

end_of_model              
                      --------------------------------------------------------
begin_model                
                            Sapphirine, ideal, holland and powell '98 

                            config entropy corrected, P Goncalves/JADC, 10/1/03

                            the corrected model assumes (after the text on TJBH's
                            saphhirine web page www.esc.cam.ac.uk/astaff/holland/ds5/sapphirines/spr.html)
                            that:

                                   1) a 14 cation unit formula
                                   2) Si occupies T2, Al occupies T5, Si and Al mix on
                                      remaining 4 sites T1 T3 T4 T6 (the T site below)
                                   3) Al occupies M7; only Fe and Mg may occupy sites
                                      M4, M5, M6 (Site MB below); Al, Mg, and Fe may occupy 
                                      sites M1, M2, M3 and M8 (Site MA below)
                              
                             N.B. This model seems to differ from the Thermocalc format version on 
                             TJBH's web page in that it accounts for the configurational entropy
                             arising from mixing on MB (i.e., the Thermocalc model looks like it
                             was written for Fe-free sapphirine). Eliminate site MB to reproduce 
                             the TJBH web page Thermocalc model.

                                                      1      2     3           
                                                      MA     MB    T     
                                                     _________________

                                      Mutliplicity    4      3     4
                                                     _________________

                                      1 spr7          MgAl7  Mg    SiAl7
                            Species:  2 fspr          FeAl7  Fe    SiAl7
                                      3 spr4          MgAl3  Mg    SiAl3
                                      4 fsp4_i        FeAl3  Fe    SiAl3      

                                      Dependent endmember:

                                      fsp4_i = spr4 +  8/7 * (fspr - spr7)
Sapp(HP)
abbreviation Sap
full_name    sapphirine

7                                     model type 
2                                     reciprocal solution
2 2                                   2 species on each site
spr7     fspr        
spr4     fsp4_i
1                                     1 dependent endmember 
fsp4_i = 1 spr4 +  8/7 fspr - 8/7 spr7

0  0  0  0                            endmember flags

0. 1. 0.1  0               | range and resolution for X(Mg), imod = 0 -> cartesian subdivision
0. 1. 0.1  0               | range and resolution for 1-X(Tschermaks), imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (MA, MB, T) configurational entropy model

2 3.                       | 2 species on MB, 3 sites per formula unit
z(mb,mg) = 1 spr4 + 1 spr7

3 4.                       | 3 species on MA, 4 sites per formula unit.
z(ma,Al) = 3/4 + 1/8 spr7 + 1/8 fspr
z(ma,fe) = 1/8 fspr

2 4.                       | 2 species on T, 4 sites per formula unit.
z(T,Al) = 3/4 + 1/8 spr7 + 1/8 fspr

site_check_override

end_of_model               
                      --------------------------------------------------------
begin_model                
                            Sapphirine, non-ideal, Kelsey et al. (J. metamorphic Geol., 2004, 22, 559-578)

                            NOTE: This model should be used in conjunction with a special
                            high temperature version of the HP data base (kel04ver.dat).

                            Model originally entered by Pulak Sengupta, 7/16/05. 

                            1) Site populations corrected to correspond to those of Kelsey et al
                               by P Goncalves, 10/12/2010.
               
                                                      1      2     3           
                                                      M3     M46   T     
                                                     _________________

                                      Mutliplicity    1      3     1
                                                     _________________

                                      1 spr4          Mg     Mg    Si
                            Species:  2 fspr          Fe     Fe    Si
                                      3 spr5          Al     Mg    Al
                                      4 fsp5_i        Al     Fe    Al      


                                      Dependent endmember:

                                      fsp5_i = spr5 +  3/4 * (fspr - spr4) 
Sapp(KWP)
abbreviation Sap
full_name    sapphirine

7                                     model type 
2                                     reciprocal solution
2 2                                   2 species on each site
spr4     fspr        
spr5     fsp5_i

1                                     1 dependent endmember 
fsp5_i = 1 spr5 +  3/4 fspr - 3/4 spr4

0  0  0  0                | endmember flags

0. 1. 0.1  0              | range and resolution for X(Mg), imod = 0 -> cartesian subdivision
0. 1. 0.1  0              | range and resolution for 1-X(Tschermaks), imod = 0 -> cartesian subdivision

begin_excess_function 
w(spr5 spr4) 10000 0 0
w(spr5 fspr) 12000 0 0
w(spr4 fspr)  8000 0 0
end_excess_function 

3                          | 3 site (M3, M46, T) configurational entropy model

2 3.                       | 2 species on M46, 3 sites per formula unit
z(m46,mg) = 1 spr5 + 1 spr4

3 1.                       | 3 species on M3, 1 sites per formula unit.
z(ma,Al) = 1 spr5 
z(ma,fe) = 1 fspr

2 1.                       | 2 species on T, 1 sites per formula unit.
z(T,si) = 1 spr4 + 1 fspr

site_check_override

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | CHLORITE: extended from holland et al. 1998, EJM.

                             NOTES:  

                             * This model will only function for the FASH subsystem
                               if MGO is also used as a component in VERTEX.
                                           
                             * This model was tested with the maple script complete_chl.mws

                             * For normal aluminous chlorites there is little to be gained
                               by considering the afchl endmember becuase the 
                               endmember has negligible contribution to the total energy of 
                               the solution (see fig 4 of holland et al). Exclude this 
                               endmember to save computational resources. For Al-poor
                               systems exclude ames and retain afchl.

                             JADC 4/03

                           | Despite this models complexity it can be 
                           | written as a simple ternary with one independent
                           | ordering parameter, however perplex does not 
                           | yet have speciation models implemented for
                           | solutions in which multiple endmembers are 
                           | characterized by a single ordering parameter.
                           | hence the model is formulated here explicitly
                           | in terms of the dependent endmembers with the
                           | site occupancy table:

                                                      1         2       3      4
                                                      M1      M2+M3     M4     T2
                                                     ________________________________

                                      Mutliplicity    1         4       1      2 
                                                     ________________________________
  
                                      1 mame          Al        Mn      Al     Al_Al   dependent
                                      2 mafchl        Mn        Mn      Mn     Si_Si   dependent
                                      3 mnchl         Mn        Mn      Al     Al_Si    
                                      4 fames         Al        Fe      Al     Al_Al   dependent
                                      5 fafchl        Fe        Fe      Fe     Si_Si   dependent
                                      6 daph          Fe        Fe      Al     Al_Si  
                                      7 ames          Al        Mg      Al     Al_Al
                                      8 afchl         Mg        Mg      Mg     Si_Si
                                      9 clin          Mg        Mg      Al     Al_Si     
 
                                          Dependent endmembers:

                                          fame = ames + 4/5 * (daph - clin) 
                                          fafchl = afchl + 6/5 * (daph - clin) 
                                          mame = ames + 4/5 * (mnchl - clin) 
                                          mafchl = afchl + 6/5 * (mnchl - clin) 

                           | For normal aluminous chlorites there is little to be gained
                           | by considering the afchl and fafchl endmembers 
                           | becuase the endmember has negligible 
                           | contribution to the total energy of the solution
                           | (see fig 4 of holland et al)

Chl(HP)
abbreviation Chl
full_name    chlorite

7                               | model type reciprocal, macroscopic formulation
2 
3 3 
mame_i   mafchl_i mnchl
fame_i   fafchl_i daph
ames     afchl    clin

4                               | 4 dependent endmembers 

fame_i   = 1 ames   + 4/5 daph  - 4/5 clin
fafchl_i = 1 afchl  + 6/5 daph  - 6/5 clin
mame_i   = 1 ames   + 4/5 mnchl - 4/5 clin
mafchl_i = 1 afchl  + 6/5 mnchl - 6/5 clin

0 0 0 0 0 0 0 0 0            |endmember flags

                             | subdivision model for (ternary) site 1 (T2):
0. 1. .1 0                   | range and resolution of X(Al_Si), imod = 0 -> cartesian subdivision
0. 1. .1 0                   | range and resolution of X(Al_Al), imod = 0 -> cartesian subdivision
                             | subdivision model for (ternary) site 2 (M2)

0. .2  .1 0                  | range and resolution of X(Mn), imod = 1 => asymmetric subdivision
0. 1.  .1 0                  | range and resolution of X(Fe), imod = 0 -> cartesian subdivision 

begin_excess_function

w(clin ames)  18000. 0. 0. 
w(clin afchl) 18000. 0. 0. 
w(ames afchl) 20000. 0. 0. 
w(clin daph)   2500. 0. 0.  
w(daph ames)  13500. 0. 0. 
w(daph afchl) 14500. 0. 0. 

end_excess_function

4                               |4 site configurational entropy model:

4 1.                            |4 species on 1 M1 site

z(al,M1) = 1 ames 
z(mn,M1) = 1 mnchl
z(fe,M1) = 1 daph 

3 4.                            |3 species on 4 M2+M3 sites

z(mn,m2+m3)= 1 mnchl
z(fe,m2+m3)= 1 daph 

2 1.                            |3 species on 1 M4 site

z(mg,m4) = 1 afchl

2 2.                            |2 species on 2 T2 sites 
z(al,T2)= 1 ames + 1/2 clin + 1/2 daph + 1/2 mnchl

site_check_override

end_of_model  
                              --------------------------------------------------------
begin_model                
                           | CHLORITE: extended from Holland et al. (1998) for sud substitution
                           | Entered by Thomas Wagner, 5/12.
                              
                             LWV 7/12

                           | The reference for this model is Lanari, Wagner and Vidal,
                           | CMP 2014 167:968

                           | the model is formulated here explicitly
                           | in terms of the dependent endmembers with the
                           | site occupancy table:

                                                      1         2         3        4
                                                      M1      M2+M3       M4       T2
                                                     ________________________________

                                      Mutliplicity    1         4         1        2 
                                                     ________________________________
  
                                      1 fames         Al        Fe        Al       Al_Al   dependent
                                      2 ames          Al        Mg        Al       Al_Al
                                      3 clin          Mg        Mg        Al       Al_Si
                                      4 daph          Fe        Fe        Al       Al_Si
                                      5 fsud          Va        Al2_Fe2   Al       Al_Si   dependent
                                      6 sud           Va        Al2_Mg2   Al       Al_Si
                                       
                                          Dependent endmembers:

                                          fames = ames + 4/5 * (daph - clin)
                                          fsud = sud + 2/5 * (daph - clin)
Chl(LWV)
abbreviation Chl
full_name    chlorite

7                               | model type reciprocal, macroscopic formulation
2 
3 2 
fames_i   fsud_i     daph
ames      sud_dqf    clin

2                               | 2 dependent endmembers

fames_i  = 1 ames   + 4/5 daph  - 4/5 clin
fsud_i   = 1 sud_dqf   + 2/5 daph  - 2/5 clin

0 0 0 0 0 0                  |endmember flags

                             | subdivision model for (ternary) site 1 (T2):
0. 1. .1 0                   | range and resolution of X(Al_Si), imod = 0 -> cartesian subdivision
0. 1. .1 0                   | range and resolution of X(Al_Al), imod = 0 -> cartesian subdivision
                             
                             | subdivision model for (ternary) site 2 (M2)
0. 1.  .1 0                  | range and resolution of X(Fe), imod = 0 -> cartesian subdivision 

begin_excess_function

w(clin ames)      18000. 0. 0. 
w(clin daph)      2500. 0. 0.
w(clin sud_dqf)   49100. 0. 0.
w(daph ames)      13500. 0. 0.
w(daph sud_dqf)   43400. 0. 0.
w(ames sud_dqf)   43300. 0. 0.

end_excess_function

3                               |3 site configurational entropy model:

4 1.                            |4 species on 1 M1 site

z(al,M1) = 1 ames
z(mg,M1) = 1 clin
z(fe,M1) = 1 daph 

3 4.                            |3 species on 4 M2+M3 sites

z(fe,m2+m3) = 1 daph
z(mg,m2+m3) = 1 clin + 1 ames + 1/2 sud_dqf

2 2.                            |2 species on 2 T2 sites

z(al,T2) = 1 ames + 1/2 clin + 1/2 daph + 1/2 sud_dqf

site_check_override

end_of_model  

                                   9 compositionally independent endmembers
                                   1 ordered endmember
                                   the mbuf exchange is limited to {MgTi}/2{Fe} - {FeTi}/2{MgFe}/2
                                   15 dependent endmembers
                                   16 fillers of which 4 are utterly superfluous


                                                        M1     M2     T
                                                     ____________________________________

                                      Multiplicity      1      1     1/2 <- fake T multiplicity
                                                     ____________________________________
                                        mkbuf_d         MgTi   K     Si    dependent 
                                        mnbuf_d         MgTi   Na    Si    dependent
                                        mcbuf           MgTi   Ca   AlSi 
                                        mcbuf_d1        MgTi   Ca   AlSi   filler
                                        ___
                                        mkbuf_d1        MgTi   K     Si    filler 
                                        mnbuf_d1        MgTi   Na    Si    filler
                                        mbuf_d          MgTi   Mg   AlSi   dependent
                                        mfbuf_d         MgTi   Fe   AlSi   dependent
                                        _________
                                        crkjd_d         Cr     K     Si    dependent
                                        crjd_d          Cr     Na    Si    dependent
                                        crdi            Cr     Ca   AlSi   
                                        crdi_d1         Cr     Ca   AlSi   filler
                                        ___
                                        crkjd_d1        Cr     K     Si    filler
                                        crjd_d1         Cr     Na    Si    filler
                                        cren_d          Cr     Mg   AlSi   dependent
                                        crfs_d          Cr     Fe   AlSi   dependent
                                        _________
                                        kess_d          Fe3+   K     Si    dependent
                                        ness_d          Fe3+   Na    Si    dependent
                                        cess            Fe3    Ca   AlSi
                                        cess_d1         Fe3    Ca   AlSi   filler
                                        ___
                                        kess_d1         Fe3+   K     Si    filler
                                        ness_d1         Fe3+   Na    Si    filler
                                        mess_d          Fe3    Mg   AlSi   dependent 
                                        fess_d          Fe3    Fe   AlSi   dependent
                                        _________
                                        kjdh            Al     K     Si  
                                        jd              Al     Na    Si   
                                        cats            Al     Ca   AlSi   
                                        cats_d1         Al     Ca   AlSi   filler
                                        ___
                                        kjd_d1          Al     K     Si    filler
                                        jd_d1           Al     Na    Si    filler
                                        mats_d          Al     Mg   AlSi   dependent
                                        fats_d          Al     Fe   AlSi   dependent
                                        _________
                                        kjd_d2          Al     K     Si    filler
                                        jd_d2           Al     Na    Si    filler
                                        di              Mg     Ca    Si
                                        hed_d           Fe     Ca    Si    dependent
                                        ___
                                        kjd_d3          Al     K     Si    filler
                                        jd_d3           Al     Na    Si    filler
                                        cenjh           Mg     Mg    Si 
                                        cfsg            Fe     Fe    Si
                                        _______________________________________________