690 DO NOT DELETE THIS LINE

                            ---------------------------------------------------------------------------
                             FOR MODEL DEFINITIONS AND REFERENCES READ THE MODEL COMMENTARY OR REFER TO
                             THE GLOSSARY AT:

                             www.perplex.ethz.ch/perplex_documentation.html#SOLUTION_MODEL_GLOSSARY

                            ---------------------------------------------------------------------------

                             DO NOT USE TABS IN PERPLE_X DATA FILES, TAB CHARACTERS ARE NOT INTERPRETED AS
                             BLANK SPACES AND CAUSE FORMATTING ERRORS.

                            ---------------------------------------------------------------------------

                             Character data is format free.

                            ---------------------------------------------------------------------------

                             Comments can be placed between models provided, nothing is written in the
                             first 10 columns. Comments may be placed after data if it is separated from
                             the data by a '|' marker.

                            ---------------------------------------------------------------------------

                             VARIOUS DOCUMENTATION SECTIONS BELOW:

                             I)   Solution model types
                             II)  Subdivision schemes
                             III) Species limits for order-disorder models
                             IV)  Templates for solution model types 2 and 39

                            ---------------------------------------------------------------------------

                             I) Solution model types are:

                             2   - simplicial composition space.
                             6   - order-disorder, simplicial composition space.
                             7   - polytope composition space (reciprocal when correct).
                             8   - order-disorder, polytope composition space.
                             688 - generic format, i.e., encompasses all of the above.

                             Special model types:

                             0     - internal (fluid) EoS
                             20    - Electrolyte (charge balance) model
                             26    - Haefner H2O-CO2-NaCl
                             29    - BCC Fe-Si alloy, Lacaze & Sundman 1990.
                             30-33 - FeSiC alloys (BCC/FCC/CBCC/HCP), Lacaze & Sundman 1990.
                             39    - generic hybrid fluid EoS
                             40    - Silicate fluid (MRK)
                             41    - COH fluid (hybrid MRK)
                             42    - FeS liquid, Saxena & Eriksson 2015 with ECRG corrections
                            ---------------------------------------------------------------------------

                             II) SUBDIVISION SCHEMES define the discretization and range of compositions for a solution
                             during a calculation. In many cases, particularly for chemically complex solutions,
                             this range is restricted to reduce the time and memory required for calculations.
                             If such a restriction is encountered (**warning ver991**) during the exploratory
                             stage of a calculation the restriction may have consequences for the final
                             auto-refine stage result. For this reason it is important for users to correct
                             the scheme (unless the restriction is intentional). A resume of warnings written
                             at the end of the exploratory stage is written to the *_auto_refine.txt file.
                             This file should be examined before any results are accepted as final.

                             There are only two subdivision schemes implemented in the current version of Perple_X
                             (6.8.1+): Cartesian subdivision and non-linear subdivision. Cartesian is more
                             robust and is therefore specified for most solution models by default. Non-linear
                             subdivision allows for high resolution at low concentrations of a species. It is
                             recommended for any compositional variable whose maximum anticipated value is less
                             than the value of the exploratory stage initial_resolution (default = 1/16) and it
                             is mandatory for any compositional variable whose maximum anticipated value is less
                             than the value of the auto-refine stage final_resolution (default = 1e-3). For example,
                             the mole fraction of Zr in granitic melts using the melt(HP) model is ~1e-5. If this
                             melt model is run with the default option values, Perple_X will indicate that Zr is
                             insoluble (i.e., below the limit of resolution).

                             A brief description of the Cartesian and non-linear subdivision schemes follows
                             (it reads worse than it is):

                             If the solution model has a simplicial composition space, then each scheme is
                             directly associated with an endmember (as identified in *_auto_refine.txt). For
                             a solution with N endmembers, there are thus N-1 subdivision schemes. In general
                             it is best to order the solution model endmembers so that the most important end-
                             member is listed last and therefore determined by difference.

                             If the solution model has a prismatic composition space (in Perple_X a polyhedral 
                             composition with more vertices than a simplex, e.g., a quadrilateral, is referred
                             to as a prism), then a subdivision scheme is
                             associated with the S-1 independent compositions of the T simplexes that comprise
                             the prism (as identified in *_auto_refine.txt). Thus for prismatic composition spaces
                             there are T*(S-1) subdivision schemes for the compositional variables X(1..T,1..S-1).
                             X(1..T,S) is determined by difference and therefore then endmembers should be ordered
                             so that X(1..T,S) corresponds to the most important compositional variable.

                             The subdivision scheme for each independent compositional variable (X) is specified by
                             four parameters that are entered as XMIN, XMAX, XINC, IMOD. The significance of these
                             parameters is dicussed below.

                             NOTE 1: 
                             In solution model type 688 format, if the composition space of the model involves at
                             least one prism, the subdivision scheme parameters for every independent composition 
                             include a name for the compositional variable, i.e., NAME, XMIN, XMAX, XINC, IMOD, 
                             where NAME is an alphanumeric string used to identify the variable in output. 

                             NOTE 2: 
                             For purposes of this discussion XMIN, XMAX, and XINC are described as static variables
                             as is indeed the case for calculations with CONVEX; however, during adaptive optimization
                             calculations in VERTEX and MEEMUM these variables are rescaled to obtain higher resolution,
                             see www.perplex.ethz.ch/perplex_options_body.html#Iteration for information on this scaling.

                             IMOD - may be either 0 or 1:

                                 IMOD = 0 - is a cartesian scheme, in which the compositional variable is discretized
                                            with regular spacing.

                                 IMOD = 1 - is a conformal, non-linear, transformation scheme, in which the discretization
                                            of the compositional variable becomes finer toward zero. Use of this scheme
                                            is recommended if the maximum anticipated value of the compositional variable
                                            is < the initial_resolution option value. It is mandatory if the maximum anticipated
                                            value of the compositional variable is < the final_resolution option value.
                                            It should be used with caution if the maximum anticipated value of the compositional
                                            variable is >> initial_resolution. And it should NOT be used if the maximum anticipated
                                            value of the compositional variable is > 1/2.

                             XMAX - is the maximum value of the compositional variable permitted by the scheme. This
                                    value may be relaxed if the hard_limits option is FALSE (default).

                             XMIN - the exact significance of XMIN is dependent on the subdivision scheme:

                                 IMOD = 0 - XMIN is the minumum value of the compositional variable permitted by
                                            the scheme. This value may be relaxed if the hard_limits option is
                                            FALSE (default).

                                 IMOD = 1 and XMIN > 0 - XMIN is the smallest non-zero value of the compositon
                                            for statically generated compositions. Thus, the value of XMIN dictates
                                            the asymmetry of the discretization. XMIN should be of the order of
                                            magnitude the smallest anticipated value of X, values of XMIN more
                                            than an order of magnitude below this value are wasteful. During
                                            adaptive optimization (VERTEX/MEEMUM), XMIN does not limit X. During
                                            convexhull optimization (CONVEX), X < XMIN is allowed if the hard_limits
                                            option is FALSE (default).

                                 IMOD = 1 and XMIN = 0 - the asymmetry of the discretization is specified by the
                                             stretch_factor option.

                                 For IMOD = 1, compositions are always generated at X = 0, X = XMIN, and X = XMAX.

                             XINC - controls the discretization (resolution) of the compositional variable its exact
                                    significance is dependent on the subdivision scheme or values of the 
                                     initial_resolution option

                                 initial_resolution = [0 0] - XINC is read from the relevant solution model, regardless 
                                            of the value of IMOD.

                                 IMOD = 0 - linear scheme - the number of compositions generated over the interval
                                            [XMIN XMAX] is 1/XINC + 1. XINC is equated to the appropriate (exploratory
                                            or auto-refine stage) value of the initial_resolution keyword, which defaults to
                                            [1/16 1/48].

                                 IMOD = 1 - nonlinear scheme - 1/XINC + 1 is the number of compositions that would
                                            be generated over the interval [0 1]. The actual number of compositions
                                            generated depends on the asymetry of the scheme and the value of XMAX.
                                            Compositions are always generated at X = 0 and X = XMIN, additional
                                            compositions are generated by incrementing the conformal variable by
                                            XINC until the X > XMAX, this final value of X is then reset to XMAX.
                                            This algorithm has the consequence that the number of compositions generated
                                            is always 1/XINC + 1 if XMAX = 1; for values XMAX < 1, small values of
                                            XINC will cause more compositions to be generated over the interval
                                            [0 XMAX], the tables below illustrate the dependence of the number of
                                            compositions on XINC and XMIN. Because Perple_X adaptively refines
                                            compositions to a resolution comparable to the final_resolution option
                                            value, it is generally unnecessary to generate a large number of compositions
                                            at low X values as occurs if XINC is small.

                                            For adaptive optimization (programs MEEMUM and VERTEX) the default behavior
                                            is that XINC is read from the text of the relevant solution model.

                                            For convexhull optimization (program CONVEX) the default behavior is that
                                            XINC is equated to the appropriate (exploratory or auto-refine stage) 
                                            value of the initial_resolution keyword, provided this value is non-zero.

                                            These defaults toggle when the non_linear_switch option is set to T (true).

                             TIPS ON THE USE OF NON-LINEAR SUBDIVISION

                             1) If XMAX = 1, then the number of compositions generated by non-linear subdivision is dictated
                                entirely by XINC. XMIN controls the asymmetry of the subdivision such that the
                                compositions cluster more closely to XMIN as XMIN becomes smaller. Setting XMAX < 1
                                chops off the poorly resolved region of the composition space; by definition, few
                                compositions are generated in this region, therefore reducing XMAX does not save much
                                memory, this is illustrated in the 3rd table below by the difference in the number of compositions
                                generated for XMAX = 0.1 and XMAX = 0.2. XMAX should be > the maximum anticipated
                                value of the composition. If this is not the case Perple_X will write a warning to the
                                my_project_auto_refine.txt file. Non-linear subdivision should NOT be used with
                                XMAX > 1/2.

                             2) XMIN should be the same order of magnitude as the minimum anticipated value of the
                                composition. If XMIN is much lower than this composition, compositional resolution will
                                deteriorate more rapidly than is necessary toward XMAX. The minimum actual value of all
                                compositional values is written to the my_project_auto_refine.txt file.

                             3) XMIN should be at least one order of magnitude < the exploratory-stage value of
                                the initial_resolution option (typically 1/16 to 1/8), i.e., XMIN should be <= 1e-2 for
                                most applications.

                             4) As a rule of thumb XINC should be chosen for adaptive optimization (MEEMUM/VERTEX)
                                so that the number of compositions generated between XMIN and XMAX is equal to the number
                                of decades of resolution between XMIN and XMAX. For example, if XMIN = 1e-4 and
                                XMAX = 1e-1, the scheme must cover log(1e-1/1e-4) = 3 decades of resolution. The
                                exact value of XINC necessary to achieve this is dependent on both XMAX and XMIN,
                                but the results in the 3rd table below suggest that XINC = 0.2 should be adequate
                                for most purposes.

                                               XINC = 1/48 = 0.002083... (default auto-refine stage initial_resolution)
                                                             XMAX   0.1     0.2
                                                       XMIN  ----------------------
                                                       1d-2          10      17
                                                       1d-3          24      31
                                                       1d-4          32      37
                                                       1d-5          36      40

                                               XINC = 1/16 = 0.0625 (default exploratory stage initial_resolution)
                                                             XMAX   0.1     0.2
                                                       XMIN  ----------------------
                                                       1d-2           7       9
                                                       1d-3          11      12
                                                       1d-4          13      14
                                                       1d-5          14      15

                                               XINC = 0.1 or 0.2
                                                             XMAX   0.1     0.2
                                                       XMIN  ----------------------
                                                       1d-2           4       5
                                                       1d-3           5       5
                                                       1d-4           5       6
                                                       1d-5           6       6

                            ---------------------------------------------------------------------------

                             III) Species limits for order-disorder models, refer to:

                             www.perplex.ethz.ch/perplex/faq/species_limit_expressions_for_type_6_and_8_solution_models.txt

                            ---------------------------------------------------------------------------

                             IV) Templates for solution model types 2 and 39, refer to:

                             www.perplex.ethz.ch/perplex/faq/solution_model_type_2_(simple)_template.dat
                             www.perplex.ethz.ch/perplex/faq/solution_model_type_39_(GFSM)_template.dat

                             For additional information on generic fluid solution models (GFSM) refer to

                             perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                            ---------------------------------------------------------------------------
begin_model         
                      | Ti-Fe-Mg-OH-O Chlinohumite, with ad-hoc Ti and Fe, assumes, somewhat improbably, that 
                      | Fe and Mg are disordered across MO and MB and that Ti is disordered on MB. this model 
                      | is an implicit o/d model because the ftchum endmember is specified as an independent 
                      | endmember. JADC, 5/20.

                                      Site:           MB      MO       OH
                                                     ____________________________
                                      Mutliplicity    1       8        2

                                    endmember        ____________________________   type
                                    _________                                       _________

                                        chum          Mg      Mg       OH            independent
                                        tchum         TiMg    Mg       OOH           independent
                                        fchum         Fe      Fe       OH            independent
                                        ftchum        TiFe    Fe       OOH           independent

                      | chum is in holland & powell data files, as is an arbitrary make definition for
                      | fchum (after fruh-green et al 94). this model requires make definitions (or real data) 
                      | for fchum, tchum, and ftchum, suggested make definitions are: 

                      | fchum = 1 chum - 1/3 ta + 1/3 fta - 4 fo + 4 fa
                      | DQF = 0

                      | tchum = 1 chum - 1/2 br + 1/2 ru
                      | DQF = -R*ln(2)*T

                      | ftchum = 1 chum - 1/2 br + 1/2 ru - 1/6 ta + 1/6 fta - 4 fo + 4 fa
                      | DQF = -R*ln(2)*T

TiCh(PL)
abbreviation TiCh
full_name    clinohumite

688                                | model type: 688 format standard model
 
1                                  | number of polytopes
2                                  | number of simplices
2 2                                | number of vertices on each simplex
chum       tchum
fchum      ftchum

X_Ti 0. 1   .1   0                 | imod = 0 -> cartesian subdivision
X_M  by difference

X_Fe 0. 1   .1   0                 | imod = 0 -> cartesian subdivision
X_Mg by difference

ideal

3                                   | number of sites in configurational entropy model

MO                                  | site name
2 8 8                               | number of species, effective multiplicity, true multiplicity
z(Mg,M)  = 1 chum + 1 tchum
z(Fe,M)  = 1 fchum + 1 ftchum

MB                                  | site name
3 1 1                               | number of species, effective multiplicity, true multiplicity
z(Ti,M)  = 1/2 tchum + 1/2 ftchum
z(Mg,M)  = 1 chum  + 1/2 tchum
z(Fe,M)  = 1 fchum + 1/2 ftchum

OH                                  | site name
2 2 2                               | number of species, effective multiplicity, true multiplicity
z(OH,OH) = 1 chum + 1/2 tchum + 1 fchum + 1/2 ftchum
z(O,OH)  = 1/2 tchum + 1/2 ftchum

[Si4O16]                            | formula suffix, enter "none" for no suffix.

end_of_model
                            ---------------------------------------------------------------------------
begin_model         

                      | Ti-Fe-Mg-F Chondrodite, with non-ideal F-OH interaction after Duffy & Greenwood, Am Min 64:1156-1174, 1979.
                      | Ad-hoc Ti and Fe, assumes, somewhat improbably, that Fe and Mg are disordered across
                      | MO and MB and that Ti is disordered on MB. this model is an implicit o/d model because
                      | the tichdr endmember is specified as an independent endmember. JADC, 5/20.

                                      Site:           MB      MO       OH
                                                     ____________________________
                                      Mutliplicity    1       8        2

                                    endmember        ____________________________   type
                                    _________                                       _________

                                        chdr         Mg      Mg       OH            independent
                                        fchdr        Mg      Mg       F             independent
                                        tchdr        Mg      TiMg     OOH           independent
                                        ftchdr       Mg      TiMg     OF            dependent
                                        ichdr        Fe      Fe       OH            independent
                                        fichdr       Fe      Fe       F             dependent
                                        tichdr       Fe      TiFe     OOH           independent
                                        ftichdr      Fe      TiFe     OF            dependent

                        This model requires data (or a make definition) for tichdr, my first guess would
                        be to use tchdr + 4*(fa-fo) + (fta-ta).

TiChdr(B)
abbreviation TiCh
full_name    clinohumite

688                                | model type: 688 format standard model
 
1                                  | number of polytopes
3                                  | number of simplices
2 2 2                              | number of vertices on each simplex
chdr      fchdr
tchdr     ftchdr
ichdr     fichdr
tichdr    ftichdr

X_F  0. 1   .1   0                      | X(F), imod = 0 -> cartesian subdivision
X_OH by difference

X_Ti 0. 1   .1   0                      | X(Ti), imod = 0 -> cartesian subdivision
X_M  by difference

X_Fe 0. 1   .1   0                      | X(Fe), imod = 0 -> cartesian subdivision
X_Mg by difference

begin_dependent_endmembers
ftchdr   = 1 tchdr + 1/2 fchdr - 1/2 chdr
fichdr   = 1 ichdr + 1 fchdr - 1 chdr
ftichdr  = 1 tichdr + 1/2 fchdr - 1/2 chdr
end_dependent_endmembers

begin_excess_function

W(ichdr  ichdr  fchdr)  -21572
W(chdr  tichdr fchdr)   -21572
W(tichdr tichdr fchdr)   -5393
W(ichdr  fchdr fchdr)   -59120
W(fchdr fchdr tichdr)   -29560

W(fchdr chdr ichdr)    -43144.2
W(fchdr ichdr tchdr)   -21572.1
W(fchdr ichdr tichdr)  -21572.1
W(fchdr tchdr tichdr)  -10786.05

W(chdr  chdr  fchdr)   -21572
W(chdr  tchdr fchdr)   -21572
W(tchdr tchdr fchdr)    -5393
W(chdr  fchdr fchdr)   -59120
W(fchdr fchdr tchdr)   -29560
end_excess_function

3                                   | number of sites in configurational entropy model

MO                                  | site name
2 8 8                               | number of species, effective multiplicity, true multiplicity
z(Mg,M)  = 1 fchdr + 1 chdr + 1 tchdr
z(Fe,M)  = 1 ichdr + 1 tichdr

MB                                  | site name
3 1 1                               | number of species, effective multiplicity, true multiplicity
z(Ti,M)  = 1/2 tchdr + 1/2 tichdr
z(Mg,M)  = 1 fchdr + 1 chdr + 1/2 tchdr
z(Fe,M)  = 1 ichdr + 1/2 tichdr

OH                                  | site name
3 2 2                               | number of species, effective multiplicity, true multiplicity
z(OH,OH) = 1 chdr + 1/2 tchdr + 1 ichdr + 1/2 tichdr
z(F,OH)  = 1 fchdr
z(O,OH)  = 1/2 tchdr + 1/2 tichdr

[Si4O16]                            | formula suffix, enter "none" for no suffix.

end_of_model
                            ---------------------------------------------------------------------------
begin_model                
                           ternary feldsar (fuhrman & lindsley, am min, 1988)
                           for binary plagioclse this model is identical
                           to that of Newton et al. 1980, and for binary
                           alkali feldspar it is identical to Haselton et al. (1983).

                           CORRECTED FOR TYPO IN ORIGINAL PAPER.

feldspar                   
abbreviation Fsp
full_name    ternary-feldspar

688                                | model type: 688 format standard model
 
1                                  | number of polytopes
1                                  | number of simplices
3                                  | number of vertices on each simplex
abh                                | endmembers on the vertices
an
san

0. 1   .1   0                      | range and resolution for albite, imod = 0 -> cartesian subdivision
0. 1   .1   0                      | range and resolution for anorthite, imod = 0 -> cartesian subdivision

begin_excess_function 
w(abh abh san) 27320   -10.3  .394 * P_bar
w(abh san san) 18810   -10.3  .394 * P_bar
w(an  an  san) 52468          
w(an  san san) 47396          -.12 * P_bar
w(an  an  abh) 28226
w(an  abh abh) 8471
w(an  abh san) 100045.5 -10.3 -0.76 * P_bar
end_excess_function 

2                                   | number of sites in configurational entropy model

M                                   | site name
3 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na,M)  = 1 abh
z(Ca,M)  = 1 an
z(K,M)   = 1 san

T1                                  | site name
2 2 2                               | number of species, effective multiplicity, true multiplicity
z(Al,T1) = 1/2 + 1/2 an
z(Si,T1) = 1/2 - 1/2 an

[Si2O8]                             | formula suffix, enter "none" for no suffix.

reach_increment 3

end_of_model
                      ---------------------------------------------------------
begin_model
                      cAmph(G)_I => Green et al. (JMG, 2016) clinoamphibole. 
                      
                      ---------------------------------------------------------
                      Reformulated as a 4-subcomposition 688 format model. JADC, 3/20

                      The composition space of the complete (published) model can be represented as
                      a mixture of three independent subcompositions

                      tschermakitic amphibole: {Mg,Fe}*[Al,Fe3,Ti]M2*[M,C,N]M4 (18 endmembers)
                      pargasitic amphibole:    {Mg,Fe}*[K,N]A*[MAl,MFe3,MTi]M2*[M,C]M4 (36 endmembers)
                      divalent amphibole:      {Mg,Fe}*[M,C]M4 (4 endmembers)

                      where T1 = f(N,M4), OH = f(Ti,M2)
                      ---------------------------------------------------------
                      NOTE: the above compositions can be combined to form the dependent subcomposition

                      piglitic amphibole:      {Mg,Fe}*[K,N]A*[Al,Ti,Fe3]M2*[N,CN,MN]M4 (36 endmembers) 

                      Because Perple_X does not currently allow dependent subcompositons, piglitic 
                      compositions can only be reached if the piglitic subcomposition is treated as an
                      independent composition. This practice is extremely costly and for this reason the
                      piglitic subcomposition has been commented out in the model text below. To restore
                      the full model remove the comments and correct the subcomposition counter accordingly. 

                      The consequence of omitting piglitic compositions is that the site fraction of alkalis
                      on the A-site (z[N+K,A]) is constrained to be less than one minus the site fraction of 
                      the alkalis on the M4 site (z[N,M4]), whereas in the full model z[N+K,A] may be as large
                      as 1 - 1/2*z[N,M4].
                      
                      If the piglitic subcomposition is restored, then tt is probable that VERTEX/MEEMUM will 
                      run out of dynamic memory. Should this occur, uncomment the low_reach option keyword
                      at the end of this model. The low_reach option dramatically reduces the
                      memory and time required for calculations, but may also causes a significant
                      deterioration in phase diagram quality.
                      ---------------------------------------------------------
                      NOTE: to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                         mrbG  = 1 gl - 1 gr + 1 andr
                            DQF = 0
                         kprg  = 1 mu - 1 pa + 1 parg
                            DQF = -7060 + 20 * T_K
                         tts   = -2 dsp + 2 ru + 1 ts
                            DQF =   95000

                      to avoid cluttering thermodynamic data files with the new plague of TC
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                         DQF(gl)   = -3000
                         DQF(parg) = -10000
                         DQF(ts)   =  10000
                         DQF(grun) = -3000

                      For (nonsensical, but common) positive DFQ's this approach may lead to
                      interference between the phase relations of the solution model and the
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.
                      ---------------------------------------------------------
                      independent endmembers and site populations:

                                                           Sites
                                            A    M1      M2      M4     T1     OH
                                            _______________________________________

                            Multiplicity    1     3      2       2     1(4)    2
                                            _______________________________________

                              Ts            V     Mg     Al     Ca     SiAl    OH
                              Parg          Na    Mg    MgAl    Ca     SiAl    OH
                              Kprg          K     Mg    MgAl    Ca     SiAl    OH
                              Tts           V     Mg     Ti     Ca     SiAl    O
                              Gl            V     Mg     Al     Na      Si     OH
                              mrbG          V     Mg     Fe3    Na      Si     OH
                              Tr            V     Mg     Mg     Ca      Si     OH
                              Cumm          V     Mg     Mg     Mg      Si     OH
                              Grun          V     Fe     Fe     Fe      Si     OH

                              a             V     Mg     Fe     Fe      Si     OH
                              b             V     Fe     Mg     Fe      Si     OH

                      cross-site exchanges
                             2 NaCa-1(M4) + 2 SiAl-1(T1)  = (gl-ts)
                             2 TiAl-1(M2) + 2 H-1(OH)     = (Tts-Ts)
                               NaV-1(A)   + 1 AlMg-1(M2)  = (parg-ts) = (parg-tr)
                               AlMg-1(M2) + 1 NaCa-1(M4)  = (gl-cumm)/2

                      intra-site exchanges
                               NaK-1(A)                   = (parg-kparg)
                             2 CaMg-1(M4)                 = (Tr-Cumm)
                             2 Fe3Al-1(M2)                = (Rb-Gl)
                             3 FeMg-1(M1)                 = (grun - a)
                             2 FeMg-1(M2)                 = (grun - b)
                             2 FeMg-1(M4)                 = (-grun + cumm + a + b)
                      ---------------------------------------------------------
cAmph_I(G)
abbreviation Amph
full_name    clinoamphibole

688                                | model type: 688 format standard model
 
3                                  | number of subcompositions
                                   | subcomposition names and composite composition space subdivision schemes
Ts-Amph    0   .5   .25  0        | X([ ][M][T][M,C,N])
Pg-Amph    0   .5   .25  0        | X([A][M][MT][M,C,N])
|Pgl-Amph   0   .1   .1  0          | X([A][M][T][MN,CN,N])
Trem-Amph  by difference           | X([ ][M][M][MC])

                                   | -------------------------------------------
                                   | subcomposition 1 [Mg,Fe]*[ ]*[M]*[Ti,Fe3,Al]*[M,C,N]
3                                  | number of simplices
2 3 3                              | number of vertices on each simplex
 
                                   | Simplex 1 {Mg,Fe} pseudo-site for the conditional cartesian product, defines bulk Mg/Fe
                                   | Simplex 2 T = Ti, Fe3, Al; z(T,M2)
                                   | Simplex 3 exchange vectors as below:

                                   | minor (0.09 bl478):
vmtn_d     vftn_d                  | [ ][M][Ti][N]      Ti-glaucophane *
mrbG       frb_d                   | [ ][M][Fe][N]      Fe3-glaucophane, aka riebeckite
gl         fgl_d                   | [ ][M][Al][N]      Al-glaucophane

mtts_d     ftts_d                  | [ ][M][Ti][M]      Ti-Ts
mgrk_d     fgrk_d                  | [ ][M][Fe][M]      Fe3-Ts
mts_d      fts_d                   | [ ][M][Al][M]      Al-Ts

tts        fctts_d                 | [ ][M][Ti][C]      M-Ca-Ti_tschermaks
mcgrk_d    fcgrk_d                 | [ ][M][Fe][C]      M-Ca-Fe3+_tschermaks (Na-free riebeckite)
ts         fcts_d                  | [ ][M][Al][C]      Al-cTs

                                   | 1st simplex
x_Mg,1    0    1  .25  0           | bulk Mg/M
x_Fe,1    by difference
                                   | 2nd simplex
z_Ti,1    0   .5 .25  0           | T on M2
z_Fe,1    0   1 .25  0           |
z_Al,1    by difference
                                   | 3rd simplex
z_Na,1    0   .5 .25  0           | M,C,N on M4
z_M,1     0   .5 .25  0           |
z_Ca,1    by difference

                                   | -------------------------------------------
                                   | subcomposition 2 [Mg,Fe]*[A]*[M]*[MT]*[M,C]
4 3                                | number of simplices
2 3 2 2                            | number of vertices on each simplex

                                   | Simplex 1 {Mg,Fe} pseudo-site that defines bulk Mg/Fe
                                   | Simplex 2 {Ti, Fe3, Al} on M2
                                   | Simplex 3 {K, Na} on A
                                   | Simplex 4 {M,C} on M4

tmkpg_d    tfkpg_d                 | [K][M][MTi][M]     K-Ti-M-Pg
omkpg_d    ofkpg_d                 | [K][M][MFe][M]     K-Fe3+-M parg
kmparg_d   kfparg_d                | [K][M][MAl][M]     K-Al-M parg

tmpg_d     tfpg_d                  | [N][M][MTi][M]     N-Ti-M-Pg
ompg_d     ofpg_d                  | [N][M][MFe][M]     Na-Fe3+-M parg
mparg_d    fparg_d                 | [N][M][MAl][M]     Na-Al-M parg

                                   | minor (0.06 bl478):
tcmkpg_d   tcfkpg_d                | [K][M][MTi][C]     K-Ti-Ca parg
ocmkpg_d   ocfkpg_d                | [K][M][MFe][C]     K-Fe3-Ca parg
kprg       kfcprg_d                | [K][M][MAl][C]     K-Al-Ca parg

tcmpg_d    tcfpg_d                 | [N][M][MTi][C]     N-Ti-Ca parg
ocmpg_d    ocfpg_d                 | [N][M][MFe][C]     Na-Fe3-Ca parg
parg       fcparg_d                | [N][M][MAl][C]     Na-Al-Ca parg

                                   | 1st simplex
x_Mg,2    0    1  .25  0            | bulk Mg/M
x_Fe,2    by difference
                                   | 2nd simplex
z_MTi     0    1  .25  0            | T on M2
z_MFe     0    1  .25  0
z_MAl     by difference
                                   | 4th simplex
z_K,2     0   .25   .25  0           | K,Na on A
z_Na,2    by difference
                                   | 3rd simplex
z_M,2     0   .5   .25  0           | M,C on M4
z_C,2     by difference

                                   | -------------------------------------------
                                   | subcomposition 3 [Mg,Fe]*[N,CN,MN]*[K,N]*[Al,Ti,Fe3]
|4                                 | number of simplices

|2 3 2 3                           | number of vertices on each simplex [Mg,Fe]*[N,CN,MN]*[K,N]*[Al,Ti,Fe3]

|kmtn_d      kftn_d                | [K][M][MTi][N]     K-Ti-N-Pgl 
|kmtmn_d     kftfn_d               | [K][M][Ti][MN]     K-Ti-MN-Pgl**
|kmtcn_d     kftcn_d               | [K][M][Ti][CN]     K-Ti-CN-Pgl**
|nmtn_d      nftn_d                | [N][M][MTi][N]     N-Ti-N-Pgl 
|nmtmn_d     nftfn_d               | [N][M][Ti][MN]     N-Ti-MN-Pgl**
|nmtcn_d     nftcn_d               | [N][M][Ti][CN]     N-Ti-CN-Pgl**

|kmfn_d      kffn_d                | [K][M][MFe][N]     K-Fe-N-Pgl 
|kmfmn_d     kfffn_d               | [K][M][Fe][MN]     K-Fe-MN-Pgl**
|kmfcn_d     kffcn_d               | [K][M][Fe][CN]     K-Fe-CN-Pgl**
|nmfn_d      nffn_d                | [N][M][MFe][N]     N-Fe-N-Pgl 
|nmfmn_d     nfffn_d               | [N][M][Fe][MN]     N-Fe-MN-Pgl**
|nmfcn_d     nffcn_d               | [N][M][Fe][CN]     N-Fe-CN-Pgl**

|kman_d      kfan_d                | [K][M][MAl][N]     K-Al-N-Pgl 
|kmamn_d     kfafn_d               | [K][M][Al][MN]     K-Al-MN-Pgl**
|kmacn_d     kfacn_d               | [K][M][Al][CN]     K-Al-CN-Pgl**
|nman_d      nfan_d                | [N][M][MAl][N]     N-Al-N-Pgl
|nmamn_d     nfafn_d               | [N][M][Al][MN]     N-Al-MN-Pgl**
|nmacn_d     nfacn_d               | [N][M][Al][CN]     N-Al-CN-Pgl**

                                   | 1st simplex
|x_Mg,3    0    1   .1  0          | bulk Mg/M
|x_Fe,3    by difference
                                   | 2nd simplex
|z_MN,3    0    1   .1  0          | MN,CN,N on M4
|z_CN,3    0    1   .1  0
|z_N,3     by difference
                                   | 3rd simplex
|z_K,3     0    1   .1  0          | K,Na on A
|z_Na,3    by difference
                                   | 4th simplex
|z_Ti,3    0   .2   .1  0          | T on M2
|z_Fe,3    0   .7   .1  0
|z_Al,3    by difference
                                   | -------------------------------------------
                                   | subcomposition 4 [Mg,Fe]*[ ][M][M][M,C] 
2                                  | number of simplices
2 2                                | number of vertices on each non-zero-d simplex

cumm       grun                    | M-Ca divalent amphibole
tr         ftr_d
                                   | First simplex
x_Mg      0    1   .25  0           | X(1,1) = bulk Mg/M
x_Fe      by difference
                                   | Second simplex
z_M       0    1   .25  0          | [ ][M][M][M]
z_C       by difference            | [ ][M][M][C]

begin_ordered_endmembers
a     = 3/7 cumm + 4/7 grun  delta_g_of_ordering   =   -9486  | = DQF(A) -4/7 DQF(Grun)
b     = 2/7 cumm + 5/7 grun  delta_g_of_ordering   =  -11657  | = DQF(B) -5/7 DQF(Grun)
end_ordered_endmembers 

begin_dependent_endmembers
                                   |==================================================
                                   | dependent endmembers for Tschermakitic subcomposition
                                   | T = Al
fcts_d = 1 ts + 1 grun - 1 a
fts_d  = 1 ts - 1 tr + 1 b
mts_d  = 1 ts - 1 tr + 1 cumm
fgl_d    = 1 gl    + 1 grun   - 1 a
                                   | T = Ti
vmtn_d   = 1 gl     + 1 tts - 1 ts 
vftn_d   = 1 gl    + 1 grun   - 1 a + 1 tts - 1 ts
fctts_d  = 1 tts   + 1 grun   - 1 a
ftts_d   = 1 tts   - 1 tr     + 1 b
mtts_d   = 1 tts   - 1 tr     + 1 cumm
                                   | T = Fe3 
frb_d    = 1 mrbG  + 1 grun   - 1 a
mcgrk_d  = 1 mrbG  + 1 ts    - 1 gl
mgrk_d   = 1 mrbG  + 1 ts    - 1 gl     - 1 tr   + 1 cumm
fgrk_d   = 1 mrbG  + 1 ts    - 1 gl     - 1 tr   + 1 b
fcgrk_d  = 1 mrbG  + 1 ts    - 1 gl     - 1 a  + 1 grun
                                   |==================================================
                                   | dependent endmembers for Pargasitic subcomposition
                                   | M or Ca on M4, Al on M2
fcparg_d  = 1 parg  + 3/2 grun - 1 a - 1/2 b
fparg_d   = 1 parg  + 1/2 grun + 1/2 b - 1 tr
mparg_d   = 1 parg  - 1 tr     + 1 cumm
kfcprg_d  = 1 kprg  + 3/2 grun - 1 a - 1/2 b
kfparg_d  = 1 kprg  + 1/2 grun + 1/2 b - 1 tr
kmparg_d  = 1 kprg  - 1 tr + 1 cumm
                                   | M or Ca on M4, Ti on M2
tcmpg_d   = 1 parg  + 1/2 tts - 1/2 ts
tcfpg_d   = 1 parg  + 3/2 grun - 1 a - 1/2 b + 1/2 tts - 1/2 ts
tmpg_d    = 1 parg  - 1 tr     + 1 cumm + 1/2 tts - 1/2 ts
tfpg_d    = 1 parg  + 1/2 grun + 1/2 b - 1 tr + 1/2 tts - 1/2 ts
tcmkpg_d  = 1 kprg  + 1/2 tts - 1/2 ts
tcfkpg_d  = 1 kprg  + 3/2 grun - 1 a - 1/2 b + 1/2 tts - 1/2 ts
tmkpg_d   = 1 kprg  - 1 tr     + 1 cumm + 1/2 tts - 1/2 ts
tfkpg_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr + 1/2 tts - 1/2 ts
                                   | M or Ca on M4, Fe3 on M2
ocmpg_d   = 1 parg  + 1/2 mrbG  - 1/2 gl
ocfpg_d   = 1 parg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  - 1/2 gl
ompg_d    = 1 parg  - 1 tr     + 1 cumm + 1/2 mrbG  - 1/2 gl
ofpg_d    = 1 parg  + 1/2 grun + 1/2 b - 1 tr + 1/2 mrbG  - 1/2 gl
ocmkpg_d  = 1 kprg  + 1/2 mrbG  - 1/2 gl
ocfkpg_d  = 1 kprg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  - 1/2 gl
omkpg_d   = 1 kprg  - 1 tr     + 1 cumm + 1/2 mrbG  - 1/2 gl
ofkpg_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr + 1/2 mrbG  - 1/2 gl

                                   |==================================================
                                   | dependent endmembers for Piglitic subcomposition
                                   | Na on M4
|kmtn_d    = 1 kprg  + 1/2 tts - 3/2 ts + 1 gl
|kftn_d    = 1 kprg  + 3/2 grun - 1 a - 1/2 b + 1/2 tts - 3/2 ts + 1 gl
|kmfn_d    = 1 kprg  + 1/2 mrbG  + 1/2 gl - 1 ts
|kffn_d    = 1 kprg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  + 1/2 gl - 1 ts
|kman_d    = 1 kprg  + 1 gl - 1 ts
|kfan_d    = 1 kprg  + 3/2 grun - 1 a - 1/2 b + 1 gl - 1 ts

|nmtn_d    = 1 parg  + 1/2 tts - 3/2 ts + 1 gl
|nftn_d    = 1 parg  + 3/2 grun - 1 a - 1/2 b + 1/2 tts - 3/2 ts + 1 gl
|nmfn_d    = 1 parg  + 1/2 mrbG  + 1/2 gl - 1 ts
|nffn_d    = 1 parg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  + 1/2 gl - 1 ts
|nman_d    = 1 parg  + 1 gl - 1 ts
|nfan_d    = 1 parg  + 3/2 grun - 1 a - 1/2 b + 1 gl - 1 ts
                                   | MgNa on M4
|nmamn_d   = 1 parg  - 1 tr     + 1/2 cumm + 1/2 gl 
|nmfmn_d   = 1 parg  - 1 tr     + 1/2 cumm + 1/2 mrbG
|nmtmn_d   = 1 parg  - 1 tr     + 1/2 cumm + 1/2 tts - 1/2 ts + 1/2 gl
|kmamn_d   = 1 kprg  - 1 tr     + 1/2 cumm + 1/2 gl
|kmfmn_d   = 1 kprg  - 1 tr     + 1/2 cumm + 1/2 mrbG
|kmtmn_d   = 1 kprg  - 1 tr     + 1/2 cumm + 1/2 tts - 1/2 ts + 1/2 gl
                                   | Mg-MgCa on M4
|nmacn_d   = 1 parg + 1/2 gl - 1/2 ts 
|nmfcn_d   = 1 parg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  - 1/2 ts
|nmtcn_d   = 1 parg  + 1/2 tts - 1 ts + 1/2 gl
|kmacn_d   = 1 kprg + 1/2 gl - 1/2 ts
|kmfcn_d   = 1 kprg  + 1/2 mrbG  - 1/2 ts
|kmtcn_d   = 1 kprg  + 1/2 tts - 1 ts + 1/2 gl
                                   | FeNa on M4
|nfafn_d   = 1 parg  + 1/2 grun + 1/2 b - 1 tr + 1/2 gl    - 1/2 a
|nfffn_d   = 1 parg  + 1/2 grun + 1/2 b - 1 tr + 1/2 mrbG  - 1/2 a
|nftfn_d   = 1 parg  + 1/2 grun + 1/2 b - 1 tr + 1/2 tts   - 1/2 ts + 1/2 gl - 1/2 a
|kfafn_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr + 1/2 gl    - 1/2 a
|kfffn_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr + 1/2 mrbG  - 1/2 a
|kftfn_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr + 1/2 tts   - 1/2 ts + 1/2 gl - 1/2 a
                                   | Fe-FeCa on M4

|nfacn_d   = 1 parg  + 3/2 grun - 1 a - 1/2 b + 1/2 gl - 1/2 ts
|nffcn_d   = 1 parg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  - 1/2 ts
|nftcn_d   = 1 parg  + 1/2 grun + 1/2 b - 1 tr  + 1/2 tts - 1/2 ts + 1/2 gl - 1/2 a
|kfacn_d   = 1 kprg  + 3/2 grun - 1 a - 1/2 b + 1/2 gl - 1/2 ts
|kffcn_d   = 1 kprg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  - 1/2 ts
|kftcn_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr  + 1/2 tts - 1/2 ts + 1/2 gl - 1/2 a
                                   |==================================================
                                   | dependent endmembers for Tremolitic subcomposition
ftr_d    = 1 tr    + 2 grun   - 1 a - 1 b

end_dependent_endmembers

begin_excess_function
W(tr ts)                  20d3
W(tr parg)                25d3
W(tr gl)                  65d3
W(tr cumm)                45d3
W(tr grun)                75d3
W(tr a)                   57d3
W(tr b)                   63d3
W(tr mrbG)                52d3
W(tr kprg)                30d3
W(tr tts)                 85d3
W(ts parg)               -40d3
W(ts gl)                  25d3
W(ts cumm)                70d3
W(ts grun)                80d3
W(ts a)                   70d3
W(ts b)                 72.5d3
W(ts mrbG)                20d3
W(ts kprg)               -40d3
W(ts tts)                 35d3
W(parg gl)                50d3
W(parg cumm)              90d3
W(parg grun)           106.7d3
W(parg a)               94.8d3
W(parg b)               94.8d3
W(parg mrbG)              40d3
W(parg kprg)               8d3
W(parg tts)               15d3
W(gl cumm)               100d3
W(gl grun)             113.5d3
W(gl a)                  100d3
W(gl b)                111.2d3
W(gl kprg)                54d3
W(gl tts)                 75d3
W(cumm grun)              33d3
W(cumm a)                 18d3
W(cumm b)                 23d3
W(cumm mrbG)              80d3
W(cumm kprg)              87d3
W(cumm tts)              100d3
W(grun a)                 12d3
W(grun b)                  8d3
W(grun mrbG)              91d3
W(grun kprg)              96d3
W(grun tts)               65d3
W(a b)                    20d3
W(a mrbG)                 80d3
W(a kprg)                 94d3
W(a tts)                  95d3
W(b mrbG)                 90d3
W(b kprg)                 94d3
W(b tts)                  95d3
W(mrbG kprg)              50d3
W(mrbG tts)               50d3
W(kprg tts)               35d3
end_excess_function

6                                   | number of sites in configurational entropy model (A, M1, M2, M4, T1, OH)

A                                   | site name
3 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na,A)    = 1 parg
z(K,A)     = 1 kprg
z(Vac,A)   = 1 cumm + 1 grun + 1 tr + 1 ts + 1 gl + 1 a + 1 b + 1 tts + 1 mrbG

M1                                  | site name
2 3 3                               | number of species, effective multiplicity, true multiplicity
z(Fe,M1)   = 1 grun + 1 b
z(Mg,M1)   = 1 cumm + 1 tr + 1 ts + 1 parg + 1 kprg + 1 mrbG + 1 gl + 1 tts + 1 a

M2                                  | site name
5 2 2                               | number of species, effective multiplicity, true multiplicity
z(Fe,M2)   = 1 grun + 1 a
z(Fe3,M2)  = 1 mrbG
z(Al,M2)   = 1 ts + 1 gl + 1/2 kprg + 1/2 parg
z(Ti,M2)   = 1 tts
z(Mg,M2)   = 1/2 kprg + 1/2 parg + 1 tr + 1 cumm + 1 b

M4                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Mg,M4)   = 1 cumm
z(Na,M4)   = 1 gl + 1 mrbG
z(Fe,M4)   = 1 grun + 1 a + 1 b
z(Ca,M4)   = 1 ts + 1 parg + 1 kprg + 1 tts + 1 tr

T1                                  | site name
2 1 4                               | number of species, effective multiplicity, true multiplicity
z(Al,T1)   = 1/2 ts + 1/2 parg + 1/2 kprg + 1/2 tts
z(Si,T1)   = 1/2 ts + 1/2 parg + 1/2 kprg + 1/2 tts + 1 gl + 1 mrbG + 1 tr + 1 grun + 1 a + 1 b + 1 cumm

OH                                  | site name
2 2 2                               | number of species, effective multiplicity, true multiplicity
z(O,OH)    = 1 tts
z(OH,OH)   = 1 cumm + 1 grun + 1 ts + 1 tr + 1 parg + 1 kprg + 1 mrbG + 1 gl + 1 b + 1 a

[Si4O22]                            | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(tr)          1
alpha(ts)          1.5
alpha(parg)        1.7
alpha(gl)          0.8
alpha(cumm)        1
alpha(grun)        1
alpha(a)           1
alpha(b)           1
alpha(mrbG)        0.8
alpha(kprg)        1.7
alpha(tts)         1.5
end_van_laar_sizes

begin_dqf_corrections
DQF(gl)   = -3000
DQF(parg) = -10000
DQF(ts)   =  10000
DQF(grun) = -3000
end_dqf_corrections
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.

| use_model_resolution

end_of_model
                      --------------------------------------------------------
begin_model
                      cAmph(G) => Green et al. (JMG, 2016) clinoamphibole. 
                      
                      ---------------------------------------------------------
                      Reformulated as a 2-polytope 688 format model. JADC, 11/19

                      The composition space of the complete (published) model corresponds to:

                      [A][M][M,T,MT][M,C,N]

                      where the brackets indicate the A, M1, M2, and M4 sites (for brevity
                      the dependent T1 and OH site chemistry has been dropped) and 

                      A  = Na, K, V
                      T  = Al, Fe3, Ti*
                      MT = MAl, MFe3, MTi
                      C  = Ca
                      M  = Mg, Fe
                      N  = Na
                      
                      *The endmembers calibrated by Green et al. (2016) do not allow Ti-glaucophane
                      
                      The composition space of the model here has been simplified to

                      [A][M][M,T,MAl][M,C,N]

                      where the brackets indicate the A, M1, M2, and M4 sites and 

                      A  = Na, K, V
                      T  = Al, Fe3, Ti*
                      MT = MAl
                      C  = Ca
                      M  = Mg, Fe
                      N  = Na
                      
                      NOTE: the definitions for the MFe3 and MTi pargasite exchanges allowed in the full model 
                      are provided below but have been commented out below because they are costly and 
                      do not seem to have any significant effect on computed phase relations, this may 
                      also be true of the M-Ca-Fe3+_tschermaks [grk] exchange, although this has not 
                      been tested. It is probable that VERTEX/MEEMUM will run out of dynamic memory if 
                      the full model is restored, if this occurs uncomment the low_reach option keyword
                      at the end of this model. The low_reach option dramatically reduces the
                      memory and time required for calculations, but also causes a significant
                      deterioration in phase diagram quality.
                     
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                     
                      Polytope 1 = Glaucophane = [ ][M][T'][N]         => 2*2 
                      Polytope 2 = ACMT-Amph   = [A][M][M,T,MAl][M,C]  => 2*2*6

                      where
                      
                      T   is generalized Tschermaks      [M][T][M,C]
                      MT  is generalized pargasite       [M][MT][N] 
                      N   is generalized glaucophane     [M][T][N] 
                      M   on M2 is generalized amphibole [M][M][M,C]      
                      ---------------------------------------------------------
                      NOTE: to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                         mrbG  = 1 gl - 1 gr + 1 andr
                            DQF = 0
                         kprg  = 1 mu - 1 pa + 1 parg
                            DQF = -7060 + 20 * T_K
                         tts   = -2 dsp + 2 ru + 1 ts
                            DQF =   95000

                      to avoid cluttering thermodynamic data files with the new plague of TC
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                         DQF(gl)   = -3000
                         DQF(parg) = -10000
                         DQF(ts)   =  10000
                         DQF(grun) = -3000

                      For (nonsensical, but common) positive DFQ's this approach may lead to
                      interference between the phase relations of the solution model and the
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.
                      ---------------------------------------------------------
                      independent endmembers and site populations:

                                                           Sites
                                            A    M1      M2      M4     T1     OH
                                            _______________________________________

                            Multiplicity    1     3      2       2     1(4)    2
                                            _______________________________________

                              Ts            V     Mg     Al     Ca     SiAl    OH
                              Parg          Na    Mg    MgAl    Ca     SiAl    OH
                              Kprg          K     Mg    MgAl    Ca     SiAl    OH
                              Gl            V     Mg     Al     Na      Si     OH
                              mrbG          V     Mg     Fe3    Na      Si     OH
                              Tts           V     Mg     Ti     Ca      Si      O
                              Tr            V     Mg     Mg     Ca      Si     OH
                              Cumm          V     Mg     Mg     Mg      Si     OH
                              Grun          V     Fe     Fe     Fe      Si     OH

                              A             V     Mg     Fe     Fe      Si     OH
                              B             V     Fe     Mg     Fe      Si     OH

           dependent exchange Mgrk          V     M      Fe3    M      SiAl    OH
           dependent exchange Mts           V     M       Al    M      SiAl    OH
           dependent exchange Mpg           Na    M      MAl    M      SiAl    OH
           dependent exchange MKpg          K     M      MAl    M      SiAl    OH
           dependent exchange MTts          V     M      Ti     M      SiAl    OH

                             2 NaCa-1(M4) = (Gl-Ts)
                             2 CaMg-1(M4) = (Tr-Cumm)
           
                             2 Fe3Al-1(M2) = (Rb-Gl)
                             2 TiAl-1(M2)  = (Tts-Ts) => coupled to T1 and OH.

                             3 FeMg-1(M1) = (grun - a)
                             2 FeMg-1(M2) = (grun - b)
                             2 FeMg-1(M4) = (-grun - cumm + a + b)
                      ---------------------------------------------------------
cAmph(G)
abbreviation Amph
full_name    clinoamphibole

688                                | model type: 688 format standard model
 
2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
GlRb-Amph  0   1  .1  0            | X([ ][M][Fe3,Al][N]), Mg-Fe-Al-Fe3+ "glaucophane"
ACMT-Amph  by difference           | X([A][M][M,T,MT][M,C]), K-Na-Mg-Fe-Al-Ti-Fe3+ 

                                   | -------------------------------------------
                                   | Polytope 1 [ ][M][T  ][N] (glauc)
2                                  | number of simplices, then for each simplex
2 2                                | number of vertices on each simplex
 
                                   | Simplex 1 Mg, Fe; is Mg/M [M1 site]
                                   | Simplex 2 Fe3, Al is Fe3+/T' [M2 site]

                                   | endmembers on the vertices, index on the first simplex
                                   | changes fastest, last slowest
                                   
                                   | => endmember 11 is [ ][Mg][Fe3][Na]
                                   | => endmember 21 is [ ][Fe][Fe3][Na]
                                   | => endmember 12 is [ ][Mg][Al ][Na]
                                   | => endmember 22 is [ ][Fe][Al ][Na]

mrbG       frb_d                   | Fe3-glaucophane, aka riebeckite
gl         fgl_d                   | Al-glaucophane

                                   | First (1d) simplex
X_Mg1   0    1  .25  0              | X(1,1) = bulk Mg/M
X_Fe1   by difference
                                   | Second (3d) simplex
X_rb    0    1  .25  0              | X(2,1) = Fe3/T' on M2, T' = Al + Fe3+
X_gl    by difference
                                   | -------------------------------------------
                                   | Polytope 2 [A][M][M,T,MT][M,C]  
3                                  | number of simplices
2 2 6                              | number of vertices on each simplex, change to 2 2 10 for full model. 

                                   | Simplex 1 is Mg/M
                                   | Simplex 2 is M/[Ca + M] on M4
                                   | Simplex 3 is parg and M, Fe3, Ti, Al M2 site chemistry

                                   | endmembers on the vertices, index on the first simplex
                                   | changes fastest, last slowest

mts_d      fts_d                   | M-Ca-Al_tschermaks
ts         fcts_d

mparg_d    fparg_d                 | M-Ca-Na-Al_parg
parg       fcparg_d

                                   | ompg_d     ofpg_d                  | M-Ca-Na-Fe3+ parg
                                   | ocmpg_d    ocfpg_d

                                   | tmpg_d     tfpg_d                  | M-Ca-Na-Ti parg
                                   | tcmpg_d    tcfpg_d

kmparg_d   kfparg_d                | M-Ca-K-Al_parg
kprg       kfcprg_d

                                   | omkpg_d    ofkpg_d                 | M-Ca-K-Fe3+ parg
                                   | ocmkpg_d   ocfkpg_d

                                   | tmkpg_d    tfkpg_d                 | M-Ca-K-Ti parg
                                   | tcmkpg_d   tcfkpg_d

mtts_d     ftts_d                  | M-Ca-Ti_tschermaks
tts        fctts_d

mgrk_d     fgrk_d                  | M-Ca-Fe3+_tschermaks (Na-free riebeckite)
mcgrk_d    fcgrk_d

cumm       grun                    | M-Ca divalent amphibole
tr         ftr_d

                                   | First (1d) simplex
X_Mg     0    1   .25  0           | X(1,1) = bulk Mg/M
X_Fe     by difference
                                   | Second (1d) simplex
X_M_M2    0   1   .25  0           | X(2,1) = M/[Ca + M] on M4
X_C_M2   by difference

                                   | Third simplex 
X_AlTs   0    1   .25  0           | X(3,1) = X(Al-Ts)
X_NaPg   0    1   .25  0           | X(3,2) = X(Na-Al-Parg)

                                   | 0   .45  .1  0                     | X(3,3) = X(Na-Fe3+-Parg)
                                   | 0   .3   .1  0                     | X(3,4) = X(Na-Ti-Parg)

X_KPg    0    1   .25  0           | X(3,5) = X(K-Al-Parg)

                                   | 0   .1   .1  0                     | X(3,6) = X(K-Fe3+-Parg)
                                   | 0   .1   .1  0                     | X(3,7) = X(K-Ti-Parg)
                                   
X_TiTs   0    1   .25  0           | X(3,8) = X(Ti-Ts)
X_FeTs   0    1   .25  0           | X(3,9) = X(Fe3-Ts)
X_MCamph by difference


begin_ordered_endmembers
a     = 3/7 cumm + 4/7 grun  delta_g_of_ordering   =   -9486  | = DQF(A) -4/7 DQF(Grun)
b     = 2/7 cumm + 5/7 grun  delta_g_of_ordering   =  -11657  | = DQF(B) -5/7 DQF(Grun)
end_ordered_endmembers 

begin_dependent_endmembers
fcts_d = 1 ts + 1 grun - 1 a
fts_d  = 1 ts - 1 tr + 1 b
mts_d  = 1 ts - 1 tr + 1 cumm

fcparg_d  = 1 parg  + 3/2 grun - 1 a - 1/2 b
fparg_d   = 1 parg  + 1/2 grun + 1/2 b - 1 tr
mparg_d   = 1 parg  - 1 tr     + 1 cumm

                                   |tcmpg_d   = 1 parg  + 1/2 tts - 1/2 ts
                                   |tcfpg_d   = 1 parg  + 3/2 grun - 1 a - 1/2 b + 1/2 tts - 1/2 ts
                                   |tmpg_d    = 1 parg  - 1 tr     + 1 cumm + 1/2 tts - 1/2 ts
                                   |tfpg_d    = 1 parg  + 1/2 grun + 1/2 b - 1 tr + 1/2 tts - 1/2 ts

                                   |ocmpg_d   = 1 parg  + 1/2 mrbG  - 1/2 gl
                                   |ocfpg_d   = 1 parg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  - 1/2 gl
                                   |ompg_d    = 1 parg  - 1 tr     + 1 cumm + 1/2 mrbG  - 1/2 gl
                                   |ofpg_d    = 1 parg  + 1/2 grun + 1/2 b - 1 tr + 1/2 mrbG  - 1/2 gl

kfcprg_d  = 1 kprg  + 3/2 grun - 1 a - 1/2 b
kfparg_d  = 1 kprg  + 1/2 grun + 1/2 b - 1 tr
kmparg_d  = 1 kprg  - 1 tr + 1 cumm

                                   |tcmkpg_d  = 1 kprg  + 1/2 tts - 1/2 ts
                                   |tcfkpg_d  = 1 kprg  + 3/2 grun - 1 a - 1/2 b + 1/2 tts - 1/2 ts
                                   |tmkpg_d   = 1 kprg  - 1 tr     + 1 cumm + 1/2 tts - 1/2 ts
                                   |tfkpg_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr + 1/2 tts - 1/2 ts

                                   |ocmkpg_d  = 1 kprg  + 1/2 mrbG  - 1/2 gl
                                   |ocfkpg_d  = 1 kprg  + 3/2 grun - 1 a - 1/2 b  + 1/2 mrbG  - 1/2 gl
                                   |omkpg_d   = 1 kprg  - 1 tr     + 1 cumm + 1/2 mrbG  - 1/2 gl
                                   |ofkpg_d   = 1 kprg  + 1/2 grun + 1/2 b - 1 tr + 1/2 mrbG  - 1/2 gl

fgl_d    = 1 gl    + 1 grun   - 1 a
frb_d    = 1 mrbG  + 1 grun   - 1 a

fctts_d  = 1 tts   + 1 grun   - 1 a
ftts_d   = 1 tts   - 1 tr     + 1 b
mtts_d   = 1 tts   - 1 tr     + 1 cumm

mcgrk_d  = 1 mrbG  + 1 ts    - 1 gl
mgrk_d   = 1 mrbG  + 1 ts    - 1 gl     - 1 tr   + 1 cumm
fgrk_d   = 1 mrbG  + 1 ts    - 1 gl     - 1 tr   + 1 b
fcgrk_d  = 1 mrbG  + 1 ts    - 1 gl     - 1 a  + 1 grun

ftr_d    = 1 tr    + 2 grun   - 1 a - 1 b
end_dependent_endmembers

begin_excess_function
W(tr ts)                  20d3
W(tr parg)                25d3
W(tr gl)                  65d3
W(tr cumm)                45d3
W(tr grun)                75d3
W(tr a)                   57d3
W(tr b)                   63d3
W(tr mrbG)                52d3
W(tr kprg)                30d3
W(tr tts)                 85d3
W(ts parg)               -40d3
W(ts gl)                  25d3
W(ts cumm)                70d3
W(ts grun)                80d3
W(ts a)                   70d3
W(ts b)                 72.5d3
W(ts mrbG)                20d3
W(ts kprg)               -40d3
W(ts tts)                 35d3
W(parg gl)                50d3
W(parg cumm)              90d3
W(parg grun)           106.7d3
W(parg a)               94.8d3
W(parg b)               94.8d3
W(parg mrbG)              40d3
W(parg kprg)               8d3
W(parg tts)               15d3
W(gl cumm)               100d3
W(gl grun)             113.5d3
W(gl a)                  100d3
W(gl b)                111.2d3
W(gl kprg)                54d3
W(gl tts)                 75d3
W(cumm grun)              33d3
W(cumm a)                 18d3
W(cumm b)                 23d3
W(cumm mrbG)              80d3
W(cumm kprg)              87d3
W(cumm tts)              100d3
W(grun a)                 12d3
W(grun b)                  8d3
W(grun mrbG)              91d3
W(grun kprg)              96d3
W(grun tts)               65d3
W(a b)                    20d3
W(a mrbG)                 80d3
W(a kprg)                 94d3
W(a tts)                  95d3
W(b mrbG)                 90d3
W(b kprg)                 94d3
W(b tts)                  95d3
W(mrbG kprg)              50d3
W(mrbG tts)               50d3
W(kprg tts)               35d3
end_excess_function

6                                   | number of sites in configurational entropy model (A, M1, M2, M4, T1, OH)

A                                   | site name
3 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na,A)    = 1 parg
z(K,A)     = 1 kprg
z(Vac,A)   = 1 cumm + 1 grun + 1 tr + 1 ts + 1 gl + 1 a + 1 b + 1 tts + 1 mrbG

M1                                  | site name
2 3 3                               | number of species, effective multiplicity, true multiplicity
z(Fe,M1)   = 1 grun + 1 b
z(Mg,M1)   = 1 cumm + 1 tr + 1 ts + 1 parg + 1 kprg + 1 mrbG + 1 gl + 1 tts + 1 a

M2                                  | site name
5 2 2                               | number of species, effective multiplicity, true multiplicity
z(Fe,M2)   = 1 grun + 1 a
z(Fe3,M2)  = 1 mrbG
z(Al,M2)   = 1 ts + 1 gl + 1/2 kprg + 1/2 parg
z(Ti,M2)   = 1 tts
z(Mg,M2)   = 1/2 kprg + 1/2 parg + 1 tr + 1 cumm + 1 b

M4                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Mg,M4)   = 1 cumm
z(Na,M4)   = 1 gl + 1 mrbG
z(Fe,M4)   = 1 grun + 1 a + 1 b
z(Ca,M4)   = 1 ts + 1 parg + 1 kprg + 1 tts + 1 tr

T1                                  | site name
2 1 4                               | number of species, effective multiplicity, true multiplicity
                                    | for some reason tts was "Al-free" here, but not in cAmph(G)_I
                                    | corrected, DEK 22/9/21
z(Al,T1)   = 1/2 ts + 1/2 parg + 1/2 kprg + 1/2 tts
z(Si,T1)   = 1/2 ts + 1/2 parg + 1/2 kprg + 1/2 tts + 1 gl + 1 mrbG + 1 tr + 1 grun + 1 a + 1 b + 1 cumm

OH                                  | site name
2 2 2                               | number of species, effective multiplicity, true multiplicity
z(O,OH)    = 1 tts
z(OH,OH)   = 1 cumm + 1 grun + 1 ts + 1 tr + 1 parg + 1 kprg + 1 mrbG + 1 gl + 1 b + 1 a


[Si4O22]                            | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(tr)          1
alpha(ts)          1.5
alpha(parg)        1.7
alpha(gl)          0.8
alpha(cumm)        1
alpha(grun)        1
alpha(a)           1
alpha(b)           1
alpha(mrbG)        0.8
alpha(kprg)        1.7
alpha(tts)         1.5
end_van_laar_sizes

begin_dqf_corrections
DQF(gl)   = -3000
DQF(parg) = -10000
DQF(ts)   =  10000
DQF(grun) = -3000
end_dqf_corrections
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

| reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.
| use_model_resolution

end_of_model
                      --------------------------------------------------------
begin_model

Aq_solvent
abbreviation Aq
full_name    special_purpose

20                          | model type: electrolytic fluid

1                           | = ns = number of solvent species
H2O
1                           | = nn = number of neutral solute species
SiO2,aq
5                           | = nq = number of charged solute species
H+
HSiO3-
Mg+2
MgOH+
OH-

                            | ranges on the first ns-1 = 0 species

                            | ranges (mol fraction) on the nn neutral solute species
1e-3    1e-2    .1      1
                            | ranges (mol fraction) on the first nq-1 charged solute species
1e-7    2e-6    .1      1
1e-10   1e-9    .1      1
1e-9    6e-8    .1      1
1e-7    3e-6    .1      1

end_of_model


begin_model

Aq_yuri
abbreviation Aq
full_name    special_purpose

20                          | model type: electrolytic fluid

3                           | = ns = number of solvent species
CO2
CH4
H2O
1                           | = nn = number of neutral solute species
SiO2,aq
6                           | = nq = number of charged solute species
HCO3-
HS-
OH-
HSiO3-
H+
Ca(HCO3)


                            | ranges on the first ns-1 = 0 species

1e-5   5e-2      .1     1   | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   2e-4      .1     1   | subdivision ranges, imod = 1 -> non-linear subdivision

                            | ranges (mol fraction) on the nn neutral solute species
1e-3    1e-1    .2      1
                            | ranges (mol fraction) on the first nq-1 charged solute species
1e-5    1e-1    .2      1
1e-5    1e-1    .2      1
1e-5    1e-1    .2      1
1e-5    1e-1    .2      1
1e-5    1e-1    .2      1

end_of_model

Aq_solven0
abbreviation Aq
full_name    special_purpose

20                          | model type: electrolytic fluid

3                           | = ns = number of solvent species, water must be the last solvent species.

CO2
CH4
H2O

2                           | = nn = number of neutral solute species

SiO2,aq
Si2O4,aq

5                           | = nq = number of charged species

HCO3-
Mg(HCO3)
OH-
HSiO3-
Mg(HSiO3

                            | ranges on the first ns-1 species
1e-2   0.05     .1      1
1e-2   0.05     .1      1
                            | ranges (mol fraction) on the nn neutral solute species
1e-3   0.8d-2   .1      1
1e-3   0.8d-2   .1      1
                            | ranges (mol fraction) on the first nq-1 charged solute species
1e-7   1e-6     .1      1
1e-7   1e-6     .1      1
1e-7   1e-6     .1      1
1e-7   1e-6     .1      1


end_of_model
                      --------------------------------------------------------
begin_model
                      Clinopyroxene, Cpx_I(HGP) - Holland, Green, and Powell; Journal of Petrology, 2018.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus
                      ---------------------------------------------------------
                      Reformulated as a 2-subcomposition 688 format model. JADC, 9/19

                      The composition space of the published model corresponds to (M1, M2 site populations are 
                      indicated, remaining are dependent):     
                      
                      [M,T][A,C,M]
                        
                      T  = Al, Fe3, Cr, MTi on M1
                      C  = Ca on M2
                      M  = Mg, Fe
                      A  = Na, K on M2*
                      
                      *A is fully coupled to T by charge balance.
                      
                      The composition space of the model is formed as a mixture of 3 subcompositions (dropping 
                      the dependent T site notation):
                     
                      subcomposition 1 = [Al,Fe3,Cr]*[N,K,C]
                      subcomposition 2 = [Mg,Fe]*[Al,Fe3,Cr,MTi]*[N,K]
                      subcomposition 3 = [Mg,Fe]*[M]*[M,C] 
                      ---------------------------------------------------------   
                      First coded for Perple_X by Julien Cornet Sept 2018.

                      Re-formulated as a triple simplex prism. JADC, Dec 11, 2018.

                      Corrected cfm enthalpy and site limit expression for z(Mg,M1). JADC, April 29, 2019.

                      NOTES:

                      to use this model, the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                      cenjh  = 1 en
                        DQF = 3500 - 2 * T + 0.048 * P
                      cfsg  = 1 fs
                        DQF = 2100 - 2 * T + 0.045 * P
                      cessh = cats + acm - jd
                        DQF = -3450
                      crdih = cats + kos - jd
                        DQF = -4900
                      mcbuf = cats + 1/2 per + 1/2 ru -1/2 cor
                        | DQF = 1750 - 1.2 * T - 0.005 * P  | corrected from -1750 ... 10/22/2019, Lisa Rummel, Mainz.
                        DQF = -16.2d3 - 1.2 * T - 0.005 * P | changed by DB to match the ECRG 10/20 revision.
                      kjdh = jd + san - abh
                        | DQF = -3750 + 1.189 * P
                        DQF = 11.7d3 + 0.6 * P              | changed by DB to match the ECRG 10/20 revision.
                      ---------------------------------------------------------   

                                           M1     M2     T
                                        ____________________________________

                         Multiplicity      1      1     2 -> fake T multiplicity = 1/2
                                        ____________________________________
     subcomposition 1:     mkbuf_d         MgTi   K     Si    dependent
                           mnbuf_d         MgTi   Na    Si    dependent
                           mcbuf           MgTi   Ca   AlSi
                           _________
                           fkbuf_d         FeTi   K     Si    dependent
                           fnbuf_d         FeTi   Na    Si    dependent
                           fcbuf_d         FeTi   Ca   AlSi   dependent
                           _________
                           crkjd_d         Cr     K     Si    dependent
                           crjd_d          Cr     Na    Si    dependent
                           crdi            Cr     Ca   AlSi
                           _________
                           kess_d          Fe3+   K     Si    dependent
                           ness_d          Fe3+   Na    Si    dependent
                           cess            Fe3    Ca   AlSi
                           _________
                           kjdh            Al     K     Si
                           jd              Al     Na    Si
                           cats            Al     Ca   AlSi
                                        ____________________________________
     subcomposition 2:     mmbuf_d         MgTi   Mg   AlSi   dependent
                           ffbuf_d         FeTi   Fe   AlSi   dependent

                           cren_d          Cr     Mg   AlSi   dependent
                           crfs_d          Cr     Fe   AlSi   dependent

                           mess_d          Fe3    Mg   AlSi   dependent
                           fess_d          Fe3    Fe   AlSi   dependent

                           mats_d          Al     Mg   AlSi   dependent
                           fats_d          Al     Fe   AlSi   dependent

                           di              Mg     Ca    Si
                           hed_d           Fe     Ca    Si    dependent

                           cenjh           Mg     Mg    Si
                           cfsg            Fe     Fe    Si
                           _______________________________________________

                    Ordered species:

                           cfm             Mg     Fe     Si independent

                      femg-1(M2) = cfm - cenjh
                      femg-1(M1) = cfsg - cfm
                      mgca-1(M2) = cenjh - di
                      feca-1(M2) = cfm - di 
                      ---------------------------------------------------------   


Cpx_I(HGP)
abbreviation Cpx
full_name    clinopyroxene

688                               | model type: 688 format standard model

2                                 | number of subcompositions
                                  | subcomposition names and composite composition space subdivision schemes 
[T][A,C,M]   0    .25  .1  0
[M][C,M]     by difference

                                  | -------------------------------------------
                                  | subcomposition 1 [T][A,C,M]
2                                 | number of simplices
3 4                               | number of vertices on each simplex, change to 3 5 for full model
mkbuf_d   mnbuf_d   mcbuf
crkjd_d   crjd_d    crdih
kess_d    ness_d    cessh
                                  |fkbuf_d   fnbuf_d   fcbuf_d
kjdh      jd        cats
                                  | Simplex 1
X_K    0     1  .1  0             | X(1,1) = Na/[A + Ca] on M2
X_Na   0     1  .1  0             | X(1,2) = K /[A + Ca] on M2
X_Ca   by difference              | X(1,N) = Ca/[A + Ca] on M2 

                                  | Simplex 2
X_TiTs 0     1  .1  0             | X(2,1) = MgTi/T on M1
X_CrTs 0     1  .1  0             | X(2,2) = Cr/T on M1
X_FeTs 0     1  .1  0             | X(2,3)  = Fe3+/T on M1
                                  |0     1  .1  0                    |X(2,4)  = FeTi/T on M1
X_AlTs by difference              | X(2,N) = Al/T on M1 
                                  | -------------------------------------------
                                  | subcomposition 2  TM+MC
2                                 | number of simplices 
2 6                               | number of vertices on each simplex

ffbuf_d  mmbuf_d
crfs_d   cren_d
fess_d   mess_d
fats_d   mats_d
cfsg     cenjh
hed_d    di
                                  | Simplex 1
X_Fe 0  .2  .1  0                 | X(1,1) => Fe/M
X_Mg by difference                | X(1,N) = Mg/M

                                  | Simplex 2
X_MTiTs 0  .1  .1  0              | X(2,1) - M-buf(MgTi)
X_MCrTs 0  .1  .1  0              | X(2,2) - M-Cr
X_MFeTs 0  .1  .1  0              | X(2,3) - M-Fe3+
X_MAlTs 0  .2  .1  0              | X(2,4) - M-Ts
X_MMPx  0   1  .1  0              | X(2,5) - M-M
X_MCPx  by difference             | X(2,6) - M-Ca

begin_ordered_endmembers
cfm   = 1/2 cenjh + 1/2 cfsg delta_g_of_ordering   =  -4400 | DQF(cfm) - (DQF(ceng) + DQF(cfsg))/2
end_ordered_endmembers 

begin_dependent_endmembers
mkbuf_d   = -1 cats  + 1 mcbuf + 1 kjdh
mnbuf_d   = -1 cats  + 1 mcbuf + 1 jd

|fcbuf_d   = 1/2 cfsg + 1 mcbuf  - 1/2 cfm
|fkbuf_d   = 1/2 cfsg - cats + mcbuf - 1/2 cfm + kjdh
|fnbuf_d   = 1/2 cfsg - 1 cats  + 1 mcbuf + jd - 1/2 cfm

ffbuf_d   = -1 di    + 1/2 cfsg + 1 mcbuf + 1/2 cfm
mmbuf_d   = -1 di    + 1 mcbuf  + 1 cenjh

crkjd_d   = -1 cats  + 1 crdih + 1 kjdh
crjd_d    = -1 cats  + 1 crdih + 1 jd
cren_d    = -1 di    + 1 crdih + 1 cenjh
crfs_d    = -1 di    + 1 crdih + 1 cfm

kess_d    = -1 cats  + 1 cessh + 1 kjdh
ness_d    = -1 cats  + 1 cessh + 1 jd
mess_d    = -1 di    + 1 cessh + 1 cenjh
fess_d    = -1 di    + 1 cessh + 1 cfm

mats_d    = -1 di    + 1 cats  + 1 cenjh
fats_d    = -1 di    + 1 cats  + 1 cfm

hed_d     =  1 di    + 1 cfsg  - 1 cfm
end_dependent_endmembers

begin_excess_function
W(di cfsg)     25.8d3 - 0.03 * p
W(di cats)       13d3 - 0.06 * p
W(di crdih)       8d3
W(di cessh)       8d3
W(di jd)         26d3
W(di cenjh)    29.8d3 - 0.03 * p
W(di cfm)      20.6d3 - 0.03 * p
W(di kjdh)       26d3

W(cfsg cats)     25d3 -  .1 * p
W(cfsg crdih)  38.3d3
W(cfsg cessh)  43.3d3
W(cfsg jd)       24d3
W(cfsg cenjh)   2.3d3
W(cfsg cfm)     3.5d3
W(cfsg kjdh)     24d3

W(cats crdih)     2d3
W(cats cessh)     2d3
W(cats jd)        6d3
W(cats cenjh)    45.2d3 - 0.35 * p
W(cats cfm)      27d3 -  .1 * p
W(cats kjdh)      6d3

W(crdih cessh)    2d3
W(crdih jd)       3d3
W(crdih cenjh) 52.3d3
W(crdih cfm)   40.3d3
W(crdih kjdh)     3d3

W(cessh jd)       3d3
W(cessh cenjh) 57.3d3
W(cessh cfm)   45.3d3
W(cessh kjdh)     3d3

W(jd cenjh)      40d3
W(jd cfm)        40d3
W(jd kjdh)       10d3

W(cenjh cfm)      4d3
W(cenjh kjdh)    40d3

W(cfm kjdh)      40d3
end_excess_function

3                                   | number of sites in configurational entropy model (M1, M2, T)

M1                                  | site name
6 1 1                               | number of species, effective multiplicity, true multiplicity
z(Fe)   = 1 cfsg
z(Mg)   = 1 di + 1 cenjh + 1/2 mcbuf + 1 cfm
z(Fe3+) = 1 cessh
z(Ti)   = 1/2 mcbuf
z(Cr)   = 1 crdih
z(Al)   = 1 cats + 1 jd + 1 kjdh

M2                                  | site name
5 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na)   = 1 jd
z(K)    = 1 kjdh
z(Mg)   = 1 cenjh
z(Fe)   = 1 cfm  + 1 cfsg
z(Ca)   = 1 di + 1 cats + 1 cessh + 1 crdih + 1 mcbuf

T                                   | site name
2 .5 2                              | number of species, effective multiplicity, true multiplicity
z(Al,T) = 1/2 cats + 1/2 mcbuf + 1/2 crdih + 1/2 cessh
z(Si,T) = 1/2 cats + 1/2 mcbuf + 1/2 crdih + 1/2 cessh + 1 cfsg  + 1 cenjh + 1 di + 1 cfm + 1 jd + 1 kjdh

[O6]                                | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(di)     1.2
alpha(cenjh)  1
alpha(cfsg)   1
alpha(jd)     1.2
alpha(kjdh)   1.2
alpha(cats)   1.9
alpha(mcbuf)  1.9
alpha(cessh)  1.9
alpha(crdih)  1.9
alpha(cfm)    1
end_van_laar_sizes
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.
| low_reach

end_of_model
                      --------------------------------------------------------
begin_model
                      Clinopyroxene - Holland, Green, and Powell; Journal of Petrology, 2018.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus
                      ---------------------------------------------------------
                      Reformulated as a 2-polytope 688 format model. JADC, 9/19

                      The composition space of the published model corresponds to (M1, M2 site populations are 
                      indicated, remaining are dependent):     
                      
                      [M,T][A,C,M]
                        
                      T  = Al, Fe3, Cr, MTi on M1
                      C  = Ca on M2
                      M  = Mg, Fe
                      A  = Na, K on M2*
                      
                      *A is partially coupled to T by charge balance.
                      
                      The composition space of the model here has been simplified by eliminating
                      the [FeTi][A,C] endmembers. The retained [FeTi][Fe] endmember is probably 
                      a waste of resources.

                      NOTE: the definitions for the FeTi exchanges allowed in the full model 
                      are provided but have been commented out below.                     
                      
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                     
                      Polytope 1 = [T'][A,C]       
                      Polytope 2 = [T,M][M]+[M][C] 
                      
                      where 
                      
                      T' = Al, Fe3, MgTi on M1
                      ---------------------------------------------------------   
                      First coded for Perple_X by Julien Cornet Sept 2018.

                      Re-formulated as a triple simplex prism. JADC, Dec 11, 2018.

                      Corrected cfm enthalpy and site limit expression for z(Mg,M1). JADC, April 29, 2019.

                      NOTES:

                      to use this model, the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                      cenjh  = 1 en
                        DQF = 3500 - 2 * T + 0.048 * P
                      cfsg  = 1 fs
                        DQF = 2100 - 2 * T + 0.045 * P
                      cessh = cats + acm - jd
                        DQF = -3450
                      crdih = cats + kos - jd
                        DQF = -4900
                      mcbuf = cats + 1/2 per + 1/2 ru -1/2 cor
                        | DQF = 1750 - 1.2 * T - 0.005 * P  | corrected from -1750 ... 10/22/2019, Lisa Rummel, Mainz.
                        DQF = -16.2d3 - 1.2 * T - 0.005 * P | changed by DB to match the ECRG 10/20 revision.
                      kjdh = jd + san - abh
                        | DQF = -3750 + 1.189 * P
                        DQF = 11.7d3 + 0.6 * P              | changed by DB to match the ECRG 10/20 revision.
                      ---------------------------------------------------------   

                                           M1     M2     T
                                        ____________________________________

                         Multiplicity      1      1     2 -> fake T multiplicity = 1/2
                                        ____________________________________
           Polytope 1:     mkbuf_d         MgTi   K     Si    dependent
                           mnbuf_d         MgTi   Na    Si    dependent
                           mcbuf           MgTi   Ca   AlSi
                           _________
                           fkbuf_d         FeTi   K     Si    dependent
                           fnbuf_d         FeTi   Na    Si    dependent
                           fcbuf_d         FeTi   Ca   AlSi   dependent
                           _________
                           crkjd_d         Cr     K     Si    dependent
                           crjd_d          Cr     Na    Si    dependent
                           crdi            Cr     Ca   AlSi
                           _________
                           kess_d          Fe3+   K     Si    dependent
                           ness_d          Fe3+   Na    Si    dependent
                           cess            Fe3    Ca   AlSi
                           _________
                           kjdh            Al     K     Si
                           jd              Al     Na    Si
                           cats            Al     Ca   AlSi
                                        ____________________________________
           Polytope 2:     mmbuf_d         MgTi   Mg   AlSi   dependent
                           ffbuf_d         FeTi   Fe   AlSi   dependent

                           cren_d          Cr     Mg   AlSi   dependent
                           crfs_d          Cr     Fe   AlSi   dependent

                           mess_d          Fe3    Mg   AlSi   dependent
                           fess_d          Fe3    Fe   AlSi   dependent

                           mats_d          Al     Mg   AlSi   dependent
                           fats_d          Al     Fe   AlSi   dependent

                           di              Mg     Ca    Si
                           hed_d           Fe     Ca    Si    dependent

                           cenjh           Mg     Mg    Si
                           cfsg            Fe     Fe    Si
                           _______________________________________________

                    Ordered species:

                           cfm             Mg     Fe     Si independent

                      femg-1(M2) = cfm - cenjh
                      femg-1(M1) = cfsg - cfm
                      mgca-1(M2) = cenjh - di
                      feca-1(M2) = cfm - di 
                      ---------------------------------------------------------   


Cpx(HGP)
abbreviation Cpx
full_name    clinopyroxene

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and composite composition space subdivision schemes 
[T'][A,C]   0    .25  .1  0
TM+MC       by difference

                                  | -------------------------------------------
                                  | Polytope 1 [T'][A,C]
2                                 | number of simplices
3 4                               | number of vertices on each simplex, change to 3 5 for full model
mkbuf_d   mnbuf_d   mcbuf
crkjd_d   crjd_d    crdih
kess_d    ness_d    cessh
                                  |fkbuf_d   fnbuf_d   fcbuf_d
kjdh      jd        cats
                                  | Simplex 1
X_K    0     1  .1  0             | X(1,1) = Na/[A + Ca] on M2
X_Na   0     1  .1  0             | X(1,2) = K /[A + Ca] on M2
X_Ca   by difference              | X(1,N) = Ca/[A + Ca] on M2 

                                  | Simplex 2
X_TiTs 0     1  .1  0             | X(2,1) = MgTi/T on M1
X_CrTs 0     1  .1  0             | X(2,2) = Cr/T on M1
X_FeTs 0     1  .1  0             | X(2,3)  = Fe3+/T on M1
                                  |0     1  .1  0                    |X(2,4)  = FeTi/T on M1
X_AlTs by difference              | X(2,N) = Al/T on M1 
                                  | -------------------------------------------
                                  | Polytope 2  TM+MC
2                                 | number of simplices 
2 6                               | number of vertices on each simplex

ffbuf_d  mmbuf_d
crfs_d   cren_d
fess_d   mess_d
fats_d   mats_d
cfsg     cenjh
hed_d    di
                                  | Simplex 1
X_Fe 0  .2  .1  0                 | X(1,1) => Fe/M
X_Mg by difference                | X(1,N) = Mg/M

                                  | Simplex 2
X_MTiTs 0  .1  .1  0              | X(2,1) - M-buf(MgTi)
X_MCrTs 0  .1  .1  0              | X(2,2) - M-Cr
X_MFeTs 0  .1  .1  0              | X(2,3) - M-Fe3+
X_MAlTs 0  .2  .1  0              | X(2,4) - M-Ts
X_MMPx  0   1  .1  0              | X(2,5) - M-M
X_MCPx  by difference             | X(2,6) - M-Ca

begin_ordered_endmembers
cfm   = 1/2 cenjh + 1/2 cfsg delta_g_of_ordering   =  -4400 | DQF(cfm) - (DQF(ceng) + DQF(cfsg))/2
end_ordered_endmembers 

begin_dependent_endmembers
mkbuf_d   = -1 cats  + 1 mcbuf + 1 kjdh
mnbuf_d   = -1 cats  + 1 mcbuf + 1 jd

|fcbuf_d   = 1/2 cfsg + 1 mcbuf  - 1/2 cfm
|fkbuf_d   = 1/2 cfsg - cats + mcbuf - 1/2 cfm + kjdh
|fnbuf_d   = 1/2 cfsg - 1 cats  + 1 mcbuf + jd - 1/2 cfm

ffbuf_d   = -1 di    + 1/2 cfsg + 1 mcbuf + 1/2 cfm
mmbuf_d   = -1 di    + 1 mcbuf  + 1 cenjh

crkjd_d   = -1 cats  + 1 crdih + 1 kjdh
crjd_d    = -1 cats  + 1 crdih + 1 jd
cren_d    = -1 di    + 1 crdih + 1 cenjh
crfs_d    = -1 di    + 1 crdih + 1 cfm

kess_d    = -1 cats  + 1 cessh + 1 kjdh
ness_d    = -1 cats  + 1 cessh + 1 jd
mess_d    = -1 di    + 1 cessh + 1 cenjh
fess_d    = -1 di    + 1 cessh + 1 cfm

mats_d    = -1 di    + 1 cats  + 1 cenjh
fats_d    = -1 di    + 1 cats  + 1 cfm

hed_d     =  1 di    + 1 cfsg  - 1 cfm
end_dependent_endmembers

begin_excess_function
W(di cfsg)     25.8d3   | changed from W(di cfsg) = 25.8d3 - 0.03 * p by DB to match the ECRG 10/20 revision.

W(di cats)       13d3 - 0.06 * p
W(di crdih)       8d3
W(di cessh)       8d3
W(di mcbuf)       8d3   | added by DB to match the ECRG 10/20 revision.
W(di jd)         26d3
W(di cenjh)    29.8d3   | changed from W(di cenjh) 29.8d3 - 0.03 * p by DB to match the ECRG 10/20 revision.
W(di cfm)      20.6d3   | changed from W(di cfm) 20.6d3 - 0.03 * p by DB to match the ECRG 10/20 revision.
W(di kjdh)       26d3

W(cfsg cats)     25d3 -  .1 * p
W(cfsg crdih)  38.3d3
W(cfsg cessh)  43.3d3
W(cfsg jd)       24d3
W(cfsg mcbuf)    24d3    | added by DB to match the ECRG 10/20 revision.
W(cfsg cenjh)   2.3d3
W(cfsg cfm)     3.5d3
W(cfsg kjdh)     24d3

W(cats crdih)     2d3
W(cats cessh)     2d3
W(cats mcbuf)     6d3    | added by DB to match the ECRG 10/20 revision.
W(cats jd)        6d3
W(cats cenjh)    45.2d3 - 0.35 * p
W(cats cfm)      27d3 -  .1 * p
W(cats kjdh)      6d3

W(crdih cessh)    2d3
W(crdih mcbuf)    6d3    | added by DB to match the ECRG 10/20 revision.
W(crdih jd)       3d3
W(crdih cenjh) 52.3d3
W(crdih cfm)   40.3d3
W(crdih kjdh)     3d3

W(cessh jd)       3d3
W(cessh cenjh) 57.3d3
W(cessh mcbuf)    6d3    | added by DB to match the ECRG 10/20 revision.
W(cessh cfm)   45.3d3
W(cessh kjdh)     3d3

W(mcbuf jd)      16d3    | added by DB to match the ECRG 10/20 revision.
W(mcbuf cenjh)   24d3    | added by DB to match the ECRG 10/20 revision.
W(mcbuf cfm)     22d3    | added by DB to match the ECRG 10/20 revision.
W(mcbuf kjdh)    16d3    | added by DB to match the ECRG 10/20 revision.

W(jd cenjh)      40d3
W(jd cfm)        40d3
W(jd kjdh)       28d3    |changed from W(jd kjdh) 10d3 by DB to match the ECRG 10/20 revision.

W(cenjh cfm)      4d3
W(cenjh kjdh)    40d3

W(cfm kjdh)      40d3
end_excess_function

3                                   | number of sites in configurational entropy model (M1, M2, T)

M1                                  | site name
6 1 1                               | number of species, effective multiplicity, true multiplicity
z(Fe)   = 1 cfsg
z(Mg)   = 1 di + 1 cenjh + 1/2 mcbuf + 1 cfm
z(Fe3+) = 1 cessh
z(Ti)   = 1/2 mcbuf
z(Cr)   = 1 crdih
z(Al)   = 1 cats + 1 jd + 1 kjdh

M2                                  | site name
5 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na)   = 1 jd
z(K)    = 1 kjdh
z(Mg)   = 1 cenjh
z(Fe)   = 1 cfm  + 1 cfsg
z(Ca)   = 1 di + 1 cats + 1 cessh + 1 crdih + 1 mcbuf

T                                   | site name
2 .5 2                              | number of species, effective multiplicity, true multiplicity
z(Al,T) = 1/2 cats + 1/2 mcbuf + 1/2 crdih + 1/2 cessh
z(Si,T) = 1/2 cats + 1/2 mcbuf + 1/2 crdih + 1/2 cessh + 1 cfsg  + 1 cenjh + 1 di + 1 cfm + 1 jd + 1 kjdh

[O6]                                | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(di)     1.2
alpha(cenjh)  1
alpha(cfsg)   1
alpha(jd)     1.2
alpha(kjdh)   1.2
alpha(cats)   1.9
alpha(mcbuf)  1.9
alpha(cessh)  1.9
alpha(crdih)  1.9
alpha(cfm)    1
end_van_laar_sizes
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.
| low_reach

end_of_model
                      --------------------------------------------------------
begin_model
                      Augite(G) => Green et al (JMG, 2016) Augite model.

                      This model should not be used for "Na-rich" compositions.
                      ---------------------------------------------------------
                      Reformulated as a 2-polytope 688 format model. JADC, 9/19

                      The composition space of the model corresponds to (M1, M2 site populations are 
                      indicated, remaining are dependent):     
                      
                      [M,T][A,C,M]
                        
                      T  = Al, Fe3* on M1
                      C  = Ca on M2
                      M  = Mg, Fe
                      A  = Na on M2*
                      
                      *A is partially coupled to T by charge balance.
                      
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                     
                      Polytope 1 = [T][A,C]       
                      Polytope 2 = [T][M]+[M][C] 
                      ---------------------------------------------------------     
                      NOTE: to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                      cenjh = 1 en
                            DQF = 3500 - 2 * T + 0.048 * P
                      cfsg  = 1 fs
                            DQF = 2100 - 2 * T + 0.045 * P

                      to avoid cluttering thermodynamic data files with the new plague of TC
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(jd)   =  2000
                      dqf(acm)  = -5000
                      dqf(cats) =  3800  - 2.8816 * T  + 0.01  * P

                      For (nonsensical, but common) positive DFQ's this approach may lead to
                      interference between the phase relations of the solution model and the
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.
                      --------------------------------------------------------

                                                        M1     M2     T
                                                       ____________________________________

                                      Multiplicity      1      1     1/2 <- fake T multiplicity
         
                                        poytope II    ____________________________________

                                        Diopside        Mg     Ca    Si     Si
                                        cEnstatite      Mg     Mg    Si     Si
                                        Mats            Al     Mg   AlSi   AlSi dependent
                                        macm            Fe3    Mg   AlSi   AlSi dependent
                            Species:
                                        hed             Fe     Ca    Si     Si  dependent
                                        cferrosilite    Fe     Fe    Si     Si
                                        fats            Al     Fe   AlSi   AlSi dependent
                                        facm            Fe3    Fe   AlSi   AlSi dependent

                                        polytope I    ____________________________________

                                        Cats            Al     Ca   AlSi   AlSi
                                        cacm            Fe3    Ca   AlSi   AlSi dependent
                                        Jadeite         Al     Na    Si     Si
                                        Acmite          Fe3+   Na    Si     Si
                      --------------------------------------------------------
Augite(G)
abbreviation Cpx
full_name    clinopyroxene

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and composite composition space subdivision schemes 
[T][N,C] 0    1 .1  0
TM+MC    by difference            | = [M,T][M,C]

                                  | -------------------------------------------
                                  | Polytope 1 [T][N,C]
2                                 | number of simplices 
2 2                               | number of vertices on each simplex
acm     cacm_d
jd      cats
                                  | Simplex 1
X_Na     0    1  .1  0            | X(1,1) = Na/[Na + Ca] on M2
X_Ca1    by difference
                                  | Simplex 2
X_FeTs   0    1  .1  0            | X(2,1) = X(Fe3) on M1
X_AlTs   by difference
                                  | -------------------------------------------
                                  | Polytope 2  TM+MC
2                                 | number of simplices 
2 4                               | number of vertices on each simplex
macm_d  facm_d
mats_d  fats_d
cenjh   cfsg
di      hed_d
                                  | Simplex 1
X_Mg     .0   1  .1  0            | X(1,1) => bulk Mg/M
X_Fe     by difference
                                  | Simplex 2
X_MFeTs  0    1  .1  0            | X(2,1) - M-Fe3+
X_MAlTs  0    1  .1  0            | X(2,2) - M-Ts
X_MMPx   0    1  .1  0            | X(2,3) - M-M
X-MCPx   by difference 

begin_ordered_endmembers
ocats = 1 cats               delta_g_of_ordering   =  -3800  + 2.8816 * T  -0.01  * P | this undoes the DQF on cats
fmc   = 1/2 cenjh + 1/2 cfsg delta_g_of_ordering   =  -4400 | DQF(fmc) - (DQF(cenjh) + DQF(cfs))/2
end_ordered_endmembers 

begin_dependent_endmembers
hed_d   = 1 di    + 1 cfsg  - 1 fmc
cacm_d  = 1 acm   + 1 cats  - 1 jd
mats_d  = 1 cats  + 1 cenjh - 1 di
macm_d  = 1 cats  + 1 cenjh - 1 di   + 1 acm - 1 jd
fats_d  = 1 cats  - 1 di    + 1 fmc
facm_d  = 1 cats  - 1 di    + 1 fmc  + 1 acm - 1 jd
end_dependent_endmembers

begin_excess_function
W(di cenjh)               29.8d3   -0.03 * p
W(di cfsg)                25.8d3   -0.03 * p
W(di jd)                  26d3
W(di acm)                 21d3
W(di ocats)               12.3d3   -0.01 * p
W(di cats)                12.3d3   -0.01 * p
W(di fmc)                 20.6d3   -0.03 * p
W(cenjh cfsg)             2.3d3
W(cenjh jd)               50d3
W(cenjh acm)              62d3
W(cenjh ocats)            45.7d3   -0.29 * p
W(cenjh cats)             45.7d3   -0.29 * p
W(cenjh fmc)              4d3
W(cfsg jd)                60d3
W(cfsg acm)               58d3
W(cfsg ocats)             48d3
W(cfsg cats)              48d3
W(cfsg fmc)               3.5d3
W(jd acm)                 5d3
W(jd ocats)               40d3
W(jd cats)                40d3
W(jd fmc)                 40d3
W(acm ocats)              35d3
W(acm cats)               35d3
W(acm fmc)                60d3
W(ocats cats)             3.8d3   + 0.01 * p
W(ocats fmc)              50d3
W(cats fmc)               50d3
end_excess_function

4                                   | 4 site entropy model (M1, M2, T1, T2)

M1                                  | site name
4 1 1                               | 4 species on m1, mult = 1
z(Fe)   = 1 cfsg
z(Mg)   = 1 di + 1 fmc + 1 cenjh
z(Fe3+) = 1 acm
z(Al)   = 1 cats + 1 ocats + 1 jd

M2                                  | site name
4 1 1                               | 4 species on m2, mult. = 1
z(Na)   = 1 acm  + 1 jd
z(Mg)   = 1 cenjh
z(Fe)   = 1 fmc  + 1 cfsg
z(Ca)   = 1 di   + 1 cats + 1 ocats

T1                                  | site name
2 0.25 1                            | 2 species on T1, effective mult. = 1/4
z(Al,T1)   = 1/2 cats
z(Si,T1)   = 1/2 cats + 1 ocats + 1 fmc  + 1 cfsg + 1 acm  + 1 jd + 1 cenjh + 1 di

T2                                  | site name
2 0.25 1                            | 2 species on T2, effective mult. = 1/4
z(Al,T2)   = 1/2 cats + 1 ocats
z(Si,T2)   = 1/2 cats + 1 fmc  + 1 cfsg + 1 acm  + 1 jd + 1 cenjh + 1 di

[O6]                                | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(di)          1.2
alpha(cenjh)       1
alpha(cfsg)        1
alpha(jd)          1.2
alpha(acm)         1.2
alpha(ocats)       1.9
alpha(cats)        1.9
alpha(fmc)         1
end_van_laar_sizes

begin_dqf_corrections
dqf(jd)   =  2000
dqf(acm)  = -5000
dqf(cats) =  3800  - 2.8816 * T  + 0.01  * P
end_dqf_corrections
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.
| low_reach

end_of_model
                           --------------------------------------------------------
begin_model
                      Aqueous low density silicate fluid/melt - Holland, Green, & Powell; J Pet, 2018, 59:881900.

                      Intended to account for the solubility of silicates in water
                      at P > 1 GPa. Use with caution.

                      JADC 4/19

                      WoL DQF corrected, Debaditya Bandyopadhyay, 5/6/19.

                      This model requires the following make definitions in the
                      thermodynamic data file make_definitions section:

                      foWL = 2 foL
                         dqf = 8.59d3    - 0.136*Pbar
                      faWL = 2 faL
                         dqf = 13.56d3   - 0.052*Pbar
                      qWL = 4 qL
                         dqf =  2.1d3    - 0.051*Pbar
                      jdWL = 1 abL - 1 qL
                         dqf =  12.32d3   - 0.099*Pbar
                      hmWL = 1/2 hemL
                         dqf =  4.05d3    - 0.077*Pbar
                      ekWL = 1/2 eskL
                         dqf =  24.75d3   + 0.245*Pbar
                      tiWL = 1 ruL
                         dqf =  5.6d3     - 0.489*Pbar
                      kWL = 1 kspL - 1 qL
                         dqf =  12.88d3   - 0.227*Pbar

                      to avoid cluttering thermodynamic data files with the new plague of TC
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(silL) = 6.72d3  -0.313*Pbar
                      dqf(woL)  = -0.22d3  -0.12*Pbar

                      For (nonsensical, but common) positive DFQ's this approach may lead to
                      interference between the phase relations of the solution model and the
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      WARNING 0: DQF'd endmembers (e.g., sil8L, ctjL) created for other thermocalc
                      melt models (e.g., melt(W), melt(JH)) should be excluded (or deleted from the
                      thermodynamic data file) from calculations with this model.

                      WARNING 1: The h2oL melt endmember may destabilize Aqfl, see:
                      www.perplex.ethz.ch/perplex/examples/example_holland_et_al_2018_melt_model/hp633_water_versus_h2oL.pdf

Aqfl(HGP)
abbreviation F
full_name    fluid

2                                   | model type: simplicial composition space

11                                  | number of endmembers

foWL     faWL
jdWL     silL     kWL
woL      ekWL     hmWL
tiWL     qWL      H2O

1 1 1 1 1 1 1 1 1 1 1               | endmember flags

                                    | non-linear subdivision is likely to be
                                    | preferable to cartesian for this model

                                    | see commentary in the header of this file for explanation of
                                    | endmember flags and subdivision schemes

1d-4 .2   .2  1                     | range and resolution of X(fo)
1d-4 .2   .2  1                     | range and resolution of X(fa)
1d-4 .2   .2  1                     | range and resolution of X(jd)
1d-4 .2   .2  1                     | range and resolution of X(sil)
1d-4 .2   .2  1                     | range and resolution of X(kj)
1d-4 .2   .2  1                     | range and resolution of X(wo)
1d-4 .2   .2  1                     | range and resolution of X(ek)
1d-4 .2   .2  1                     | range and resolution of X(hm)
1d-4 .2   .2  1                     | range and resolution of X(ti)
1d-4 .2   .2  1                     | range and resolution of X(q)

begin_excess_function
W(qWL  H2O)   59d3     0  -0.82
W(silL H2O)   57.6d3   0  -0.80
W(woL  H2O)   72.2d3   0  -0.67
W(foWL H2O)   71.7d3   0  -1.10
W(faWL H2O)   71.7d3   0  -1.10
W(jdWL H2O)   57d3     0  -0.79
W(hmWL H2O)   73d3     0  -0.66
W(ekWL H2O)   73d3     0  -0.66
W(tiWL H2O)   75d3     0  -0.67
W(kWL  H2O)   44.9d3   0  -1.19
end_excess_function

1                                   | molecular entropy model
11 1
z(foWL) = 1 foWL
z(faWL) = 1 faWL
z(jdWL) = 1 jdWL
z(silL) = 1 silL
z(kWL)  = 1 kWL
z(woL)  = 1 woL
z(ekL)  = 1 ekWL
z(hmL)  = 1 hmWL
z(tiL)  = 1 tiWL
z(qWL)  = 1 qWL

begin_dqf_corrections
dqf(silL) =  6.72d3  -0.313*Pbar
dqf(woL)  = -0.22d3  -0.12 *Pbar
end_dqf_corrections

reach_increment 0

end_of_model
                           --------------------------------------------------------
begin_model
                      Generic Melt - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881-900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus. JADC 12/18

                      Modified after Heinrich & Connolly, GEOLOGY, 50:1101-1105. To account for molecular CO2
                      solubility based on the Morizet et al. (2010) synthesis for basaltic liquid. Use with 
                      caution. JADC 9/22.

                      * DQF's changed from published values to the values in the TC files. JADC 4/23/19

                      * updated to 688 format, added previously missing van Laar size terms. Ben Klein, BC, 8/19/20.

                      This model requires the following make definitions in the
                      thermodynamic data file make_definitions section:

                      foHL = 2 foL
                         dqf = 8.67d3  -0.131*Pbar
                      faHL = 2 faL
                         dqf = 13.7d3  - 0.055*Pbar
                      qHL = 4 qL
                         dqf =  0.22d3    -0.059*Pbar
                      jdL = 1 abL - 1 qL
                         dqf =  12.19d3 - 0.089*Pbar
                      hmL = 1/2 hemL
                         dqf =  3.3d3 - 0.032*Pbar
                      ekL = 1/2 eskL
                         dqf =  24.85d3   + 0.245*Pbar
                      tiL = 1 ruL
                         dqf =  5.58d3   -0.489*Pbar
                      kjL = 1 kspL - 1 qL
                         dqf =  11.98d3 -0.210*Pbar

                      to avoid cluttering thermodynamic data files with the new plague of TC
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(silL) = 6.35d3  -0.320*Pbar
                          updated to DQF   6.20  0  -0.318
                      dqf(woL)  = -0.18d3  -0.118*Pbar
                          updated to DQF  -0.45  0   -0.114
                      dqf(h2oL) = 3.24d3  -3.9*TK  0.00085*Pbar

                      dqf(CO2)   = 54355.   |based on Morizet 2010 for basalt data & rhyolite curve in  Fig. 11, JADC-CAH apr22

                      For (nonsensical, but common) negative DFQ's this approach may lead to
                      interference between the phase relations of the solution model and the
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      WARNING 0: DQF'd endmembers (e.g., sil8L, ctjL) created for other thermocalc
                      melt models (e.g., melt(W), melt(JH)) should be excluded (or deleted from the
                      thermodynamic data file) from calculations with this model.

melt(HGPH)
abbreviation Melt
full_name    liquid

688                                | model type: 688 format standard model

1                                  | number of polytopes
1                                  | number of simplices
12                                 | number of vertices (endmembers) on each simplex

foHL     faHL
jdL      silL     kjL
woL      ekL      hmL
tiL      qHL      CO2 
h2oL

0     1   .1  0                    | range and resolution of X(fo)
0     1   .1  0                    | range and resolution of X(fa)
0     1   .1  0                    | range and resolution of X(jd)
0     1   .1  0                    | range and resolution of X(sil)
0     1   .1  0                    | range and resolution of X(kj)
0     1   .1  0                    | range and resolution of X(wo)
0     1   .1  0                    | range and resolution of X(ek)
0     1   .1  0                    | range and resolution of X(hm)
0     1   .1  0                    | range and resolution of X(ti)
0     1   .1  0                    | range and resolution of X(q)
0     1   .1  0                    | range and resolution of X(CO2)

begin_ordered_endmembers
                                    | H(ctL) = -108.3d3  +55*TK  +0.053*Pbar - dqfwol - dqfsil + dqfq/4
ctL = 1 woL + 1 silL - 1/4 qHL        Delta(enthalpy)   = -113995 + 55*TK+ .47025*P

end_ordered_endmembers

begin_excess_function

W(qHL  silL)    9.5d3   -0.1 * Pbar
W(qHL  woL)   -10.3d3
W(qHL  foHL)  -26.5d3   -3.12 * Pbar
W(qHL  faHL)    -12d3   -0.55 * Pbar
W(qHL  jdL)   -15.1d3   -0.13 * Pbar
W(qHL  hmL)      20d3
W(qHL  tiL)    24.6d3
W(qHL  kjL)   -17.8d3   -0.05 * Pbar
W(qHL  ctL)   -14.6d3
W(qHL  h2oL)   17.8d3   -0.61 * Pbar

W(silL  woL)  -26.5d3    0.85 * Pbar
W(silL  foHL)   2.2d3
W(silL  faHL)   2.5d3
W(silL  jdL)   16.8d3
W(silL  hmL)     -5d3
W(silL  tiL)   15.2d3   -0.04 * Pbar
W(silL  kjL)      7d3
W(silL  ctL)      4d3
W(silL  h2oL)  23.7d3   -0.94 * Pbar

W(woL  foHL)   25.5d3    0.11 * Pbar
W(woL  faHL)     14d3
W(woL  jdL)    -1.2d3
W(woL  tiL)      18d3
W(woL  kjL)    -1.1d3
W(woL  ctL)     9.5d3
W(woL  h2oL)   40.3d3   -0.86 * Pbar

W(foHL  faHL)    18d3
W(foHL  jdL)    1.5d3
W(foHL  tiL)    7.5d3
W(foHL  kjL)      3d3
W(foHL  ctL)   -5.6d3
W(foHL  h2oL)   9.4d3   -1.58 * Pbar

W(faHL  jdL)    7.5d3   -0.05 * Pbar
W(faHL  hmL)    -30d3
W(faHL  tiL)    6.7d3
W(faHL  kjL)     10d3
W(faHL  ctL)   -6.5d3
W(faHL  h2oL)   9.2d3   -1.58 * Pbar

W(jdL  hmL)      10d3
W(jdL  tiL)    16.5d3    0.14 * Pbar
W(jdL  kjL)    -5.9d3
W(jdL  ctL)     7.6d3
W(jdL  h2oL)   -8.3d3   -0.06 * Pbar

W(hmL  kjL)      10d3
W(hmL  h2oL)     60d3   -0.66  * Pbar

W(ekL  h2oL)     30d3   -0.66 * Pbar

W(tiL  kjL)       9d3
W(tiL  h2oL)     30d3   -0.6 * Pbar

W(kjL  ctL)    -5.6d3
W(kjL  h2oL)   -0.1d3    0.22 * Pbar

W(ctL  h2oL)   17.3d3    0.05 * Pbar

end_excess_function

3

OH
2 2 1                         | water-vacancy site, multiplicity 2
z(H)   = 1 h2oL
z(Vac) = 1 qHL + 1 silL + 1 woL + 1 foHL + 1 faHL + 1 jdL + 1 hmL + 1 ekL + 1 tiL + 1 kjL + 1 ctL + 1 CO2

M
4 0 0                       | Temkin M-site
n(Mg) = 4 foHL
n(Fe) = 4 faHL
n(Ca) = 1 woL
n(Al) = 1 silL

F
11 0 0                      | Temkin F-site, decomposing "AlSi2" into k/na-jd here eliminates the necessity of the A-site
n(jdL)   = 1 jdL
n(kjL)   = 1 kjL
n(alsi)  = 1 silL
n(si0)   = 1 woL
n(ol)    = 1 faHL + 1 foHL
n(q)     = 1 qHL
n(ek)    = 1 ekL
n(tiL)   = 1 tiL
n(ctL)   = 1 ctL
n(hem)   = 1 hmL
n(CO2)   = 1 CO2

none                              | formula suffix, enter "none" for no suffix. 

begin_dqf_corrections
dqf(silL)  =  6.2d3          - 0.318   *Pbar
dqf(woL)   = -0.45d3         - 0.114   *Pbar
dqf(h2oL)  =  3.2d3  -3.9*TK + 0.00087 *Pbar
dqf(CO2)   = 54355.   |based on Morizet 2010 for basalt data & rhyolite curve in  Fig. 11 ****ADDITION JADC-CAH apr22
|dqf(CO2)  = 46994.   |based on Morizet 2010 for the andesite curve in their Fig. 11      ****ADDITION JADC-CAH apr22
end_dqf_corrections


begin_van_laar_sizes
alpha(qHL)   = 1
alpha(silL)  = 1.2
alpha(woL)   = 1.4
alpha(foHL)  = 2.4
alpha(faHL)  = 1
alpha(jdL)   = 1.2
alpha(hmL)   = 1
alpha(ekL)   = 1
alpha(tiL)   = 1
alpha(kjL)   = 1
alpha(ctL)   = 1
alpha(CO2)   = 1
alpha(h2oL)  = 1
end_van_laar_sizes

begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name. This
                                    | may be useful for testing purposes for systems in which the 
                                    | the endmember compositions are not expected to be stable, i.e., 
                                    | the stability of pure h2oL would alert the user to unexpected 
                                    | behaviour. if/when endmember compositions of the solution are 
                                    | expected, those endmembers should be removed from the list of
                                    | flagged endmembers. 
foHL     
faHL
jdL      
silL     
kjL
woL      
ekL      
hmL
tiL      
qHL      
h2oL
CO2
end_flagged_endmembers

end_of_model

                           --------------------------------------------------------
begin_model
                      Tonalitic melt, Green et al., JMG, 2016.

                      JADC 9/16

                      * reformulated as standard O/D model, 12/18, JADC

                      * converted to 688 format, 1/8/20, JADC

                      * the current solver for this model (gpmelt) precludes stability
                        of antiordered states, 6/27/20, JADC.

                      This model requires the following make definitions in the
                      thermodynamic data file make_definitions section:

                      foTL = 2 foL
                         dqf = -4d3

                      faTL = 2 faL
                         dqf = -8.2d3  - 1.4 * P

                      q8L = 4 qL
                         dqf = 0

                      to avoid cluttering thermodynamic data files with the new plague of TC
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(silL) = -7800
                      dqf(woL) = 1300

                      For (nonsensical, but common) positive DFQ's this approach may lead to
                      interference between the phase relations of the solution model and the
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      WARNING 0: DQF'd endmembers (e.g., sil8L, ctjL) created for other thermocalc
                      melt models (e.g., melt(W), melt(JH)) should be excluded (or deleted from the
                      thermodynamic data file) from calculations with this model.

melt(G)
abbreviation Melt
full_name    liquid

688                               | model type: 688 format standard model

1                                  | number of polytopes
1                                  | number of simplices
8                                  | number of vertices (endmembers) on each simplex

foTL     faTL
abL      silL     kspL
woL      q8L      h2oL

0    1   .1  0                     | range and resolution of X(fo),  1 => asymmetric subdivision
0    1   .1  0                     | range and resolution of X(fa),  1 => asymmetric subdivision
0    1   .1  0                     | range and resolution of X(ab),  0 => cartesian subdivision
0    1   .1  0                     | range and resolution of X(sil), 1 => asymmetric subdivision
0    1   .1  0                     | range and resolution of X(ksp), 1 => asymmetric subdivision
0    1   .1  0                     | range and resolution of X(wo),  1 => asymmetric subdivision
0    1   .1  0                     | range and resolution of X(q), 0 => cartesian subdivision


begin_ordered_endmembers
                                    | H(oanL) = -46.5d3 - 0.25 * P - dqf(woL) 1300 - dqf(silL) -7800

oanL = 1 woL + 1 silL        Delta(enthalpy)   = -40000  - 0.25 * P

end_ordered_endmembers

begin_excess_function

W(q8L abL)    =    12d3   - 0.4 * P
W(q8L kspL)   =   -2d3    -  .5 * P
W(q8L woL)    =   -5d3
W(q8L foTL)   =    42d3   +   1 * P
W(q8L h2oL)   =    18.1d3 - 0.68 * P
W(q8L oanL)   =   -29.5d3 -  .1 * P

W(abL kspL)   =   -6d3    + 3   * P
W(abL woL)    =   -12d3
W(abL silL)   =    10d3
W(abL faTL)   =   -30d3   + 0.8 * P
W(abL foTL)   =   -47.3d3 + 0.3 * P
W(abL h2oL)   =   -4.4d3  - 0.17 * P
W(abL oanL)   =    8.6d3  +  0.4 * P

W(kspL woL)   =   -13d3
W(kspL faTL)  =   -11.3d3
W(kspL foTL)  =    6.8d3
W(kspL h2oL)  =    10.4d3 - 0.39 * P
W(kspL oanL)  =   -16d3   - 0.25 * P

W(woL silL)   =   -1.6d3
W(woL faTL)   =    6.5d3
W(woL foTL)   =    4d3
W(woL h2oL)   =    21d3
W(woL oanL)   =    3.5d3

W(silL faTL)  =    12d3
W(silL foTL)  =    12d3
W(silL h2oL)  =    11d3   -  .5 * P
W(silL oanL)  =    6.4d3

W(faTL foTL)  =    18d3
W(faTL h2oL)  =    29d3
W(faTL oanL)  =   -43.5d3 - 0.95 * P

W(foTL h2oL)  =    29d3   -  .5 * P
W(foTL oanL)  =   -26d3   - 0.6 * P

W(h2oL oanL)  =    9.75d3 -  .5 * P

end_excess_function

3                           | Configurational entropy: two non-temkin sites (Water, Melt)
                            | and one temkin site (olvine). HP assume a fsp = ab + or "molecule"
                            | with mixing on a temkin M site, but the math works out the same as
                            | the endmembers are treated as separate endmembers and the M site
                            | dropped.

OH
2 1 1                       | water-vacancy site
z(OH)  = 1 h2oL
z(Vac) = 1 foTL + 1 faTL + 1 abL + 1 silL + 1 kspL + 1 woL + 1 q8L + 1 oanL

Ol
2 0 0                       | Temkin olivine site
n(Mg) = 4 foTL
n(Fe) = 4 faTL

M
8 0 0                       | melt site, pseudo-Temkin
z(q)     = 1 q8L
z(ksp)   = 1 kspL
z(ab)    = 1 abL
z(sil)   = 1 silL
z(an)    = 1 oanL
z(wo)    = 1 woL
z(Ol)    = 1 faTL + 1 foTL  | this term was not counted prior to dec 12, 2018.
z(OH)    = 1 h2oL

none                        | formula suffix, enter "none" for no suffix.

begin_dqf_corrections
dqf(silL) = -7800
dqf(woL)  =  1300
end_dqf_corrections

begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
foTL     
faTL
abL      
silL     
kspL
woL      
q8L      
h2oL
end_flagged_endmembers

end_of_model
                    --------------------------------------------------------
begin_model
                             CHLORITE, White et al JMG 32:261-286, 2014

                             NOTES:

                             * This is an oddball model because Al disorder is implicit
                               while Fe-Mg disorder is explicit. The model should be 
                               reformulated so that clin is an explicit ordered species.

                             * This model will only function in the Al-free and
                               Mg-free limits if Al and Mg are retained as thermodynamic
                               components.

                             JADC 4/14

                             This model requires the following make definition for f3clin:

                                      f3clin = 1 clin - 1/2 gr + 1/2 andr
                                      2d3

                             TJ 4/14

                             Mn endmembers entered, P.-H. Trapy, 5/16

                             Site limits corrected, JADC, 5/16

                                                      M1      M2+M3     M4     T2
                                                     ________________________________

                                      Mutliplicity    1         4       1      2
                                                     ________________________________

                                      1 fames         Al        Fe      Al     Al_Al   dependent
                                      2 fafchl        Fe        Fe      Fe     Si_Si   dependent
                                      3 ff3cli        Fe        Fe      Fe3+   Al_Si   dependent
                                      4 daph          Fe        Fe      Al     Al_Si
                                      5 f3clin        Mg        Mg      Fe3+   Al_Si
                                      6 ames          Al        Mg      Al     Al_Al
                                      7 afchl         Mg        Mg      Mg     Si_Si
                                      8 clin          Mg        Mg      Al     Al_Si

                                      9 mnchl         Mn        Mn      Al     Al_Si
                                                      _______________________________

                                     13 och1          Mg        Fe      Fe     Si_Si   ordered
                                     14 och2          Fe        Mg      Mg     Si_Si   ordered

Chl(W)
abbreviation Chl
full_name    chlorite

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and composite composition space subdivision schemes 
[Mn][Mn]  0   .5   .1   0         | X(1) is [Mn][Mn]
[M][M,T]  by difference
                                  | ----------------------------
                                  | Polytope 1 - 1 simplex
1                                 | number of simplices
1                                 | number of vertices on each simplex
mnchl                             | endmembers on the vertices
                                  | ----------------------------
                                  | Polytope 2 - 4x2 simplices
2                                 | number of simplices
4 2                               | number of vertices on each simplex
                                  | endmembers on the vertices
fames    fafchl   ff3cli   daph
ames     afchl    f3clin   clin
                                  | subdivision model for (quaternary) chemical mixing space
X_Mames   0  1  .1 0              | range and resolution of X(M-ames),   imod = 0 -> cartesian subdivision
X_Mafchl  0  1  .1 0              | range and resolution of X(M-afchl),  imod = 0 -> cartesian subdivision
X_Mf3clin 0  1  .1 0              | range and resolution of X(M-f3clin), imod = 0 -> cartesian subdivision
X_Mclin   by difference 
                                  | subdivision model for (ternary) chemical mixing space
X_Mg      0  1  .1 0              | range and resolution of X(Fe), imod = 0 -> cartesian subdivision
X_Fe      by difference 

begin_ordered_endmembers
och1 = 1 afchl  - 1 clin   + 1 daph      delta_g_of_ordering  = 3d3
och2 = 1 afchl  - 1/5 clin + 1/5 daph    delta_g_of_ordering  = 2.4d3
end_ordered_endmembers

begin_dependent_endmembers
fames  = 1 ames   + 1 daph - 1 och2 + 1 afchl - 1 clin
fafchl = 1 och1   + 1 och2 - 1 afchl
ff3cli = 1 f3clin + 1 daph - 1 clin
end_dependent_endmembers

begin_excess_function
W(clin afchl)             17d3
W(clin ames)              17d3
W(clin daph)              20d3
W(clin och1)              30d3
W(clin och2)              21d3
W(clin f3clin)             2d3
W(clin mnchl)              6d3    | changed from 15d3 DEK 02-JUN-2021
W(afchl ames)             16d3
W(afchl daph)             37d3
W(afchl och1)             20d3
W(afchl och2)              4d3
W(afchl f3clin)           15d3
W(afchl mnchl)            23d3    | changed from 32d3 DEK 02-JUN-2021
W(ames daph)              30d3
W(ames och1)              29d3
W(ames och2)              13d3
W(ames f3clin)            19d3
W(ames mnchl)             17d3    | changed from 26d3 DEK 02-JUN-2021
W(daph och1)              18d3
W(daph och2)              33d3
W(daph f3clin)            22d3
W(daph mnchl)              4d3    | changed from 10d3 DEK 02-JUN-2021
W(och1 och2)              24d3
W(och1 f3clin)          28.6d3
W(och1 mnchl)             19d3    | changed from 25d3 DEK 02-JUN-2021
W(och2 f3clin)            19d3
W(och2 mnchl)             22d3    | changed from 31d3 DEK 02-JUN-2021
W(f3clin mnchl)            8d3    | changed from 17d3 DEK 02-JUN-2021
end_excess_function

4                                 | 4 site configurational entropy model:

M1
4 1 1                             | 4 species on 1 M1 site
z(Al,M1)    = 1 ames
z(Fe,M1)    = 1 daph + 1 och2
z(Mn,M1)    = 1 mnchl
z(Mg,M1)    = 1 f3clin + 1 afchl + 1 clin + 1 och1

M23
3 4 4                             | 3 species on 4 M2+M3 sites
z(Fe,M23) = 1 daph + 1 och1
z(Mn,M23) = 1 mnchl
z(Mg,M23) = 1 f3clin + 1 ames + 1 afchl + 1 clin + 1 och2

M4
4 1 1                             | 4 species on 1 M4 site
z(Fe3,M4)   = 1 f3clin
z(Fe,M4)    = 1 och1
z(Mg,M4)    = 1 afchl + 1 och2
z(Al,M4)    = 1 daph + 1 clin + 1 ames + 1 mnchl

T2
2 2 2                             | 2 species on 2 T2 sites
z(Al,T2)    = 1 ames + 1/2 clin + 1/2 daph + 1/2 f3clin + 1/2 mnchl
z(Si,T2)    = 1 afchl + 1 och1 + 1 och2 + 1/2 clin + 1/2 daph + 1/2 f3clin + 1/2 mnchl 

[Si2O10(OH)8]                     | formula suffix, enter "none" for no suffix.


begin_dqf_corrections
dqf(mnchl) -5670                  | changed from -13030 DEK 02-JUN-2021
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                                      holland and powell '11 non-ideal cz-fep solution

                                      entered by Pierre-Henri Trapy, May 16, 2016

                                      reformulated as an implicit O/D model to eliminate 
                                      need to adjust the enthalpy of ordering with each
                                      revision of the TC data base. DEK/JADC, 8/10/2021.

                                                      M1      M3
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 cz            Al      Al
                            Species:  2 fep           Fe      Fe
                                                      _____________

                        Ordered Cpd:  3 ep            Al      Fe

Ep(HP11)
abbreviation Ep
full_name    epidote

688                               | model type: 688 format standard model
1                                 | number of polytopes
1                                 | number of simplices
3                                 | number of vertices on each simplex
cz       fep      ep              | endmember names

0  1   .1  0                      | X(cz)
0  1   .1  0                      | X(fep)

begin_excess_function
w(cz fep) 3d3
w(fep ep) 1d3
w(cz ep)  1d3
end_excess_function

2                                 | 2 site (M1, M3) configurational entropy model

M1                                | site name
2 1 1                             | 2 species on M1, 1 site per formula unit.
z(Fe,M1) = 1 fep
z(Al,M1) = 1 cz + 1 ep

M3                                | site name
2 1 1                             | 2 species on M3, 1 site per formula unit.
z(Al,M3) = 1 cz
z(Fe,M3) = 1 fep + 1 ep

[Ca2Si3O12(OH)]                   | formula suffix, enter "none" for no suffix.

end_of_model
                      --------------------------------------------------------
begin_model
                      Cpx(JH) => Jennings and Holland, J Pet, 56:869-892, 2015, intended for pressures of 0-60 GPa
                      ---------------------------------------------------------
                      Reformulated as a 2-polytope 688 format model. JADC, 9/19

                      The composition space of the published model corresponds to (M1, M2 site populations are 
                      indicated, remaining are dependent):     
                      
                      [M,T][A,C,M]
                        
                      T  = Al, Fe3, Cr on M1
                      C  = Ca on M2
                      M  = Mg, Fe
                      A  = Na on M2*
                      
                      *A is partially coupled to T by charge balance.
                                                    
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                     
                      Polytope 1 = [T][A,C]       
                      Polytope 2 = [T,M][M]+[M][C] 
                      ---------------------------------------------------------
                      NOTES:

                      The Cr/Fe3+-free version of this model is from Holland et al., 2013 or Green et al., 2012?

                      Pierre Bouilhol & JADC, 12/16/15

                      Changed to true T site multiplicity, Oliver Shorttle, 3/16

                      Changed to fake T site multiplicity (1/4) with true Al site fraction, JADC 6/16

                      Changed to fake T site multiplicity (1/2) with true Al site fraction, Bob Myhill, 2/18

                      Formatted as prismatic model w/o Cr & Fe3+. Bob Myhill, 2/18

                      Corrected cess composition assumed in the model (mess was assumed previously). JADC, 6/18

                      Dual polytope 688 format, JADC, 9/19.

                      to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                      crdi = 1 cats + 1 kos - 1 jd
                             DQF(J/mol) = -3d3 
                      cess = 1 cats + 1 acm - 1 jd
                            DQF(J/mol) = -6d3 
                      cenjh  = 1 en
                            DQF = 3500 - 2 * T + 0.048 * P
                      cfs  = 1 fs
                            DQF = 3800 - 3 * T + 0.03 * P


                                                        M1     M2     T
                                                     ____________________________________

                                      Multiplicity      1      1     1/2 <- fake T multiplicity
                                                     ____________________________________
                    Polytope 2 species:
                                        di              Mg     Ca    Si    independent
                                        cenjh           Mg     Mg    Si    independent
                                        mats_d          Al     Mg   AlSi   dependent
                                        cren_d          Cr     Mg   AlSi   dependent
                                        mcess_d         Fe3+   Mg   AlSi   dependent

                                        hed_d           Fe     Ca    Si    dependent
                                        cfs             Fe     Fe    Si    independent
                                        fats_d          Al     Fe   AlSi   dependent
                                        crfs_d          Cr     Fe   AlSi   dependent
                                        fcess_d         Fe3+   Fe   AlSi   dependent
                                                     ____________________________________
                    Ppolytope 1 species: 
                                        cats            Al     Ca   AlSi   independent
                                        crdi            Cr     Ca   AlSi   independent
                                        cess            Fe3+   Ca   AlSi   independent

                                        jd              Al     Na    Si    independent
                                        crjd            Cr     Na    Si    dependent
                                        ness            Fe3+   Na    Si    dependent
                                                      ___________________________________
                      ---------------------------------------------------------
Cpx(JH)
abbreviation Cpx
full_name    clinopyroxene

688                               | model type: 688 format standard model

2                                 | number of polytopes, subvision range for the composite space
                                  | polytope names and composite composition space subdivision schemes 
[T][N,C]   0    .25  .1  0
[M,T][M,C] by difference

                                  | -------------------------------------------
                                  | Polytope 1 [T][N,C]
2                                 | number of simplices 
2 3                               | number of vertices on each simplex
crjd_d    crdi
ness_d    cess
jd        cats
                                  | Simplex 1
X_Na      0    1   .1  0          | X(1,1) = Na/[Na + Ca] on M2
X_Ca      by difference

                                  | Simplex 2
X_CrTs1   0    1   .1  0          | X(2,1) = X(Cr) on M1
X_Fe3Ts1  0    1   .1  0          | X(2,2) = X(Fe3) on M1
X_AlTs1   by difference 

                                  | -------------------------------------------
                                  | Polytope 2  [M,T][M,C]
2                                 | number of simplices 
2 5                               | number of vertices on each simplex
cren_d    crfs_d
mess_d    fess_d
mats_d    fats_d
cenjh     cfs
di        hed_d
                                  | Simplex 1
X_Mg      0  1   .1  0            | X(1,1) => bulk Mg/M
X_Fe      by difference

                                  | Simplex 2
X_CrTs    0  .1  .1  0            | X(2,1) - M-Cr
X_Fe3Ts   0  .2  .1  0            | X(2,2) - M-Fe3+
X_MTs     0  .2  .1  0            | X(2,3) - M-Ts
X_MM      0  .9  .1  0            | X(2,4) - M-M
X_MCa     by difference

begin_ordered_endmembers
cfm   = 1/2 cenjh + 1/2 cfs delta_g_of_ordering   =  -6.65d3  2.5 - 0.039 | DQF(cfm) - (DQF(ceng) + DQF(cfs))/2
                                   | -3   - (3.5 - 2T + 0.048P + 3.8 - 3T + 0.03)/2
                                   | = -6.65 + 2.5T - 0.039P
end_ordered_endmembers 

begin_dependent_endmembers
crjd_d = 1 crdi  + 1 jd   - 1 cats
cren_d = 1 cenjh + 1 crdi - 1 di
crfs_d = 1 cfm   + 1 crdi - 1 di

ness_d = 1 cess + 1 jd  - 1 cats
mess_d = 1 cess - 1 di  + 1 cenjh
fess_d = 1 cess - 1 di  + 1 cfm

hed_d  = 1 di    + 1 cfs - 1 cfm
mats_d = 1 cats  + 1 cenjh - 1 di
fats_d = 1 cats  - 1 di   + 1 cfm
end_dependent_endmembers

begin_excess_function
W(di cfs)       20d3
W(di cats)      12.3d3  -0.1 * P
W(di jd)        26d3
W(di cenjh)     29.8d3  -0.03 * P
W(di cfm)       18d3
W(cfs cats)     25d3    -0.1 * P
W(cfs jd)       36d3
W(cfs cenjh)    7d3
W(cfs cfm)      4d3
W(cats jd)      6d3
W(cats cenjh)   45.7d3  -0.29 * P
W(cats cfm)     27d3    -0.1 * P
W(jd cenjh)     40d3
W(jd cfm)       40d3
W(cenjh cfm)    4d3

W(di crdi)     8d3
W(di cess)     8d3
W(cfs crdi)    34d3
W(cfs cess)    34d3
W(cats crdi)   2d3
W(cats cess)   2d3
W(crdi cess)   2d3
W(crdi jd)     3d3
W(crdi cenjh)  48d3
W(crdi cfm)    36d3
W(cess jd)     3d3
W(cess cenjh)  58d3
W(cess cfm)    36d3
end_excess_function

3                                   | 3 site entropy model (M1, M2, T)

M1                                  | site name
5 1 1                               | number of species, effective multiplicity, true multiplicity
z(Fe,m1)   = 1 cfs
z(Al,m1)   = 1 cats + 1 jd
z(Fe3,m1)  = 1 cess
z(Cr,m1)   = 1 crdi
z(Mg,M1)   = 1 di   + 1 cenjh + 1 cfm

M2                                  | site name
4 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na,m2)   = 1 jd
z(Mg,m2)   = 1 cenjh
z(Fe,m2)   = 1 cfs  + 1 cfm
z(Ca,M2)   = 1 di   + 1 crdi + 1 cess + 1 cats

T                                   | site name
2 .5 2                              | number of species, effective multiplicity, true multiplicity
z(Al,T)   = 1/2 cats + 1/2 cess + 1/2 crdi
z(Si,T)   = 1/2 cats + 1/2 cess + 1/2 crdi +  1 cfs  + 1 cfm + 1 jd + 1 cenjh + 1 di

[O6]                                | formula suffix, enter "none" for no suffix.


begin_van_laar_sizes
alpha(di)    =  1.2
alpha(cfs)   =  1
alpha(cats)  =  1.9
alpha(crdi)  =  1.9
alpha(cess)  =  1.9
alpha(jd)    =  1.2
alpha(cenjh) =  1
alpha(cfm)   =  1
end_van_laar_sizes
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

end_of_model
                      --------------------------------------------------------
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15

                             Temkin M-site added 3/16, Oliver Shorttle
Melt(JH)
abbreviation Melt
full_name    liquid

2
8
jdjL ctjL fojL fajL dijL hmjL ekjL qjL

0 0 0 0 0 0 0 0

0  1  .1 0   | jd
0  1  .1 0   | ct
0  1  .1 0   | fo
0  1  .1 0   | fa
0  1  .1 0   | di
0  1  .1 0   | hm
0  1  .1 0   | ek

begin_excess_function
W(qjL dijL)     26d3   - .4 * P
W(qjL jdjL)    -10d3
W(qjL ctjL)    -10d3
W(qjL fojL)    -25d3   - .1 * P
W(qjL fajL)     -7d3
W(dijL ctjL)    -2d3
W(dijL fojL)    24d3   + .2 * P
W(dijL fajL)    17d3
W(ctjL fojL)    -1d3   + .1 * P
W(fojL fajL)     9d3
end_excess_function

2               only 2 sites contribute to configurational entropy

3 0             Temkin M-site has Fe, Mg, Ca
n(Ca) = 1 dijL
n(Mg) = 1 dijL + 2 fojL
n(Fe) = 2 fajL

7 1             F site
z(jd) = 1 jdjL
z(di) = 1 dijL
z(ct) = 1 ctjL
z(ol) = 1 fojL + 1 fajL
z(q)  = 1 qjL
z(ek) = 1 ekjL

end_of_model
                      --------------------------------------------------------
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15
O(JH)
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space
2                                     2 endmembers
fo       fa
0  0                                | endmember flags

0    1    .1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 9000
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(fe) = 1 fa

end_of_model
                      --------------------------------------------------------
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15

                             Removed extraneous line in Sp(JH) excess
                             definitions [which read w(sp herc) 7d2  0  0]
                             Added z(al)  = 2/3 sp + 2/3 herc definition to Sp(JH)
                             configurational entropy site fractions.

                             Oliver Shorttle, 3/18/16

Sp(JH)
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space
4                          | 4 endmembers
sp mt picr herc

0  0  0  0                 | endmember flags

0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision
0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision
0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc)     4d3
W(sp mt)      56d3
W(sp picr)    39d3
W(herc mt)    32d3
W(herc picr)  27d3
W(mt picr)    36d3
end_excess_function

1

5 3.                        cations disordered across all sites

z(al)  = 2/3 sp + 2/3 herc
z(mg)  = 1/3 sp + 1/3 picr
z(fe3) = 2/3 mt
z(cr)  = 2/3 picr

end_of_model
                      --------------------------------------------------------
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15

Pl(JH)
abbreviation Pl
full_name    binary-feldspar

2                          | model type: simplicial composition space

2                          | 2 endmembers
abh      an

  1  0                     | endmember flags

0  1  .1  0                | imod = 0 -> cartesian subdivision

begin_excess_function
w(abh an) 22.4d3
end_excess_function

2                          | 2 sites (O, T) kerrick and darkens Al-avoidance model:
2 1                        | 2 species on O site, multiplicity = 1.
z(Na) = 1 abh

2 2.                       | 2 species on T, mutiplicity = 2.
z(Al) = 1/2 + 1/2 an

begin_van_laar_sizes
alpha(abh)   1
alpha(an)    .39
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015
                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15

                                                      X       Y
                                                     _____________

                                      Mutliplicity    3       2
                                                     _____________

                          Dependent:   fkho_d        Fe      Fe3+
                          Dependent:   kho_d         Mg      Fe3+
                                       andr          Ca      Fe3+

                          Dependent:   fkno_d        Fe      Cr
                                       knor          Mg      Cr
                          Dependent:   ckno_d        Ca      Cr

                                       alm           Fe      Al
                                       py            Mg      Al
                                       gr            Ca      Al

Grt(JH)
abbreviation Gt
full_name    garnet

7
2
3 3
alm     py     gr
fkno_d  knor   ckno_d
fkho_d  kho_d  andr

4
fkno_d = 1 alm + 1 knor - 1 py
ckno_d = 1 gr  + 1 knor - 1 py
fkho_d = 1 alm + 1 andr - 1 gr
kho_d  = 1 py  + 1 andr - 1 gr

0 0 0 0 0 0 0 0 0

0  1  .1   0
0  1  .1   0

0  1  .1   0
0  1  .1   0

begin_excess_function
W(py alm)       4d3              .1 * P
W(py gr)       35d3              .1 * P
W(py andr)     91d3    1.7 * T   .032 * P
W(py knor)      2d3
W(alm gr)       4d3              .1 * P
W(alm andr)    60d3    1.7 * T   .032 * P
W(alm knor)     6d3              .01 * P
W(gr andr)      2d3
W(gr knor)     47d3  -33.8 * T   .221 * P
W(andr knor)  101d3  -32.1 * T   .153 * P
end_excess_function

2
3 3.
z(m1,fe) = 1 alm
z(m1,mg) = 1 py + 1 knor

3 2.
z(m2,cr)  = 1 knor
z(m2,fe3) = 1 andr

unbounded_composition

end_of_model
                      --------------------------------------------------------
begin_model
                             Jennings and Holland, J Pet, 56:869-892, 2015

                             originally from

                             Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

                             Mantle Melt Model, intended for pressures of 0-60 GPa

                             Pierre Bouilhol & JADC, 12/16/15

                             T-site mixing added 3/16, O. Shorttle.

                             T-site mixing corrected for a false multiplicity of 1/4,
                             with the fully disordered tetrahedral Al site fraction.
                             JADC, 6/10/15

                             Changed fake T site multiplicity from 1/4 to 1/2
                             with true Al site fraction. Bob Myhill, 2/18

                      NOTE: to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                      odi  = 1 di
                            DQF = -100 + 0.211 * T + 0.005 * P | NOTE entropy term incorrect in some perplex files


                                                      M1      M2     T
                                                     _____________________

                                      Mutliplicity    1       1      1/2
                                                     ______________________

                                        en            Mg      Mg     SiSi
                                        mgts          Al      Mg     SiAl
                                        oen           Fe3+    Mg     SiAl
                                        cren          Cr      Mg     SiAl

                            Species:    fs            Fe      Fe     SiSi
                                        tsfs          Al      Fe     SiAl      dependent
                                        ofs           Fe3+    Fe     SiAl      dependent
                                        crfs          Cr      Fe     SiAl      dependent

                            Species:    odi           Mg      Ca     SiSi
                                        tsdi          Al      Ca     SiAl     dependent
                                        odif          Fe3+    Ca     SiAl     dependent
                                        odicr         Cr      Ca     SiAl     dependent
                                                      _____________

                           Internal:    opx           Mg      Fe     SiSi

Opx(JH)
abbreviation Opx
full_name    orthopyroxene

8                          | prismatic composition space, order-disorder

2                          | 2 independent composition spaces
3 4                        | 3 vertices on first space, 4 on second

                           | endmembers:
odif    oen     ofs
odicr   cren    crfs
tsdi    mgts    tsfs
odi     en      fs

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6d3

6                          | 6 dependent endmembers

tsfs  = 1 mgts   + 1 opx - 1 en
tsdi  = 1 odi    + 1 mgts - 1 en

ofs   = 1 oen    + 1 opx - 1 en
odif  = 1 odi    + 1 oen - 1 en

crfs  = 1 cren   + 1 opx - 1 en
odicr = 1 odi    + 1 cren - 1 en

0 0 0 0 0 0 0 0 0 0 0 0    | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (ternary) site 1 (M1):
0   1  .1   0
0   1  .1   0
                           | subdivision model for (quaternary) site 2 (M2):
0  .1  .1   0
0  .1  .1   0
0  .2  .1   0

begin_excess_function
W(en fs)        5.2d3
W(en opx)         4d3
W(en odi)      32.2d3    0.12 * P_bar
W(en mgts)       13d3   -0.15 * P_bar
W(en cren)        8d3
W(en oen)         8d3
W(fs opx)         4d3
W(fs odi)        24d3
W(fs mgts)        7d3   -0.15 * P_bar
W(fs cren)       10d3
W(fs oen)        10d3
W(opx odi)       18d3
W(opx mgts)       2d3   -0.15 * P_bar
W(opx cren)      12d3
W(opx oen)       12d3
W(odi mgts)    75.4d3   -0.94 * P_bar
W(odi cren)      30d3
W(odi oen)       30d3
W(mgts cren)      2d3
W(mgts oen)       2d3
W(cren oen)       2d3
end_excess_function

3                          | 2 site (M1, M2, T1) configurational entropy model

5 1                        | 5 species on M1, 1 site per formula unit.
z(m1,fe)   = 1 fs
z(m1,cr)   = 1 cren
z(m1,fe3+) = 1 oen
z(m1,al)   = 1 mgts

3 1                        | 3 species on M2, 1 site per formula unit. OS_EDIT-3/16 changed comment [2 species...]
z(m2,ca) = 1 odi
z(m2,fe) = 1 fs + 1 opx

2  .5                      | 2 species on "1/2" T sites with true site fraction.
z(t,al) = 1/2 mgts + 1/2 cren + 1/2 oen


begin_van_laar_sizes
alpha(en)     1
alpha(fs)     1
alpha(opx)    1
alpha(odi)    1.2
alpha(mgts)   1
alpha(cren)   1
alpha(oen)    1
end_van_laar_sizes

end_of_model
                                  --------------------------------------------------------
begin_model

                                  Ca-Fe2+-Mg-Al-Fe3+ Garnet, White et al., JMG 32:261-286, 2014.

                                  * In calculations that use this model, the andradite endmember ("andr") in the Holland
                                  and Powell data base must be excluded. This model also requires the following make
                                  definition for khoharite in the thermodynamic data file:

                                      kho1 = 1 py - 1 gr + 1 andr
                                      27d3

                                  * Mn added as in Gt(WPPH). JADC 4/14

                                  * Mn excess energy updated, alpha(kho1 & spss) reduced
                                    to 1(formerly 2.7). Felix Gervais, 1/28/2015.

                                                      X       Y
                                                     _____________

                                      Mutliplicity    3       2
                                                     _____________

                          Dependent:   fkho_i        Fe      Fe3+
                          Dependent:   kho1          Mg      Fe3+
                          Dependent:   fmn_i         Mn      Fe3+
                                       andr_i        Ca      Fe3+

                                       spss          Mn      Al
                                       alm           Fe      Al
                                       py            Mg      Al
                                       gr            Ca      Al

Gt(W)
abbreviation Gt
full_name    garnet

7                            | model type: prismatic (reciprocal)
2                            | the number of independent subcompositions
4  2                         | 4 species on site 1, 2 species on site 2.
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mn-Mg-Fe-Ca and the species that mix on
                             | site 2 are Al-Fe3+.

spss   alm      py     gr    | endmember names
fmn_i  fkho_i   kho1  andr_i


3                                 | number of dependent endmembers

andr_i = 1 kho1  - 1 py   +1 gr
fkho_i = 1 kho1  + 1 alm  -1 py
fmn_i  = 1 kho1  + 1 spss -1 py

0  0  0  0  0  0  0  0             | endmember flags

0  1     .1  0                     | imod = 0 -> cartesian subdivision (xmn) on X
0  1     .1  0                     | imod = 0 -> cartesian subdivision (xfe) on X
0  1     .1  0                     | imod = 0 -> cartesian subdivision (xmg) on X

0  1     .1  0                     | imod = 0 -> cartesian subdivision x(fe3+) on Y

begin_excess_function
W(py  alm)               2.5d3     | as given by White et al 2014 and updated (post-GreenEtAl) metabasite set.
W(py  gr)                 31d3     | DEK 2-Jun2021: was 30.1d3   0.164 * P_bar
W(py  kho1)              5.4d3
W(py  spss)                2d3
W(alm gr)                  5d3
W(alm kho1)             22.6d3     | DEK 2-Jun2021: was 21.63d3   0.168 * P_bar
W(alm spss)                2d3
W(gr  kho1)            -15.3d3     | DEK 2-Jun2021: was -16.15d3   0.164 * P_bar
w(spss kho1)            29.4d3     | DEK 2-Jun2021: was 28.43d3   0.168 * P_barend_excess_function
end_excess_function

2                                     |2 site entropy model

4 3.                                  |4 species, site multiplicity 3
z(x,mn) = 1 spss
z(x,fe) = 1 alm
z(x,ca) = 1 gr

2 2.                                  |2 species, site multiplicity 2
z(y,al) = 1 spss + 1 alm + 1 py + 1 gr

begin_van_laar_sizes
alpha(py)       1
alpha(alm)      1
alpha(gr)       2.7
alpha(kho1)     1
alpha(spss)     1
end_van_laar_sizes

end_of_model
                              --------------------------------------------------------
begin_model
                                      Melt, White et al., JMG 32:261-286, 2014.

                                      JADC 4/14

                                      reformulated as ordinary configurational entropy model. JADC 12/18.

                                      This model requires the following make definitions in the
                                      thermodynamic data file make_definitions section:

                                      sil8L = 8/5 silL
                                      -23d3 0 0

                                      fo8L = 2 foL
                                      -10d3 0 0

                                      fa8L = 2 faL
                                      -9d3 0 -1.3

                                      q8L = 4 qL
                                      0 0 0

                                      WARNING 3: the (stabilizing) dqf corrections made
                                      to the fo8L, fa8L, and sil8L enedmembers make the
                                      haplogranite melt model inapplicable to melts where
                                      these endmembers are present in high concentrations,
                                      to model such situations or to reproduce the published
                                      fo-fa-q or sil-q melting phase relations, the dqf corrections
                                      (below) should be set to zero.

                                      WARNING 5: The melt model incorrectly predicts a high
                                      pressure-low temperature stability field for water-silica
                                      rich melts. at 10 kb this field extends to ca 750 K and
                                      at 3 kb to ca 550 K. To eliminate this artifact set T_melt
                                      in perplex_option.dat.

melt(W)
abbreviation Melt
full_name    liquid

2                                     model type: simplicial composition space.

8                                     number of endmembers

fo8L     fa8L
abL      sil8L    anL
kspL     q8L      h2oL

0 0 0 0 0 0 0 0 0                   | endmember flags.

2d-3  .1   .1 1                      | range and resolution of X(fo),  1 => asymmetric subdivision
2d-3  .1   .1 1                      | range and resolution of X(fa),  1 => asymmetric subdivision
0    0.4   .1 0                      | range and resolution of X(ab),  0 => cartesian subdivision
2d-3  .1   .1 1                      | range and resolution of X(sil), 1 => asymmetric subdivision
2d-3  .2   .1 1                      | range and resolution of X(an),  1 => asymmetric subdivision
0     .5   .1 0                      | range and resolution of X(ksp), 0 => cartesian subdivision
0    0.6   .1 0                      | range and resolution of X(q),   0 => cartesian subdivision

begin_excess_function

W(q8L abL)                 12d3           -0.4 * P_bar
W(q8L kspL)                -2d3           -0.5 * P_bar
W(q8L anL)                  5d3
W(q8L sil8L)               12d3
W(q8L fo8L)                12d3           -0.4 * P_bar
W(q8L fa8L)                14d3
W(q8L h2oL)                17d3           -0.5 * P_bar
W(abL kspL)                -6d3            3   * P_bar
W(abL sil8L)               12d3
W(abL fo8L)                10d3
W(abL fa8L)                 2d3
W(abL h2oL)              -1.5d3           -0.3 * P_bar
W(kspL anL)                 0d3           -1   * P_bar
W(kspL sil8L)              12d3
W(kspL fo8L)               12d3
W(kspL fa8L)               12d3
W(kspL h2oL)              9.5d3           -0.3 * P_bar
W(anL h2oL)               7.5d3           -0.5 * P_bar
W(sil8L fo8L)              12d3
W(sil8L fa8L)              12d3
W(sil8L h2oL)              11d3
W(fo8L fa8L)               18d3
W(fo8L h2oL)               11d3           -0.5 * P_bar
W(fa8L h2oL)               12d3

end_excess_function

3                           | Configurational entropy: two non-temkin sites (Water, Melt)
                            | and one temkin site (olvine).

2 1                         | water-vacancy site
z(H)     = 1 h2oL

2 0                         | temkin olivine site
n(Mg)    = 4 fo8L
n(Fe)    = 4 fa8L

7 0                         | melt species site, treating ksp and abl as separate species
n(q)     = 1 q8L            | accomplishes the same thing as adding them to form fsp and then
n(ksp)   = 1 kspL           | adding a fsp temkin site.
n(ab)    = 1 abL
n(sil)   = 1 sil8L
n(an)    = 1 anL
n(ol)    = 1 fo8L + 1 fa8L  | this term was not counted prior to dec 2018.
n(w)     = 1 h2oL

end_of_model
                      --------------------------------------------------------
begin_model
                             Mica(W), White et al., JMG 32:261-286, 2014.

                             This model requires the make definitions:

                                fmu = 1 mu + 1/2 andr - 1/2 gr
                                25d3 0 0

                                ma1_dqf = 1 ma
                                6.5d3 0 0

                             in the thermodynamic data file (e.g., hp11ver.dat), additionally the
                             endmember "ma" must be exlcuded from any calculations that employ this
                             model.

                             In thermocalc, different dqf's are used for "muscovite", "margarite"
                             and "paragonite" described by this model. this treatment is clearly
                             inconsistent and not followed here. The dqf's given above are for the
                             thermocalc "muscovite" phase.

                             JADC, 4/14

                             W(pa ma) and W(mu ma) adjusted slightly to match the values used in
                             the Holland et al (2018) TC files (3/19). It is not known when the change
                             was introduced in TC. Change noted by Debaditya Bandyopadhyay 5/1/19.


                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _
                                      3 ma1_dqf       Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 fmu           K       Al      Fe3+  AlSi    _

Mica(W)
abbreviation Mica
full_name    white-mica

2                            | model type: simplex

6                            | 6 endmembers

mu pa ma1_dqf cel fmu fcel

0 0 0 0 0 0 0 0              | endmember flags

                             | subdivision model
0  1     .1 0                | range and resolution of X(mu),      imod = 0 -> cartesian subdivision
0  1     .1 0                | range and resolution of X(pa),      imod = 0 -> cartesian subdivision
0  1     .1 1                | range and resolution of X(ma1_dqf), imod = 0 -> cartesian subdivision
0  1     .1 0                | range and resolution of X(cel),     imod = 0 -> cartesian subdivision
0  .3    .1 0                | range and resolution of X(fmu),
begin_excess_function

W(mu cel)        0                   + .2   * P_bar
W(mu fcel)       0                   + .2   * P_bar
W(mu pa)         10.12d3 + 3.4 *T_K  + .353 * P_bar
W(mu ma1_dqf)    35d3                                      | changed from 34d3, 5/1/19.
W(cel pa)        45d3                + .25  * P_bar
W(cel ma1_dqf)   50d3
W(fcel pa)       45d3                + .25  * P_bar
W(fcel ma1_dqf)  50d3
W(pa ma1_dqf)    15d3                                      | changed from 18d3, 5/1/19.
W(pa fmu)        30d3
W(ma1_dqf fmu)   35d3

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1                         | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel + 1 fmu
z(a,na) = 1 pa

3 1                         | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma1_dqf + 1 fmu
z(m2a,mg) = 1 cel

2 1                         | 2 species on M2b, 1 site per formula unit.
z(m2b,fe) = 1 fmu

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 fmu + 1 ma1_dqf

begin_van_laar_sizes
alpha(mu)       .63
alpha(pa)       .37
alpha(ma1_dqf)  .63
alpha(cel)      .63
alpha(fmu)      .63
alpha(fcel)     .63
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                             Fe3-Fe-Mg Ctd, White et al., JMG 32:261-286, 2014.

                             This model requires the make definitions:

                                ctdo = 1 mct + 1/4 andr - 1/4 gr
                                25d3 0 0

                             JADC, 4/14

                             Mn added DEK June 2021.

Ctd(W)
abbreviation Ctd
full_name    chloritoid

2                          | model type: simplicial composition space
4                          | 4 endmembers
ctdo    fctd     mctd   mnctd
0  0  0  0                 | endmember flags

                           | Note restricted range on X(Mn)

0  1   .1 0                | range and resolution for X(Fe3), imod = 1 -> asymmetric transform subdivision
0  1   .1 0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision
0  1   .1 0                | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(mctd fctd)               4d3
W(mctd mnctd)              3d3
W(mctd ctdo)               1d3
W(fctd mnctd)              3d3
W(fctd ctdo)               5d3
W(mnctd ctdo)              4d3
end_excess_function

2                                     1 site entropy model

3 1                                   2 species on M1b, site multiplicity = 1.
z(Fe) = 1 fctd
z(Mg) = 1 mctd + 1 ctdo    | added by DEK 02-Jun-2021 (put all Mg-bearing EMs here)

2  .5                                2 species on M1a, site multiplicity = 0.5
z(Fe3) = 1 ctdo

begin_dqf_corrections
dqf(mnctd)  660            | added by DEK 02-JUN-2021
end_dqf_corrections

end_of_model
                      --------------------------------------------------------

begin_model

                             688-type Ti-Fe-Fe3-Mg-Mn Staurolite, White et al., JMG 32:261-286, 2014.

                             This model requires the make definitions:

                             mnst = 1 mnst                           | added DEK 2nd June 2021
                             -0.19d3

                             msto   = 1 andr  -1 gr  + 1 mst
                             9d3

                             mstt   = 1 mst - 1 cor   +3/2   ru
                             13d3

                             JADC, 4/14

                             Missing DQF for mst added by Mark Caddick.
                             JADC, 1/26/2014

                             mnst added, vacancy on Al site disassociated
                             from Ti, by Felix Gervais.  JADC, 1/26/2014

                             DEK 17th Sept 2021: reconfigured to 688 model type so as to allow
                             calculation of structural formulae with activity output in meemum.

St(W)

abbreviation St
full_name    staurolite

688                                   | model type: 688 format standard model

1                                     | number of polytopes
1                                     | number of simplices
5                                     | 5 independent end-members (or number of vertices on each simplex)

mstt   msto    mst    mnst   fst      | end-member names

| NAME, XMIN, XMAX, XINC, IMOD (IMOD = 0 is cartesian scheme; IMOD = 1 is non-linear scheme, See https://www.perplex.ethz.ch/perplex/datafiles/solution_model.dat)
| If only one simplex no need to put NAME out front.

0. .3  .1   1                | first simplex: range and resolution for X(Ti),  imod = 1 -> asymmetric transform subdivision
0. .3  .1   1                | range and resolution for X(Fe3), imod = 1 -> asymmetric transform subdivision

0. 1   .1   0                | range and resolution for X(Mg),  imod = 0 -> cartesian subdivision
0. 6   .1   0                | range and resolution for X(Mn),  imod = 0 -> cartesian subdivision

begin_excess_function
W(mst fst)                16d3
W(mst mnst)               12d3
W(mst msto)                2d3
W(mst mstt)               20d3
W(fst msto)               18d3
W(fst mnst)                8d3
W(fst mstt)               36d3
W(mnst msto)              14d3
W(mnst mstt)              32d3
W(msto mstt)              30d3
end_excess_function

2                                     2 site entropy model

X
3 4 4                                 3 species, effective site multiplicity of 4, true multiplicity
z(Mg,X) = 1 mst + 1 mstt + 1 msto     | corrected from just 1 mst by Felix Gervais, 4/9/2015. JADC
x(Mn,X) = 1 mnst
z(Fe,X) = 1 fst

Y
4 2 2                                 4 species, effective site multiplicity of 2, true multiplicity (not clear if the vacancy is associated with Ti)
z(Ti,Y)  = 3/4 mstt
z(Fe3,Y) =   1 msto
z(v,Y)  = 1/4 mstt
z(Al,Y) = 1 mst + 1 fst + 1 mnst

[Al16Si7.5O44(OH)4]                   | formula suffix, enter "none" for no suffix

begin_dqf_corrections
dqf(mst)  -8000
dqf(mnst) -190                        | corrected from 0.19 by Felix Gervais, 4/9/2015. JADC
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model

                             Fe2+-Fe3+-Mg-Al-Ca Orthopyroxene, White et al., JMG 32:261-286, 2014.

                             This model requires the make definitions:

                             mots1    = 1 mgts + 1/2  andr  - 1/2   gr
                             2d3 0 0

                             mnopx = 2 pxmn
                             6.68d3 0 0

                             JADC, 4/14

                             Al site fraction of T "corrected" to (mots1 + mgts)/8 by Mark Caddick.

                             JADC, 1/26/2015

                             Mn added by Felix Gervais, 1/28/2015.

                             This model is as implemented in THERMOCALC. The implementation is
                             irrational because Mn is assumed to remain disordered across M1 and
                             M2, while Al, Fe, Fe3+ and Ca order. The model should only be used
                             with the site_check set to true in perplex_option.dat

                             JADC, 1/28/2015

                             The correction on 1/26/15 was NOT what is done in thermocalc,
                             apparently the correct form is to compute the true disordered
                             tetrahedral site fraction  (mots1 + mgts)/2, but apply a fake
                             multiplicity of 1/4.

                             JADC, 6/10/2016

                             odi replaced by a internal dqf on di

                             JADC, 30/11/2016

                             reformulated as a prismatic + orphan vertex model.

                             JADC, 10/5/2018

                                       Site:          M1      M2      T
                                                     ____________________

                                      Mutliplicity:   1       1       1/4 <- fake
                                                     ____________________

                                      1 en            Mg      Mg      Si
                            Species:  2 fs            Fe2+    Fe2+    Si
                                      3 mnopx         Mn      Mn      Si    independent orphan

                                      4 mgts          Al      Mg      AlSi
                                      5 fets          Al      Fe2+    AlSi  dependent

                                      7 mots1         Fe3+    Mg      AlSi
                                      8 feots         Fe3+    Fe2+    AlSi  dependent

                                     10 di            Mg      Ca      Si
                                     11 fdi           Fe      Ca      Si    dependent
                                                      ___________________

                           Internal: 13 opx           Mg      Fe2+    Si


                           Dependent: fets  = mgts  + opx - en
                                      feots = mots1 + opx - en
                                      fdi   = di   + opx - en

           T  = Al, Fe3; M1
           C  = Ca, M2
           M  = Mg, Fe

           2 polytope model: M1, M2 site populations are indicated, remaining are dependent

           Polytope 1 [Mn][Mn]       => 1 
           Polytope 2 [M,T][M,C]     => 2*5

                           ----------------------------------------------------

Opx(W)                       | solution name.
abbreviation Opx
full_name    orthopyroxene

688                                | model type: 688 format standard model

2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
[Mn][Mn]   0   .7   .1   0
[M,T][M,C] by difference  
                                   | ----------------------------
                                   | Polytope 1 
1                                  | number of simplices, [Mn][Mn]
1                                  | number of vertices on each simplex
mnopx                              | endmembers on the vertices

                                   | ----------------------------
                                   | Polytope 2
2                                  | number of simplices
2  4                               | number of vertices on each simplex
                                   | endmembers on the vertices
mots1    feots_d
di       fdi_d
mgts     fets_d
en       fs
                                  | Simplex 1
X_Mg    0  .8  .1  0              | X(1,1) => bulk Mg/M
X_Fe    by difference
                                  | Simplex 2
X_FeTs  0  .1  .1  0              | X(2,1) - M-Fe3+
X_CaPx  0  .2  .1  0              | X(2,2) - M-Ca
X_AlTs  0  .1  .1  0              | X(2,3) - M-Ts
X_MPx   by difference 

begin_ordered_endmembers
opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.6d3  | changed from -6.95 DEK 02-JUN-2021
end_ordered_endmembers 

begin_dependent_endmembers
fets_d   = 1 mgts  + 1 opx - 1 en
feots_d  = 1 mots1 + 1 opx - 1 en
fdi_d    = 1 di    + 1 fs  - 1 opx
end_dependent_endmembers

begin_excess_function
W(en fs)                   7d3
W(en opx)                  4d3
W(en mgts)                13d3          -0.15 * P_bar
W(en mots1)               11d3          -0.15 * P_bar
W(en mnopx)                5d3
W(en di)                32.2d3           0.12 * P_bar
W(fs opx)                  4d3
W(fs mgts)                13d3          -0.15 * P_bar
W(fs mots1)             11.6d3          -0.15 * P_bar
W(fs mnopx)              4.2d3
W(fs di)               25.54d3          0.084 * P_bar
W(opx mgts)               17d3          -0.15 * P_bar
W(opx mots1)              15d3          -0.15 * P_bar
W(opx mnopx)             5.1d3
W(opx di)              22.54d3          0.084 * P_bar
W(mgts mots1)              1d3
W(mgts mnopx)             12d3          -0.15 * P_bar
W(mgts di)              75.4d3          -0.94 * P_bar
W(mots1 mnopx)          10.6d3          -0.15 * P_bar
W(mots1 di)             73.4d3          -0.94 * P_bar
W(di mnopx)             24.54d3         0.084 * P_bar
end_excess_function

3                                   | 3 site (M1, M2, T) configurational entropy model

M1                                  | site name
5 1 1                               | number of species, effective multiplicity, true multiplicity
z(Fe)   = 1 fs
z(Al)   = 1 mgts
z(Fe3+) = 1 mots1
z(Mn)   = 1 mnopx
z(Mg)   = 1 en + 1 opx + 1 di

M2                                  | site name
4 1 1                               | number of species, effective multiplicity, true multiplicity
z(Fe)   = 1 fs + 1 opx
z(Ca)   = 1 di
z(Mn)   = 1 mnopx
z(Mg)   = 1 en + 1 mgts + 1 mots1

T                                   | site name
                                    | effective site multiplicity increased from .25 to .5, DEK 22/9/2021
                                    | the ".25" value is apparently a typo in the TC commentary.
2 .5 2                              | number of species, effective multiplicity, true multiplicity
z(Al,T)    = 1/2 mgts + 1/2 mots1
z(Si,T)    = 1/2 mgts + 1/2 mots1 + 1 en + 1 fs + 1 opx + 1 di + 1 mnopx

[O6]                                | formula suffix, enter "none" for no suffix.


begin_van_laar_sizes
alpha(en)       1
alpha(fs)       1
alpha(opx)      1
alpha(mgts)     1
alpha(mots1)    1
alpha(di)       1.2
alpha(mnopx)    1
end_van_laar_sizes

begin_dqf_corrections
dqf(di)  = -100    +   0.211 *T      0.005 *P
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                             BIOTITE, White et al., JMG 32:261-286, 2014.

                             NOTE: this model requires make definitions for fbi and tbi
                             in the thermodynamic data file:

                             tbi = 1 phl - 1 br + 1 ru
                             55e3
                             fbi = 1 east - 1/2 gr + 1/2 andr
                             -3e3

                             Modified model entered by Tim Johnson, Apr 7, 2014.

                             enthalpy of ordering for obi corrected, Mark Caddick, JADC 1/26/2015.

                             Mn added and Ti occupancy corrected by Felix Gervais, 1/28/2015.

                             Enthalpy of ordering corrected from -2 to -1 kJ/mol. JADC 5/19

                             Enthalpy of ordering corrected back to -2 kJ/mol. JADC 6/21

                             Holland et al. 2018 modify the parameters of this model,
                             the modified version is present as Bi(HGP).

                                                      M1      M2    T1     H
                                                     ____________________________

                                      Mutliplicity    1       2      2      2
                                                     ____________________________

                          Dependent:    ffbi          Fe3+    Fe     AlAl   OH
                                        fbi           Fe3+    Mg     AlAl   OH

                          Dependent:    ftbi          Ti      Fe     AlSi   O
                                        tbi           Ti      Mg     AlSi   O

                          Dependent:    Sdph          Al      Fe     AlAl   OH
                                        East          Al      Mg     AlAl   OH

                                        Ann           Fe      Fe     AlSi   OH
                                        Phl           Mg      Mg     AlSi   OH

                                        mnbi          Mn      Mn     AlSi   OH independent orphan
                                                      __________________________

                            Ordered:    Obi           Fe      Mg     AlSi   OH

Bi(W)                              | solution name.
abbreviation Bio
full_name    biotite

688                                | model type: 688 format standard model

2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
[Mn][Mn]    0   .5   .1   0
[M,T][M]    by difference
                                   | ----------------------------
                                   | Polytope 1 - 1 simplex
1                                  | number of simplices, [Mn][Mn]
1                                  | number of vertices on each simplex
mnbi                               | endmembers on the vertices

                                   | ----------------------------
                                   | Polytope 2 - 2x4 simplices
2                                  | number of simplices
2  4                               | number of vertices on each simplex
                                   | endmembers on the vertices
ffbi_d   fbi
sdph_d   east
ftbi_d   tbi
ann      phl
                                   | First 2-simplex
X_Mg   0   1    .1  0              | X(1,1) is bulk Fe/M
X_Fe   by difference
                                   | Second 4-simplex
X_FeTs 0   .3   .1  0              | X(2,1) is Fe3/[T+M] on M1, M on M2
X_AlTs 0   .3   .1  0              | X(2,2) is Al/[T+M]  on M1, M on M2
X_TiTs 0   .3   .1  0              | X(2,3) is Ti/[M+T] on M2, M on M1
X_MBio by difference

begin_ordered_endmembers
                             | enthalpy corrected to -1d3 from -2d3, May 1, 2019. JADC
                             | uncorrected to -2d3 to be consistent with 12-12-2019 TC files.
                             | -2d3 for older (WhiteEtAl14), -3d3 for newer/tc350 | changed from -1d3 DEK 02-JUN-2021. Different tc a-x files have ann vs annm as end-members. 
                             | Depending on which a-x file version will determine what DQF_obi is. DEK
obi = 2/3 phl + 1/3 ann   delta_g_of_ordering  = -2d3
end_ordered_endmembers

begin_dependent_endmembers
sdph_d = 1 east  + 1 ann - 1 obi
ffbi_d = 1 fbi   + 1 ann - 1 obi
ftbi_d = 1 tbi   + 1 ann - 1 obi
end_dependent_endmembers

begin_excess_function
W(phl ann)   12d3
W(phl obi)    4d3
W(phl east)  10d3
W(phl tbi)   30d3
W(phl fbi)    8d3
W(phl mnbi)   9d3
W(ann obi)    8d3
W(ann east)  15e3
W(ann tbi)   32d3
W(ann fbi)  136d2
W(ann mnbi)  63d2
W(obi east)   7d3
W(obi tbi)   24d3
W(obi fbi)  5.6d3
W(obi mnbi) 8.1d3
W(east tbi)  40d3
W(east fbi)   1d3
W(east mnbi) 13d3
W(tbi fbi)   40d3
W(tbi mnbi)  30d3
W(fbi mnbi) 116d2

end_excess_function

4                                   | Configurational entropy: 4 sites, M1, M2, T1, OH.

M1                                  | site name
6 1 1                               | 6 species on M1, 1 site per formula unit.

z(Mg)   = 1 phl
z(Fe3+) = 1 fbi
z(Mn)   = 1 mnbi
z(Ti)   = 1 tbi
z(Al)   = 1 east
z(Fe)   = 1 ann  + 1 obi

M2                                  | site name
3 2 2                               | 3 species on M2, 2 sites per formula unit.
z(Fe)   = 1 ann
z(Mn)   = 1 mnbi
z(Mg)   = 1 phl + 1 tbi + 1 obi + 1 fbi + 1 east

T1                                  | site name
2 2 2                               | 2 species on T1, 2 site per formula unit.
z(Si)   = 1/2 phl + 1/2 ann + 1/2 tbi + 1/2 obi + 1/2 mnbi
z(Al)   = 1/2 phl + 1/2 ann + 1/2 tbi + 1/2 obi + 1/2 mnbi + 1 east + 1 fbi

OH                                  | site name
2 2 2                               | 2 species on H, 2 site per formula unit.
z(O,OH)     = 1 tbi
z(OH,OH)    = 1 phl + 1 obi + 1 fbi + 1 east + 1 ann + 1 mnbi

[Si2O10]                            | formula suffix, enter "none" for no suffix.

begin_dqf_corrections
dqf(ann)  -3000
dqf(mnbi) -7890
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                             BIOTITE, "HGP" version of model after White et al., JMG 32:261-286, 2014.

                             NOTE: this model requires make definitions for fbi and tbi
                             in the thermodynamic data file:

                             tbi = 1 phl - 1 br + 1 ru
                             55e3 0 0
                             fbi = 1 east - 1/2 gr + 1/2 andr
                             -3e3 0 0

                             Modified model entered by Tim Johnson, Apr 7, 2014.

                             enthalpy of ordering for obi corrected, Mark Caddick, JADC 1/26/2015.

                             Mn added and Ti occupancy corrected by Felix Gervais, 1/28/2015.

                             The Holland et al (2018) TC files (3/19) indicate changes to Bi(W) that
                             are not discussed in that publication. Change noted by Debaditya Bandyopadhyay 5/1/19.


                                                      M1      M2    T1     H
                                                     ____________________________

                                      Mutliplicity    1       2      2      2
                                                     ____________________________

                          Dependent:    ffbi          Fe3+    Fe     AlAl   OH
                                        fbi           Fe3+    Mg     AlAl   OH

                          Dependent:    ftbi          Ti      Fe     AlSi   O
                                        tbi           Ti      Mg     AlSi   O

                          Dependent:    Sdph          Al      Fe     AlAl   OH
                                        East          Al      Mg     AlAl   OH

                            Species:    Ann           Fe      Fe     AlSi   OH
                                        Phl           Mg      Mg     AlSi   OH
                                        mnbi          Mn      Mn     AlSi   OH independent orphan
                                                      __________________________

                            Ordered:    Obi           Fe      Mg     AlSi   OH

Bi(HGP)                      | solution name.
abbreviation Bio
full_name    biotite

688                                | model type: 688 format standard model

2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
[Mn][Mn]    0   .5   .1   0
[M,T][M]    by difference
                                   | ----------------------------
                                   | Polytope 1 - 1 simplex
1                                  | number of simplices, [Mn][Mn]
1                                  | number of vertices on each simplex
mnbi                               | endmembers on the vertices

                                   | ----------------------------
                                   | Polytope 2 - 2x4 simplices
2                                  | number of simplices
2  4                               | number of vertices on each simplex
                                   | endmembers on the vertices
ffbi_i   fbi
sdph_i   east
ftbi_i   tbi
ann      phl
                                   | First 2-simplex
X_Mg   0    1   .1  0              | X(1,1) is bulk Fe/M
X_Fe   by difference
                                   | Second 4-simplex
X_FeTs 0    1   .1  0              | X(2,1) is Fe3/[T+M] on M1, M on M2
X_AlTs 0    1   .1  0              | X(2,2) is Al/[T+M]  on M1, M on M2
X_TiTs 0    1   .1  0              | X(2,3) is Ti/[M+T] on M2, M on M1
X_MBio by difference

begin_ordered_endmembers
                             | enthalpy corrected to -1d3 from -2d3, May 1, 2019. JADC
                             | uncorrected to -4d3 to be consistent with 31-10-20 TC files. JADC, June 20, 2021.
obi = 2/3 phl + 1/3 ann   delta_g_of_ordering  = -4d3
end_ordered_endmembers

begin_dependent_endmembers
sdph_i = 1 east  + 1 ann - 1 obi
ffbi_i = 1 fbi   + 1 ann - 1 obi
ftbi_i = 1 tbi   + 1 ann - 1 obi
end_dependent_endmembers

begin_excess_function

W(phl ann)   12d3
W(phl obi)    4d3
W(phl east)  10d3
W(phl tbi)   30d3
W(phl fbi)    8d3
W(phl mnbi)   9d3
W(ann obi)    8d3
W(ann east)   5e3           | changed from 15d3 by Holland et al 2018 TC file. Debaditya Bandyopadhyay 5/1/19.
W(ann tbi)   32d3
W(ann fbi)  136d2
W(ann mnbi)  63d2
W(obi east)   7d3
W(obi tbi)   24d3
W(obi fbi)  5.6d3
W(obi mnbi) 8.1d3
W(east tbi)  40d3
W(east fbi)   1d3
W(east mnbi) 13d3
W(tbi fbi)   40d3
W(tbi mnbi)  30d3
W(fbi mnbi) 116d2

end_excess_function

4                                   | Configurational entropy: 4 sites, M1, M2, T1, OH.

M1                                  | site name
6 1 1                               | 6 species on M1, 1 site per formula unit.

z(Mg)   = 1 phl
z(Fe3+) = 1 fbi
z(Mn)   = 1 mnbi
z(Ti)   = 1 tbi
z(Al)   = 1 east
z(Fe)   = 1 ann  + 1 obi

M2                                  | site name
3 2 2                               | 3 species on M2, 2 sites per formula unit.
z(Fe)   = 1 ann
z(Mn)   = 1 mnbi
z(Mg)   = 1 phl + 1 tbi + 1 obi + 1 fbi + 1 east

T1                                  | site name
2 2 2                               | 2 species on T1, 2 site per formula unit.
z(Si)   = 1/2 phl + 1/2 ann + 1/2 tbi + 1/2 obi + 1/2 mnbi
z(Al)   = 1/2 phl + 1/2 ann + 1/2 tbi + 1/2 obi + 1/2 mnbi + 1 east + 1 fbi

OH                                  | site name
2 2 2                               | 2 species on H, 2 site per formula unit.
z(O,OH)     = 1 tbi
z(OH,OH)    = 1 phl + 1 obi + 1 fbi + 1 east + 1 ann + 1 mnbi

[Si2O10]                            | formula suffix, enter "none" for no suffix.

begin_dqf_corrections
dqf(ann)  -6000             | changed from -3d3 in Holland et al. 2018 TC file. Debaditya Bandyopadhyay 5/1/19.
dqf(mnbi) -7890
end_dqf_corrections

end_of_model
                     --------------------------------------------------------
begin_model
                             non-ideal CORDIERITE White et al., JMG 32:261-286, 2014
                             with Mn added

                                                      M       H
                                                     ________________

                                      Mutliplicity    2       1
                                                     ________________

                                      1 mncrd         Mn      Vac
                            Species:  2 fcrd          Fe      Vac
                                      3 crd           Mg      Vac
                                      4 hmncrd        Mn      H2O    dependent
                                      5 hfcrd         Fe      H2O    dependent
                                      6 hcrd          Mg      H2O
                                                      _______________

                            Dependent: hfcrd = hcrd + (fcrd - crd)

                            Modified model entered by Tim Johnson, Apr 7 2014.

                            w(fcrd hcrd) changed from w(crd hcrd), May 16, 2014. Felix Gervais.

                            w(mncrd ...)'s and mncrd DQF added. Felix Gervais, Jan 28, 2015.

Crd(W)
abbreviation Crd
full_name    cordierite

7                                 model type: reciprocal
2                                 2 reciprocal sites
3  2                              3 species on site 1, 2 on site 2
mncrd    fcrd     crd
hmncrd_i hfcrd_i  hcrd

2                                 2 dependent endmembers

hfcrd_i = 1 hcrd +  1 fcrd - 1 crd
hmncrd_i = 1 hcrd + 1 mncrd - 1 crd

1 0 0 1 0 0                | endmember flags

                           | Note restricted range on X(Mn)

0  .2 .1  0                | range and resolution for X(Mn) on M site, imod = 1 -> asymmetric transform subdivision
0  1  .1  0                | range and resolution for X(Fe) on M site, imod = 0 -> cartesian subdivision

0  1   .1 0                | range and resolution for 1-X(H2O) on H site, imod = 0 -> cartesian subdivision

begin_excess_function
W(crd fcrd)        8d3
W(fcrd hcrd)       9d3
W(crd mncrd)       6d3
W(fcrd mncrd)      4d3
W(hcrd mncrd)      6d3
end_excess_function

2                                       2 site entropy model.

3 2.                                    3 species on M, 2 sites per formula unit.
z(m,mg) = 1 crd + 1 hcrd
z(m,fe) = 1 fcrd

2 1                                     2 species on H, 1 sites per formula unit.
z(H,H2O) = 1 hcrd

begin_dqf_corrections
dqf(mncrd)   -4210
end_dqf_corrections

end_of_model
                     --------------------------------------------------------
begin_model
                             non-ideal CORDIERITE model, HGP version of White et al., JMG 32:261-286, 2014
                             with Mn added

                                                      M       H
                                                     ________________

                                      Mutliplicity    2       1
                                                     ________________

                                      1 mncrd         Mn      Vac
                            Species:  2 fcrd          Fe      Vac
                                      3 crd           Mg      Vac
                                      4 hmncrd        Mn      H2O    dependent
                                      5 hfcrd         Fe      H2O    dependent
                                      6 hcrd          Mg      H2O
                                                      _______________

                            Dependent: hfcrd = hcrd + (fcrd - crd)

                            Modified model entered by Tim Johnson, Apr 7 2014.

                            w(fcrd hcrd) changed from w(crd hcrd), May 16, 2014. Felix Gervais.

                            w(mncrd ...)'s and mncrd DQF added. Felix Gervais, Jan 28, 2015.

Crd(HGP)
abbreviation Crd
full_name    cordierite

7                                 model type: reciprocal
2                                 2 reciprocal sites
3  2                              3 species on site 1, 2 on site 2
mncrd    fcrd     crd
hmncrd_i hfcrd_i  hcrd

2                                 2 dependent endmembers

hfcrd_i = 1 hcrd +  1 fcrd - 1 crd
hmncrd_i = 1 hcrd + 1 mncrd - 1 crd

1 0 0 1 0 0                | endmember flags

                           | Note restricted range on X(Mn)

0  .2 .1  0                | range and resolution for X(Mn) on M site, imod = 1 -> asymmetric transform subdivision
0  1  .1  0                | range and resolution for X(Fe) on M site, imod = 0 -> cartesian subdivision

0  1   .1 0                | range and resolution for 1-X(H2O) on H site, imod = 0 -> cartesian subdivision

begin_excess_function
W(crd fcrd)        6d3
W(crd mncrd)       6d3
W(fcrd mncrd)      4d3
W(hcrd mncrd)      6d3
end_excess_function

2                                       2 site entropy model.

3 2.                                    3 species on M, 2 sites per formula unit.
z(m,mg) = 1 crd + 1 hcrd
z(m,fe) = 1 fcrd

2 1                                     2 species on H, 1 sites per formula unit.
z(H,H2O) = 1 hcrd

begin_dqf_corrections
dqf(mncrd)   -4210
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                            Sapphirine, O/D non-ideal, Wheller & Powell (JMG, 32, 287299, 2014)

                            Modified JADC model entered by Tim Johnson, 7 April 2014.

                                                      1      2      3
                                                      M3     M456   T
                                                     _________________

                                      Mutliplicity    1      3     1
                                                     _________________

                                      1 spr4          Mg     Mg    Si
                            Species:  2 fspr          Fe     Fe    Si
                                      3 spr5          Al     Mg    Al
                                      4 fsp5_d        Al     Fe    Al        dependent
                                      5 ospr          Fe3+   Mg    Al
                                      6 fospr_d       Fe3+   Fe    Al        dependent

                                      7 spro          Fe     Mg    Si        ordered

                                      Dependent endmember:

                                      FeMg-1_M456 = (fspr-spro)/3

                                      fsp5_d = spr5 +  fspr - spro
                                      fospro_d = ospr +  fspr - spro

Sa(WP)
abbreviation Sap
full_name    sapphirine

8                            | model type: order-disorder, prismatic composition space
2                            | 2 independent mixing sites
2  3                         | 2 components {Fe2+, Mg} for composition 1, 3 components {Al, Si, Fe3+} for composition 2.

                             | endmember names
spr4     fspr
spr5     fsp5_d
ospr     fospr_d

1                            | 1 ordered species:

spro = 3/4 spr4 + 1/4 fspr   delta_g_of_ordering  = -3.5d3

2                            | 2 dependent endmembers

fsp5_d   = 1 spr5 +  1 fspr - 1 spro
fospr_d  = 1 spr5 +  1 fspr - 1 spro

0 0 0 0 0 0                | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0  1  .1   0               | range and resolution of X(Mg), subdivision scheme for site 1: imod = 0 -> cartesian

                           | subdivision model for (ternary) site 2
0  1  .1   0               | range and resolution of X(Ts), subdivision scheme for site 3, species 1: imod = 0 -> cartesian
0  1  .1   0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian

begin_excess_function
W(spr4 spr5)              10d3         -0.02 * P_bar
W(spr4 fspr)              16d3
W(spr4 spro)              12d3
W(spr4 ospr)               8d3         -0.02 * P_bar
W(spr5 fspr)              19d3         -0.02 * P_bar
W(spr5 spro)              22d3         -0.02 * P_bar
W(spr5 ospr)               1d3
W(fspr spro)               4d3
W(fspr ospr)             17600         -0.02 * P_bar
W(spro ospr)              20d3         -0.02 * P_bar
end_excess_function

3                          | 3 site (M3, M456, T) configurational entropy model

2 3.                       | 2 species on M46, 3 sites per formula unit
z(m456,fe) = 1 fspr

4 1                        | 4 species on M3, 1 sites per formula unit.
z(m3,Al)  = 1 spr5
z(m3,Fe3) = 1 ospr
z(m3,mg)  = 1 spr4

2 1                        | 2 species on T, 1 sites per formula unit.
z(T,si) = 1 spr4 + 1 fspr + 1 spro

begin_dqf_corrections
dqf(fspr)   -2d3
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                             Orthopyroxene with compound formation, PH '99 Am Min.
                             JADC 3/03

                             site population limits added Feb 20, 2011, JADC.

                             added ferric iron, Jul 24, 2012. JADC.

                             NOTES:

                             * This model will only function for the FASH subsystem
                               if MGO is present as a component in VERTEX.

                                                      1       2
                                                      M1      M2
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 en            Mg      Mg
                            Species:  2 fs            Fe2+    Fe2+
                                      3 mgts          Al      Mg
                                      4 fets          Al      Fe2+  dependent
                                      5 mots          Fe3+    Mg
                                      6 feots         Fe3+    Fe2+  dependent
                                                      _____________

                           Internal:  7 opx           Mg      Fe2+


                           Dependent: fets  = mgts + opx - en
                                      feots = mots + opx - en


Opx(HP)                    | solution name.
abbreviation Opx
full_name    orthopyroxene

8                          | model type: order-disorder, prismatic composition space
2                          | 2 independent composition spaces
2 3                        | 2 dimensions on first space, 3 on second
                           | endmembers:
mgts     fets_d
en       fs
mots     feots

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3

2                          | 2 dependent endmembers

fets_d = 1 mgts + 1 opx - 1 en
feots  = 1 mots + 1 opx - 1 en

0 0 0 0 0 0                | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0   1  .1  0               | range and resolution of X(Mg)

                           | subdivision model for (ternary) site 2
0   1  .1  0               | range and resolution of X(Ts), subdivision scheme for site 3, species 1: imod = 0 -> cartesian
0   1  .1  0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian


begin_excess_function
w(en fs)     68d2
w(fs mgts)   -1d3
w(en opx)    45d2
w(fs opx)    45d2
w(mgts opx)  12d2
w(en mots)  -14d3
w(fs mots)    6d3
w(opx mots)   6d3
end_excess_function

2                          | 2 site (M1, M2) configurational entropy model

4 1                        | 3 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 fs
z(m1,al)   = 1 mgts
z(m1,fe3+) = 1 mots

2 1                        | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en + 1 mgts + 1 mots

end_of_model
                      --------------------------------------------------------
begin_model

                             Ti-Fe3+ Biotite from Tajcmanova et al., JMG 2009;
                             extended for Mn solution after Tinkham et al. 2001.

                             Model entered by Lucie Tajcmanova, December, 2008.

                             NOTE this model requires the following make definitions 
                             in the thermodynamic data file:

                             tbit = 1 phl - 1 br + 1 ru           84e3 -11.5 0 
                             fbit = 1 east - 1/2 cor + 1/2 hem    6e3 0 0  

                             site population limits added Feb 20, 2011, JADC.

                             reformulated as a prismatic + orphan vertex model.

                             JADC, 10/5/2018

                             688 format, JADC, 9/9/2019.


                                      Site:           M1      M2       T1     H
                                                     ____________________________

                                      Mutliplicity    1       2        2      2       

                                    endmember        ____________________________   type
                                    _________                                       _________


                                        ffbit         Fe3+   FeFe     AlAl    OH    dependent 
                                        fbit          Fe3+   MgMg     AlAl    OH
                          
                                        ftbit         Fe     TiFe     AlSi    O     dependent
                                        tbit          Mg     TiMg     AlSi    O
   
                                        sdph          Al     FeFe     AlAl    OH    dependent
                                        east          Al     MgMg     AlAl    OH

                                        mnbi          Mn     MnMn     AlSi    OH    independent orphan
                                        ann           Fe     FeFe     AlSi    OH
                                        phl           Mg     MgMg     AlSi    OH

                                        obi           Fe     MgMg     AlSi    OH    ordered

Bio(TCC)                           | model name
abbreviation Bio
full_name    biotite

688                                | model type: 688 format standard model
 
2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
[Mn][Mn]  0   .5   .1   0
[M,T][M]  by difference
                                   | ----------------------------
                                   | Polytope 1 - 1 simplex
1                                  | number of simplices, [Mn][Mn]
1                                  | number of vertices on each simplex
mnbi                               | endmembers on the vertices
                                   | ----------------------------
                                   | Polytope 2 - 2x4 simplices
2                                  | number of simplices
2  4                               | number of vertices on each simplex
                                   | endmembers on the vertices
ffbit     fbit
sdph      east
ftbit     tbit
ann       phl
                                   | First 2-simplex
X_Mg    0    1   .1  0             | X(1,1) is bulk Fe/M
X_Fe    by difference

                                   | Second 4-simplex
X_FeTs  0    1   .1  0             | X(2,1) is Fe3/[T+M] on M1, M on M2
X_AlTs  0    1   .1  0             | X(2,2) is Al/[T+M]  on M1, M on M2
X_TiTs  0    1   .1  0             | X(2,3) is MTi/[M+MTi] on M2, M on M1
X_MBio  by difference

begin_ordered_endmembers
obi = 2/3 phl + 1/3 ann   delta_g_of_ordering  = -6.8d3 
end_ordered_endmembers

begin_dependent_endmembers
sdph    = 1 east + 1 ann    - 1 obi
ffbit   = 1 fbit + 1 ann    - 1 obi
ftbit   = 1 tbit + 1/2 ann  + 1/2 obi - 1 phl
end_dependent_endmembers

begin_excess_function
W(phl ann)   12000   | excess parameters from Holland & Powell, JMG, 2006
W(phl east)  10000 
W(phl obi)    4000
W(ann east)   3000 
W(ann obi)    8000
W(obi east)   7000
end_excess_function 

4                                   | number of identisites in configurational entropy model

M1                                  | site name
5 1 1                               | number of species, effective multiplicity, true multiplicity
z(Al,M1)   = 1 east
z(Mg,M1)   = 1 phl + 1 tbit
z(Mn,M1)   = 1 mnbi 
z(Fe3+,M1) = 1 fbit
z(Fe,M1)   = 1 ann + 1 obi 

M2                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Fe,M2)   = 1 ann
z(Ti,M2)   = 1/2 tbit
z(Mn,M2)   = 1 mnbi
z(Mg,M2)   = 1 phl + 1 obi + 1 east + 1/2 tbit + 1 fbit

T1                                  | site name
2 2 2                               | number of species, effective multiplicity, true multiplicity
z(Si,T1)   = 1/2 phl + 1/2 ann + 1/2 tbit + 1/2 obi + 1/2 mnbi 
z(Al,T1)   = 1 east + 1/2 phl + 1/2 ann + 1/2 tbit + 1/2 obi + 1/2 mnbi + 1 fbit

OH                                  | site name
2 2 2                               | 2 species on H, 2 site per formula unit.
z(O,OH)     = 1 tbit
z(OH,OH)    = 1 east + 1 phl + 1 ann + 1 obi + 1 mnbi + 1 fbit

[Si2O10(OH)2]                       | formula suffix, enter "none" for no suffix.

end_of_model
                    --------------------------------------------------------
begin_model

                                  Ti-Biotite model after White, Powell & Holland (JMG, 2007)

                                  Model entered by Lucie Tajcmanova, May 11, 2007.

                                  DQF corrections to annite added, Mark Caddick, Nov, 2007.

                                  NOTE: this model requires make defintions for fbi and tbi
                                  in the thermodynamic data file.

                                                      1       2      3      4
                                                      M1      M2     T1     H
                                                     ____________________________

                                      Mutliplicity    1       2      2      2
                                                     ____________________________

                          Dependent:  1 ffbi          Fe3+    Fe     AlAl   OH
                                      2 fbi           Fe3+    Mg     AlAl   OH

                          Dependent:  3 ftbi          Ti      Fe     AlSi   O
                                      4 tbi1          Ti      Mg     AlSi   O

                          Dependent:  5 Sdph          Al      Fe     AlAl   OH
                                      6 East          Al      Mg     AlAl   OH

                            Species:  7 Ann           Fe      Fe     AlSi   OH
                                      8 Phl           Mg      Mg     AlSi   OH
                                                      __________________________

                            Ordered:  9 Obi           Fe      Mg     AlSi   OH

Bio(WPH)                     | solution name.
abbreviation Bio
full_name    biotite

8                            | model type: order-disorder, prismatic composition space
2                            |
2  4                         | 2 species on site 1, 4 species on site 2.
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mg-Fe and the species that mix on
                             | site 2 are M2+, Al, Ti. Fe3+. The identity of M2+ on site 2 is determined by
                             | the identity of the M2+ cation on site 1
ffbi_i   fbi
ftbi_i   tbi1
sdph_i   east
ann      phl

1                            | ordered species:

obi = 2/3 phl + 1/3 ann   delta_g_of_ordering  = -10.73d3

3                            | 3 dependent endmembers

sdph_i = 1 east  + 1 ann - 1 obi
ffbi_i = 1 fbi   + 1 ann - 1 obi
ftbi_i = 1 tbi1  + 1 ann - 1 obi

0 0 0 0 0 0 0 0 0            | endmember flags: if 0 the endmember is considered to be part of the solution.

                             | subdivision model for (binary) site 1 (M2):

0   1  .1 0                  | range and resolution of X(Fe)

                             | subdivision model for (quinary) site 2 (M1)
0. .2 .1  0                  | range and resolution of X(Fe3+,M1)
0. .2 .1  0                  | range and resolution of X(Ti,M1)
0   1  .1 0                  | range and resolution of X(Al,M1)

begin_excess_function
                             | current preferred thermocalc values, Caddick, Nov '07
W(phl ann)   9000.
W(phl east) 10000.
W(phl obi)   3000.
W(ann east) -1000.
W(ann obi)   6000.
W(ann fbi)   8000
W(ann tbi1) 10000
W(obi east) 10000.
                             | values from White et al paper and earlier Perple_X verions.
                             | W(phl ann) 12000
                             | W(phl east) 10000
                             | W(phl obi) 4000
                             | W(ann east)  3000
                             | W(ann obi) 8000
                             | W(ann fbi)   8000
                             | W(ann tbi1)   10000
                             | W(obi east)  7000
end_excess_function

4                           | Configurational entropy: 4 sites, M1, M2, T1 H.

5 1                         | 5 species on M1, 1 site per formula unit.

z(m1,fe) = 1 ann  + 1 obi
z(m1,mg) = 1 phl
z(m1,Fe3+) = 1 fbi
z(m1,Ti) = 1 tbi1

2 2.                        | 2 species on M2, 2 sites per formula unit.

z(m2,fe) = 1 ann

2 2.                        | 2 species on T1, 2 site per formula unit.

z(Al,T1) = 1/2 tbi1 + 1/2 ann + 1/2 phl + 1/2 obi + 1 east + 1 fbi

2 2.                        | 2 species on H, 2 site per formula unit.

z(h,o) = 1 tbi1

begin_dqf_corrections
dqf(ann) -3000
end_dqf_corrections

end_of_model
                  --------------------------------------------------------
begin_model
                             Orthopyroxene with compound formation, PH '99 Am Min.
                             JADC 3/03

                             Modified for ideal Cr, additionally a temperature
                             dependence of -16 J/K has been assigned adhoc to W(mgts-en)
                             and W(mgts-opx) in order to increase the Al-content of opx
                             for upper mantle compositions and conditions. A better way
                             of accomplishing the same result would be to increase the
                             entropy of mgts. PGP Workshop 4/12/06.
                             (folk.uio.no/ninasim/Cr_results.html)

                             site population limits added Feb 20, 2011, JADC.

                             NOTES:

                             * This model should not be used for crustal rocks/conditions!

                             * This model will only function for the FASH subsystem
                               if MGO is present as a component in VERTEX.

                             * Added ferric iron. JADC, 3/29/13.

                                                      1       2
                                                      M1      M2
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 en            Mg      Mg
                            Species:  2 fs            Fe2+    Fe2+
                                      3 mgts          Al      Mg
                                      5 mots          Fe3+    Mg
                                      7 crts          Cr      Mg
                                                      _____________

                           Internal:  9 opx           Mg      Fe2+

                           Dependent: fets  = mgts + opx - en
                                      feots = mots + opx - en
                                      fcrts = crts + opx - en

CrOpx(HP)                  | solution name.
abbreviation Opx
full_name    orthopyroxene

8                          | model type: Reciprocal with speciation

2                          | 2 independent composition spaces
2 4                        | 2 dimensions on first space, 3 on second
                           | endmembers:
crts     fcrts_d
mgts     fets_d
en       fs
mots     feots

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3

3                          | 3 dependent endmembers

fets_d  = 1 mgts + 1 opx - 1 en
feots   = 1 mots + 1 opx - 1 en
fcrts_d = 1 crts - 1/2 en + 1/2 fs

0 0 0 0 0 0 0 0            | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0   1  .1  0               | range and resolution of X(Mg),subdivision scheme for site 1: imod = 0 -> cartesian

                           | subdivision model for (ternary) site 2
0   1  .1  0               | range and resolution of X(Cr), subdivision scheme for site 3, species 1: imod = 0 -> cartesian
0   1  .1  0               | range and resolution of X(Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian
0   1  .1  0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 3: imod = 0 -> cartesian

begin_excess_function
w(en fs)     68d2
w(fs mgts)   -1d3 -14. 0
w(en opx)    45d2
w(fs opx)    45d2
w(mgts opx)  12d2 -14. 0
w(en mots)  -14d3
w(fs mots)    6d3
w(opx mots)   6d3
end_excess_function

2                          | 2 site (M1, M2) configurational entropy model

5 1                        | 5 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 fs
z(m1,al)   = 1 mgts
z(m1,fe3+) = 1 mots
z(m1,cr)   = 1 crts

2 1                        | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en + 1 mgts + 1 mots + 1 crts

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                                Mg-Fe-Ca-Al-Cr Garnet
                                Hybrid Holland & Powell + Simon/PGP Cr Workshop
                                (folk.uio.no/ninasim/Cr_results.html)
CrGt
abbreviation Gt
full_name    garnet

7                              | model type: reciprocal
2                              | 2 chemical site model
3 2                            | 3 endmembers mix on site 1, 2 endmembers mix on site 2

uv_d  fuv_d  knor
gr    alm    py

2                              | 2 dependent endmembers

uv_d = 1 gr +  1 knor  - 1 py
fuv_d = 1 alm +  1 knor  - 1 py

0 0 0 0 0 0                    | endmember flags 0 include it   1 drop it

0   1  .1  0                | range and resolution for  XCa on A
0   1  .1  0                | range and resolution for  XFe on A

0   1  .1  0                | range and resolution for  XCr on B

begin_excess_function
w(py gr) 33d3
w(py knor) 3d3              | corrected as in erratum to ziberna et al 2013 (2014)
 | w(py py gr) 59304. -10.5  .036   Ganguly excess paramters
 | w(py gr gr) 25860. -10.5  .174
end_excess_function
2                                     2 site entropy model
3 3.                                  3 species, site multiplicity of 3
z(Ca) = 1 gr 
z(Mg) = 1 py + 1 knor
2 2.                                  2 species, site multiplicity of 2
z(Al) = 1 gr + 1 alm + 1 py

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model
                             Garnet model of Malaspina et al. 2009

                             the andradite endmember should be excluded from calculations when
                             this model is use. JADC, 6/2010

                             Cr added as in Simon/PGP Cr Workshop,
                             folk.uio.no/ninasim/Cr_results.html. JADC, 3/29/13

                             For Cr garnet it's probably better to use CrGt. JADC, 23/1/15.

                                                      M1      M2
                                                     _____________

                                      Mutliplicity    3       2
                                                     _____________

                                       skiag         Fe      Fe3+
                          Dependent:   kho           Mg      Fe3+
                          Dependent:   andr          Ca      Fe3+

                          Dependent:   fuv_d         Fe      Cr
                                       knor          Mg      Cr
                          Dependent:   uv_d          Ca      Cr

                                       alm           Fe      Al
                                       py            Mg      Al
                                       gr            Ca      Al

Gt(MPF)
abbreviation Gt
full_name    garnet

7                                 | model type: macroscopic with dependent endmembers
2                                 | number of independent mixing sites, reciprocal solution
3  3                              | 3 species on site M1, 2 species on site M2.

alm    py     gr                  | endmember names
skiag  kho    andr
fuv_d  knor   uv_d

4                                 | number of dependent endmembers

andr  = 1 gr  + 1 skiag - 1 alm
kho   = 1 py  + 1 skiag - 1 alm
uv_d  = 1 gr  + 1 knor  - 1 py
fuv_d = 1 alm + 1 knor  - 1 py

0  0  0  0  0  0  0  0  0         | endmember flags

0. 1     .1 0                     | imod = 0 -> cartesian subdivision (xfe) on M1
0. 1     .1 0                     | imod = 0 -> cartesian subdivision (xmg) on M1

0. 1     .1 0                     | imod = 0 -> cartesian subdivision x(al) on M2
0. 1     .1 0                     | imod = 0 -> cartesian subdivision x(fe3+) on M2

begin_excess_function
w(py knor) 30000.
w(alm gr) 15000.
w(py gr) 80000.            | HP (33000.)
w(alm py) 2500.            | HP
w(alm skiag) -37053.18     | Skiag
end_excess_function

2                                 |2 site entropy model

3 3.                              |3 species, site multiplicity 3
z(x,fe) = 1 alm + 1 skiag
z(x,Mg) = 1 py  + 1 knor

3 2.                              |2 species, site multiplicity 2
z(y,al) = 1 alm + 1 py + 1 gr
z(y,cr) = 1 knor

end_of_model

                      --------------------------------------------------------
begin_model
                             ad hoc pumpellyite, assumes fe-mg occupy two
                             octahedral (M1) sites and al-fe3 occupy 5 (M2).
                                                       JADC, Sep 17, 2017

Pu
abbreviation Pu
full_name    pumpellyite

7                                 | model type: macroscopic with dependent endmembers
2                                 | number of independent mixing sites, reciprocal solution
2  2                              | 2 species on site M1, 2 species on site M2.

mpm  fpm                          | endmembers
mjgd jgd

1                                 | number of dependent endmembers

mjgd  = 1 jgd  + 1 mpm - 1 fpm

0  0  0  0                        | endmember flags

0. 1     .1 0                     | imod = 0 -> cartesian subdivision (xfe) on M1
0. 1     .1 0                     | imod = 0 -> cartesian subdivision (xmg) on M1

ideal

2                                 |2 site entropy model

2 1                               |2 species, M1 site multiplicity 1
z(M1,Mg) = 1 mpm

2 5.                              |2 species, M2 site multiplicity 5
z(M2,Fe3) = 1 jgd

end_of_model
                              --------------------------------------------------------
begin_model
                                      Sack & Ghiorso (1989 CMP 102:41-68) for Fe-Mg olivine.
                                      [an astoundingly complex presentation]
                                      JADC 7/03
O(SG)
abbreviation Ol
full_name    olivine

2                                     model type macroscopic
2                                     2 endmembers

fo
fa

0  0                               | endmember flags

0   1  .1 0                        | range and resolution of X(mg), imod = 0 -> cartesian subdivision

begin_excess_function
w(fo fa)  20314. 0  3e-2
end_excess_function

1                                     1 site entropy model (m)
2 2.                                  2 species on m2, mutiplicity = 2
z(m,mg) = 1 fo

end_of_model
                                      --------------------------------------------------------
begin_model

                                      Ghiorso et al (2002) G3 v. 3 (n. 5) model for mantle
                                      melting, 1-3 GPa. Read cautionary notes in Ghirso for
                                      applications beyond this pressure range. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the pMELTS model that excludes
                                      the Cr-, Ni-, Co-, and P-bearing melt components. The melt
                                      endmember names have been changed from those used in the pMELTS paper.

                                      This model should be applied with solid phase data
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the pMELTS model, however using these files
                                      will almost certainly result in inconsistencies with published
                                      pMELTS results.


                                      JADC 7/03

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the pMELT
                                      model. Check these ranges, and adjust them as
                                      necessary before using this model.

                                      ====================================================
                                      Modified to use pure water at P and T standard
                                      state (the H2O endmember) as opposed to the h2oGL
                                      endmember of Ghiorso et al. (2003), which so far
                                      as I understand should  be equivalent.

                                      NOTE: Use of H2O as an endmember requires the user
                                      specify an equation of state for H2O when running
                                      BUILD. To be strictly consistent with Ghiorso et al
                                      the Sterner and Pitzer EoS for water should be used
                                      for this purpose, but it is not presently included
                                      in perplex.

                                      JADC May 23, 2004.

                                      Added TiO2 endmember. JADC Feb 7, 2012.

                                      converted to an ordinary temkin model. JADC, 12/18.
pMELTS(G)
abbreviation Melt
full_name    liquid

2                                    model type: ordinary simplicial

9                                    number of endmembers

H2O
foGL
faGL
woGL
kalGL
nasGL
coGL
tiGL
qGL

1 0 0 0 0 0 0 0 0                   | endmember flags

                                    | NOTE restricted compositional ranges!

0    1     .1  0                    | range and resolution of X(h2o), 0 => cartesian subdivision
0    .5    .1  0                    | range and resolution of X(fo), 0 => cartesian subdivision
0    .2    .1  0                    | range and resolution of X(fa), 0 => cartesian subdivision
0    .2    .1  0                    | range and resolution of X(wo), 0 => cartesian subdivision
0    .6    .1  0                    | range and resolution of X(kal), 0 => cartesian subdivision
0    .6    .1  0                    | range and resolution of X(nas), 0 => cartesian subdivision
0    .2    .1  0                    | range and resolution of X(co), 0 => cartesian subdivision
0    .2    .1  0                    | range and resolution of X(Ti), 0 => cartesian subdivision

begin_excess_function
w( coGL  qGL  ) -296975.2
w( faGL  qGL  ) -18841.4
w( foGL  qGL  ) -33833.5
w( woGL  qGL  ) -34232.9
w( nasGL qGL  ) -59822.7
w( kalGL qGL  ) -102706.5
w( H2O   qGL  ) -45181.6
w( faGL  coGL ) -200788.1
w( foGL  coGL ) -192709.0
w( woGL  coGL ) -270700.8
w( nasGL coGL ) -205068.6
w( kalGL coGL ) -114506.5
w( H2O   coGL ) -161944.4
w( foGL  faGL ) -28736.4
w( woGL  faGL ) -28573.8
w( nasGL faGL ) -4723.9
w( kalGL faGL ) 22245
w( H2O   faGL ) 9769.4
w( woGL  foGL ) 574.1
w( nasGL foGL ) 9272.3
w( kalGL foGL ) 36512.7
w( H2O   foGL ) 24630.1
w( nasGL woGL ) 7430.3
w( kalGL woGL ) 19927.4
w( H2O   woGL ) -1583.7
w( kalGL nasGL) -1102.3
w( H2O   nasGL) 13043.1
w( H2O   kalGL) 35572.8

w(coGL  tiGL) 144804.9
w(faGL  tiGL) 9324.2
w(foGL  tiGL) 16355.6
w(woGL  tiGL) 9471.5
w(nasGL tiGL) 22194.2
w(kalGL tiGL) 3744

end_excess_function
                                    | the configurational entropy for this model is unclear
                                    | eq 1 of ghiorso et al. (2002) is almost certainly wrong
                                    | the model below follows ghioro and sack 1995 & Nicholls 1980 CMP 74:211

2                                   | 2 sites

9 0                                 | melt site, 9 species
z(h2o)   = 1 H2O
z(foGL)  = 1 foGL
z(faGL)  = 1 faGL
z(woGL)  = 1 woGL
z(kalGL) = 1 kalGL
z(nasGL) = 1 nasGL
z(coGL)  = 1 coGL
z(tiGL)  = 1 tiGL
z(qGL)   = 1 qGL

2 1                                  | water vacancy site
z(h2o) = 1 H2O

end_of_model
                                      --------------------------------------------------------
begin_model

                                      mMELTS(G) is a chopped down version of pMELTS(G) with
                                      Cr added to model lunar melting without changing dimensioning.

                                      Ghiorso et al (2002) G3 v. 3 (n. 5) model for mantle
                                      melting, 1-3 GPa. Read cautionary notes in Ghirso for
                                      applications beyond this pressure range. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the pMELTS model that excludes
                                      the Cr-, Ni-, Co-, and P-bearing melt components. The melt
                                      endmember names have been changed from those used in the pMELTS paper.

                                      This model should be applied with solid phase data
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the pMELTS model, however using these files
                                      will almost certainly result in inconsistencies with published
                                      pMELTS results.


                                      JADC 7/03


                                      WARNING 1: This model can only be used for hydrous systems
                                      if H2O is specified as a thermodynamic component
                                      (i.e., if H2O is specified as a saturated
                                      component, VERTEX will reject the h2oG(L) endmember
                                      and the model will be applicable only to dry melts).

                                      WARNING 2: this model uses an internal routine to
                                      compute the entropy of the melt that assumes
                                      h2oG(l) is the first endmember.

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the pMELT
                                      model. Check these ranges, and adjust them as
                                      necessary before using this model.

                                      ====================================================
                                      Modified to use pure water at P and T standard
                                      state (the H2O endmember) as opposed to the h2oGL
                                      endmember of Ghiorso et al. (2003), which so far
                                      as I understand should  be equivalent.

                                      NOTE: Use of H2O as an endmember requires the user
                                      specify an equation of state for H2O when running
                                      BUILD. To be strictly consistent with Ghiorso et al
                                      the Sterner and Pitzer EoS for water should be used
                                      for this purpose.

                                      JADC May 23, 2004.

                                      Added TiO2 endmember. JADC Feb 7, 2012

                                      reformulated as ordinary solution model. JADC 12/18.

mMELTS(G)
abbreviation Melt
full_name    liquid

2                                    model type: internal entropy routine

8                                     number of endmembers

H2O
foGL
faGL
woGL
crGL
coGL
tiGL
qGL

1 0 0 0 0 0 0 0 0                   | endmember flags

                                    | NOTE restricted compositional ranges!

0    1     .1  0                    | range and resolution of X(h2o), 0 => cartesian subdivision
0    1     .1  0                    | range and resolution of X(fo), 0 => cartesian subdivision
0    1     .1  0                    | range and resolution of X(fa), 0 => cartesian subdivision
0    1     .1  0                    | range and resolution of X(wo), 0 => cartesian subdivision
0    1     .1  0                    | range and resolution of X(kal), 0 => cartesian subdivision
0    1     .1  0                    | range and resolution of X(co), 0 => cartesian subdivision
0    1     .1  0                    | range and resolution of X(Ti), 0 => cartesian subdivision

begin_excess_function
w( coGL  qGL  ) -296975.2
w( faGL  qGL  ) -18841.4
w( foGL  qGL  ) -33833.5
w( woGL  qGL  ) -34232.9
w( H2O   qGL  ) -45181.6
w( faGL  coGL ) -200788.1
w( foGL  coGL ) -192709
w( woGL  coGL ) -270700.8
w( H2O   coGL ) -161944.4
w( foGL  faGL ) -28736.4
w( woGL  faGL ) -28573.8
w( H2O   faGL ) 9769.4
w( woGL  foGL ) 574.1

w( H2O   foGL ) 24630.1
w( H2O   woGL ) -1583.7

w(coGL  tiGL) 144804.9
w(faGL  tiGL) 9324.2
w(foGL  tiGL) 16355.6
w(woGL  tiGL) 9471.5

w(coGL  crGL) -269339.7
w(faGL  crGL) -74759
w(foGL  crGL) -3638.5
w(woGL  crGL)  48337.5
w(tiGL  crGL) -22455.8


end_excess_function

                                    | the configurational entropy for this model is unclear
                                    | eq 1 of ghiorso et al. (2002) is almost certainly wrong
                                    | the model below follows ghioro and sack 1995 & Nicholls 1980 CMP 74:211

2                                   | 2 sites

8 0                                 | melt site, 8 species multiplicity 1
z(h2o)  = 1 H2O
z(foGL) = 1 foGL
z(faGL) = 1 faGL
z(crGL) = 1 crGL
z(woGL) = 1 woGL
z(coGL) = 1 coGL
z(tiGL) = 1 tiGL
z(qGL)  = 1 qGL

2 1                                  | water vacancy site
z(h2o) = 1 H2O


end_of_model
                                      --------------------------------------------------------
begin_model
                                      Ghiorso & Sack (1995) CMP 119:197-212 (the MELTS model)
                                      Read cautionary notes in Ghirso. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the MELTS model that excludes
                                      the Cr- and P-bearing melt components. The melt
                                      endmember names have been changed from those used
                                      in the MELTS paper.

                                      This model should be applied with solid phase data
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the MELTS model, however using these files
                                      will almost certainly result in inconsistencies with published
                                      MELTS results.

                                      JADC 7/03

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the MELT
                                      model. Check these ranges, and adjust them as
                                      necessary before using this model.
MELTS(GS)
abbreviation Melt
full_name    liquid

2                                     model type: simplicial

8                                     number of endmembers

h2oGM
foGM
faGM
woGM
kalGM
nasGM
coGM
qGM

0 0 0 0 0 0 0 0                  | endmember flags

0   0.3  0.04 0
0.3 0.7  0.04 0
0   0.3  0.04 0
0    .2  0.04 0
0   0.4  0.04 0
0    .2  0.04 0
0   0.3  0.04 0                   | (restricted) subdivision ranges and model

begin_excess_function

w( coGM  qGM  ) -39120.
w( faGM  qGM  ) 23661.
w( foGM  qGM  ) 3421.
w( woGM  qGM  ) -864.
w( nasGM qGM  ) -99039.
w( kalGM qGM  ) -33922.
w( h2oGM qGM  ) 30967.
w( faGM  coGM ) -30509.
w( foGM  coGM ) -32880.
w( woGM  coGM ) -57918.
w( nasGM coGM ) -130785.
w( kalGM coGM ) -25859.
w( h2oGM coGM ) -16098.
w( foGM  faGM ) -37257.
w( woGM  faGM ) -12971.
w( nasGM faGM ) -90534.
w( kalGM faGM ) 23649.
w( h2oGM faGM ) 28874.
w( woGM  foGM ) -31732.
w( nasGM foGM ) -41877.
w( kalGM foGM ) 22323.
w( h2oGM foGM ) 35634.
w( nasGM woGM ) -13247.
w( kalGM woGM ) 17111.
w( h2oGM woGM ) 20375.
w( kalGM nasGM) 6523.
w( h2oGM nasGM) -96938.
w( h2oGM kalGM) 10374.
end_excess_function


2

8 0                                 | melt site, 8 species, temkin multiplicity 1
z(h2o) = 1 h2oGM
z(fo)  = 1 foGM
z(fa)  = 1 faGM
z(wo)  = 1 woGM
z(kal) = 1 kalGM
z(nas) = 1 nasGM
z(co)  = 1 coGM
z(q)   = 1 qGM

2 1                                  | water vacancy site
z(h2o) = 1 h2oGM

end_of_model
                  --------------------------------------------------------
begin_model
                                      holland and powell '98 non-ideal cz-fep solution

                                                      1       2
                                                      M1      M3
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 cz            Al      Al
                            Species:  2 fep           Fe      Fe
                                                      _____________

                        Ordered Cpd:  3 ep            Al      Fe

Ep(HP)
abbreviation Ep
full_name    epidote

6                          | model type: speciation
2                          | 2 endmembers
cz       fep               | endmember names

1                          | ordered species definition

ep = 1/2 fep + 1/2 cz Delta(enthalpy) = -13.05d3

0 0 0                      | endmember flags
0. 1   .1  0               | range and resolution for X(cz), imod = 0 -> cartesian subdivision

begin_excess_function
w(cz fep) 15400
w(fep ep) 3000
end_excess_function

2                          | 2 site (M1, M3) configurational entropy model

2 1                        | 2 species on M1, 1 site per formula unit.
z(fe,m1) = 1 fep

2 1                        | 2 species on M3, 1 site per formula unit.
z(al,m3) = 1 cz

end_of_model
                      --------------------------------------------------------
begin_model
                             Phengite as http://www.esc.cam.ac.uk/astaff/holland/ds5/muscovites/mu.html
                             This model assumes M2 (multiplicity 2) is split into 1 M2a site on
                             which tri- and di-valent cations mix, and an M2b site occupied
                             solely by Al.

                             JADC 2/03

                             config entropy corrected, D Tinkham, 5/6/03

                                                      A       M2a      T1
                                                     _________________________

                                      Mutliplicity    1       1         2
                                                     _________________________

                                      1 mu            K       Al       Al_Si
                            Species:  2 cel           K       Mg       Si_Si
                                      3 fcel          K       Fe       Si_Si
                                      4 pa            Na      Al       Al_Si


                                      this model makes a dqf correction for paragonite
                                      (meaning that this model is not valid for Na-rich
                                      compositions).

Pheng(HP)                             | solution name
abbreviation Mica
full_name    white-mica

2                                     | model type: endmember fractions
4                                     | 4 species

pa                                    | endmember names
cel      fcel        mu               | endmember names


1 0 0 0                               | endmember flags

0   1  .1 0                           | range and resolution for x(pa), imod = 0 -> cartesian subdivision
0   1  .1 0                           | range and resolution for x(cel), imod = 0 -> cartesian subdivision
0   1  .1 0                           | range and resolution for x(fcel), imod = 0 -> cartesian subdivision

begin_excess_function
w(mu pa)   12d3       0.4 * P_bar
w(cel pa)  14d3       0.2 * P_bar
w(fcel pa) 14d3       0.2 * P_bar
end_excess_function

3                          | 3 sites (A, M2, T1) configurational entrpoy model

2 1                        | 2 species on A, 1 site per formula unit.
z(A,Na) = 1 pa

3 1                        | 3 species on M2a, 1 sites per formula unit.
z(m2,Mg) = 1 cel
z(m2,Fe) = 1 fcel

2  2.                      | 2 species on T1, 2 sites per formula unit.

z(T1,Si) = 1/2 mu + 1/2 pa

begin_dqf_corrections
                           | for endmember "name" the dqf correction is
                           | entered as
                           | dqf(name) num1 num2 num3
                           | where the dqf correction to the endmembers
                           | Gibbs energy is computed as
                           | Gdqf(J/mol) = num1 + T[K]*num2 + P[bar]*num3
dqf(pa) 1420   0.4  * P_bar
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model               
                             Osumilite, ideal, Holland et al Contrib Mineral Petrol (1996) 124: 383-394

                             Osm(HP) uses the TC ds5 osumulite endmember names, use
                             Osm(HP11) for calculations with ds6 versions of the TC
                             data base.

                             Internal DQF corrections added for all endmembers. 
                             If the true endmembers interfere with the Osm(HP), then the 
                             DQF "corrections" must be removed below and added to the thermodynamic data
                             file as make definitions. JADC, 6/7/2019

                                                      1      2     3           
                                                      M1     T1    T2   
                                                     _________________

                                      Mutliplicity    2      3     2
                                                     _________________
              
                            Species:            osm1  Mg    Al     Al   
                                                osm2  Mg    MgAl2  AlSi 
                                                fosm  Fe    Al     Al       

Osm(HP)
abbreviation Osm
full_name    osumilite

2                                     model type: endmember fractions. 
3                                     number of endmembers 
osm1     osm2      fosm               endmember names 
0  0  0                               endmember flags
0  1     .1  0   | imod = 0 -> cartesian subdivision
0  1     .1  0   | imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M1, T1, T2) configurational entropy model

2 2                        | 2 species on M1, 2 sites per formula unit
z(m1,fe) = 1 fosm

2 3                        | 2 species on T1, 3 sites per formula unit.
z(t1,mg) = 1/3 osm2

2 2                        | 2 species on T2, 2 sites per formula unit.
z(t2,si) = 1/2 osm2

begin_dqf_corrections
dqf(osm1) =  22.6d3 - 0.02d3 * T_K
dqf(osm2) =  20.7d3 - 0.02d3 * T_K
dqf(fosm) =  24.8d3 - 0.02d3 * T_K
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model               
                            Osumilite, ideal, Holland et al Contrib Mineral Petrol (1996) 124: 383-394
              
                                                      1      2     3           
                                                      M1     T1    T2   
                                                     _________________

                                      Mutliplicity    2      3     2
                                                     _________________
              
                            Species:            osm1  Mg    Al     Al   => osma
                                                osm2  Mg    MgAl2  AlSi => osmb
                                                fosm  Fe    Al     Al   => osfa
                                                
                             In DS6 the endmembers have been renamed osma, ossm, and osfa respectively.
                             Korhonen et al 2013 indicate DQF's for the DS5 endmember names, these are
                             applied below. If the true endmembers interfere with the Osm(HP), then the 
                             DQF "corrections" must be removed below and added to the thermodynamic data
                             file as make definitions. JADC, 6/7/2019.                                              

Osm(HP11)
abbreviation Osm
full_name    osumilite

2                                     model type: endmember fractions. 
3                                     number of endmembers 
osma     osmm      osfa               endmember names 
0  0  0                               endmember flags
0  1     .1  0   | imod = 0 -> cartesian subdivision
0  1     .1  0   | imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M1, T1, T2) configurational entropy model

2 2                        | 2 species on M1, 2 sites per formula unit
z(m1,fe) = 1 osfa

2 3                        | 2 species on T1, 3 sites per formula unit.
z(t1,mg) = 1/3 osmm

2 2                        | 2 species on T2, 2 sites per formula unit.
z(t2,si) = 1/2 osmm

begin_dqf_corrections
dqf(osma) =  22.6d3 - 0.02d3 * T_K
dqf(osmm) =  20.7d3 - 0.02d3 * T_K
dqf(osfa) =  24.8d3 - 0.02d3 * T_K
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                                      primitive non-inverse spinel model
                                      with gahnite end-member. Interaction
                                      parameters after Nichols et al.(1992), CMP
                                      111, 362-377. Jiri Konopasek

                                      If this model is used with Holland & Powell
                                      data it automatically has T-tempendent
                                      disorder that is independent of composition.
                                      JADC, 5/19.
GaHcSp
abbreviation Sp
full_name    spinel

2                                     model type macroscopic
3                                     3 endmembers
gah      herc     sp                  endmember names - this order implies: x(1) = x(Zn),x(2) = x(Fe), x(3) = x(Mg)

0  0  0                               endmember flags

0    .3  .1  0            | range and resolution for X(Zn), imod = 1 -> asymmetric transform subdivision
0    1   .1  0            | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function
w(gah herc) -3800.
w(herc sp)   1960.
w(gah sp)   -2600.
end_excess_function

1                                     one site configurational entropy model

3 1                                   3 species on M site with multiplicity 1

z(M,mg) = 1 sp
z(M,fe) = 1 herc

end_of_model
                    --------------------------------------------------------
begin_model
                                  | Fluid, Connolly & Trommsdorff CMP 1991.

                                  | The EoS used for this model is chosen by the user
                                  | when BUILD is run (the value of IFUG in the problem definition file).
                                  | If this choice is identified as a hybrid EoS, then the EoS used
                                  | for the individual species are controlled by the hybrid_EoS_XXX option.
F
abbreviation F
full_name    fluid

0                                 | solution model type: internal EoS. See explanation in the header of
                                  | this file for a list of model types

2                                 | number of endmembers
                           | NOTE: for model type 0, the first endmember listed here, must correspond
                           | to the second special component in the thermodynamic 
                           | file, i.e., the endmembers CANNOT be reordered.
CO2
H2O
                                  | see commentary in the header of this file for explanation of
                                  | endmember flags and subdivision schemes.

0 0                               | endmember flags, 1 -> the endmember composition is not considered part of the solution, otherwise 0

0    1   .1 0                     | subdivision scheme for CO2

ideal                             | the ideal tag indicates excess properties are computed internally

0                                 | zero indicates a molecular configurational entropy model

end_of_model
                    --------------------------------------------------------
begin_model

F(salt)                    | H2O-CO2-NaCl Fluid from andreas's thesis
abbreviation F
full_name    fluid

26                         | model type internal EoS.
3                          | three endmembers
hltL
H2O
CO2
0  0  0
0    1   .1 0              | range and increment for x(hlt), imod = 0 -> cartesian subdivision
0    1   .1 0              | range and increment for x(H2O), imod = 0 -> cartesian subdivision

ideal                      | internal excess function
0                          | internal config entropy model

reach_increment 1

end_of_model
                      --------------------------------------------------------
begin_model
                             Scapolite. Presumably from Barbara Kuhn's thesis.

                                                      M       T2a       T2b
                                                     ______________________

                                      Mutliplicity    4       1         2
                                                     ______________________

                                      1 me            Ca      Al       Al     independent
                            Species:  2 coma          Na3Ca   Si       Si     independent
                                      _____________________________________

                                      3 mizz          NaCa3   Si       Al     ordered

                            enthalpy of ordering changed to match thermocalc phase eq,
                            rather than the incorrect enthalpy that follows
                            from table 6.4. JADC, Dec 30, 2013.

Scap                       | solution name
abbreviation Scp
full_name    scapolite

6                          | model type: compound formation

2                          | 2 endmembers
me
coma

1                          | ordered species definition

mizz = 2/3 me + 1/3 coma   delta_g_of_ordering  = -29000

0 0                        | endmember flags
0   1   .1  0

begin_excess_function
w(me coma)   20000.
w(me mizz)   20000.
w(coma mizz) 30000.
end_excess_function
3                          | 3 site (M1, T2a, T2b) conigurational entropy model

2 4.                       | 2 species on M, 4 sites per formula unit.

z(m,na) = 1/4 mizz  +  3/4 coma

2 1                        | 2 species on T2a, 1 site per formula unit.

z(t2a,al) = 1 me

2 2.                       | 2 species on T2b, 1 site per formula unit.

z(t1a,si) = 1 coma

end_of_model
                      --------------------------------------------------------
begin_model

St(HP)                     | Mn-Fe-Mg Staurolite
abbreviation St
full_name    staurolite

2                                     model type: Ideal or macroscopic
3                                     3 endmembers
mnst     fst      mst
  1  0  0                  | endmember flags


0. 1   .1  0                | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0. 1   .1  0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function
w(mst fst) -8d3
end_excess_function

1                                     1 site entropy model

3 4.                                  3 species, site multiplicity of 4
z(Fe) = 1 fst
z(Mg) = 1 mst

end_of_model
                      --------------------------------------------------------
begin_model

                             Mn-Fe-Mg Ctd

Ctd(HP)
abbreviation Ctd
full_name    chloritoid

2                          | model type: simplicial composition space
3                          | 3 endmembers
mnctd    fctd     mctd
  1  0  0                  | endmember flags

                           | Note restricted range on X(Mn)

0. .2 .1  0                | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0   1  .1 0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function
w(mctd fctd) 1000.
end_excess_function

1                                     1 site entropy model

3 1                                   3 species, site multiplicity = 1.
z(Fe) = 1 fctd
z(Mg) = 1 mctd

end_of_model
                      --------------------------------------------------------
begin_model

Carp                       | Carpholite
abbreviation Crp
full_name    carpholite

2                          | model type: simplicial composition space.
2                          | 2 endmembers
mcar     fcar
  0  0                     | endmember flags

0.     1        .1     0   | imod = 0 -> cartesian subdivision
ideal

1                                     1 site entropy model

2 1                                   2 species, site multiplicity = 1.
z(Mg) = 1 mcar

end_of_model
                      --------------------------------------------------------
begin_model
                             ideal anhydrous/hydrous mg/fe HP cordierite model.
                             hfcrd_i stoichiometry corrected, L. Baumgartner, 5/6/03

                                                      M       H
                                                     ________________

                                      Mutliplicity    2       1
                                                     ________________

                                      1 mncrd         Mn      Vac
                            Species:  2 fcrd          Fe      Vac
                                      3 crd           Mg      Vac
                                      4 hmncrd        Mn      H2O    dependent
                                      5 hfcrd         Fe      H2O    dependent
                                      6 hcrd          Mg      H2O
                                                      _______________

                            Dependent: hfcrd = hcrd + (fcrd - crd)

hCrd
abbreviation Crd
full_name    cordierite

7                                 model type: reciprocal
2                                 2 reciprocal sites
3  2                              3 species on site 1, 2 on site 2
mncrd    fcrd     crd
hmncrd_i hfcrd_i  hcrd

2                                 2 dependent endmembers

hfcrd_i = 1 hcrd +  1 fcrd - 1 crd
hmncrd_i = 1 hcrd + 1 mncrd - 1 crd

1 0 0 1 0 0                | endmember flags

                           | Note restricted range on X(Mn)

0. .2 .1  0                | range and resolution for X(Mn) on M site, imod = 1 -> asymmetric transform subdivision
0   1  .1 0                | range and resolution for X(Fe) on M site, imod = 0 -> cartesian subdivision

0. 1   .1 0                | range and resolution for 1-X(H2O) on H site, imod = 0 -> cartesian subdivision

ideal

2                                       2 site entropy model.

3 2.                                    3 species on M, 2 sites per formula unit.
z(m,mg) = 1 crd + 1 hcrd
z(m,fe) = 1 fcrd

2 1                                     2 species on H, 1 sites per formula unit.
z(H,H2O) = 1 hcrd

end_of_model
                      --------------------------------------------------------
begin_model
                           | ideal model for mg-fe sudoite assuming
                           | mg fe and al are distributed over
                           | 4 m1 sites.
Sud(Livi)
abbreviation Sud
full_name    sudoite

2                          | Macroscopic

2                          | 2 endmembers
fsud     sud
  0  0                     | endmember flags
0. 1   .1  0               | imod = 0 -> cartesian subdivision

ideal

1                          | 1 independent mixing site, M1.

3 4.                       | 3 species on M1, 4 sites per formula unit.

z(Mg) = 1/2 sud
z(Fe) = 1/2 fsud

end_of_model
                      --------------------------------------------------------
begin_model
                           | ideal model for mg-fe sudoite assuming
                           | mg and fe are distributed over
                           | 2 sites.
Sud
abbreviation Sud
full_name    sudoite

2                          | model type: simplicial composition space

2                          | 2 endmembers
fsud     sud
  0  0                     | endmember flags
0. 1   .1  0               | imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(Mg) = 1 sud

end_of_model
                      --------------------------------------------------------
begin_model
                              HP '98 Non-ideal amphibole
Cumm
abbreviation Cumm
full_name    clinoamphibole

2                           | model type: macroscopic
2
cumm     grun
  0  0
0   1  .1 0                 | imod = 0 -> cartesian subdivision

begin_excess_function
W(cumm grun)  17500
end_excess_function

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 cumm

end_of_model
                      --------------------------------------------------------
begin_model
                                      anthophyllite

Anth
abbreviation oAmph
full_name    orthoamphibole

2                                   | model type: macroscopic
2                                     isp
fanth    anth
  0  0                                endmember flags
0. 1   .1      0        subdivision ranges and model

ideal

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 anth

end_of_model
                      --------------------------------------------------------
begin_model
                                      "anthophyllite" a compromise
                                      model using the clinoamphibole
                                      Fe-endmember, cumm and fap should
                                      be excluded.
A
abbreviation oAmph
full_name    orthoamphibole

2                          | model type: Macroscopic
2
grun     ap
  0  0
0. 1   .1      0           | subdivision ranges, imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 ap

end_of_model
                      --------------------------------------------------------
begin_model

Gl
abbreviation Gl
full_name    clinoamphibole

2                          | model type: Macroscopic
2
gl       fgl
  0  0                                endmember flags
0. 1   .1      0           | subdivision ranges and model, imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 3.                                  2 species, site multiplicity = 3
z(gl) = 1 gl

end_of_model
                      --------------------------------------------------------
begin_model

Tr                         | Tremolite
abbreviation Tr
full_name    clinoamphibole

2                          | model type: Macroscopic
2
ftr      tr
  0  0                                endmember flags

0. 1   .1      0           | subdivision ranges, imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 5                                   2 species, site multiplicity = 5.
z(mg) = 1 tr

end_of_model
                      --------------------------------------------------------
begin_model
                           | ternary feldspar (Benisek et al, CMP 160:327-337, 2010)
                           | for T > 973 K.

                           | Entered by Vratislav Hurai, May 10, 2011.

feldspar_B
abbreviation Fsp
full_name    ternary-feldspar
2                          | model type: simplicial composition space
3                          | 3 endmembers

abh
an
san

0 0 0                      | endmember flags = 0 if the endmember is part of the solution.

0   1  .1 0                | range and resolution for albite, cartesian subdivision
0   1  .1 0                | range and resolution for anorthite, cartesian subdivision


begin_excess_function
w(abh abh san) 17711.  -10.3   .461 * P_bar
w(abh san san) 22945.  -10.3   .327 * P_bar
w(an an san) 90600.           -.257 * P_bar
w(an san san) 60300.          -.21 * P_bar
w(an an abh) 40000.    -16.4   .069 * P_bar
w(an abh abh) 14000.    -4.7  -.049 * P_bar
w(an abh san) 210078. -114.75 -.2965 * P_bar
end_excess_function

2                          | 2 site (O-site and T-site) entropy model

3 1                        | 3 species on O-site, 1 site per formula unit.
z(Na) = 0 + 1 abh
z(Ca) = 0 + 1 an

2 2.                       | 2 species on T-site, 2. sites per formula (al-avoidance model)
z(Al) = 1/2 + 1/2 an

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model

Pl(h)                      | Newton et al 1981
abbreviation Pl
full_name    binary-feldspar

2                          | model type: simplicial composition space
2                          | 2 endmembers
abh      an
  1  0                     | endmember flags
0   1  .1 0                | imod = 0 -> cartesian subdivision
begin_excess_function
w(abh abh an) 8477
w(an an abh) 28246
end_excess_function

2                          | 2 sites (O, T) kerrick and darkens Al-avoidance model:
2 1                        | 2 species on O site, multiplicity = 1.
z(Na) = 1 abh

2 2.                       | 2 species on T, mutiplicity = 2.
z(Al) = 1/2 + 1/2 an

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model
                           | Waldbaum and Thompson 1968. This model is just the San
                           | model with the low structural state endmembers.
Kf
abbreviation Mic
full_name    binary-feldspar

2                          | model type: Macroscopic
2                          | 2 endmembers

mic      ab

  0  0                     | endmember flags

0   1  .1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(mic ab ab)  32098        -16.1356     0.469020 * P_bar
w(mic mic ab)  26470       -19.3810     0.387020 * P_bar
end_excess_function

  1                        | 1 site mixing model
2 1                        | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 ab

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model

San                        | Waldbaum and Thompson 1968.
abbreviation San
full_name    binary-feldspar

2                          | model type: Macroscopic
2                          | 2 endmembers
san      abh

  0  0                     | endmember flags

0   1  .1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(san abh abh)  32098       -16.1356     0.469020 * P_bar
w(san san abh)  26470       -19.3810     0.387020 * P_bar
end_excess_function

  1                        | 1 site mixing model
2 1                        | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 abh

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model

San(TH)                    | Thompson and Hovis 1979.
abbreviation San
full_name    binary-feldspar

2                          | model type: Macroscopic
2                          | 2 endmembers
san      abh

  0  0                     | endmember flags

0   1  .1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(san abh abh)  17062.4                  0.360661 * P_bar
w(san san abh)  30978.3     -21.7568     0.360661 * P_bar
end_excess_function

  1                        | 1 site mixing model
2 1                        | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 abh

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model
                                      Connolly and Cesare C-O-H Fluid
                                      this model is for X(O) = 0-1

                                  | The EoS used for this model is chosen by the user
                                  | when BUILD is run (the value of IFUG in the problem definition file).
                                  | If this choice is identified as a hybrid EoS, then the EoS used
                                  | for the individual species are controlled by the hybrid_EoS_XXX option.

GCOHF
abbreviation F
full_name    fluid

0                          | model type: Internal EoS
2
                           | NOTE: for model type 0, the first endmember listed here, must correspond
                           | to the second special component in the thermodynamic 
                           | file, i.e., the endmembers CANNOT be reordered.
O2       H2
  0  0                                endmember flags
1d-5 0.999999  .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision


ideal
0

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model
                           | Ternary C-O-H Fluid
                           | see: perplex.ethz.ch/perplex/faq/calculations_with_unbuffered_COH_fluids.txt
COHF
abbreviation F
full_name    fluid

41                         | model type: Internal EoS
3
gph      O2       H2
 1  0  0                   | endmember flags

1d-5 0.67       .1    0    | subdivision ranges, imod = 0 -> cartesian subdivision
1d-5 0.999999   .1    0    | subdivision ranges, imod = 0 -> cartesian subdivision

ideal
0

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model
                                      Non-ideal margarite-paragonite
                                      to fit field data of Bucher-Nurminen et al (1983)
                                      and Frank (1983), critical T = 972 K, X(Ma) = 33%.
                                      JADC, 4/08.



MaPa                       | margarite-paragonite
abbreviation Ma
full_name    white-mica

2                          | macroscopic
2
pa       ma
  0  0                                endmember flags
0   1  .1 0                           subdivision ranges and model

begin_excess_function
w(pa pa ma) 18201
w(ma ma pa)  9101
end_excess_function

  1                        | 1 site mixing model
2 1                        | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 pa

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model
                           | non-ideal hybrid model for K-Na phengitic mica
                           | mixes Chaterjee and Froese (1975) with ideal phengite model

                           | this configurational entropy is that of HP '98, see Phen(HP)

                             config entropy corrected, D Tinkham, 5/6/03

                                                      A        M2a      T
                                                     _________________________

                                      Mutliplicity    1         1       2
                                                     _________________________

                            Species:  1 cel           K        Mg     Si_Si
                                      2 fcel          K        Fe     Si_Si
                                      3 mu            K        Al     Al_Si
                                      4 pa            Na       Al     Al_Si

Mica(CF)                   | solution name
abbreviation Mica
full_name    white-mica

2                          | model type: simplicial composition space

4                          | endmembers

cel
fcel
mu
pa

0 0 0 0                    | endmember flags

                           | subdivision schemes for cel, fcel, and pa,
                           | see commentary in the header of this file for further explanation

0. 1  .1 0               | cel  subdivision range
0. 1  .1 0               | fcel subdivision range
0. 1  .1 0               | pa   subdivision range

begin_excess_function
W(mu pa pa) 19456       1.65440     -.4561 * P_bar
W(mu mu pa) 12230       0.710440     0.6653 * P_bar
end_excess_function

3                          | 3 site (M2a, T2, A) entropy model

3 1                        | 3 species on M2a, 1 sites per formula unit.
z(m,mg) = 1 cel
z(m,fe) = 1 fcel

2 2.                       | 2 species on T2, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa

2 1                        | 2 species on A, 1 site per formula unit.
z(a,k) = 1 mu + 1 cel + 1 fcel

reach_increment 0 3

end_of_model
                      --------------------------------------------------------
begin_model
                             Mica(CHA1): Reciprocal version of white mica model Mica(CHA) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             Coggon & Holland model orginally entered by Mark Caddick, Aug 30, 2005.

                             This model allows Tschermaks and Ti substitution in both the Na
                             and Ca mica subsytems. When these substitutions are insignificant,
                             use of the reduced version of the model used in Mica(CHA)
                             is much more efficient.

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip).

                             MODIFICATION/CORRECTION HISTORY:

                             1) van laar size terms added Nov 25, 2005. JADC.

                             2) ma t12 site occupancy corrected from AlSi to AlAl, D. Dolejs. Mar 23, 2006

                             3) endmember order corrected from: mu pa ma cel npa nfpa fcel nfma nma
                                                            to: mu pa ma cel npa nma  fcel nfpa nfma
                                                            JADC, May 4, 2006.

                             4) van Laar size terms for potassic endmembers corrected from 0.67 to 0.63.
                                                             L. Tajcmanova, Jan 6, 2010.

                             5) extended from Mica(CH1) to include Ti-substitution afer Auzanneau et al (2010).


                             N.B., the Coggon and Holland mica model predicts a significantly narrower
                             mu-pa solvus than Chatterjee and Froese's model (1975), so far as I know both
                             models are based on Chartterjee and Froese's experimental determination of
                             the solvus.

                             JADC, 5/17/13

                                                      A       M2a    M2b    T12    M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _
                                      3 ma            Ca      Al      Al    AlAl    _

                                      4 cel           K       Mg      Al    SiSi    _
                                      5 npa           Na      Mg      Al    SiSi    _    dependent
                                      6 nma           Ca      Mg      Al    AlSi    _    dependent

                                      7 fcel          K       Fe      Al    SiSi    _
                                      8 nfpa          Na      Fe      Al    SiSi    _    dependent
                                      9 nfma          Ca      Fe      Al    SiSi    _    dependent

                                     10 tip           K       Mg      Ti    AlSi    _
                                     11 ntip          Na      Mg      Ti    AlSi    _    dependent
                                     12 ctip          Ca      Mg      Ti    AlAl    _    dependent

                                     13 ftip          K       Fe      Ti    AlSi    _    dependent
                                     14 nftip         Na      Fe      Ti    AlSi    _    dependent
                                     15 cftip         Ca      Fe      Ti    AlAl    _    dependent
                                                     ___________________________________
Mica(CHA1)
abbreviation Mica
full_name    white-mica

7                            | model type: Macroscopic
2                            | number of independent mixing sites
3  5                         | 3 species on site 1, 5 species on site 2.

cel npa nma
fcel nfpa nfma
tip ntip ctip
ftip nftip cftip
mu pa ma

9                            | dependent end-members

nma   = 1 cel + 1 ma - 1 mu
npa   = 1 cel + 1 pa - 1 mu
nfpa  = 1 fcel + 1 pa - 1 mu
nfma  = 1 fcel + 1 ma - 1 mu
ntip  = 1 tip + 1 pa - 1 mu
ctip  = 1 tip + 1 ma - 1 mu
ftip  = 1 tip + 1 fcel - 1 cel
nftip = 1 tip + 1 fcel - 1 cel + 1 pa - 1 mu
cftip = 1 tip + 1 fcel - 1 cel + 1 ma - 1 mu

0 0 0 0 0 0 0 0
0 0 0 0 0 0 0                | endmember flags

                             | subdivision model, site 1 (A):
0    1  .1  0                | range and resolution of X(K)
0    1  .1  0                | range and resolution of X(Na)

                             | subdivision model, site 2 (M2)
0. .8   .1   0               | range and resolution of X(MgAl,M2)
0. .5   .1   0               | range and resolution of X(FeAl,M2)
0. .5   .1   0               | range and resolution of X(MgTi,M2)
0. .3   .1   0               | range and resolution of X(FeTi,M2)

begin_excess_function

W(mu pa)    10120. 3.4 0.353 * P_bar
W(mu ma)    30000.
W(mu cel)   0    0.2 * P_bar
W(mu fcel)  0    0.2 * P_bar
W(pa ma)    14500.
W(pa cel)   52000.
W(pa fcel)  52000.
W(ma cel)   30000.  0.2 * P_bar
W(ma fcel)  30000.  0.2 * P_bar
W(tip cel)  10000.
W(tip fcel) 10000.
W(tip pa)   80000.

 | W(prl mu)   20000. 0  0.2
 | W(prl pa)   20000. 0  0.2
 | W(prl ma)   30000. 0  0.2
 | W(prl cel)  25000. 0  0.2
 | W(prl fcel) 25000. 0  0.2
 | W(prl tip)  40000.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1                         | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel + 1 tip
z(a,na) = 1 pa

3 1                         | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma
z(m2a,mg) = 1 cel + 1 tip

2 1                         | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma

begin_van_laar_sizes
alpha(mu)     0.63
alpha(pa)     0.37
alpha(ma)     0.37
alpha(cel)    0.63
alpha(tip)    0.63
alpha(fcel)   0.63
 | alpha(prl)     .5
 | alpha(phl)    0.63
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                             Mica(CHA): Non-reciprocal version of white mica model Mica(CHA1) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             The non-reciprocal version does not allow tschermaks or Ti substutions
                             in the Ca- and Na-subsystems. If these substitutions are important use
                             the more costly model Mica(CHA1)

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip).

                             This version does not include the prl and phl endmembers considered by
                             both Coggon & Holland (2002) and Auzanneau et al. (2010) (the data is commented
                             below) as solution of these endmembers is usually unimportant.

                             JADC, 1/18/10

                             N.B., the Coggon and Holland mica model predicts a significantly narrower
                             mu-pa solvus than Chatterjee and Froese's model (1975), so far as I know both
                             models are based on Chartterjee and Froese's experimental determination of
                             the solvus.

                             JADC, 5/17/13

                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _
                                      3 ma            Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 tip           K       Mg      Ti    AlSi    _

                             not included:
                                                     ___________________________________
                                      7 prl           _       Al      Al    SiSi    _
                                      8 phl           K       Mg      Mg    AlSi    Mg
                                                     ___________________________________
Mica(CHA)
abbreviation Mica
full_name    white-mica

2                            | model type: macroscopic.

6                            | 6 endmembers

mu pa ma cel tip fcel        | prl phl

0 0 0 0 0 0 0 0              | endmember flags

                              | subdivision model
0    1  .1  0                 | range and resolution of X(mu),  imod = 0 -> cartesian subdivision
0    1  .1  0                 | range and resolution of X(pa),  imod = 0 -> cartesian subdivision
0    1  .1  0                 | range and resolution of X(ma),  imod = 0 -> cartesian subdivision
0    1  .1  0                 | range and resolution of X(cel), imod = 0 -> cartesian subdivision
0. 0.3  .1  0                 | range and resolution of X(tip), imod = 1 -> asymmetric transform subdivision

begin_excess_function

W(mu pa)    10120. 3.4 0.353 * P_bar
W(mu ma)    30000
W(mu cel)   0     0.2 * P_bar
W(mu fcel)  0     0.2 * P_bar
W(pa ma)    14500.
W(pa cel)   52000.
W(pa fcel)  52000.
W(ma cel)   30000  0.2 * P_bar
W(ma fcel)  30000.  .2 * P_bar
W(tip cel)  10000.
W(tip fcel) 10000.
W(tip pa)   80000.

 | W(prl mu)   20000. 0   .2
 | W(prl pa)   20000. 0   .2
 | W(prl ma)   30000. 0   .2
 | W(prl cel)  25000. 0   .2
 | W(prl fcel) 25000. 0   .2
 | W(prl tip)  40000.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1                         | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel + 1 tip
z(a,na) = 1 pa

3 1                         | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma
z(m2a,mg) = 1 cel + 1 tip

2 1                         | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma

begin_van_laar_sizes
alpha(mu)      .63
alpha(pa)      .37
alpha(ma)      .37
alpha(cel)     .63
alpha(tip)     .63
alpha(fcel)    .63
 | alpha(prl)     .5
 | alpha(phl)     .63
end_van_laar_sizes

end_of_model
                                  --------------------------------------------------------
begin_model
                             Mica+(CHA): Non-reciprocal version of white mica model Mica(CHA1) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             extended from Mica(CHA) to allow the pyrophyllite substitution, renamed
                             to prevent unintentional use.

                             The non-reciprocal version does not allow tschermaks or Ti substutions
                             in the Ca- and Na-subsystems. If these substitutions are important use
                             the more costly model Mica(CHA1)

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip).

                             This version does not include the prl and phl endmembers considered by
                             both Coggon & Holland (2002) and Auzanneau et al. (2010) (the data is commented
                             below) as solution of these endmembers is usually unimportant.

                             JADC, 1/18/10

                             N.B., the Coggon and Holland mica model predicts a significantly narrower
                             mu-pa solvus than Chatterjee and Froese's model (1975), so far as I know both
                             models are based on Chartterjee and Froese's experimental determination of
                             the solvus.

                             JADC, 5/17/13

                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _
                                      3 ma            Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 tip           K       Mg      Ti    AlSi    _
                                      7 prl           _       Al      Al    SiSi    _

                             not included:
                                                     ___________________________________
                                      8 phl           K       Mg      Mg    AlSi    Mg
                                                     ___________________________________

Mica+(CHA)
abbreviation Mica
full_name    white-mica

2                            | model type: macroscopic.

7                            | # of endmembers

mu pa ma cel tip prl fcel    | phl

0 0 0 0 0 0 0 0              | endmember flags

                             | subdivision model
0    1  .1  0                 | range and resolution of X(mu),  imod = 0 -> cartesian subdivision
0    1  .1  0                 | range and resolution of X(pa),  imod = 0 -> cartesian subdivision
0    1  .1  0                 | range and resolution of X(ma),  imod = 0 -> cartesian subdivision
0    1  .1  0                 | range and resolution of X(cel), imod = 0 -> cartesian subdivision
0.  .3  .1  0                 | range and resolution of X(tip), imod = 1 -> asymmetric transform subdivision
0   .3  .1  0                 | range and resolution of X(prl), imod = 1 -> asymmetric transform subdivision


begin_excess_function

W(mu pa)    10120  3.4  .353 * P_bar
W(mu ma)    30000.
W(mu cel)   0      .2 * P_bar
W(mu fcel)  0      .2 * P_bar
W(pa ma)    14500.
W(pa cel)   52000.
W(pa fcel)  52000.
W(ma cel)   30000      .2 * P_bar
W(ma fcel)  30000      .2 * P_bar
W(tip cel)  10000.
W(tip fcel) 10000.
W(tip pa)   80000.
W(prl mu)   20000      .2 * P_bar
W(prl pa)   20000      .2 * P_bar
W(prl ma)   30000      .2 * P_bar
W(prl cel)  25000      .2 * P_bar
W(prl fcel) 25000      .2 * P_bar
W(prl tip)  40000.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

4 1                         | 3 species on A, 1 site per formula unit.

z(a,k)  = 1 mu  + 1 cel + 1 fcel
z(a,na) = 1 pa
z(a,V)  = 1 prl

3 1                         | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma + 1 prl
z(m2a,mg) = 1 cel + 1 tip

2 1                         | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma

begin_van_laar_sizes
alpha(mu)      .63
alpha(pa)      .37
alpha(ma)      .37
alpha(cel)     .63
alpha(tip)     .63
alpha(fcel)    .63
alpha(prl)     .5
 | alpha(phl)    0.63
end_van_laar_sizes

end_of_model
                                  --------------------------------------------------------
begin_model
                                      HP '98 olivine solution.


O(HP)
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space

4                                     endmembers
teph     fran
fo       fa

0  0   0   0                        | endmember flags

                                    | NOTE restricted compositional range for Mn

0    1     .1   0                    | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0    1     .1   0                    | range and resolution for X(Ni), imod = 0 -> cartesian subdivision
0    1     .1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 8400                | corrected from 4.2 kJ Nov 15, 2004.
end_excess_function

1                                     1 site entropy model

4 2.                                  3 species, site multiplicity = 2.

z(mg) = 1 fo
z(ni) = 1 fran
z(fe) = 1 fa

end_of_model
                                  --------------------------------------------------------
begin_model
                                      ad hoc stilpnomelane

Stlp
abbreviation Stlp
full_name    stilpnomelane

2                                     model type: simplicial composition space

2                                     endmembers
mstp fstp
0  0                                | endmember flags

0    1    .1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 5.                                  3 species, site multiplicity = 2.

z(mg) = 1 mstp

end_of_model
                                  --------------------------------------------------------
begin_model
                                      HP '98 olivine solution with an approximation to the
                                      T Kawasaki (J Min Pet Sci, 96:54-66, 2001) symetric fo-monticellite
                                      excess function, this is probably adequate a first order
                                      model for Ca solution in olivine. To reproduce the solvus
                                      or evaluate pressure effects refer to Kawasaki or Warner
                                      and Luth 1973 or find more recent work. JADC, Jul 10, 2016.
O(HPK)
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space

4                                     3 endmembers
mont     teph     fo       fa
  0  0  0   0                       | endmember flags

                                    | NOTE restricted compositional range for Mn
0    1    .1   0                    | range and resolution for X(Ca), imod = 0
0    1    .1   0                    | range and resolution for X(Mn), imod = 0
0    1    .1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 8400                | corrected from 4.2 kJ Nov 15, 2004.
W(fo mont) 34050.
end_excess_function

                                    | this model is not incorrect because Ca partitions onto M1, i.e.,
                                    | the model should be an o/d model, such a model has been published
                                    | (probably by Ghiorso or coworkers).

1                                     1 site entropy model

4 2.                                  4 species, site multiplicity = 2
z(mn) = 1 teph
z(mg) = 1 fo
z(fe) = 1 fa

end_of_model
                      --------------------------------------------------------
begin_model
                                      "Ordered" Jadeite-Diopside-Hedenbergite-CaTs,
                                      as: 1) Gasparik '85 (GCA) in the jd/di limit.
                                          2) HP'98 in the di/hed limit
                                          3) Assuming nonideality in the
                                             jd/hed limit is the same as for jd/di.
                                          4) No ternary interactions.
                                          5) Gasparik '85 (CMP) in the jd/cats limit.
                                      This should be Gaspariks preferred model.
                                      JADC Apr. 99.

                                      the configurational entropy model has been
                                      constructed to take into account that Gasparik
                                      uses an X^2 molecular model for CaTs-Di and an
                                      X molecular model for Jd-Di. This implies that
                                      there is no disorder associated with placing Na
                                      on M2 (i.e., it is associated with Al on M1),
                                      whereas Al on M1 is not assocated with Al on T.
                                      To get Gasparik's molecular formulation it is
                                      necessary to specify that Al mixes on only one
                                      of the two T-sites.
Cpx(l)
abbreviation Cpx
full_name    clinopyroxene

2                                  | model type: simplicial composition space

4                                  | 4 endmembers

di
hed
cats
jd

0  0  0  0                         | endmember flags

0  1   .1  0
0  1   .1  0
0  1   .1 0                        | subdivision ranges and model

begin_excess_function
w(cats jd) 14810       -7.15        0
w(cats cats jd) -5070
w(cats jd jd)   5070
w(cats cats cats jd)  -3350
w(cats cats jd jd)   6700
w(cats jd jd jd)   -3350
w(di jd jd)    12600   -7.6 0
w(di di jd)   -12600    7.6 0
w(di jd jd jd)  -21400       16.2   0
w(di di jd jd)    42800      -32.4   0
w(di di di jd)   21400      -16.2   0
w(di jd)   12600       -9.45  0.

w(di hed)    2500
w(hed hed jd)    -12600        7.6   0
w(hed jd jd jd)  -21400       16.2   0

w(hed jd)   12600       -9.45  0
w(hed jd jd)   12600       -7.6   0
w(hed hed jd jd)   42800      -32.4   0
w(hed hed hed jd) -21400       16.2   0.

end_excess_function

2                                     wierd entropy model, see above (maybe it's right).

3 1                                   M1, Al-Mg-Fe, 1 site

z(fe,m1) = 1 hed
z(mg,m1) = 1 di

2 1                                   T, Al-Si, this is fake to get gasparik's model.
z(al,t) = 1 cats

end_of_model
                      --------------------------------------------------------
begin_model
                                      "disordered" Jadeite-Diopside-Hedenbergite-CaTs,
                                      as: 1) Gasparik '85 (GCA) in the jd/di limit.
                                          2) HP'98 in the di/hed limit
                                          3) Assuming nonideality in the
                                             jd/hed limit is the same as for jd/di.
                                          4) No ternary interactions.
                                          5) Gasparik '85 (CMP) in the jd/cats limit.
                                      JADC Apr. 99.

                                      the configurational entropy model has been
                                      constructed to take into account that Gasparik
                                      uses an X^2 molecular model for CaTs-Di and
                                      Jd-Di. See comments for Cpx(l) above.

Cpx(h)
abbreviation Cpx
full_name    clinopyroxene

2
4
di
hed
cats
jd

0  0  0  0                         | endmember flags

0  1   .1  0
0  1   .1  0
0  1   .1  0                       | subdivision ranges and model


begin_excess_function
w(cats jd) 14810       -7.15        0
w(cats cats jd) -5070
w(cats jd jd)   5070
w(cats cats cats jd)  -3350
w(cats cats jd jd)   6700
w(cats jd jd jd)   -3350
w(di jd jd)   12430       -6.21  0
w(di di jd)  -12430        6.21  0
w(di jd jd jd)  -22290       23.19   0
w(di di jd jd)   44580      -46.38   0
w(di di di jd)  -22290       23.19   0
w(di jd)   12540       12.63  0
w(di hed)    2500
w(hed hed jd)  -12430        6.21  0
w(hed jd jd jd) -22290       23.19   0
w(hed jd)  12540       12.63  0
w(hed jd jd)  12430       -6.21  0
w(hed hed jd jd)  44580      -46.38   0
w(hed hed hed jd) -22290       23.19   0
end_excess_function

3                                     msite
3 1                                   M1, Al-Mg-Fe, 1 site

z(Fe,m1) = 1 hed
z(Mg,m1) = 1 di

2 1                                   M2, Ca-Na, 1 site

z(na,m2) = 1 jd

2 1                                   T, Al-Si, this is fake to get gasparik's model.
z(al,t) = 1 cats

end_of_model
                      --------------------------------------------------------
begin_model
                                      HP '98 dolomite-ankerite solution
Do(HP)
abbreviation Do
full_name    carbonate

2                          | macroscopic

2                          | 2 endmembers
dol      ank
  0  0                     | endmember flags

0  1   .1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(dol ank) 3000
end_excess_function

1                          | 1 site entropy model
2 1
z(Mg) = 1 dol

end_of_model
                     --------------------------------------------------------
begin_model
                                      HP '98 Magnesite/siderite modified by DMH
                                      to include rhc
M(HP)
abbreviation Mag
full_name    carbonate

2                                     model type: simplicial composition space

3                                     number of endmembers
rhc    mag     sid                    endmember names

  0  0  0                        | endmember flags

0  1   .1  0                       | range X(Mn), imod = 1 -> asymmetric transform subdivision
0  1   .1  0                       | range X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function
w(mag sid) 4000                 | hp '98 give 4 kJ
end_excess_function

1                                     1 site entropy model

3 1                                   3 species, site multiplicity 1
z(Fe) = 1 sid
z(Mg) = 1 mag

end_of_model
                     --------------------------------------------------------
begin_model
                   A solution model for Dolomite from Anovitz & Essene
                   1987 J Pet 28:389-414; this model requires fictive
                   do-structure endmembers that have a standard state
                   G 20920 j > than the cc-structure endmember, these
                   are made here by a "DQF" correction.
Do(AE)
abbreviation Do
full_name    carbonate

2                          | model type: simplicial composition space

3                          | 3 endmembers
cc
mag
sid
1 1 1                      | endmember flags
0  1   .1 0                | subdivision range X(cc), imod = 0 -> cartesian subdivision
0  1   .1 0                | subdivision range X(mag), imod = 0 -> cartesian subdivision
begin_excess_function
w(mag mag cc) -96850   36.23  0
w(mag cc cc) -55480   -22.85  0
w(sid sid cc) -155523  141.5  0  | this is a linearization of -1040 -T*(212.4  - 0.2027*T) at 873 K, JADC 5/08.
w(sid cc cc)  -16746   -89.2  0  | this is a linearization of -86740-T*(-71.18+.9184e-1*T) at 873 K, JADC 5/08.
w(sid cc mag) -293520 -121.6  0  | this is a linearization of -185450-T*(369.2-.1418*T) at 873 K, JADC 5/08.
end_excess_function
1                          | 1 site entropy model
3 1                        | 2 species, site multiplicity of 1? should check against source
z(Mg) = 1 mag
z(Fe) = 1 sid

begin_dqf_corrections
dqf(cc) 20920
dqf(mag) 20920
dqf(sid) 20920
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                   A solution model for Magnesite from Anovitz & Essene
                   1987 J Pet 28:389-414.
Cc(AE)
abbreviation Cc
full_name    carbonate

2                          | model type: simplicial composition space

3                          | 2 endmembers
mag
cc
sid
0  0  0                                endmember flags
0  1   .1 0                | subdivision range, imod = 0 -> cartesian subdivision
0  1   .1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(cc cc mag)  24300 -7.743 0
w(cc mag mag) 23240  0     0
w(sid sid cc) 28404 -2.5   0 | this is a linearization of 27313.2-5.9651e-6/T-1.43147e-3*T^2 at T = 873. JADC, 5/08.
w(sid cc cc)  20624 -7.533 0 | this is a linearization of -70751.4 + 91.8848*T + 2.79244e7/T - 3.59552e-2 * T^2 at T = 873. JADC, 5/08.
                             | missing the ternary interaction parameter estimated by Anovitz & Essene.
end_excess_function

1
3 1.
z(mg) = 1 mag
z(fe) = 1 sid
end_of_model
                      --------------------------------------------------------
begin_model
                             Magnesioferrite/magnetite (inverse)

MF
abbreviation Mt
full_name    spinel

2                          | model type: simplicial composition space

2  1                                isp(1), ist(1)
mt       mft
  0  0                                endmember flags
0     1   .1     0         subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(mt mft)  8368            | Sack & Ghiorso, W_FeMg, CMP, 1991.
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity of 2
z(Fe) = 1 mt

reach_increment 3

end_of_model
                      --------------------------------------------------------

begin_model

Sp(JR)                      Jamieson and Roeder '85 (iron + ol,1300 C)
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers
sp       herc
  0  0                     | endmember flags
0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(sp herc) -3102
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity of 2
z(Fe) = 1 herc

end_of_model
                      --------------------------------------------------------
begin_model
                                      Ghiorso 1991, gives similar W=8638

Sp(GS)                                Ganguly and Saxena '87 (ol, 1200-1300 C, 1-5 kb)
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers
sp       herc
  0  0                     | endmember flags
0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(sp herc) 7703
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity of 2
z(Fe) = 1 herc

end_of_model
                      --------------------------------------------------------
begin_model

Sp(HP)                                 HP '98:
abbreviation Sp
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers
sp       herc
  0  0                     | endmember flags
0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(sp herc) 7d2
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity of 1
z(Fe) = 1 herc

end_of_model
                      --------------------------------------------------------
begin_model
                            valid for T>800C<1300C

Mt(W)                                 Wood et al 1991
abbreviation Mt
full_name    spinel

2                          | model type: simplicial composition space

2                          | 2 endmembers
usp      mt
  0  0                                endmember flags
0  1   .1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(usp mt mt) 42110
w(usp usp mt) 10580
end_excess_function


2                          | 2 site model

3 2.                       | 3 species on O, 2 sites per formula unit.

z(Ti,O) = 1/2 usp
z(Fe3+,O) = 1/2 mt

2 1                        | 2 species on T, 1 site per formula unit.
z(Fe3+,T) = 1 mt

end_of_model
                      --------------------------------------------------------
begin_model
                                      The Andersen and Lindsley models
                                      (Am Min v 73, p 714, 1988)
                                      are for ilmenite coexisiting with
                                      magnetite, its performance at high
                                      T (ca 1200) has been criticized by
                                      Ghiorso, but this is probably the
                                      best model for T<800 C

                                      Jury-rigged for geik, JADC, 2/14/13

                                      Ti only on B, Fe3+ disordered


IlHm(A)
abbreviation Ilm
full_name    ilmenite

2                            | macroscopic

3                            | 3 endmembers
ilm      hem     geik
  0  0  0                    | endmember flags
0  1   .1 0                  | subdivision range, imod = 0 -> cartesian subdivision
0  1   .1 0                  | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(ilm hem hem) 126342.5 -100.6 0  term 1
w(ilm ilm hem) 44204.8 -12.274 0  term 2
w(geik hem hem) 126342.5 -100.6 0  term 1
w(geik geik hem) 44204.8 -12.274 0  term 2
end_excess_function

2

2 1                          | B-site, Fe3+ and Ti
z(Ti,B) = 1 ilm + 1 geik

3 1                          | A-site, Fe2+, Fe3+ and Mg
z(Mg,A)   = 1 geik
z(Fe2+,A) = 1 ilm

end_of_model
                      --------------------------------------------------------
begin_model
                                      Ideal ilmenite-geikielite-pyrophanite solution
IlGkPy
abbreviation Ilm
full_name    ilmenite

2                          | model type: simplicial composition space

3                          | 3 endmembers
pnt      geik     ilm
0 0 0                      | endmember flags

                           | restricted mn range!

0  .2  .1    0             | imod = 1 -> asymmetric transform subdivision
0  1   .1    0             | imod = 0 -> cartesian subdivision
ideal

1                          | 1 site entropy model

3 1                        | 3 species, site multiplicity of 1
z(Mn) = 1 pnt
z(Mg) = 1 geik

end_of_model
                      --------------------------------------------------------
begin_model

MtUl(A)                    | Andersen and Lindsley 1988, Akimoto model
abbreviation Mt
full_name    spinel
                           | assumes Ti is only octahedral, Mg and Fe2+
                           | jury rigged for magnesio-ferrite, JADC 2/14/13

2                          | model type: simplicial composition space

3                          | 3 species
usp     mt     mft
  0  0  0                  | endmember flags
0  1   .1 0                | subdivision range, imod = 0 -> cartesian subdivision
0  1   .1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(usp mt mt) 46175. -23.077 0
w(usp usp mt) 15748.
w(usp mft mft) 46175. -23.077 0
w(usp usp mft) 15748.
end_excess_function

2                          | 2 site model, assumes Fe3+ is disorderd

4 2.                       | 4 species on O, 2 sites per formula unit.

z(Ti,O) = 1/2 usp
z(Fe3+,O) = 1/2 mt + 1/2 mft
z(Mg,O) = 1/2 mft

3 1                        | 2 species on T, 1 site per formula unit.
z(Fe3+,T) = 1 mt + 1 mft
z(Fe2+,T) = 1 usp

end_of_model
                      --------------------------------------------------------
begin_model

Neph(FB)                              Ferry and Blencoe '78
abbreviation Neph
full_name    feldspathoid

2                          | macroscopic

2                          | 2 endmembers
ne       kls
  0  0                                endmember flags
0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(ne kls kls) 85057       -20.0500     -.550000
w(ne ne kls) 35945        23.7800     0.69
end_excess_function

1                          | 1 site model

2 1                        | 2 species, 1 sites per formula unit.
z(na) = 1 ne

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model

Gt(B)                           Grossular-pyrope-almandine-spessartine, Berman '90,
abbreviation Gt
full_name    garnet

2                          | macroscopic

4                          | 4 endmembers
gr       py       alm
spss
  0  0  0  0                          endmember flags

  0    1  .1 0             | imod = 0 -> cartesian subdivision
  0    1  .1 0             | imod = 0 -> cartesian subdivision
  0    1  .1 0             | imod = 0 -> cartesian subdivision

begin_excess_function
w(gr gr py) 21560       -18.79       0.1
w(gr py py)  69200       -18.79         0.1
w(gr gr alm)   20320         -5.08        0.17
w(gr alm alm)  2620          -5.08        0.09
w(py py alm)   230        0      0.01
w(py alm alm) 3720      0      0.06
w(gr py alm)  58825.        -23.87       0.265
w(gr py spss)  45424.     -18.7900     0.1
w(gr alm spss)  11470       -18.7900     0.13
w(py alm spss) 1975 0      0.035
end_excess_function

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model
                      --------------------------------------------------------
begin_model
                                  Grossular-pyrope-almandine-spessartine garnet

                                  Ganguly, Cheng & Tirrone (1996) Contrib Mineral Petrol 126:137-151

                                  The expansion of the Cheng & Ganguly (1994) GCA 58:3763-3767
                                  model to the Perple_X excess function is in Maple file
                                  garnet_jiba_96.mws

                                  JADC Nov 23, 2010.
Gt(GCT)
abbreviation Gt
full_name    garnet

2                          | model type: simplicial composition space

4                          | endmembers
gr
py
alm
spss

  0  0  0  0               | endmember flags

  0    1   .1 0            | imod = 0 -> cartesian subdivision
  0    1   .1 0            | imod = 0 -> cartesian subdivision
  0    1   .1 0            | imod = 0 -> cartesian subdivision

begin_excess_function
w(gr py )         47191.395  -17.34  .105
w(gr alm)         11468.955   -5.07  .045
w(alm spss)        1616.925    0     .075
w(gr spss)         1616.925    0     .075
w(py alm)          4217.895    0     .105
w(py spss)        36248.895  -23.01  .105

w(gr gr py )     -17689.569    0     .069
w(py py gr)       17689.569    0    -.069
w(gr gr alm)       8849.955    0     .045
w(alm alm gr)     -8849.955    0    -.045
w(py py alm)      -2132.895    0    -.105
w(alm alm py)      2132.895    0     .105

                                  | these could be deleted:

w(py py spss)     .15e-1       0    -.015
w(spss spss py)  -.15e-1       0     .015
w(alm alm spss)   .45e-1       0    -.045
w(spss spss alm) -.45e-1       0     .045
w(gr gr spss)     .45e-1       0    -.045
w(spss spss gr)  -.45e-1       0     .045
end_excess_function

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model
                      --------------------------------------------------------
begin_model
                                      hp '98 quaternary garnet model
Gt(HP)
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space
4                                     number of endmembers
spss     alm      py       gr         endmember names

  1  0  0  0                        | endmember flags

0  1     .1 0              | imod = 1 -> asymmetric transform subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
                           | NOTE restricted subdivision range on Mn (Species 1)!

begin_excess_function
w(py gr) 33000
w(alm py)  2500                | hp '98 give 2.4 kJ
w(py spss) 4500
w(alm spss)  240
end_excess_function

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model
                      --------------------------------------------------------
begin_model
                             Mg-Fe-Ca-Al-Fe3 Garnet
                             Hybrid Holland & Powell + Engi & Wersin
                             The Engi & Wersin terms for the excess energy
                             are suspect and should probably be set to zero.
Gt(EWHP)
abbreviation Gt
full_name    garnet

7                              | model type: reciprocal
2                              | 2 chemical site model
3 2                            | 3 endmembers mix on site 1, 2 endmembers mix on site 2
gr   alm  py
andr FA_d MA_d

2                              | 2 dependent endmembers
MA_d = -1 gr +  1 py  + 1 andr
FA_d = -1 gr +  1 alm + 1 andr

0  0  0 0 0 0                  | endmember flags   0 include it   1 drop it
0  1  .1 0                     | range and resolution for XCa on A
0  1  .1 0                     | range and resolution for XFe on A

0  1  .1 0                     | range and resolution for XAl on B, imod = 0 -> cartesian

begin_excess_function
w(py gr) 33d3
w(gr andr andr) 25812 0  -0.52  | eliminate this terms to make Fe3+ - Al exchange ideal
w(andr gr gr)  -93820 0  -0.11  | eliminate this terms to make Fe3+ - Al exchange ideal
end_excess_function
2                                     2 site entropy model
3 3.                                  3 species, site multiplicity of 3
z(Ca) = 1 gr + 1 andr
z(Mg) = 1 py
2 2.                                  2 species, site multiplicity of 2
z(Al) = 1 gr + 1 alm + 1 py
end_of_model
                              --------------------------------------------------------
begin_model
                                  Ca-Fe2+-Mg-Al-Fe3+ Garnet model after White, Powell & Holland (JMG, 2007, 25:511-527)

                                  Model entered by Lucie Tajcmanova, May 11, 2007.

                                  w(alm py) value and reference corrected, Thomas Wagner, June 22, 2007.

                                  Interaction parameters (W terms) updated to the current THERMOCALC "preferred"
                                  values, Van Laar size parameters, added spessartine, Mark Caddick, Nov, 07.

                                  Deleted the unused kho_i interaction term, JADC, Nov 07.

                                  alphas and w's updated to current TC values, Lucie Tajcmanova, April 14, 2010.

                                  NOTE: the more recent Smye et al. (2011) models [Mica(SGH),  Carp(SGH), and
                                  Ctd(SGH)]are calibrated in terms of the Gt(WPPH) model for garnet. JADC, Oct 27, 2011.

                                                      X       Y
                                                     _____________

                                      Mutliplicity    3       2
                                                     _____________

                          Dependent:   fkho_i        Fe      Fe3+
                          Dependent:   kho_i         Mg      Fe3+
                          Dependent:   fmn_i         Mn      Fe3+
                                       andr          Ca      Fe3+

                                       spss          Mn      Al
                                       alm           Fe      Al
                                       py            Mg      Al
                                       gr            Ca      Al
                                                      ____________
Gt(WPH)
abbreviation Gt
full_name    garnet

7                            | model type: simplicial composition space
2                            | the number of independent subcompositions, reciprocal solution if > 1.
4  2                         | 4 species on site 1, 2 species on site 2.
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mn-Mg-Fe-Ca and the species that mix on
                             | site 2 are Al-Fe3+.


spss   alm      py     gr    | endmember names
fmn_i  fkho_i   kho_i  andr

3                                 | number of dependent endmembers

fmn_i = 1 andr + 1 spss -1 gr
fkho_i = 1 andr + 1 alm -1 gr
kho_i = 1 andr + 1 py -1 gr

0  0  0  0  0  0  0  0            | endmember flags

0  .2    .1 0                     | imod = 0 -> cartesian subdivision (xmn) on X
0  1     .1 0                     | imod = 0 -> cartesian subdivision (xfe) on X
0  1     .1 0                     | imod = 0 -> cartesian subdivision (xmg) on X

0  1     .1 0                     | imod = 0 -> cartesian subdivision x(fe3+) on Y

begin_excess_function
                                  | commented values are from White et al. (2007):
w(alm gr) 10000                   | w(alm gr)    15000
w(py gr) 45000                    | w(py gr)     33000
w(alm py)  2500            | w(alm py)     2500
w(py andr) 90000           | w(py andr)  160000
w(alm andr)  75000         | w(alm andr) 135000
end_excess_function

2                                     |2 site entropy model

4 3.                                  |4 species, site multiplicity 3
z(x,mn) = 1 spss
z(x,fe) = 1 alm
z(x,Mg) = 1 py

2 2.                                  |2 species, site multiplicity 2
z(y,al) = 1 spss + 1 alm + 1 py + 1 gr

begin_van_laar_sizes
                                  | commented values are from White et al. (2007):
alpha(py)     1
alpha(alm)    1
alpha(spss)   1
alpha(gr)     3     | 9
alpha(andr)   3     | 9
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                                  berman and brown 1984, cao-al2o3-sio2 melt
                                  model. reformulated as macroscopic Aug 21, 2007.
casmelt
abbreviation Melt
full_name    liquid

2                          | model type: macroscopic
3                          | 3 species
SIO2     AL2O3    CAO      | endmember names
  0  0  0                  | endmember flags
0  1   .1 0                | cartesian
0  1   .1 0

begin_excess_function
w(SIO2 AL2O3 AL2O3 AL2O3)  63617.2     -23.7400  0  term 1
w(SIO2 SIO2 AL2O3 AL2O3)  0.164266d7 -763.870  0  term 2
w(SIO2 SIO2 SIO2 AL2O3)   -106635.      28.1300  0  term 3
w(SIO2 CAO CAO CAO)       -898693.      240.770  0  term 4
w(SIO2 SIO2 CAO CAO)      -350208.     -48.6200  0  term 5
w(SIO2 SIO2 SIO2 CAO)     -14081.8     -35.4900  0  term 6
w(AL2O3 CAO CAO CAO)      -455634.      2.47000  0  term 7
w(AL2O3 AL2O3 CAO CAO)    -725166.      255.390  0  term 8
w(AL2O3 AL2O3 AL2O3 CAO)  -240215.      26.7000  0  term 9
w(SIO2 SIO2 AL2O3 CAO)    -.284791d7  1046.35  0  term 10
w(SIO2 AL2O3 AL2O3 CAO)   -.214904d7  641.840  0  term 11
w(SIO2 AL2O3 CAO CAO)       209109.     -313.360  0  term 12
end_excess_function

1                                     1 site molecular entropy model

3 1                                   3 species, site multiplicity 1
z(SIO2) = 1 SIO2
z(AL2O3) = 1 AL2O3

end_of_model
                      --------------------------------------------------------
begin_model

A-phase                               ideal phase A
abbreviation phA
full_name    alphabet-phase

2                          | macroscopic
2
phA      fphA
  0  0                                endmember flags
 0   1    .1  0            | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal

1                          | 1 site entropy model
2 7.                       | 2 species, 7 sites pfu
z(mg) = 1 phA

end_of_model
                      --------------------------------------------------------
begin_model

Chum
abbreviation Chu
full_name    clinohumite

2                          | macroscopic
2
chum     fchum
  0  0                                endmember flags
 0   1    .1   0           | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal

1                          | 1 site entropy model
2 9.                       | 2 species, 9 sites pfu
z(mg) = 1 chum

end_of_model
                      --------------------------------------------------------
begin_model

B
abbreviation Br
full_name    brucite

2                          | macroscopic

2                                isp(1)
br       fbr
  0  0                                endmember flags
 0   1   .1  0             | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal

1                          | 1 site entropy model
2 1                        | 2 species, 1 site pfu
z(mg) = 1 br

end_of_model
                      --------------------------------------------------------
begin_model
                             Ternary feldspars (Holland and Powell, 2003, CMP, p.492-501)
                             Van Laar Versions.

                             USE THIS MODEL WITH EXTREME CAUTION (AND DON'T USE THE
                             MODEL IF YOU DON'T UNDERSTAND THE IMPLICATIONS OF THIS
                             WARNING):

                             The model has the following difficulties for the Ab-An
                             binary and they undoubtedly cause problems in the ternary:

                             1) The I1/C1 models are not (and cannot be used to) predict
                                the stable structural state, the I1 model is always more
                                stable than the C1; thus the "stable" state is supposed
                                to be chosen by assuming the C1 model is valid at
                                X(Ab) > 1 - (0.12+0.00038*TK).

                             2) The model assigns a large positive interaction term for
                                I1 plagioclase, as a result the I1 model gives a solvus
                                that closes at ~ 910 K. At temperatures below the critical
                                temperature plagioclases in vicinity of the prescribed
                                I1/C1 transition (as defined in 1, above), that in principle
                                is supposed to be stable, is metastable with respect to
                                a mixture of I1 and C1 plagioclase.

                             JADC 1/04

                             MORE NOTES:

                             * These models use the asymmetric formalism as outlined by H & P.

                             * They are complicated by the C1/I1 transition across the plag. join.

                             * Model parameters for the C1 field (Ab-rich plag. component)
                                 Wabsan = 25100 - 10.8*T + 0.343*P
                                 Wansan = 40000
                                 Wanab  = 3100
                                 a-san  = 1.0
                                 a-ab   = 0.643
                                 a-an   = 1.0
                                 Ian    = 7030 - 4.66*T

                             * Model parameters for the I1 field (An-rich plag. component)
                                 Wabsan = 25100 - 10.8*T + 0.343*P
                                 Wansan = 40000
                                 Wanab  = 15000
                                 a-san  = 1.0
                                 a-ab   = 0.643
                                 a-an   = 1.0
                                 Iab    = 570 - 4.12*T

                             D.Tinkham, 12-18-2003

                             reformatted and compositional ranges chosen given the following
                             considerations (JADC 12/03):

                             * On the Ab-An join C1 is not stable below ~ 800 K,
                               and has X(An) < 0.4 and I1 is not stable for
                               X(An) < 0.6

                             * On the Ab-Or join C1 is always stable, with critical
                               composition X(Ab) ~ 0.34

                             * The above considerations suggest the I1 model could be effectively represented
                               by a binary An-Ab (with X(Ab)>0.2) model; and the C1 model
                               should be split into a model with X(ab) < 0.33 with
                               extensive ternary solution; and a model with X(Ab) > 0.33
                               with very limited ternary solution. Assuming these relationships
                               are valid the ternary feldspar phase relations are well
                               represented by three solutions models. When these conditions are
                               not met, the HP feldpsar models should not be used.


Pl(I1,HP)                    | solution name.
abbreviation Pl
full_name    ternary-feldspar

2                            | model type
3                            | number of endmembers

san
abh
an

 0  0  0                     | endmember flags

 0  1    .1  0              | compositional range and resolution of san
 0  1    .1  0              | compositional range and resolution of abh

begin_excess_function
w(san abh)         25100   -10.8  0.338 | pressure coefficient changed from 0.343 to match current TC value, JADC, May 2, 2019.
w(san an)          40000
w(abh an)          15000
end_excess_function

1                            | 1 site entropy model
3 1                          | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san            | van laar volumes follow:


begin_van_laar_sizes
alpha(san)     1
alpha(abh)     .643
alpha(an)      1
end_van_laar_sizes

begin_dqf_corrections
dqf(abh) 570 -4.12*T
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                             | See WARNING above for HP ASF Ternary Feldspar

Fsp(C1)
abbreviation Fsp
full_name    ternary-feldspar

2                            | model type
3                            | number of endmembers

an
san
abh

0  0  0                      | endmember flags

0     1     .1   0           | compositional range and resolution of an
0     1     .1   0           | compositional range and resolution of san

begin_excess_function
w(san abh)  =   25100   -10.8 * TK +  0.338 * Pb | pressure coefficient changed from 0.343 to match current TC value, JADC, May 2, 2019.
w(san an)   =   40000
w(abh an)   =    3100
end_excess_function

1                            | 1 site entropy model
3 1                          | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san

begin_van_laar_sizes
alpha(san)  =   1
alpha(abh)  =   0.643
alpha(an)   =   1
end_van_laar_sizes

begin_dqf_corrections
dqf(an) = 7030 - 4.66 * T_K
end_dqf_corrections

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model
                                      HP '03 CMP van Laar
                                      Calcite-Magnesite with Dolomite
                                      compound formation.
oCcM(HP)
abbreviation Do
full_name    carbonate

2                                     model type
3                                     number of endmembers
cc       mag      odo
  0  0  0                             endmember flags
0  1   .1  0                        | range and increments on X(cc)
0  1   .1  0                        | range and increments on X(mag)

begin_excess_function
w(cc mag) 35000
w(cc odo) 10250
w(mag odo) 14950
end_excess_function

2                                     2 site (m1  m2) entropy model

2  .5                                 2 species on m2, mutiplicity = 1/2
z(m2,Ca) = 1 cc + 1 odo

2  .5                                 2 species on m1, mult. = 1/2
z(m1,Ca) = 1 cc

begin_van_laar_sizes
alpha(cc)     .5 + 0.000546 *T 
alpha(mag)    1
alpha(odo)    .7
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                            Tourmaline model with no Li formulated as a hexary
                            solution.

                            NOTE: ffoit, mfoit, drav and shrl are linearly dependent

                                                             1       2          3
                                                             x       y          z
                                                          _________________________

                                             Mutliplicity    1       3          6
                                                          _________________________

                            Species:         1 drav          Na      Mg3        Al6
                                             2 uvit          Ca      Mg3        MgAl5
                                             3 mfoit         vac     Mg2Al      Al6
                                             4 shrl          Na      Fe3        Al6
                                             5 olen          Na      Al3        Al6
                                             6 ffoit         vac     Fe2Al      Al6
                                                           ________________________

                                         Vincent van Hinsberg <v.j.vanHinsberg@bristol.ac.uk>

Tour(V)                      | solution name.
abbreviation Tour
full_name    tourmaline

2                            | model type: simplicial composition space
6                            | 6 species mix on the chemical mixing site

drav   uvit   mfoit          | endmember names
shrl   olen   ffoit          |
0 0 0 0 0 0                  | endmember flags, indicate if the endmember is part of the solution.

0  1  .1  0                 | range drav
0  .2 .1  0                 | restricted range uvit
0  1  .1  0                 | range mfoit
0  1  .1  0                 | range shrl
0  1  .1  0                 | range olen

ideal

3                            | configurational entropy: 3 sites

3 1                          | 3 species on X, 1 site per formula unit.
z(na,x) = 1 drav  + 1 shrl + 1 olen
z(ca,x) = 1 uvit


3 3.                         | 3 species on Y, 3 sites per formula unit.
z(mg,y) = 1 drav + 1 uvit + 2/3 mfoit
z(al,y) = 1/3 mfoit + 1 olen + 1/3 ffoit


2 6.                         | 2 species on Z, 6 site per formula unit.
z(al,z) = 1 drav + 5/6 uvit + 1 mfoit + 1 shrl + 1 olen + 1 ffoit

end_of_model
                      --------------------------------------------------------
begin_model
                                      dolomite order disorder model

                                                         Site:
                                                       1      2
                                                       M1     M2
                                                     ____________

                                      Mutliplicity     1     1
                                                     ____________

                                      1 adol           Ca     Mg
                            Species:  2 bdol          CaMg   CaMg
                                                      ___________
DoDo
abbreviation Do
full_name    carbonate

2                                     model type simplicial composition space
2                                     number of endmembers
adol
bdol
  0  0                              endmember flags
0  1   .1   0                     | range and increments on X(cc)

ideal

2                                     2 site (m1  m2) entropy model

2  .5                                 2 species on m2, mutiplicity = 1/2
z(m2,Ca) = 1/2 bdol

2  .5                                 2 species on m1, mult. = 1/2
z(m1,Mg) = 1/2 bdol

end_of_model

begin_model
                                      magnesio-wuestite solution, after fabrichnaya '99

Wus(fab)
abbreviation Wus
full_name    wuestite

2                                     model type: simplicial composition space
2                                     2 endmembers
per       wus
  0  0                           | endmember flags
0    1    .1 0                   | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
W(per wus)  24d3
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model
                      --------------------------------------------------------
begin_model
                                      akimotoite (ilmenite-structure) solution, after fabrichnaya '99

Aki(fab)
abbreviation Aki
full_name    ilmenite

2                                     model type: simplicial composition space
3                                     number of endmembers
cor   aki   faki
  1  0  0                           | endmember flags
0  1   .1  0                        | subdivision range, imod = 0 -> cartesian subdivision
0  1   .1  0                        | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(aki cor)  60000
W(faki cor) 60000
end_excess_function

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model
                           | perovskite solution, after fabrichnaya '99
Pv(fab)
abbreviation Pv
full_name    perovskite

2                                     model type: simplicial composition space

3                                    3 endmembers
aperov   perov   fperov
  0  0  0                           | endmember flags

0  1    .1 0               | subdivision range, imod = 0 -> cartesian subdivision
0  1    .1 0               | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
W(perov aperov)   49000
W(fperov aperov)  49000
end_excess_function

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 perov
z(fe) = 1 fperov

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 aperov

end_of_model
                      --------------------------------------------------------
begin_model
                           | perovskite solution, after oganov. the fppv and
                           | appv endmembers are henry's law ss.
Ppv(og)
abbreviation Ppv
full_name    postperovskite

2                                     model type: simplicial composition space
3                                     number of endmembers
appv  ppv   fppv
  0  0  0                           | endmember flags

0  1     .1  0             | subdivision range, imod = 0 -> cartesian subdivision
0  1     .1  0             | subdivision range, imod = 0 -> cartesian subdivision

ideal

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 ppv
z(fe) = 1 fppv

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 appv

end_of_model
                      --------------------------------------------------------
begin_model
                                      olivine solution
O(stx)
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space
2                                     2 endmembers
fo       fa
  0  0                     | endmember flags
0  1     .1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 14400      | was 7200
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model
                      --------------------------------------------------------
begin_model

Wad(stx)
abbreviation Wad
full_name    wadleysite

2                          | model type: simplicial composition space
2                          | 2 endmembers
wad       fwad
  0  0                     | endmember flags
0  1  .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) 3000                   | was 1500.
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model
                      --------------------------------------------------------
begin_model

Ring(stx)
abbreviation Ring
full_name    ringwoodite

2                                     model type: simplicial composition space

2                                     2 endmembers
ring       fring
  0  0                     | endmember flags

0  1  .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 7800           | was 3900
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model
                      --------------------------------------------------------
begin_model
                                      Spinel solution, fixed order!
Sp(stx)
abbreviation Sp
full_name    spinel

2                                     model type: simplicial composition space

2                                     2 endmembers
sp       herc
  0  0                     | endmember flags
0  1  .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 28800             | was 7200
end_excess_function

2                                     2 site entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model
                      --------------------------------------------------------
begin_model
                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears the B site should be split into two M-sites
                                      for the 05 paper.
Gt(stx)
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space
4                                     4 endmembers
gr   alm  maj  py
 0  0  0  0                         | endmember flags
0  1  .1   0               | range and resolution for X(gr), imod = 0 -> cartesian subdivision
0  1  .1   0               | range and resolution for X(alm), imod = 0 -> cartesian subdivision
0  1  .1   0               | range and resolution for X(py), imod = 0 -> cartesian subdivision

ideal

3                                     3 site entropy model

3 3.                                  3 species, A site multiplicity = 3.
z(A,ca) = 1 gr
z(A,fe) = 1 alm

2 1                                   2 species, M1 site multiplicity = 1.
z(M1,Mg) = 1 maj

2 1                                   2 species, M2 site multiplicity = 1.
z(M1,Si) = 1 maj

end_of_model
                      --------------------------------------------------------
begin_model

C2/c(stx)
abbreviation C2/c
full_name    C2/c-pyroxene

2                                     model type: simplicial composition space
2                                     2 endmembers
c2/c      fc2/c
  0  0                     | endmember flags
0  1  .1  0                | subdivision range, imod = 0 -> cartesian subdivision
ideal

1                                     1 site entropy model

2 4.                                  2 species, site multiplicity = 4.
z(mg) = 1 c2/c

end_of_model
                      --------------------------------------------------------
begin_model
                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears disorder is assumed across all 4 M sites,
                                      for the 05-07 papers.
Opx(stx)
abbreviation Opx
full_name    orthopyroxene

2                                     model type: simplicial composition space
3                                     3 endmembers
en   fs   ts
 0  0  0                            | endmember flags
0  1  .1  0                         | range and resolution for X(en)
0  1  .1  0                         | range and resolution for X(fs)

ideal

1                                     1 site entropy model

3 4.                                  3 species, M site multiplicity = 4.
z(M,al) = 1/2 ts
z(M,fe) = 1 fs
end_of_model
                      --------------------------------------------------------
begin_model
                                      Cpx solution, entropy model not specified
                                      by stixrude, additionally there is some
                                      ambiguity about his excess term, here i
                                      assume its Gex = X(M1,Ca)*X(M1,M)*W.
Cpx(stx)
abbreviation Cpx
full_name    clinopyroxene

2                                     model type: simplicial composition space
3                                     3 endmembers
di  hed  mdi
 0  0  0                            | endmember flags

0  1  .1  0                         | range and resolution for X(di)
0  1  .1  0                         | range and resolution for X(hed)

begin_excess_function
W(mdi di)   52000
W(mdi hed)  52000
end_excess_function

2                                     2 site entropy model

2 2.                                  2 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi

2 2.                                  2 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed

end_of_model
                      --------------------------------------------------------
begin_model
                                      Stixrude pers com (10/07) indicates
                                      Gex = X(M1,Ca)*X(M1,Mg)*W.
                                      JADC 12/07

                                      Corrected excess function to include
                                      W(mdi hed), 9/08, JADC.
Cpx(stx7)
abbreviation Cpx
full_name    clinopyroxene

2                                     model type: simplicial composition space
3                                     3 endmembers
di  hed  mdi
 0  0  0                            | endmember flags

0  1  .1  0                         | range and resolution for X(di)
0  1  .1  0                         | range and resolution for X(hed)

begin_excess_function
W(mdi di)    52600
W(mdi hed)   52600
end_excess_function

2                                     2 site entropy model

2 2.                                  2 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi

2 2.                                  2 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed

end_of_model
                              --------------------------------------------------------
begin_model
                                      HP '96 Am Min, Non-ideal quasi ordered omphacite,
                                      i.e., compound formation only occurs for omph.
                                      The value of wdh appears discrepant
                                      with the value in HP '98.

                                      The interaction parameters here are from the
                                      Omphacite model distributed with the '00
                                      Thermocalc program. JADC 2/03

                                      Added ideal acm+cats, JADC, 1/06.

                                      CORRECTIONS:

                                      enthalpy of ordering corrected from -16 kJ to
                                      -3.5 kJ. JADC, Aug 20, 2003.

                                      Modified for non-ideal cats after
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17.
                                      T. Wagner 2/18/06.


                                                         Site:
                                                       1      2      3      4    5
                                                      M2a    M2b    M1a    M1b   T1
                                                     ____________________________________

                                      Mutliplicity    1/2    1/2    1/2    1/2    1
                                                     ____________________________________

                                      1 Diopside      Ca     Ca     Mg     Mg    Si
                            Species:  2 Jadeite       Na     Na     Al     Al    Si
                                      3 Hedenbergit   Ca     Ca     Fe2+   Fe2+  Si
                                      4 Ca-Tschermaks Ca     Ca     Al     Al    Al
                                      5 Acmite        Na     Na     Fe3+   Fe3+  Si
                                                      ___________________________________

                        Ordered Cpd:  6 Omphacite     Na     Ca     Al     Mg    Si

Omph(HP)
abbreviation Cpx
full_name    clinopyroxene

6                                     model type: o/d, simplicial composition space
5                                     number of disordered endmembers

di
jd
cats
acm
hed

1                             | ordered species definition

omph = 1/2 jd + 1/2 di delta_g_of_ordering  = -35d2

0  0  0  0  0                 | endmember flags

0  1   .1  0                  | range and resolution of X(di)
0  1   .1  0                  | range and resolution of X(jd)
0  1   .1  0                  | range and resolution of X(cats)
0  1   .1  0                  | range and resolution of X(acm)

begin_excess_function
w(di jd)    26000
w(omph jd)  16000
w(omph di)  16000
w(omph hed) 17000
w(hed jd)   24000
w(di hed)   4000        | hp 98 give 2.5 kJ
w(cats di)    7d3
w(cats hed)   4d3
end_excess_function

5                                   | 4 site entropy model (m1a, m1b, m2b, m2a)

2  .5                               | 2 species on m2a, mutiplicity = 1/2

                                    | WARNING! fractions can only be used in the site
                                    | fraction definitions, do not use fractions to specify
                                    | site multiplicities in the above line.


z(m2a,ca) = 1 di + 1 hed + 1 cats

2  .5                                 2 species on m2b, mult. = 1/2
z(m2a,na) = 1 jd + 1 acm

4  .5                                 4 species on m1a, mult = 1/2
z(m1a,mg) = 1 di
z(m1a,fe2+) = 1 hed
z(m1a,fe3+) = 1 acm

4  .5                                 4 species on m1b, mult = 1/2
z(m1b,al) = 1 jd + 1 cats
z(m1a,fe2+) = 1 hed
z(m1a,fe3+) = 1 acm

2 1                                   2 species on T1 (perhaps Al should be disordered over T1-T2?)
z(t1,al)  = 1 cats

end_of_model
                      --------------------------------------------------------
begin_model
                                      HP '96 Am Min, Non-ideal disordered cpx
                                      Note HP '98 give Wdh = 2500 j/mol.

                                      Configurational entropy model changed
                                      (corrected) from 1 site two 2 site model
                                      and model reformatted. D. Tinkham, 1/04.

                                      Added ideal acm+cats, JADC, 1/06.

                                      Modified for non-ideal cats after
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17.
                                      T. Wagner 2/18/06.

                                      Added ideal Cr, PGP Workshop 4/12/06.
                                      (folk.uio.no/ninasim/Cr_results.html)

                                      Corrected    z(m1,al) = 1 jd
                                      to   z(m1,al) = 1 jd + 1 cats
                                      M. Caddick, 5/8/08.

                                      converted to 688 format. JADC, 12/19.
Cpx(HP)
abbreviation Cpx
full_name    clinopyroxene

688                                | model type: 688 format standard model

1                                  | number of polytopes
1                                  | number of simplices
7                                  | number of vertices on each simplex

esn
ccrts
cats
jd
acm
hed
di

0  1   .1  0                 | range and resolution of X(esn): imod = 1 -> assymmetric stretching
0  1   .1  0                 | range and resolution of X(ccrts): imod = 1 -> assymmetric stretching
0  1   .1  0                 | range and resolution of X(cats): imod = 1 -> assymmetric stretching
0  1   .1  0                 | range and resolution of X(jd)
0  1   .1  0                 | range and resolution of X(acm): imod = 1 -> assymmetric stretching
0  1   .1  0                 | range and resolution of X(hed)

begin_excess_function
w(jd di)     26d3
w(jd hed)    24d3
w(di hed)     4d3
w(cats di)    7d3
w(cats hed)   4d3
end_excess_function

3                             | number of sites in the configurational entropy model

M1                            | site name
5 1 1                         | number of species, effective multiplicity, true multiplicity.
z(Fe,M1)   = 1 hed
z(Al,M1)   = 1 jd + 1 cats
z(Fe3+,M1) = 1 acm + 1 esn
z(Cr,M1)   = 1 ccrts
z(Mg,M1)   = 1 di

M2                            | site name
2 1 1                         | number of species, effective multiplicity, true multiplicity.
z(Na,M2)   = 1 jd + 1 acm
z(Ca,M2)   = 1 ccrts + 1 esn + 1 cats + 1 di + 1 hed

T1                            | site name
2 1 1                         | number of species, effective multiplicity, true multiplicity.
                              | ccrts not counted in Al intentionally; 
                              | this is nonsense, but keeps consistency with Klemme et al 2011.
z(Al,T1)   = 1 cats + 1 esn
z(Si,T1)   = 1 ccrts + 1 di + 1 hed + 1 jd + 1 acm

[SiO6]                        | formula suffix, enter "none" for no suffix.

reach_increment 0

end_of_model
                           --------------------------------------------------------
begin_model
                                      Chromite/Spinel, Klemme et al. 2010.

                                      To use this model, the fcrm endmember must be
                                      excluded from thermodynamic stability calculations.

                                                      A       B
                                                     _____________

                                      Mutliplicity    1       2
                                                     _____________

                                      1 sp            Mg      Al
                            Species:  2 herc          Fe      Al
                                      3 mcrm          Mg      Cr
                                      4 fcrm_d        Fe      Cr
                                      5 mft           Fe3+    MgFe3+
                                      6 mt            Fe3+    FeFe3+

                                      Ad-hoc incorporation of Fe3+ made here by assuming
                                      Mt remains inverse and the associated divalent Mg
                                      and Fe is disordered on B. An alternative model would
                                      be to assume the divalent B cation is associated with
                                      Fe3+. Model lacks excess function for mt-crm, which
                                      could be estimated if the solvus is known.

                                                                    JADC, 3/29/13

CrSp                       | solution name.
abbreviation Sp
full_name    spinel

7                          | model type: Reciprocal
2                          | 2 independent subcompositions
2 3                        | 2 dimensions on each site

mcrm     fcrm_d
sp       herc
mft      mt

1                          | 1 dependent endmember

fcrm_d = 1 herc + 1 mcrm - 1 sp

0 0 0 0 0 0                | endmember flags, indicate if the endmember is part of the solution.

                           | subdivision model for (binary) site 1 (A):
0  1  .1  0                | range and resolution of X(Mg): imod = 0 -> cartesian

                           | subdivision model for (binary) site 2 (B)
0  1  .1  0                | range and resolution of X(Cr): imod = 0 -> cartesion
0  1  .1  0

begin_excess_function
w(sp herc)      7d2 0 0
w(mcrm sp sp)   4208. 1.501  .321e-1 | from Oka et al CMP '84
w(mcrm sp)      19686 0.463 0.0183   | 19686 + 0.0183*P + 0.463*T;
w(mcrm herc)    20d3          | guessed solvus
end_excess_function

2                          | 2 site (a, b) configurational entropy model

3 1                        | 3 species on a, 1 site per formula unit.

z(a,fe)   = 1 herc
z(a,mg) =   1 sp + 1 mcrm

5 2.                       | 5 species on b, 2 site per formula unit.
z(b,cr)   = 1 mcrm
z(b,al)   = 1 sp + 1 herc
z(b,fe3+) = 1/2 mt + 1/2 mft
z(b,mg)   = 1/2 mft

reach_increment 3

end_of_model
                  --------------------------------------------------------
begin_model
                               Eskolaite from Chaterjee et al '82 Am Min.
                               added at PGP Workshop on 4/12/06
                               (folk.uio.no/ninasim/Cr_results.html).

                               notes:

                               w(esk cor cor) corrected to w(esk esk cor). this error was noted by
                               J. A. Padron-Navarta, 3/30/12, but left uncorrected until 11/24/2015;
                               the thermodynamic data in cr_hp02ver.dat as used by Klemme et al. 2009 and
                               Ziberna et al. 2013; to reproduce the calculations in those papers the
                               error must be reinstated.

                               added ideal hem. JADC, 3/29/13

Eskol(C)
abbreviation Esk
full_name    ilmenite

2                          | model type: simplicial composition space
3                          | number of endmembers
esk cor hem                | endmember names

0  0  0                    | endmember flags

0  1  .1  0                | X(Cr), cartesian
0  1  .1  0                | X(Al), cartesian

begin_excess_function
w(esk esk cor)   -5755. .385 -.38e-1       | Chattejee et al '82 Am Min
w(esk cor)       37484  4.334  0.0386      | Chattejee et al '82 Am Min
end_excess_function

1                                     1 site entropy model

3 2.                                  2 species, site multiplicity 2
z(Al) = 1 cor
z(Cr) = 1 esk

end_of_model

                      --------------------------------------------------------
begin_model
                                      magnesio-wuestite solution, stixrude EPSL 07 also xu et al EPSL 08
Wus(stx7)
abbreviation Wus
full_name    wuestite

2                                     model type: simplicial composition space
2                                     2 endmembers
per       wus
  0  0                           | endmember flags
0    1    .1 0                   | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
W(per wus)  13d3
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model
                      --------------------------------------------------------
begin_model
                                      akimotoite (ilmenite-structure) solution, stixrude EPSL 07
Aki(stx7)
abbreviation Aki
full_name    ilmenite

2                                     model type: simplicial composition space
3                                    3 endmembers
cor   aki   faki
  1  0  0                           | endmember flags
0    1   .1  0             | subdivision range, imod = 0 -> cartesian subdivision
0    1   .1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
                                 | Stixrude pers com (10/07) states
                                 |     Gex = X(One_Site,Al)*X(One_Site,Mg)*W
                                 | JADC 12/07

W(aki cor)  66000
end_excess_function

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model
                           | perovskite solution, stixrude epsl 07 also xu et al epsl 08
Pv(stx7)
abbreviation Pv
full_name    perovskite

2                                    model type: simplicial composition space
3                                    3 endmembers
aperov   perov   fperov
  0  0  0                           | endmember flags

0  1    .1 0               | subdivision range, imod = 0 -> cartesian subdivision
0  1    .1 0               | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
                                 | Stixrude pers com (10/07)
                                 |     Gex = X(Big_Site,Al)*X(Big_Site,Mg)*W
                                 | JADC 12/07
W(perov aperov)   12000
end_excess_function

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 perov
z(fe) = 1 fperov

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 aperov

end_of_model
                      --------------------------------------------------------
begin_model

O(stx7)
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space
2                                     2 endmembers
fo       fa
  0  0                     | endmember flags
0  1     .1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 10.6d3            | was 5.3 kJ/molar site
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model
                      --------------------------------------------------------
begin_model

Wad(stx7)
abbreviation Wad
full_name    wadleysite

2                          | model type: simplicial composition space
2                          | 2 endmembers
wad       fwad
  0  0                     | endmember flags
0  1  .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) 12.2d3           | 6.1 kJ/site
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model
                      --------------------------------------------------------
begin_model

Ring(stx7)
abbreviation Ring
full_name    ringwoodite

2                                     model type: simplicial composition space, macroscopic

2                                     2 endmembers
ring       fring
  0  0                     | endmember flags

0  1  .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 7d3          | 3.5 kJ/site
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model
                      --------------------------------------------------------
begin_model
                                      Spinel solution, fixed order!
Sp(stx7)
abbreviation Sp
full_name    spinel

2                                     model type: simplicial composition space, macroscopic

2                                     2 endmembers
sp       herc
  0  0                     | endmember flags
0  1  .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 20d3            | was 5 kJ/site
end_excess_function

2                                     2 site entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model
                      --------------------------------------------------------
begin_model
                      Spinel after White, RW, Powell, R & Clarke, GL (JMG, 2002)

                      The THERMOCALC version of Sp(WPC) invokes both imaginary crystallographic
                      sites and the equipartition assumption, this combination is impossible to 
                      implement with complete fidelity in Perple_X. Two approximations of this 
                      model are available in Perple_X Sp(WPC) and Sp_II(WPC). Sp(WPC) yields 
                      results closer to those generated by THERMOCALC. However in 6.9.1+ the stable
                      compositions of Sp(WPC) drift outside the simplicial composition space of 
                      the model, this drift has no noticeable consequences other than a number 
                      of warnings. Sp_II(WPC) eliminates these warning be defining the a compositional
                      prism that spans the entire composition space allowed by the imaginary sites.

                      This model has two fake sites, each with a mulitplicity of one.
                      Fe3+ Al and Ti mix on the fake A site, and Mg-Fe2+ mix on the fake B site

                      Replaces Sp(WPH), JADC Mar 5, 2009.

                                                      A       B
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 sp            Al      Mg
                            Species:  2 herc          Al      Fe2+
                                      3 usp           Ti      Fe2+
                                      4 mt            Fe3+    Fe2+


Sp(WPC)
abbreviation Sp
full_name    spinel

2                                 | model type: simplicial composition space

4                                 | 4 endmembers
sp
herc
usp
mt

0  0  0  0                        | endmember flags

0  1  .1 0                        | X(sp) subdivision range,   imod = 0 -> cartesian
0  1  .1 0                        | X(herc) subdivision range, imod = 1 -> assymmetric stretching
0  1  .1 0                        | X(usp) subdivision range,  imod = 1 -> assymmetric stretching

begin_excess_function
W(herc mt)    18.5d3
W(herc usp)   27d3
W(sp mt)      40d3
W(sp usp)     30d3
end_excess_function

2                                     2 site entropy model, see comments above

3 1                                   3 species, site multiplicity of 1
z(a,Fe3+) =  1 mt
z(a,Ti)   =  1 usp

2 1                                   2 species, site multiplicity of 1
z(b,Mg)   =  1 sp

end_of_model
                      --------------------------------------------------------
begin_model
                      Spinel_II after White, RW, Powell, R & Clarke, GL (JMG 20:41-55 2002)

                      The THERMOCALC version of Sp(WPC) invokes both imaginary crystallographic
                      sites and the equipartition assumption, this combination is impossible to 
                      implement with complete fidelity in Perple_X. Two approximations of this 
                      model are available in Perple_X Sp(WPC) and Sp_II(WPC). Sp(WPC) yields 
                      results closer to those generated by THERMOCALC. However in 6.9.1+ the stable
                      compositions of Sp(WPC) drift outside the simplicial composition space of 
                      the model, this drift has no noticeable consequences other than a number 
                      of warnings. Sp_II(WPC) eliminates these warning be defining the a compositional
                      prism that spans the entire composition space allowed by the imaginary sites.

                      * to prevent Perple_X from rejecting the Ti endmember (usp) of this
                        model because of invalid site populations the musp endmember 
                        be specified by the make definition 

                           musp_d   = 1 usp + 2 sp - 2 herc
                           DQF = 0

                        in the header of the thermodynamic data file to be used for the 
                        calculation, for more information on make definitions see: 
                        www.perplex.ethz.ch/perplex_thermodynamic_data_file_body.html#Make_definitions

                      * Converted to reciprocal 688 format solution model by adding
                        mft_d and musp_d, JADC Aug 1, 2020.

                      * Replaces Sp(WPH), JADC Mar 5, 2009.

                      This model has two fake sites, each with a mulitplicity of one.
                      Fe3+ Al and Ti mix on the fake A site, and Mg-Fe2+ mix on the fake B site,
                      a mind boggling contortion. There is no way to reproduce this model exactly
                      in Perple_X because it has no rational expression. In fact, if you wanted
                      to make something worse than equipartition, this is it. Two semi-rational 
                      implementations are:

                      1) assume a distinct subsite B' and reduce the effective multiplicity of
                         B and B' to 1/2 so that the total B' + B site configurational entropy
                         is comparable to the WPC single B site.

                                                      B       B'       A  
                                                     _____________________

                                      Mutliplicity    1       1        1
                            Effective Multiplicity    1/2     1/2      1
                                                     _____________________

                                      1 sp            Al      Al       Mg
                            Species:  2 herc          Al      Al       Fe
                                      3 usp           Ti      Fe       Fe
                                        musp          Ti      Mg       Mg
                                      4 mt            Fe3+    Fe3+     Fe
                                        mft_d         Fe3+    Fe3+     Mg

                                                      B       B'       A  
                                                     _____________________

                                      Mutliplicity    1       1        1
                            Effective Multiplicity    1/2     1/2      1
                                                     _____________________

                                      1 sp            Al      Al       Mg
                            Species:  2 herc          Al      Al       Fe
                                      3 usp           Ti      Fe       Fe
                                        musp          Ti      Mg       Mg
                                      4 mt            Fe3+    Fe3+     Fe
                                        mft_d         Fe3+    Fe3+     Mg

                      2) Make usp inverse. This is unsatisfactory in the mt IS inverse, but
                         treated as normal, who knows what usp, etc are.

                                                      B          A
                                                     ____________________________

                          Effective  Multiplicity     1          1
                               True  Multiplicity     2          1
                                                     ____________________________

                                        sp            [Al]2      Mg
                            Species:    herc          [Al]2      Fe
                                        usp           TiFe       Fe
                                        musp_d        TiMg       Mg
                                        mt            [Fe3+]2    Fe
                                        mft_d         [Fe3+]2    Mg

                      Scheme 1 is adopted below. The implementation underestimates the
                      site fraction of Ti compared to the WPC formulation and therefore
                      is likely to destabilize Ti-solution compared to the THERMOCALC
                      implementation, the effect seems slight (cf the bl478 benchmark).

Sp_II(WPC)
abbreviation Sp
full_name    spinel

688                                | model type: 688 format standard model
 
1                                  | number of polytopes
2                                  | number of simplices
2 3                                | number of vertices on each simplex

musp     usp
mft_d    mt
sp       herc

X_Mg,A  0. 1   .1   0              | imod = 0 -> cartesian subdivision
X_Fe,A  by difference

X_MT,B  0. 1   .1   0              | imod = 0 -> cartesian subdivision
X_Fe,B  0. 1   .1   0              | imod = 0 -> cartesian subdivision
X_Al,B  by difference

begin_dependent_endmembers
mft_d    = 1 mt  + 1 sp - 1 herc
end_dependent_endmembers

begin_excess_function
W(herc mt)    18.5d3
W(herc usp)   27d3
W(sp mt)      40d3
W(sp usp)     30d3
end_excess_function

2                                   | number of sites in configurational entropy model

A                                   | site name
2 1 1                               | number of species, effective multiplicity, true multiplicity
z(Mg,A)   =  1 sp   + 1 musp
z(Fe,A)   =  1 herc + 1 usp + 1 mt

B                                   | site name
5 1 2                               | number of species, effective multiplicity, true multiplicity
z(Ti,B)    =  1/2 usp + 1/2 musp
z(Fe3,B)   =  1 mt
z(Al,B)    =  1 herc + 1 sp
z(Mg,B)    =  1/2 musp
z(Fe,B)    =  1/2 usp

[cf model comment!]O4               | formula suffix, enter "none" for no suffix.

end_of_model
                     --------------------------------------------------------
begin_model

                                      CPX in CMASCH marbles (di-en-cats),
                                      hence enstatite endmember added.

                            Entered by A Proyer, Aug 27, 2008.

                                      based on:
                                      HP '96 Am Min, Non-ideal disordered cpx
                                      Note HP '98 give Wdh = 2500 j/mol.

                                      Configurational entropy model changed
                                      (corrected) from 1 site two 2 site model
                                      and model reformatted. D. Tinkham, 1/04.

                                      Modified for non-ideal cats after
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17.
                                      T. Wagner 2/18/06.
Cpx(m)
abbreviation Cpx
full_name    clinopyroxene

2                                   | model type sf.

3                                   | number of endmembers
en
cats
di

0  0  0                      | endmember flags

                             | NOTE RESTRICTED RANGES

0  1   .1  0                 | range and resolution of X(en): imod = 1 -> assymmetric stretching
0  1   .1  0                 | range and resolution of X(cats): imod = 1 -> assymmetric stretching

begin_excess_function
w(en cats)   24d3
w(en di)     24d3
w(cats di)    7d3
end_excess_function

2                             | 2 site (M1, M2) configurational entropy model

2 1                           | 2 species on M1, 1 site per formula unit.
z(m1,al) = 1 cats

2 1                           | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en

begin_dqf_corrections
dqf(en) 8100 -4.5*T
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                            Olivine in marble; from TC-solution model: Ca only on M2
                            Entered by A Proyer, Aug 27, 2008.
Ol(m)
abbreviation Ol
full_name    olivine

2                          | model type: simplicial composition space
2                          | 2 endmembers
fo       mont
  0  0                     | endmember flags
0  1  .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(fo mont) 24000
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity of 1
z(Ca) = 1 mont

end_of_model
                      --------------------------------------------------------
begin_model

Pl(stx8)                   | Xu et al. EPSL 08, to be used with the stx08ver.dat data generated from that paper.
abbreviation Pl
full_name    binary-feldspar

2                          | model type: simplicial composition space
2                          | # of endmembers
ab       an

  0  0                     | endmember flags

0  1  .1  0                | imod = 0 -> cartesian subdivision

begin_excess_function
w(an ab) 26d3
end_excess_function

1                          | 1 site molecular model:
2 1
z(Na) = 1 ab

end_of_model
                      --------------------------------------------------------
begin_model
                                      Spinel solution, fixed order!
Sp(stx8)
abbreviation Sp
full_name    spinel

2                                     model type: simplicial composition space
2                                     2 endmembers
sp       herc
  0  0                     | endmember flags
0  1  .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 29.6d3
end_excess_function

2                                     2 site configurational entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model

begin_model
                      --------------------------------------------------------
                        HP 2011 model, "tro" must be excluded to stabilize this 
                        solution model.
Po(HP)
abbreviation Po
full_name    pyrrhotite

2                                     model type: simplicial composition space

2                                     endmembers
trov trot
  0  0                     | endmember flags
0  1  .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(trov trot) = -3190
end_excess_function

1                                     1 site configurational entropy model

2 1                                   2 species (Fe, V), site multiplicity = 1.
z(M2,V) = 1/8 trov

end_of_model
                      --------------------------------------------------------
begin_model

O(stx8)
abbreviation Ol
full_name    olivine

2                                     model type: simplicial composition space

2                                     2 endmembers
fo       fa
  0  0                     | endmember flags
0  1     .1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 9d3
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model
                      --------------------------------------------------------
begin_model

Wad(stx8)
abbreviation Wad
full_name    wadleysite

2                          | model type: simplicial composition space

2                          | 2 endmembers
wad       fwad
  0  0                     | endmember flags
0  1  .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) -8.6d3
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model
                      --------------------------------------------------------
begin_model

Ring(stx8)
abbreviation Ring
full_name    ringwoodite

2                                     model type: simplicial composition space

2                                     2 endmembers
ring       fring
  0  0                     | endmember flags

0  1  .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 8d3
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model
                      --------------------------------------------------------
begin_model
                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears disorder that in the '08 papers the M sites
                                      are now split.
Opx(stx8)
abbreviation Opx
full_name    orthopyroxene

2                                     model type: simplicial composition space
4                                     4 endmembers
odi  en   fs   ts
0  0  0  0                            | endmember flags
0  1  .1  0                         | range and resolution for X(odi)
0  1  .1  0                         | range and resolution for X(en)
0  1  .1  0                         | range and resolution for X(fs)

begin_excess_function
W(odi ts) 43.8d3
W(odi en) 43.8d3
end_excess_function

2                                    |2 site entropy model, Al on M2 is associated with Mg on M1 and
                                     |Ca on M1 is associated with Mg on M2, so reduce M2 site model to
                                     |a two species model?

3 2.                                  3 species, M1 site multiplicity = 2.
z(M1,Ca) = 1 odi
z(M1,Fe) = 1 fs
3 2.                                  3 species, M2 site multiplicity = 2.
z(M2,Al) = 1 ts
z(M2,Fe) = 1 fs

end_of_model
                      --------------------------------------------------------
begin_model

Cpx(stx8)
abbreviation Cpx
full_name    clinopyroxene

2                                     model type: simplicial composition space

5                                     # of endmembers
jd  di  hed  mdi cts
0  0  0  0  0                         endmember flags

0  1  .1  0                         | range and resolution for X(jd)
0  1  .1  0                         | range and resolution for X(di)
0  1  .1  0                         | range and resolution for X(hed)
0  1  .1  0                         | range and resolution for X(mdi)

begin_excess_function
W(mdi di)    49d3            | Mg-Ca
W(mdi hed)   49d3
W(mdi cts)   49d3
W(jd  di)    486d2           | Na-Ca
W(jd  hed)   486d2
W(jd  cts)   486d2
end_excess_function

2                                     2 site entropy model

3 2.                                  3 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi
z(M1,Na) = 1 jd

3 2.                                  3 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed
z(M2,Al) = 1 jd + 1 cts

end_of_model
                      --------------------------------------------------------
begin_model
                                     akimotoite (ilmenite-structure) solution
Aki(stx8)
abbreviation Aki
full_name    ilmenite

2                                    model type: simplicial composition space

3                                    3 endmembers
cor   aki   faki
  1  0  0                           | endmember flags
0    1   .1  0             | subdivision range, imod = 0 -> cartesian subdivision
0    1   .1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(aki cor)   42000
W(faki cor)  52000
end_excess_function

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model
                                      Garnet solution, from Xu et al '08.
Gt(stx8)
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space
5                                     # of endmembers
gr   alm  maj  py jmaj
0  0  0  0  0                         endmember flags
0  1  .1   0               | range and resolution for X(gr), imod = 0 -> cartesian subdivision
0  1  .1   0               | range and resolution for X(alm), imod = 0 -> cartesian subdivision
0  1  .1   0               | range and resolution for X(maj), imod = 0 -> cartesian subdivision
0  1  .1   0               | range and resolution for X(py), imod = 0 -> cartesian subdivision

begin_excess_function
W(gr maj)  45000
W(gr py)   45000
end_excess_function

2                                     # of sites for configurational entropy model

4 0                                   4 independent species, A site multiplicity = 0 => variable multiplicity, means need molar amounts of all species
n(A,ca) = 3 gr
n(A,fe) = 3 alm
n(A,na) = 2 jmaj
n(A,mg) = 3 py + 3 maj

3 2.                                  3 species, B site multiplicity = 2, this is a peculiarity in stixrude's model because he sets r[Al,jmj,B]=2
z(B,Mg) = 1/2 maj
z(B,Si) = 1/2 maj

end_of_model
                      --------------------------------------------------------
begin_model

Ppv(stx8)
abbreviation Ppv
full_name    postperovskite

2                                     model type: simplicial composition space

3                                    3 endmembers
appv  ppv   fppv
  0  0  0                           | endmember flags

0  1     .1  0             | subdivision range, imod = 0 -> cartesian subdivision
0  1     .1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ppv appv)  21000
end_excess_function

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 ppv
z(fe) = 1 fppv

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 appv

end_of_model
                      --------------------------------------------------------
begin_model
                                      Ca-Ferrite solution.
CF(stx8)
abbreviation CF
full_name    calcium-ferrite

2                                     model type: simplicial composition space
3                                     3 endmembers
mfer ffer nfer
0  0  0
0  1  .1   0
0  1  .1   0

ideal

2                                     number of sites for the entropy model

3 1                                   3 species, A site multiplicity = 1.
z(A,fe) = 1 ffer
z(A,mg) = 1 mfer

2 1                                   al-si mixing on only one "T" site.
z(M,Si) = 1 nfer

end_of_model
                      --------------------------------------------------------
begin_model
                                    Fe2+-Fe3+-Mg pumpellyite
                                    Massonne & Willner (EJM, 2008) Ideal
Pu(M)
abbreviation Pu
full_name    pumpellyite

2                                 | model type: simplicial composition space
3                                 | 3 endmembers
pump     fpum     ffpu
0  0  0                           | endmember flags

0  1   .1  0                      | range and resolution for X(Mg)
0  1   .1  0                      | range and resolution for X(Fe2), 0 -> cartesian

ideal

1                                     1 site entropy model

3 1                                   3 species, site multiplicity = 1.
z(Fe) = 1 fpum
z(Mg) = 1 pump

end_of_model
                      --------------------------------------------------------
begin_model
                           Low Temperature Amphibole from
                           Massonne & Willner (EJM, 2008)
Act(M)
abbreviation Amph
full_name    clinoamphibole

2                          | model type: simplicial composition space
4                          | 4 endmembers
tr     acti
gl     mrie

  0  0  0  0               | endmember flags

0  1   .1  0               | range and resolution for X(Mn)
0  1   .1  0               | range and resolution for X(Fe)
0  1   .1  0               | range and resolution for X(Al)

begin_excess_function
w(tr gl)    27000
w(acti gl)  27000
w(tr mrie)  15000
w(gl mrie)  15000
end_excess_function

1                                     1 site entropy model

4 2.                                  4 species, site multiplicity = 2.
z(Fe) = 0 + 1 acti
z(Mg) = 0 + 1 tr
z(Al) = 0 + 1 gl

end_of_model
                      --------------------------------------------------------
begin_model
                            Fe2-Mg-Mn Stilpnomelane from
                            Massonne & Willner (EJM, 2008)
Stlp(M)
abbreviation Stlp
full_name    stilpnomelane

2                          | model type: simplicial composition space
3                          | 3 endmembers
stlp     mstl     mnsp
  0  0  0                  | endmember flags

0  1   .1 0                | range and resolution for X(Mg)
0  1   .1 0                | range and resolution for X(Fe2)

ideal

1                                     1 site entropy model

3 48.                                  3 species, site multiplicity = 48.
z(Fe) = 0 + 1 stlp
z(Mg) = 0 + 1 mstl

end_of_model
                      --------------------------------------------------------
begin_model
                             Margarite-Muscovite-Paragonite from
                             Massonne & Willner (EJM, 2008)
Mica(M)
abbreviation Mica
full_name    white-mica


2                          | model type: simplicial composition space
3                          | 3 endmembers
ma    mu    pa
  0  0  0                  | endmember flags

0   1   .1 0               | range and resolution for X(Ca)
0   1   .1 0               | range and resolution for X(K)

begin_excess_function
w(ma ma pa)   18200
w(pa pa ma)   10000
W(mu pa pa) 19456        1.6544*T     -.456100*P
W(mu mu pa) 12230         .71044*T     .665300*P
w(ma mu)      35000
end_excess_function

1                                     1 site entropy model

3 1                                   2 species, site multiplicity = 1.
z(Ca) = 0 + 1 ma
z(K)  = 0 + 1 mu

end_of_model
                      --------------------------------------------------------
begin_model
                             Mn-Fe-Mg Carpholite from
                             Massonne & Willner (EJM, 2008)
Carp(M)
abbreviation Carp
full_name    carpholite

2                          | model type: simplicial composition space
3                          | 3 endmembers
mnca    fcar     mcar
  0  0  0                  | endmember flags

0  1   .1 0                | range and resolution for X(Mn)
0  1   .1 0                | range and resolution for X(Fe)

ideal

1                                     1 site entropy model

3 1                                   3 species, site multiplicity = 1.
z(Fe) = 0 + 1 fcar
z(Mg) = 0 + 1 mcar

end_of_model
                      --------------------------------------------------------
begin_model
                             fe-mg sudoite from
                             Massonne & Willner (EJM, 2008)
Sud(M)
abbreviation Sud
full_name    sudoite

2                          | model type: simplicial composition space
2                          | 2 endmembers
fsud    sud
  0  0                     | endmember flags

0  1   .1 0                | range and resolution for X(Fe)

ideal

1                                     1 site entropy model

2 3.                                  2 species, site multiplicity = 3.
z(Fe) = 0 + 1 fsud

end_of_model
                      --------------------------------------------------------
begin_model
                             Magnesite-Siderite-Calcite-Rhodochrosite

Carb(M)
abbreviation Cc
full_name    carbonate

2                          | model type: simplicial composition space
4                          | 4 endmembers
cc     mag
sid    rhc
  0  0  0  0               | endmember flags
0   1    .1   0            | range and resolution for X(Ca)
0   1    .1   0            | range and resolution for X(Mg)
0   1    .1   0            | range and resolution for X(Fe)

begin_excess_function
w(cc mag) 35000
w(cc cc sid) 13500
w(cc sid sid) 21000
w(mag sid) 4000                 | hp '98 give 4 kJ
w(mag rhc) 20000
w(sid rhc) 4000
end_excess_function

1                                     1 site entropy model

4 1                                   4 species, site multiplicity = 1.
z(Ca) = 0 + 1 cc
z(Mg) = 0 + 1 mag
z(Fe) = 0 + 1 sid

end_of_model
                    --------------------------------------------------------
begin_model

                             Ti-Fe-Mg-Mn-Biotite with compound formation, Powell and Holland '99
                             Am Min, extended for Mn-solution.

                             reformulated as dual polytope model.

                             JADC, 10/9/2019

                             NOTES:

                             * Limits added 5/6/2011. JADC.

                                                      1       2      3
                                                      M1      M2     T2
                                                     _________________________

                                      Mutliplicity    1       2      2
                                                     _________________________

                          Dependent:  2 ftbi          Ti      FeV    AlSi
                                      3 tbi           Ti      MgV    AlSi

                          Dependent:  5 Sdph          Al      Fe     AlAl
                                      6 East          Al      Mg     AlAl

                                      7 MnBi          Mn      Mn     AlSi
               Species:               8 Ann           Fe      Fe     AlSi
                                      9 Phl           Mg      Mg     AlSi
                                                      ________________________

                        Ordered Cpd: 10 Obi           Fe      Mg     AlSi

                             | Comments can be placed before character data within a solution
                             | model as long as they are preceded by the comment marker "|",
                             | in general comments should not be placed before numerica data,
                             | but they can be written following numeric data on the same line.

Bio(HP)                            | solution name.
abbreviation Bio
full_name    biotite

688                                | model type: 688 format standard model

2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
[Mn][Mn]  0   .5   .1   0
[M,T][M]  by difference
                                   | ----------------------------
                                   | Polytope 1 - 1 simplex
1                                  | number of simplices
1                                  | number of vertices on each simplex
mnbi                               | endmembers on the vertices

                                   | ----------------------------
                                   | Polytope 2 - 2x3 simplices
2                                  | number of simplices
2  3                               | number of vertices on each simplex
                                   | endmembers on the vertices
ftbi_i   tbi
sdph_i   east
ann      phl
X_Mg    0    1   .1  0             | X(1,1) is bulk Fe/M
X_Fe    by difference
                                   | Second 3-simplex
X_TiTs  0    1   .1  0             | X(2,1) is Ti/[M+T] on M1
X_AlTs  0    1   .1  0             | X(2,2) is Al/[T+M] on M1
X_MBio  by difference

begin_ordered_endmembers
                             | model types 6 and 8 require data defining the
                             | properties of an ordered "species". this species
                             | is defined as a stoichiometric combination of
                             | two independent endmembers and the enthalpy of
                             | formation of the ordered species from the
                             | these independent endmbers. the format for this
                             | data is

                             | name = num_1 * name_1 + num_2 * name_2 text = enthalpy

                             | where name is the arbitrary name of the ordered
                             | species, num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the
                             | name of a valid endmember. text is arbitrary and
                             | enthalpy is the enthalpy of formation of the ordered species.
obi = 2/3 phl + 1/3 ann   delta_g_of_ordering  = -10.73d3

end_ordered_endmembers

begin_dependent_endmembers
                             | model types 7 and 8 (reciprocal solutions) use
                             | internal endmembers that are defined as a
                             | stoichiometric combination of the other endmembers.
                             | the names of these endmembers are arbitrary, but
                             | here dependent endmembers are highlighted by the
                             | suffix "_i", this also serves to distinguish the
                             | endmembers from real equivalents that may be
                             | present in the thermodynamic data file.

                             | the format of this data is

                             | name = num_1 * name_1 + num_2 * name_2

                             | where num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the
                             | name of a valid endmember.

sdph_i = 1 east + 1 ann - 1 obi
ftbi_i = 1 tbi  + 1/2 ann - 1/2 obi
end_dependent_endmembers

begin_excess_function
                             | format is W(e1 e1 e2 ...) num1 num2 num3
                             | where the excess parameter = num1 + num2*T + num3*P
                             | and is multiplied by y(e1)*y(e1)*y(e2)...
W(phl ann) 9000
W(phl east) 10000
W(phl obi) 3000
W(phl tbi)  -10000
W(ann east)  -1000
W(ann obi) 6000.
W(ann tbi)   12000
W(obi east)  10000

end_excess_function

3                                   | Configurational entropy: 3 sites, M1, M2, T1

M2                                  | site name
5 1 1                               | 5 species on M1, 1 site per formula unit.
z(Mg) = 1 phl
z(Mn) = 1 mnbi
z(Al) = 1 east
z(Ti) = 1 tbi
z(Fe) = 1 ann  + 1 obi

M2                                  | site name
4 2 2                               | 4 species on M2, 2 sites per formula unit.
z(Fe)   = 1 ann
z(Mn)   = 1 mnbi
z(Vac)  = 1/2 tbi
z(Mg)   = 1/2 tbi + 1 phl + 1 obi + 1 east

T1                                  | site name
2 2 2                               | number of species, effective multiplicity, true multiplicity
z(Al,T1) = 1/2 tbi + 1/2 mnbi + 1/2 ann + 1/2 phl +1/2 obi + 1 east
z(Si,T1) = 1/2 tbi + 1/2 mnbi + 1/2 ann + 1/2 phl +1/2 obi

[Si2O10(OH)2]                       | formula suffix, enter "none" for no suffix.

end_of_model

                      --------------------------------------------------------
begin_model
                             Mica(SGH): Non-reciprocal version of white mica model Mica(SGH1) after:

                                Smye et al (JMG, 2011, 28:753-768)

                             This model requires the make definition:

                                fmu = 1 mu + 1/2 hem - 1/2 cor
                                  -30d3
                                ma_dqf = 1 ma
                                    3d3

                             in the thermodynamic data file (e.g., hp02ver.dat), additionally the
                             endmember "ma" must be exlcuded from any calculations that employ this
                             model.

                             WARNING! The computed phase relations in Fig 1 of Smye et al (2011) were
                             computed by imposing the tetrahedral silica content. Thus it is unlikely
                             that the model accurately predicts silica content.

                             JADC, 19/09/11


                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _
                                      3 ma_dqf        Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 fmu           K       Al      Fe3+  AlSi    _
Mica(SGH)
abbreviation Mica
full_name    white-mica

2                            | model type: simplex

6                            | 6 endmembers

mu pa ma_dqf cel fmu fcel

0 0 0 0 0 0 0 0              | endmember flags

                             | subdivision model
0    1  .1 0                 | range and resolution of X(mu),      imod = 0 -> cartesian subdivision
0    1  .1 0                 | range and resolution of X(pa),      imod = 0 -> cartesian subdivision
0    1  .1 0                 | range and resolution of X(ma_dqf),  imod = 0 -> cartesian subdivision
0    1  .1 0                 | range and resolution of X(cel),     imod = 0 -> cartesian subdivision
0  0.3  .1 0                 | range and resolution of X(fmu)

begin_excess_function

W(mu pa)         10120  3.4*T 0.353*P
W(mu ma_dqf)     35000
W(mu cel)        0  0.2*P
W(mu fcel)       0  0.2*P

W(pa cel)        45000  0.25*P
W(ma_dqf cel)    40000

W(pa fcel)       45000  0.25*P
W(ma_dqf fcel)   40000

W(pa ma_dqf)     15000
W(pa fmu)        30000

W(ma_dqf fmu)    35000

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1                         | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel + 1 fmu
z(a,na) = 1 pa

3 1                         | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma_dqf + 1 fmu
z(m2a,mg) = 1 cel

2 1                         | 2 species on M2b, 1 site per formula unit.
z(m2b,fe) = 1 fmu

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 fmu + 1 ma_dqf

begin_van_laar_sizes
alpha(mu)     0.63
alpha(pa)     0.37
alpha(ma_dqf) 0.63
alpha(cel)    0.63
alpha(fmu)    0.63
alpha(fcel)   0.63

end_van_laar_sizes

end_of_model
                                  --------------------------------------------------------
begin_model

                                    Mn-Fe-Mg-Fe3+ Chloritoid after:

                                       Smye et al (JMG, 2011, 28:753-768)

                                    This model requires the make definition:

                                       octd = 1 fctd + 1/4 hem - 1/4 cor
                                         125d2 0 0

                                    in the thermodynamic data file (e.g., hp02ver.dat).

                                    NOTE: this version is formulated with 5 Oxygen formula unit, NOT the
                                    10 oxygen formula unit used by Smye et al (2011).
                                    JADC, 19/09/11

                                                      M1a     M1b
                                                     _______________

                                      Mutliplicity    1/2      1
                                                     _______________

                                          mctd         Al     Mg
                                          fctd         Al     Fe
                                          mnctd        Al     Mn
                                          octd         Fe3+   Fe
Ctd(SGH)
abbreviation Ctd
full_name    chloritoid

2                          | model type

4                          | endmembers

octd
mnctd
fctd
mctd

0  0  0  0                 | endmember flags

0  1   .1 0                | range and resolution for X(Fe3+), imod = 0 -> cartesian subdivision
0  1   .1 0                | range and resolution for X(Mn),   imod = 0 -> cartesian subdivision
0  1   .1 0                | range and resolution for X(Fe),   imod = 0 -> cartesian subdivision

begin_excess_function
w(mctd fctd ) 500
w(mctd mnctd) 500
w(fctd mnctd) 500
end_excess_function

2                                     2 site entropy model

2 .5                                  2 species on M1a, site multiplicity = 1/2
z(Fe) = 1 octd

3 1                                   3 species on M1b, site multiplicity = 1
z(Mn) = 1 mnctd
z(Mg) = 1 mctd

end_of_model
                                  --------------------------------------------------------
begin_model

                                    Mn-Fe-Mg-Fe3+ Carpholite after:

                                       Smye et al (JMG, 2011, 28:753-768)

                                    This model requires the make definitions:

                                       ocar  = 1 fcar + 1/2 hem - 1/2 cor
                                         45d3 0 0
                                       mncar = 1 mcar + 1 mang - 1/2 cor
                                         30d3 0 0

                                    in the thermodynamic data file (e.g., hp02ver.dat).

                                    JADC, 19/09/11

                                                      M2      M1
                                                     _______________

                                      Mutliplicity     1       1
                                                     _______________

                                          mcar         Al     Mg
                                          fcar         Al     Fe
                                          mncar        Al     Mn
                                          ocar         Fe3+   Fe
Carp(SGH)
abbreviation Crp
full_name    carpholite

2                          | model type

4                          | endmembers

mncar
ocar
fcar
mcar

0 0 0 0                    | endmember flags

0      1        .1     0   | imod = 0 -> cartesian subdivision
0      1        .1     0   | imod = 0 -> cartesian subdivision
0      1        .1     0   | imod = 0 -> cartesian subdivision

begin_excess_function
w(mcar fcar )  1d3
w(mcar mncar)  1d3
w(fcar mncar)  1d3
end_excess_function

2                                     2 site entropy model

2 .5                                  2 species on M2, site multiplicity = 1
z(Fe) = 1 ocar

3 1                                   3 species on M1, site multiplicity = 1
z(Mn) = 1 mncar
z(Mg) = 1 mcar

end_of_model
                                  --------------------------------------------------------
begin_model

                                  Ca-Fe2+-Mg-Al-Fe3+ Garnet model after White, Pomroy, Powell & Holland (JMG, 2005)

                                  In calculations that use this model, the andradite endmember ("andr") in the Holland
                                  and Powell data base must be excluded. This model also requires the following make
                                  definition for khoharite in the thermodynamic data file:

                                      kho = 1 py - 1 gr + 1 andr
                                      40d3 0 0

                                                      1       2
                                                      X       Y
                                                     _____________

                                      Mutliplicity    3       2
                                                     _____________

                          Dependent:   fkho_i        Fe      Fe3+
                          Dependent:   kho           Mg      Fe3+
                          Dependent:   fmn_i         Mn      Fe3+
                                       andr_i        Ca      Fe3+

                                       spss          Mn      Al
                                       alm           Fe      Al
                                       py            Mg      Al
                                       gr            Ca      Al
                                                      ____________

                                  When originally entered 9/20/11, this model was formulated (incorrectly) in terms of
                                  andradite, it was corrected to use the khoharite endmember 10/24/11. JADC

                                  definition of andr_i corrected from 1 kho + 1 py - 1 gr to 1 kho - 1 py + 1 gr on
                                  1/4/13. JADC
Gt(WPPH)
abbreviation Gt
full_name    garnet

7                            | model type
2                            | the number of independent subcompositions, reciprocal solution if > 1.

4  2                         | 4 species on site 1, 2 species on site 2.
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mn-Mg-Fe-Ca and the species that mix on
                             | site 2 are Al-Fe3+.


spss   alm      py     gr    | endmember names
fmn_i  fkho_i   kho    andr_i


3                                 | number of dependent endmembers

andr_i = 1 kho  - 1 py   +1 gr
fkho_i = 1 kho  + 1 alm  -1 py
fmn_i  = 1 kho  + 1 spss -1 py

0  0  0  0  0  0  0  0            | endmember flags

0  .2    .1 0                     | imod = 0 -> cartesian subdivision (xmn) on X
0  1     .1 0                     | imod = 0 -> cartesian subdivision (xfe) on X
0  1     .1 0                     | imod = 0 -> cartesian subdivision (xmg) on X


0  1     .1 0                     | imod = 0 -> cartesian subdivision x(fe3+) on Y


begin_excess_function
w(alm py)    2.5d3
w(alm kho)  22.5d3
w(py gr)     33d3
w(gr kho)   -7d3
w(spss kho) 20d3
end_excess_function

2                                     |2 site entropy model

4 3.                                  |4 species, site multiplicity 3
z(x,mn) = 1 spss
z(x,fe) = 1 alm
z(x,ca) = 1 gr

2 2.                                  |2 species, site multiplicity 2
z(y,al) = 1 spss + 1 alm + 1 py + 1 gr

end_of_model
                      --------------------------------------------------------
begin_model
                      CLINOAMPHIBOLE: Diener et al, JMG 2011 25:631-656, modified from Diener et al, JMG 2008.

                      ---------------------------------------------------------
                      Reformulated as a 2-polytope 688 format model. JADC, 11/19

                      The composition space of the complete (published) model corresponds to:

                      [A][M][M,T,MT][M,C,N]

                      where the brackets indicate the A, M1, M2, and M4 sites and 

                      A  = Na, K, V
                      T  = Al, Fe3
                      MT = MAl, MFe3
                      C  = Ca
                      M  = Mg, Fe
                      N  = Na
                      
                      The composition space of the model here has been simplified to

                      [A][M][M,T,MT][M,C,N]

                      where the brackets indicate the A, M1, M2, and M4 sites and 

                      A  = Na, K, V
                      T  = Al, Fe3
                      MT = MAl
                      C  = Ca
                      M  = Mg, Fe
                      N  = Na
                      
                      Refer to to cAmph(G) for an (commented out) example with MT = MAl, MFe3.
                      
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                      
                      Polytope 1 = Glaucophane = [M][T][N]         => 2*2 
                      Polytope 2 = ACMT-Amph   = [M][M,T,MT][M,C]  => 2*2*4              
                      
                      T   is generalized Tschermaks      [M][T][M,C]
                      MT  is generalized pargasite       [M][MT][N] 
                      N   is generalized glaucophane     [M][T][N] 
                      M   on M2 is generalized amphibole [M][M][M,C]                       
                      --------------------------------------------------------
                      earlier corrections/revisions

                        10/07   z(m2a,al) corrected. Y Y. Podladchikov
                         3/08   z(m1a,mg),z(m4,ca),z(m4,mg), and fged corrected,
                                T1 multiplicity reduced to 1
                                Enthalpies of ordering corrected. JADC.
                         6/08   z(m1,mg) corrected to include mrb, second limit
                                equations for cammo1 and cammo2 corrected accordingly.
                                corrected enthalpies for cammo1 and cammo2.
                       8/31/11 2011 DP model revisions entered by MJC.
                       1/24/17 fgrk-grk exchange added
                       3/ 8/18 dqfs for cumm and grun moved from model to data file
                       11/2/18 reformulated as 2x2x5 prism, adding Ca-free parg and Ts, and
                               Ca-bearing grk exchanges. JADC.
                      --------------------------------------------------------
                      NOTE to use this model the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                          ts_dqf
                          parg_dqf
                          gl_dqf
                          cumm_dqf
                          grun_dqf

                       additionally the following endmembers should be excluded in the
                       computational option file:

                          ts
                          parg
                          gl
                          cumm
                          grun
                      --------------------------------------------------------
                      independent endmembers and site populations:

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       1(4)*
                                            _________________________________________

                               tr            Vac       Mg      Mg     Ca      Si_Si       
                               ts_dqf        Vac       Mg      Al     Ca      Al_Si       
                               parg_dqf      Na        Mg      Mg_Al  Ca      Al_Si     
                               gl_dqf        Vac       Mg      Al     Na      Si_Si     
                               cumm_dqf      Vac       Mg      Mg     Mg      Si_Si      
                               grun_dqf      Vac       Fe      Fe     Fe      Si_Si      
                               mrb           Vac       Mg      Fe3+   Na      Si_Si      

                               cammo1        Vac       Mg      Fe     Fe      Si_Si      ordered
                               cammo2        Vac       Fe      Mg     Fe      Si_Si      ordered

                        *T1 has a true multiplicity of 4, H&P previously used an effective multiplicity of 2;
                        however in Diener et al. '07 the multiplicity has been reduced to 1  JADC 9/07.

                        2 NaCa-1(M4) = (Gl-Ts)
                        2 CaMg-1(M4) = (Tr-Cumm)
                        2 Fe3Al-1(M2) = (Rb-Gl)
                        3 FeMg-1(M1) = (grun - a)
                        2 FeMg-1(M2) = (grun - b)
                        2 FeMg-1(M4) = (-grun - cumm + a + b)
                      ----------------------------------------------------------------------------------------

cAmph(DP)
abbreviation Amph
full_name    clinoamphibole

688                                | model type: 688 format standard model

2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
GlRb-Amph 0   .2   .1  0           | X([ ][M][Fe3,Al][N]), Mg-Fe-Al-Fe3+ "glaucophane"
ACMT-Amph by difference            | X([A][M][M,T,MT][M,C]), K-Na-Mg-Fe-Al-Ti-Fe3+ "pargasite"

                                   | -------------------------------------------
                                   | Polytope 1 [ ][M][T  ][N] (generalized glaucophane)
2                                  | number of simplices
2 2                                | number of vertices on each simplex
 
                                   | Simplex 1 is M
                                   | Simplex 2 is T

                                   | endmembers on the vertices, index on the first simplex
                                   | changes fastest, last slowest
                                   
                                   | => endmember 11 is [ ][Mg][Fe3][Na]
                                   | => endmember 21 is [ ][Fe][Fe3][Na]
                                   | => endmember 12 is [ ][Mg][Al ][Na]
                                   | => endmember 22 is [ ][Fe][Al ][Na]

mrb        frb_d                   | Fe3-glaucophane, aka riebeckite
gl_dqf     fgl_d                   | Al-glaucophane

                                   | First (1d) simplex
X_Mg1   0    1  .1  0              | X(1,1) = bulk Mg/M
X_Fe1   by difference
                                   | Second (3d) simplex
X_rb    0    1  .1  0              | X(2,1) = Fe3/T' on M2, T' = Al + Fe3+
X_gl    by difference
                                   | -------------------------------------------
                                   | Polytope 2 [A][M][M,T,MT][M,C]
3                                  | number of simplices
2 2 4                              | number of vertices on each simplex

                                   | Simplex 1 is bulk Mg/M
                                   | Simplex 2 is M/[C + M] on M4
                                   | Simplex 3 is M, T, MT on M2 

                                   | endmembers on the vertices, index on the first simplex
                                   | changes fastest, last slowest

ts_dqf     fcts_d                  | M-Ca-Al_tschermaks
mts_d      fts_d          

parg_dqf   fcparg_d                | M-Ca-Na-Al_parg
mparg_d    fparg_d           
   
mcgrk_d    fcgrk_d                 | M-Ca-Fe3+_tschermaks (Na-free riebeckite)
mgrk_d     fgrk_d

cumm_dqf   grun_dqf                | M-Ca divalent amphibole
tr         ftr_d
                                   | First (1d) simplex
X_Mg     0    1   .1  0            | X(1,1) = bulk Mg/M
X_Fe     by difference
                                   | Second (1d) simplex
X_M_M2   0    1   .1  0            | X(2,1) = M/[Ca + M] on M4
X_C_M2   by difference
                                   | Third simplex 
X_AlTs   0    1   .1  0            | X(3,1) = X(Al-Ts)
X_NaPg   0    1   .1  0            | X(3,2) = X(Na-Al-Parg)
X_FeTs   0    1   .1  0            | X(3,9) = X(Fe3-Ts)
X_MCamph by difference

begin_ordered_endmembers

cammo1 = 3/7 cumm_dqf + 4/7 grun_dqf   delta_g_of_ordering  = -9.5d3
cammo2 = 2/7 cumm_dqf + 5/7 grun_dqf   delta_g_of_ordering  = -11.7d3    | these enthalpies differ from the published values
                                                                         | becuase Thermocalc reactions are specified in terms of the
                                                                         | endmember without "DQF" corrections, while in Perple_X
                                                                         | endmember include any DQF corrections.
end_ordered_endmembers 

begin_dependent_endmembers

ftr_d    = 1 tr       + 2 grun_dqf    - 1 cammo1 - 1 cammo2

fcparg_d = 1 parg_dqf + 3/2 grun_dqf  - 1 cammo1   - 1/2 cammo2
fparg_d  = 1 parg_dqf + 1/2 grun_dqf  + 1/2 cammo2 - 1 tr
mparg_d  = 1 parg_dqf - 1 tr          + 1 cumm_dqf

fcts_d   = 1 ts_dqf   + 1 grun_dqf    - 1 cammo1
fts_d    = 1 ts_dqf - 1 tr            + 1 cammo2
mts_d    = 1 ts_dqf - 1 tr            + 1 cumm_dqf

fgl_d    = 1 gl_dqf   + 1 grun_dqf    - 1 cammo1
frb_d    = 1 mrb      + 1 grun_dqf    - 1 cammo1

mcgrk_d  = 1 mrb      + 1 ts_dqf  - 1 gl_dqf
mgrk_d   = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 tr         + 1 cumm_dqf
fgrk_d   = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 tr         + 1 cammo2
fcgrk_d  = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 cammo1     + 1 grun_dqf
end_dependent_endmembers

begin_excess_function
w(mrb tr)          52e3
w(mrb ts_dqf)      20e3
w(mrb parg_dqf)        40e3

w(mrb cumm_dqf)        80e3
w(mrb grun_dqf)        91e3
w(mrb cammo1)      80e3
w(mrb cammo2)      90e3

w(cammo2 tr)          63e3
w(cammo2 ts_dqf)     72.5e3
w(cammo2 parg_dqf)   94.8e3
w(cammo2 gl_dqf)   111.2e3
w(cammo2 cumm_dqf)        23e3
w(cammo2 grun_dqf)         8e3
w(cammo2 cammo1)      20e3

w(cammo1 tr)         57e3
w(cammo1 ts_dqf)     70e3
w(cammo1 parg_dqf)  94.8e3
w(cammo1 gl_dqf)    100e3
w(cammo1 cumm_dqf)       18e3
w(cammo1 grun_dqf)       12e3

w(grun_dqf tr)          75e3
w(grun_dqf ts_dqf)      80e3
w(grun_dqf parg_dqf)  106.7e3
w(grun_dqf gl_dqf)   113.5e3
w(grun_dqf cumm_dqf)        33e3

w(cumm_dqf tr)          45e3
w(cumm_dqf ts_dqf)      70e3
w(cumm_dqf parg_dqf)     90e3
w(cumm_dqf gl_dqf)     100e3

w(gl_dqf tr)        65e3
w(gl_dqf ts_dqf)    25e3
w(gl_dqf parg_dqf)   50e3

w(parg_dqf tr)      25e3
w(parg_dqf ts_dqf) -40e3

w(ts_dqf tr)        20e3
end_excess_function

5                                   | number of sites in configurational entropy model (A, M1, M2, M4, T1)

A                                   | site name
2 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na,A)   =    1 parg_dqf
z(Vac,A)  =    1 cumm_dqf + 1 grun_dqf + 1 tr + 1 ts_dqf + 1 gl_dqf + 1 cammo1 + 1 cammo2 + 1 mrb

M1                                  | site name
2 3 3                               | number of species, effective multiplicity, true multiplicity
z(Fe,M1)   = 1 grun_dqf + 1 cammo2
z(Mg,M1)   = 1 cumm_dqf + 1 ts_dqf + 1 parg_dqf + 1 mrb + 1 gl_dqf + 1 cammo1 + 1 tr

M2                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Fe,M2)   = 1 grun_dqf + 1 cammo1
z(Fe3,M2)  = 1 mrb
z(Al,M2)   = 1 ts_dqf     + 1/2 parg_dqf + 1 gl_dqf
z(Mg,M2)   = 1/2 parg_dqf + 1 tr         + 1 cumm_dqf + 1 cammo2

M4                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Mg,M4)   = 1 cumm_dqf
z(Na,M4)   = 1 gl_dqf + 1 mrb
z(Fe,M4)   = 1 grun_dqf + 1 cammo1 + 1 cammo2
z(Ca,M4)   = 1 ts_dqf + 1 parg_dqf + 1 tr

T1                                  | site name
2 1 4                               | number of species, effective multiplicity, true multiplicity
z(Al,T1)   = 1/2 ts_dqf  + 1/2 parg_dqf
z(Si,T1)   = 1/2 ts_dqf + 1/2 parg_dqf + 1 gl_dqf + 1 mrb + 1 tr + 1 grun_dqf + 1 cammo1 + 1 cammo2 + 1 cumm_dqf

[Si4O22(OH)2]                       | formula suffix, enter "none" for no suffix.


begin_van_laar_sizes
alpha(tr)       1
alpha(parg_dqf) 1.7
alpha(ts_dqf)   1.5
alpha(gl_dqf)   0.8
alpha(cumm_dqf) 1
alpha(grun_dqf) 1
alpha(cammo1)   1
alpha(cammo2)   1
alpha(mrb)      0.8
end_van_laar_sizes
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.
| low_reach

end_of_model
                      --------------------------------------------------------
begin_model
                      CLINOAMPHIBOLE, cAmph_I(DP): Diener et al, JMG 2011 25:631-656, 
                      modified from Diener et al, JMG 2008.

                      ---------------------------------------------------------
                      Reformulated as a 4-subcomposition 688 format model. JADC, 3/20

                      The composition space of the complete (published) model corresponds to:

                      [A][M][M,T,MT][M,C,N,MN,CN]

                      where the brackets indicate the A, M1, M2, and M4 sites (for brevity
                      the dependent T1 and OH site chemistry has been dropped) and 

                      A  = Na, V
                      T  = Al, Fe3
                      MT = MAl, MFe3
                      C  = Ca
                      M  = Mg, Fe
                      N  = Na
                      MN = MNa
                      CN = CNa
                      
                      NOTE: the model composition space below has been simplified by commenting out some of
                      the possible endmembers. It is probable that VERTEX/MEEMUM will run out of dynamic memory if 
                      the full model is restored, if this occurs uncomment the low_reach option keyword
                      at the end of this model. The low_reach option dramatically reduces the
                      memory and time required for calculations, but also causes a significant
                      deterioration in phase diagram quality.
                     
                      The composition space of the model is formed as a mixture of four independent subcompositions:

                      tschermakitic amphibole: {Mg,Fe}*[Al,Fe3]*[M,C,N] = 12 endmembers
                      pargasitic amphibole:    {Ng,Fe}*[N]*[MAl,MFe3]*[M,C] = 8 endmembers
                      piglitic amphibole:      {Mg,Fe}*[N,CN,MN]*[N]*[Al,Fe3] = 12 endmembers 
                      divalent amphibole:      {Ng,Fe}*[M,C] = 4 endmembers                      => 36 endmembers + 2 ordered endmembers

                      where T1 = f(N,M4)
                      --------------------------------------------------------
                      earlier corrections/revisions

                        10/07   z(m2a,al) corrected. Y Y. Podladchikov
                         3/08   z(m1a,mg),z(m4,ca),z(m4,mg), and fged corrected,
                                T1 multiplicity reduced to 1
                                Enthalpies of ordering corrected. JADC.
                         6/08   z(m1,mg) corrected to include mrb, second limit
                                equations for cammo1 and cammo2 corrected accordingly.
                                corrected enthalpies for cammo1 and cammo2.
                       8/31/11 2011 DP model revisions entered by MJC.
                       1/24/17 fgrk-grk exchange added
                       3/ 8/18 dqfs for cumm and grun moved from model to data file
                       11/2/18 reformulated as 2x2x5 prism, adding Ca-free parg and Ts, and
                               Ca-bearing grk exchanges. JADC.
                      --------------------------------------------------------
                      NOTE to use this model the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                          ts_dqf
                          parg_dqf
                          gl_dqf
                          cumm_dqf
                          grun_dqf

                       additionally the following endmembers should be excluded in the
                       computational option file:

                          ts
                          parg
                          gl
                          cumm
                          grun
                      --------------------------------------------------------
                      independent endmembers and site populations:

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       1(4)*
                                            _________________________________________

                               tr            Vac       Mg      Mg     Ca      Si_Si       
                               ts_dqf        Vac       Mg      Al     Ca      Al_Si       
                               parg_dqf      Na        Mg      Mg_Al  Ca      Al_Si     
                               gl_dqf        Vac       Mg      Al     Na      Si_Si     
                               cumm_dqf      Vac       Mg      Mg     Mg      Si_Si      
                               grun_dqf      Vac       Fe      Fe     Fe      Si_Si      
                               mrb           Vac       Mg      Fe3+   Na      Si_Si      

                               cammo1        Vac       Mg      Fe     Fe      Si_Si      ordered
                               cammo2        Vac       Fe      Mg     Fe      Si_Si      ordered

                        *T1 has a true multiplicity of 4, H&P previously used an effective multiplicity of 2;
                        however in Diener et al. '07 the multiplicity has been reduced to 1  JADC 9/07.

                        2 NaCa-1(M4) = (Gl-Ts)
                        2 CaMg-1(M4) = (Tr-Cumm)
                        2 Fe3Al-1(M2) = (Rb-Gl)
                        3 FeMg-1(M1) = (grun - a)
                        2 FeMg-1(M2) = (grun - b)
                        2 FeMg-1(M4) = (-grun + cumm + a + b)
                      ----------------------------------------------------------------------------------------

cAmph_I(DP)
abbreviation Amph
full_name    clinoamphibole

688                                | model type: 688 format standard model

4                                  | number of subcompositions
                                   | polyhedron names and composite composition space subdivision schemes
Ts-Amph    0   .5   .1  0          | X([ ][M][T][M,C,N])
Pg-Amph    0   .5   .1  0          | X([A][M][MT][M,C,N])
Pgl-Amph   0   .1   .1  0          | X([A][M][T][MN,CN,N])
Trem-Amph  by difference           | X([ ][M][M][MC])

                                   | -------------------------------------------
                                   | subcomposition 1 [ ][M][T][M,C,N]
3                                  | number of simplices
2 2 3                              | number of vertices on each non-zero-d simplex

mrb        frb_d                   | [ ][M][Fe][N]      Fe3-glaucophane, aka riebeckite
gl_dqf     fgl_d                   | [ ][M][Al][N]      Al-glaucophane

mgrk_d     fgrk_d                  | [ ][M][Fe][M]      Fe3-Ts
mts_d      fts_d                   | [ ][M][Al][M]      Al-Ts

mcgrk_d    fcgrk_d                 | [ ][M][Fe][C]      M-Ca-Fe3+_tschermaks (Na-free riebeckite)
ts_dqf     fcts_d                  | [ ][M][Al][C]      Al-cTs

                                   | First simplex
X_Mg1     0    1  .1  0            | X(1,1) = bulk Mg/M
X_Fe1     by difference
                                   | 2nd simplex
z_Fe3     0    1  .1  0            | T on M2
z_Al      by difference
                                   | 3rd simplex
z_Na      0   .2   .1  0           | M,C,N on M4
z_M       0   .7   .1  0           |
z_Ca      by difference
                                   | -------------------------------------------
                                   | subcomposition 2 [A][M][MT][M,C]
3                                  | number of simplices
2 2 2                              | number of vertices on each simplex

                                   | Simplex 1 {Mg,Fe} pseudo-site that defines bulk Mg/Fe
                                   | Simplex 2 {Fe3,Al} on M2
                                   | Simplex 3 {M,C} on M4

mparg_d    fparg_d                 | [N][M][MAl][M]     Na-Al-M parg
parg_dqf   fcparg_d                | [N][M][MAl][C]     Na-Al-Ca parg

ompg_d     ofpg_d                  | [N][M][MFe][M]     Na-Fe3+-M parg*
ocmpg_d    ocfpg_d                 | [N][M][MFe][C]     Na-Fe3-Ca parg*

                                   | 1st simplex
x_Mg      0    1  .1  0            | bulk Mg/M
x_Fe      by difference
                                   | 2nd simplex
z_Fe3     0   .7  .1  0            | T on M2
z_Al      by difference
                                   | 3rd simplex
z_M       0   .1   .1  0           | M,C on M4
z_C       by difference
                                   | -------------------------------------------
                                   | Polyhedron 3 [Mg,Fe]*[N,CN,MN]*[K,N]*[Al,Ti,Fe3]
3                                  | number of simplices

2 3 2                              | number of vertices on each simplex [Mg,Fe]*[N,CN,MN]*[N]*[Al,Fe3]

nmfn_d      nffn_d                 | [N][M][MFe][N]     N-Fe-N-Pgl*
nmfmn_d     nfffn_d                | [N][M][Fe][MN]     N-Fe-MN-Pgl*
nmfcn_d     nffcn_d                | [N][M][Fe][CN]     N-Fe-CN-Pgl*

nman_d      nfan_d                 | [N][M][MAl][N]     N-Al-N-Pgl*
nmamn_d     nfafn_d                | [N][M][Al][MN]     N-Al-MN-Pgl*
nmacn_d     nfacn_d                | [N][M][Al][CN]     N-Al-CN-Pgl*

                                   | 1st simplex
x_Mg      0    1   .1  0           | bulk Mg/M
x_Fe      by difference
                                   | 2nd simplex
z_MN      0    1   .1  0           | MN,CN,N on M4
z_CN      0    1   .1  0
z_N       by difference
                                   | 3rd simplex
z_Fe3     0   .7   .1  0           | T on M2
z_Al      by difference
                                   | -------------------------------------------
                                   | Polyhedron 4 [Mg,Fe]*[ ][M][M][M,C] 
2                                  | number of simplices
2 2                                | number of vertices on each non-zero-d simplex

cumm_dqf   grun_dqf                | M-Ca divalent amphibole
tr         ftr_d
                                   | First simplex
x_Mg,2    0    1   .1  0           | X(1,1) = bulk Mg/M
x_Fe,2    by difference
                                   | Second simplex
z_M       0    1    .1  0          | [ ][M][M][M]
z_C       by difference            | [ ][M][M][C]


begin_ordered_endmembers

cammo1 = 3/7 cumm_dqf + 4/7 grun_dqf   delta_g_of_ordering  = -9.5d3
cammo2 = 2/7 cumm_dqf + 5/7 grun_dqf   delta_g_of_ordering  = -11.7d3    | these enthalpies differ from the published values
                                                                         | becuase Thermocalc reactions are specified in terms of the
                                                                         | endmember without "DQF" corrections, while in Perple_X
                                                                         | endmember include any DQF corrections.
end_ordered_endmembers 

begin_dependent_endmembers

ftr_d    = 1 tr       + 2 grun_dqf    - 1 cammo1 - 1 cammo2

fcparg_d = 1 parg_dqf + 3/2 grun_dqf  - 1 cammo1   - 1/2 cammo2
fparg_d  = 1 parg_dqf + 1/2 grun_dqf  + 1/2 cammo2 - 1 tr
mparg_d  = 1 parg_dqf - 1 tr          + 1 cumm_dqf

fcts_d   = 1 ts_dqf   + 1 grun_dqf    - 1 cammo1
fts_d    = 1 ts_dqf - 1 tr            + 1 cammo2
mts_d    = 1 ts_dqf - 1 tr            + 1 cumm_dqf

fgl_d    = 1 gl_dqf   + 1 grun_dqf    - 1 cammo1
frb_d    = 1 mrb      + 1 grun_dqf    - 1 cammo1

mcgrk_d  = 1 mrb      + 1 ts_dqf  - 1 gl_dqf
mgrk_d   = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 tr         + 1 cumm_dqf
fgrk_d   = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 tr         + 1 cammo2
fcgrk_d  = 1 mrb      + 1 ts_dqf  - 1 gl_dqf     - 1 cammo1     + 1 grun_dqf

                                   | M or Ca on M4, Fe3 on M2

ocmpg_d   = 1 parg_dqf  + 1/2 mrb  - 1/2 gl_dqf
ocfpg_d   = 1 parg_dqf  + 3/2 grun_dqf - 1 cammo1 - 1/2 cammo2  + 1/2 mrb   - 1/2 gl_dqf
ompg_d    = 1 parg_dqf  - 1 tr     + 1 cumm_dqf + 1/2 mrb  - 1/2 gl_dqf
ofpg_d    = 1 parg_dqf  + 1/2 grun_dqf + 1/2 cammo2 - 1 tr + 1/2 mrb  - 1/2 gl_dqf

                                   | piglitic endmembers
nfan_d    = 1 parg_dqf  + 3/2 grun_dqf - 1 cammo1 - 1/2 cammo2 + 1 gl_dqf - 1 ts_dqf
nman_d    = 1 parg_dqf  + 1 gl_dqf - 1 ts_dqf
nmacn_d   = 1 parg_dqf  + 1/2 gl_dqf - 1/2 ts_dqf 
nfafn_d   = 1 parg_dqf  + 1/2 grun_dqf + 1/2 cammo2 - 1 tr + 1/2 gl_dqf    - 1/2 cammo1
nmamn_d   = 1 parg_dqf  - 1 tr     + 1/2 cumm_dqf + 1/2 gl_dqf
nfacn_d   = 1 parg_dqf  + 3/2 grun_dqf - 1 cammo1 - 1/2 cammo2 + 1/2 gl_dqf - 1/2 ts_dqf

nmfn_d    = 1 parg_dqf  + 1/2 mrb  + 1/2 gl_dqf - 1 ts_dqf
nffn_d    = 1 parg_dqf  + 3/2 grun_dqf - 1 cammo1 - 1/2 cammo2  + 1/2 mrb   + 1/2 gl_dqf - 1 ts_dqf
nmfmn_d   = 1 parg_dqf  - 1 tr     + 1/2 cumm_dqf + 1/2 mrb

nfffn_d   = 1 parg_dqf  + 1/2 grun_dqf + 1/2 cammo2 - 1 tr + 1/2 mrb  - 1/2 cammo1
nmfcn_d   = 1 parg_dqf  + 3/2 grun_dqf - 1 cammo1 - 1/2 cammo2  + 1/2 mrb   - 1/2 ts_dqf
nffcn_d   = 1 parg_dqf  + 3/2 grun_dqf - 1 cammo1 - 1/2 cammo2  + 1/2 mrb   - 1/2 ts_dqf

end_dependent_endmembers

begin_excess_function
w(mrb tr)          52e3
w(mrb ts_dqf)      20e3
w(mrb parg_dqf)        40e3

w(mrb cumm_dqf)        80e3
w(mrb grun_dqf)        91e3
w(mrb cammo1)      80e3
w(mrb cammo2)      90e3

w(cammo2 tr)          63e3
w(cammo2 ts_dqf)     72.5e3
w(cammo2 parg_dqf)   94.8e3
w(cammo2 gl_dqf)   111.2e3
w(cammo2 cumm_dqf)        23e3
w(cammo2 grun_dqf)         8e3
w(cammo2 cammo1)      20e3

w(cammo1 tr)         57e3
w(cammo1 ts_dqf)     70e3
w(cammo1 parg_dqf)  94.8e3
w(cammo1 gl_dqf)    100e3
w(cammo1 cumm_dqf)       18e3
w(cammo1 grun_dqf)       12e3

w(grun_dqf tr)          75e3
w(grun_dqf ts_dqf)      80e3
w(grun_dqf parg_dqf)  106.7e3
w(grun_dqf gl_dqf)   113.5e3
w(grun_dqf cumm_dqf)        33e3

w(cumm_dqf tr)          45e3
w(cumm_dqf ts_dqf)      70e3
w(cumm_dqf parg_dqf)     90e3
w(cumm_dqf gl_dqf)     100e3

w(gl_dqf tr)        65e3
w(gl_dqf ts_dqf)    25e3
w(gl_dqf parg_dqf)   50e3

w(parg_dqf tr)      25e3
w(parg_dqf ts_dqf) -40e3

w(ts_dqf tr)        20e3
end_excess_function

5                                   | number of sites in configurational entropy model (A, M1, M2, M4, T1)

A                                   | site name
2 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na,A)   =    1 parg_dqf
z(Vac,A)  =    1 cumm_dqf + 1 grun_dqf + 1 tr + 1 ts_dqf + 1 gl_dqf + 1 cammo1 + 1 cammo2 + 1 mrb

M1                                  | site name
2 3 3                               | number of species, effective multiplicity, true multiplicity
z(Fe,M1)   = 1 grun_dqf + 1 cammo2
z(Mg,M1)   = 1 cumm_dqf + 1 ts_dqf + 1 parg_dqf + 1 mrb + 1 gl_dqf + 1 cammo1 + 1 tr

M2                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Fe,M2)   = 1 grun_dqf + 1 cammo1
z(Fe3,M2)  = 1 mrb
z(Al,M2)   = 1 ts_dqf     + 1/2 parg_dqf + 1 gl_dqf
z(Mg,M2)   = 1/2 parg_dqf + 1 tr         + 1 cumm_dqf + 1 cammo2

M4                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Mg,M4)   = 1 cumm_dqf
z(Na,M4)   = 1 gl_dqf + 1 mrb
z(Fe,M4)   = 1 grun_dqf + 1 cammo1 + 1 cammo2
z(Ca,M4)   = 1 ts_dqf + 1 parg_dqf + 1 tr

T1                                  | site name
2 1 4                               | number of species, effective multiplicity, true multiplicity
z(Al,T1)   = 1/2 ts_dqf  + 1/2 parg_dqf
z(Si,T1)   = 1/2 ts_dqf + 1/2 parg_dqf + 1 gl_dqf + 1 mrb + 1 tr + 1 grun_dqf + 1 cammo1 + 1 cammo2 + 1 cumm_dqf

[Si4O22(OH)2]                       | formula suffix, enter "none" for no suffix.


begin_van_laar_sizes
alpha(tr)       1
alpha(parg_dqf) 1.7
alpha(ts_dqf)   1.5
alpha(gl_dqf)   0.8
alpha(cumm_dqf) 1
alpha(grun_dqf) 1
alpha(cammo1)   1
alpha(cammo2)   1
alpha(mrb)      0.8
end_van_laar_sizes
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.
low_reach

end_of_model
                      --------------------------------------------------------
begin_model
                      --------------------------------------------------------
begin_model
                      ORTHOAMPHIBOLE: Diener et al, JMG 2011 25:631-656, modified from Diener et al, JMG 2008

                      ---------------------------------------------------------
                      Reformulated as a 2-polytope 688 format model. JADC, 11/19

                      The composition space of the complete (published) model corresponds to:

                      [A][M][M,T,MT][M,C,N]

                      where the brackets indicate the A, M1, M2, and M4 sites and 

                      A  = Na, K, V
                      T  = Al, Fe3
                      MT = MAl, MFe3
                      C  = Ca
                      M  = Mg, Fe
                      N  = Na
                      
                      The composition space of the model here has been simplified to

                      [A][M][M,T,MAl][M,C,N]

                      where the brackets indicate the A, M1, M2, and M4 sites and 

                      A  = Na, K, V
                      T  = Al, Fe3
                      MT = MAl
                      C  = Ca
                      M  = Mg, Fe
                      N  = Na
                      
                      Refer to to cAmph(G) for an (commented out) example with MT = MAl, MFe3.
                      
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                      
                      Polytope 1 = Glaucophane = [M][T][N]         => 2*2 
                      Polytope 2 = ACMT-Amph   = [M][M,T,MT][M,C]  => 2*2*4              
                      
                      T   is generalized Tschermaks      [M][T][M,C]
                      MT  is generalized pargasite       [M][MT][N] 
                      N   is generalized glaucophane     [M][T][N] 
                      M   on M2 is generalized amphibole [M][M][M,C]                       
                      --------------------------------------------------------
                      earlier corrections/revisions

                        10/07   z(m2a,al) corrected. Y. Podladchikov.
                         3/08   z(m1a,mg),z(m4,ca),z(m4,mg), and fged corrected,
                                T1 multiplicity reduced to 1
                                Enthalpies of ordering corrected. JADC.
                         8/08   Enthalpy of ordering corrected for HP dqfs.
                        10/11   2011 DP revisions entered by MJC.
                        11/18   reformulated as a 2x2x6 prism adding Na-free riebeckite (grk)
                      --------------------------------------------------------
                      NOTE: to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                              mpa       = 1 parg - 1 tr +1 anth dqf(25d3) (recently modified to 3d3, JADC, 8/21)
                              ged_dqf   = dqf(ged)   20000 (recently modified to 40d3, JADC, 8/21)
                              ogl_dqf   = dqf(gl)    15000 (recently modified to 0, i.e., model could just use gl, JADC, 8/21)
                              fanth_dq  = dqf(fanth)  7000
                              omrb_dqf  = 1 gl -2 jd -2 acm dqf(33d3)

                       additionally the following endmembers should be excluded in the
                       computational option file if they interfere with calculated
                       phase relations:

                              ged
                              fanth
                              gl
                      --------------------------------------------------------
                      independent endmembers and site populations:


                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       1(4)*
                                            _________________________________________

                               tr            Vac       Mg      Mg     Ca      Si_Si                 
                               ged_dqf       Vac       Mg      Al     Mg      Al_Si                  
                               mpa           Na        Mg      Mg_Al  Mg      Al_Si                 
                               ogl_dqf       Vac       Mg      Al     Na      Si_Si                   
                               anth          Vac       Mg      Mg     Mg      Si_Si                 
                               fanth_dq      Vac       Fe      Fe     Fe      Si_Si                  
                               omrb_dqf      Vac       Mg      Fe3+   Na      Si_Si                 

                               ammo1         Vac       Mg      Fe     Fe      Si_Si      ordered
                               ammo2         Vac       Fe      Mg     Fe      Si_Si      ordered

                        *T1 has a true multiplicity of 4, H&P previously used an effective multiplicity of 2;
                        in Diener et al '07 the multiplicity has been reduced to 1

                        JADC 9/07.

                        (AlMg-1,M2)  = ged - anth
                        (CaNa-1,M4)  = tr + (ged - anth) - gl
                        (CaMg-1,M4)  = tr - anth
                        (MgNa-1,M4)  = ged - ogl
                        (Fe3Al-1,M2) = mrb - ogl
                        FeMg-1(M4) = (-fanth - anth + ammo1 + ammo2)
                      ---------------------------------------------------------
oAmph(DP)
abbreviation oAmph
full_name    orthoamphibole

688                                | model type: 688 format standard model

2                                  | number of polytopes
                                   | polytope names and composite composition space subdivision schemes 
GlRb-Amph 0   .2   .1  0           | X([ ][M][Fe3,Al][N]), Mg-Fe-Al-Fe3+ "glaucophane"
ACMT-Amph by difference            | X([A][M][M,T,MT][M,C]), K-Na-Mg-Fe-Al-Ti-Fe3+ "pargasite"

                                   | -------------------------------------------
                                   | Polytope 1 [ ][M][T  ][N] (Glaucophane)
2                                  | number of simplices
2 2                                | number of vertices on each simplex
 
                                   | Simplex 1 is M
                                   | Simplex 2 is T

                                   | endmembers on the vertices, index on the first simplex
                                   | changes fastest, last slowest
                                   
                                   | => endmember 11 is [ ][Mg][Fe3][Na]
                                   | => endmember 21 is [ ][Fe][Fe3][Na]
                                   | => endmember 12 is [ ][Mg][Al ][Na]
                                   | => endmember 22 is [ ][Fe][Al ][Na]

omrb_dqf   frb_d                   | Fe3-glaucophane, aka riebeckite
ogl_dqf    fgl_d                   | Al-glaucophane

                                   | First (1d) simplex
X_Mg1   0    1  .1  0              | X(1,1) = bulk Mg/M
X_Fe1   by difference
                                   | Second (3d) simplex
X_rb    0    1  .1  0              | X(2,1) = Fe3/T' on M2, T' = Al + Fe3+
X_gl    by difference
                                   | -------------------------------------------
                                   | Polytope 2 [A][M][M,T,MT][M,C]  
3                                  | number of simplices, then for each simplex
2 2 4                              | number of vertices on each simplex

                                   | Simplex 1 is bulk Mg/M
                                   | Simplex 2 is C/[C + M] on M4
                                   | Simplex 3 is M, T, MT on M2 

                                   | endmembers on the vertices, index on the first simplex
                                   | changes fastest, last slowest                 
cmged_d       cfged_d
ged_dqf       fged_d               | M-Ca-Al_tschermaks

cmpa_d        cfpa_d         
mpa           fpa_d                | M-Ca-Na-Al_parg

mcgrk_d       fcgrk_d       
mgrk_d        fgrk_d               | M-Ca-Fe3+_tschermaks (Na-free riebeckite)

tr            ftr_d
anth          fanth_dq             | M-Ca divalent amphibole

                                   | First (1d) simplex
X_Mg     0    1   .1  0            | X(1,1) = bulk Mg/M
X_Fe     by difference
                                   | Second (1d) simplex
X_C_M2   0    1   .1  0            | X(2,1) = Ca/[Ca + M] on M4
X_M_M2   by difference
                                   | Third simplex 
X_AlTs   0    1   .1  0            | X(3,1) = X(Al-Ts)
X_NaPg   0    1   .1  0            | X(3,2) = X(Na-Al-Parg)
X_FeTs   0    1   .1  0            | X(3,9) = X(Fe3-Ts)
X_MCamph by difference

begin_ordered_endmembers
ammo1 = 3/7 anth + 4/7 fanth_dq   delta_g_of_ordering  = -9.5d3
ammo2 = 2/7 anth + 5/7 fanth_dq   delta_g_of_ordering  = -11.7d3 | these enthalpies differ from the published values
                                                                 | becuase Thermocalc reactions are specified in terms of the
                                                                 | endmember without "DQF" corrections, while in Perple_X
                                                                 | endmember include any DQF corrections.
end_ordered_endmembers 

begin_dependent_endmembers
ftr_d   = 1 tr + 2 fanth_dq - 1 ammo1 - 1 ammo2

fpa_d   = 1 mpa  + 1/2 fanth_dq + 1/2 ammo2 - 1   anth
cfpa_d  = 1 mpa  + 1 tr         + 3/2 fanth_dq -   1 ammo1 - 1/2 ammo2 - 1 anth
cmpa_d  = 1 mpa  + 1 tr         - 1 anth

cmged_d = 1 ged_dqf  - 1 anth + 1 tr
cfged_d = 1 ged_dqf  - 1 anth + 1 tr + 1 fanth_dq - 1 ammo1

mgrk_d  = 1 omrb_dqf  + 1 ged_dqf  - 1 ogl_dqf
mcgrk_d = 1 omrb_dqf  + 1 ged_dqf  - 1 anth     - 1 ogl_dqf   + 1 tr
fcgrk_d = 1 omrb_dqf  + 1 ged_dqf  - 1 ogl_dqf  + 1 fanth_dq  - 1 ammo1
fgrk_d  = 1 omrb_dqf  + 1 ged_dqf  - 1 ogl_dqf  - 1 anth      + 1 ammo2

fged_d  = 1 ged_dqf  - 1 anth + 1 ammo2

fgl_d   = 1 ogl_dqf +  1 fanth_dq - 1 ammo1
frb_d   = 1 omrb_dqf + 1 fanth_dq - 1 ammo1
end_dependent_endmembers

begin_excess_function
W(anth ged_dqf )      25d3
W(anth mpa )          25d3
W(anth ogl_dqf)       65d3
W(anth tr)            45d3
W(anth fanth_dq)      33d3
W(anth omrb_dqf)      52d3
W(anth ammo1)         18d3
W(anth ammo2)         23d3

W(ged_dqf  mpa )          -40d3
W(ged_dqf  ogl_dqf)        25d3
W(ged_dqf  tr)             70d3
W(ged_dqf  fanth_dq)     38.5d3
W(ged_dqf  omrb_dqf)       20d3
W(ged_dqf  ammo1)          29d3
W(ged_dqf  ammo2)        34.6d3

W(mpa  ogl_dqf)       50d3
W(mpa  tr)            90d3
W(mpa  fanth_dq)      45d3
W(mpa  omrb_dqf)      40d3
W(mpa  ammo1)       33.2d3
W(mpa  ammo2)         36d3

W(ogl_dqf tr)            65d3
W(ogl_dqf fanth_dq)    81.2d3
W(ogl_dqf ammo1)       65.5d3
W(ogl_dqf ammo2)       78.4d3

W(tr fanth_dq)        75d3
W(tr omrb_dqf)       52d3
W(tr ammo1)          57d3
W(tr ammo2)          63d3

W(fanth_dq omrb_dqf)     65d3
W(fanth_dq ammo1)        12d3
W(fanth_dq ammo2)         8d3

W(omrb_dqf ammo1)        52d3
W(omrb_dqf ammo2)        63d3

W(ammo1 ammo2)            20d3
end_excess_function

5                                   | number of sites in configurational entropy model (A, M1, M2, M4, T1)

A                                   | site name
2 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na,A)   =    1 mpa
z(Vac,A)  =    1 anth     + 1 fanth_dq + 1 tr + 1 ged_dqf + 1 ogl_dqf + 1 ammo1 + 1 ammo2 + 1 omrb_dqf  

M1                                  | site name
2 3 3                               | number of species, effective multiplicity, true multiplicity
z(Fe,M1)   = 1 fanth_dq + 1 ammo2
z(Mg,M1)   = 1 anth     + 1 ged_dqf + 1 mpa + 1 omrb_dqf + 1 ogl_dqf + 1 ammo1 + 1 tr

M2                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Fe,M2)   = 1 fanth_dq + 1 ammo1
z(Fe3,M2)  = 1 omrb_dqf
z(Al,M2)   = 1 ged_dqf   + 1/2 mpa + 1 ogl_dqf
z(Mg,M2)   = 1/2 mpa     + 1 tr    + 1 anth + 1 ammo2

M4                                  | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Ca,M4)   = 1 tr
z(Mg,M4)   = 1 anth     + 1 ged_dqf  + 1 mpa
z(Na,M4)   = 1 ogl_dqf  + 1 omrb_dqf
z(Fe,M4)   = 1 fanth_dq + 1 ammo1    + 1 ammo2

T1                                  | site name
2 1 4                               | number of species, effective multiplicity, true multiplicity
z(Al,T1)   = 1/2 ged_dqf  + 1/2 mpa
z(Si,T1)   = 1/2 ged_dqf  + 1/2 mpa + 1 anth + 1 ogl_dqf + 1 omrb_dqf + 1 tr + 1 fanth_dq + 1 ammo1 + 1 ammo2

[Si4O22(OH)2]                       | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(tr)          1
alpha(ged_dqf )    1.5
alpha(mpa )        1.7
alpha(ogl_dqf)     0.8
alpha(anth)        1
alpha(fanth_dq)    1
alpha(ammo1)       1
alpha(ammo2)       1
alpha(omrb_dqf)    0.8
end_van_laar_sizes
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

reach_increment 0
                                    | low_reach and reach_increment conflict, set only one.
| low_reach

end_of_model
                      --------------------------------------------------------
begin_model
                                      Green, ECR, Holland, TJB & Powell, R (2007) An order-disorder model for
                                      omphacitic pyroxenes in the system jadeite-diopside-hedenbergite-acmite,
                                      with applications to eclogite rocks. American Mineralogist, 92, 1181-1189.

                                      Originally this model had no DQF corrections.

                                      To use this model with ds5 versions (pre-2011) of the THERMOCALC data base, the
                                      DQF on acmite should be -4000 J/mol as specified by Diener & Powell (2011), entered by MJC, Oct 31, 2011.

                                      To use this model with ds6 versions (2011+) of the THERMOCALC data base, the
                                      DQF [specified at the end of this model] on acmite should be -7000 J/mol
                                      as specified by Green et al (2016) and noted by Felix Gervais.

                                      The DQF specification for acm moved from this solution model to the
                                      thermodynamic data file. March 7, 2018. JADC.

                                      Converted to 688 format. Aug, 2020. JADC.
                                      ---------------------------------------------

                                      WARNING: The choice of independent ordered species (here, cfm, om, jac)
                                      has the conseqence that this model CANNOT be used for the following
                                      subcompositions:

                                          jd-hed, hed-acm, di-acm, hed-acm-jd, hed-acm-di

                                      to work in these joins either fom, hac, or dac must replace either
                                      om or/and cfm.

                                                         Site:
                                                       1      2      3      4
                                                      M2a    M2b    M1a    M1b
                                                     ____________________________________

                                      Mutliplicity    1/2    1/2    1/2    1/2
                                                     ____________________________________

                                      1 Diopside      Ca     Ca     Mg     Mg
                            Species:  2 Jadeite       Na     Na     Al     Al
                                      3 Hedenbergite  Ca     Ca     Fe2+   Fe2+
                                      4 Acmite        Na     Na     Fe3+   Fe3+
                                                      ___________________________________

                        Ordered Cpd:  5 om            Na     Ca     Al     Mg
                                      6 cfm           Ca     Ca     Mg     Fe
                                      7 jac           Na     Na     Fe3+   Al

Omph(GHP)
abbreviation Cpx
full_name    clinopyroxene


688                               | model type: 688 format standard model

1                                  | number of polytopes
1                                  | number of simplices
4                                  | number of vertices (endmembers) on each simplex

di
jd
acm_dqf
hed

0  1   .1  0                 | range and resolution of X(di)
0  1   .1  0                 | range and resolution of X(jd)
0  1   .1  0                 | range and resolution of X(acm)

begin_ordered_endmembers
om   = 1/2 jd + 1/2 di       delta_g_of_ordering   =  -2.9d3
cfm  = 1/2 di + 1/2 hed      delta_g_of_ordering   =  -1.5d3
jac  = 1/2 jd + 1/2 acm_dqf  delta_g_of_ordering   =  -1d3      | this differs from the published value of -3d3 J/mol
                                                                | because Thermocalc reactions are specified in terms of the
                                                                | endmember without "DQF" corrections, while in Perple_X
                                                                | endmember include any DQF corrections.
end_ordered_endmembers

begin_excess_function
W(jd di)       26d3
W(jd hed)      24d3
W(jd acm_dqf)  5d3
W(jd om)       15.5d3
W(jd cfm)      25.2d3
W(jd jac)      3d3
W(di hed)      4d3
W(di acm_dqf)  21d3
W(di om)       15.75d3
W(di cfm)      2d3
W(di jac)      24.65d3
W(hed acm_dqf) 20.8d3
W(hed om)      17.2d3
W(hed cfm)     2d3
W(hed jac)     24.6d3
W(acm_dqf om)  16.4d3
W(acm_dqf cfm) 22.2d3
W(acm_dqf jac) 3d3
W(om cfm)      18.45d3
W(om jac)      19.5d3
W(cfm jac)     24.55d3

end_excess_function

4                                   | 4 site entropy model (m1a, m1b, m2b, m2a)

M1a
4  .5  .5                           | 4 species on m1a, mult = 1/2
z(Mg,M1a)   = 1 di + 1 cfm
z(Fe2+,M1a) = 1 hed
z(Fe3+,M1a) = 1 acm_dqf + 1 jac
z(Al,M1a)   = 1 jd + 1 om

M1b
4  .5  .5                           | 4 species on m1b, mult = 1/2
z(Al,m1b)   = 1 jd  + 1 jac
z(Fe,m1b)   = 1 hed + 1 cfm
z(Fe3,m1b)  = 1 acm_dqf
z(Mg,m1b)   = 1 di  + 1 om

M2a
2  .5  .5                           | 2 species on m2a, mutiplicity = 1/2
z(Ca,m2a)   = 1 di + 1 hed + 1 cfm
z(Na,m2a)   = 1 jd + 1 om  + 1 jac + 1 acm_dqf

M2b
2  .5  .5                           | 2 species on m2b, mult. = 1/2
z(Na,M2b)   = 1 jd + 1 acm_dqf + 1 jac
z(Ca,M2b)   = 1 di + 1 hed + 1 om + 1 cfm


[Si2O6]                            | formula suffix, enter "none" for no suffix.

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model
                           | preliminary BCC iron solution model
FeSi(BCC)
abbreviation BCC
full_name    alloy

2                          | model type: simplicial composition space.
2                          | 2 endmembers
iron     Si
  0  0                     | endmember flags

0      1        .1     0   | imod = 0 -> cartesian subdivision

begin_excess_function
W(iron Si)       -100d3
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity = 1.
z(Fe) = 1 iron

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model
                           | FCC Fe-Si alloy after Lacaze and Sundman (1990) Metal. Trans 22A:1991-2211
FeSi(fcc)
abbreviation FCC
full_name    alloy

2                          | model type: simplicial composition space.
2                          | 2 endmembers
Fe-FCC
Si-FCC
  0  0                     | endmember flags

0      1        .1     0   | imod = 0 -> cartesian subdivision

begin_excess_function
W(Fe-FCC Si-FCC)               -125247.7 41.116 0
W(Fe-FCC Fe-FCC Si-FCC)        -142707.6
W(Fe-FCC Si-FCC Si-FCC)         142707.6
W(Fe-FCC Fe-FCC Fe-FCC Si-FCC)   89907.3
W(Fe-FCC Fe-FCC Si-FCC Si-FCC) -179814.6
W(Fe-FCC Si-FCC Si-FCC Si-FCC)   89907.3
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity = 1.
z(Fe) = 1 Fe-FCC

reach_increment 3

end_of_model
                            --------------------------------------------------------
begin_model
                           | BCC Fe-Si alloy after Lacaze and Sundman (1990) Metal. Trans 22A:1991-2211
                           | because the order/disorder formulation implemented in this model is thermodynamically
                           | inconsistent, the model is implemented internally in Perple_X (function gbccfesi).
                           | The information provided below is a stub for the internal implementation and should
                           | not be modified (the compositional limits and subdivision scheme are an exception in
                           | this regard).
oFeSi(bcc)
abbreviation BCC
full_name    alloy

29

2

Fe-BCC
Si-BCC

0 0

0    1     .1 0            | compositional limits and subdivision scheme

ideal

0

end_of_model
                            --------------------------------------------------------
begin_model

FeSi_liq
abbreviation Liq
full_name    liquid
2

2
Fe_LIQ
Si_LIQ
0 0

0  1   .1 0

begin_excess_function
w(Fe_LIQ Si_LIQ)                      -164434.600  41.9773 0.
w(Fe_LIQ Fe_LIQ Si_LIQ)                   0.000  -21.523 0.
w(Fe_LIQ Si_LIQ Si_LIQ)                   0.000   21.523 0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)         -18821.542   22.070 0.
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ)          37643.080  -44.14  0
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)         -18821.542   22.07 0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)   9695.8     | 9695.8
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ)   -29087.4
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)   29087.4
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ Si_LIQ)   -9695.8 | 9695.8
end_excess_function

1
2 1.
z(Fe) = 1 Fe_LIQ


end_of_model
                            --------------------------------------------------------
begin_model
                            | Entered by Jeff Marsh, Jan 10, 2012.

ZrRu                        | zr in rutile after Tomkins et al., 07
abbreviation Ru
full_name    ilmenite


2                           | model type 2
2                           | number of endmembers
zrru  ru

0 0                         | endmember flags

1e-5 1e-2  .1 1             | non-linear resolution of zrru

begin_excess_function
w(ru zrru)   10000
end_excess_function

1                            | 1 site configurational entropy model
2 1                          | 2 species, site multiplicity = 1.
z(Ti) = 1 ru

end_of_model
                      --------------------------------------------------------
begin_model
                                      Silica Fluid

                                      this is a hybrid EoS, the EoS used for the
                                      individual species are controlled by the
                                      hybrid_EoS_XXX option.

Si-Fluid
abbreviation F
full_name    fluid

0                          | model type: Internal EoS
2
                           | NOTE: for model type 0, the first endmember listed here, must correspond
                           | to the second special component in the thermodynamic 
                           | file, i.e., the endmembers CANNOT be reordered.
O        SIO
  0  0                                endmember flags
0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision

ideal
0

reach_increment 3

end_of_model
                      --------------------------------------------------------
begin_model
                      COH-Fluid Generic Hybrid Fluid EoS with linear Subdivision,
                      see COH-Fluid+ for the non-linear subdivision version of this model.

                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
                      --------------------------------------------------------

COH-Fluid
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
11
CO2
CH4
H2S
SO2
H2
CO
N2
NH3
HF
C2H6
H2O


0 0 0 0 0 0 0 0 0 0 0      | endmember flags

0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision
0  1   .1  0               | subdivision ranges, imod = 0 -> cartesian subdivision

ideal                      | the fluid is non-ideal, this tag means only no excess function

0

refine_endmembers

end_of_model
                      --------------------------------------------------------
begin_model
                      COH-Fluid+ Generic Hybrid Fluid EoS with non-linear Subdivision.

                      see COH-Fluid for the linear subdivision version of this model.

                      See the header of this file for an explanation of non-linear
                      subdivision parameters.

                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
                      --------------------------------------------------------
COH-Fluid+
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
9
CO2
CH4
H2S
SO2
H2
CO
HF
C2H6
H2O

0 0 0 0 0 0 0 0 0           | endmember flags

1e-5   5e-1      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-3      .1       1        | H2S subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   2.5e-5    .1       1        | SO2 subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision
1e-5   1e-2      .1       1        | subdivision ranges, imod = 1 -> non-linear subdivision

ideal

0

reach_increment 0

refine_endmembers

end_of_model
                      --------------------------------------------------------
begin_model
                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
WADDAH
abbreviation F
full_name fluid

39                          | model type: Generic Hybrid EoS
1
H2O

0                           | endmember flags

ideal

0                           | ideal configurational entropy

refine_endmembers

end_of_model
                      --------------------------------------------------------
begin_model
                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
C-H-Fluid
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
3
C2H6
CH4
H2

  0  0  0                              endmember flags

0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision

ideal

0                          | ideal configurational entropy

reach_increment 3

end_of_model

                      --------------------------------------------------------
begin_model
                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
HOS-Fluid
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
5
H2S
SO2
H2
O2
H2O

0  0  0  0  0                | endmember flags

0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision

ideal

0                           | ideal configurational entropy

reach_increment 3

end_of_model


                      --------------------------------------------------------
begin_model
                      See perplex.ethz.ch/Perple_X_generic_hyrbid_fluid_EoS.html
                      for explanation of this type of fluid model.
HO-Fluid
abbreviation F
full_name    fluid

39                          | model type: Generic Hybrid EoS
3
O2
H2
H2O

0  0  0  0                 | endmember flags

0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
0    1   .1       0        | subdivision ranges, imod = 0 -> cartesian subdivision

ideal

0                           | ideal configurational entropy

reach_increment 3

end_of_model


                      --------------------------------------------------------
begin_model
                                      majoritic garnet from stixrude '11


Maj
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space

4                                     number of endmembers
maj     alm      py       gr         endmember names

  1  0  0  0                        | endmember flags

0   .2   .1 0              | imod = 1 -> asymmetric transform subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
                           | NOTE restricted subdivision range on Mn (Species 1)!

begin_excess_function
w(py gr) 33000
w(alm py)  2500                 | hp '98 give 2.4 kJ
W(gr maj)  58d3
W(py maj)  21.3d3
end_excess_function

2                                     2 site entropy model

3 3.                                  3 species, A site multiplicity 3
z(Fe) = 1 alm
z(Ca) = 1 gr

3 2.                                  2 species, B site multiplicity 2
z(Mg) = 1/2 maj
z(Si) = 1/2 maj

reach_increment 4

end_of_model
                      --------------------------------------------------------
begin_model

Wad
abbreviation Wad
full_name    wadleysite

2                                 | model type: simplicial composition space
2                                 | 2 endmembers
mwd       fwd
  0  0                            | endmember flags
0  1  .1    0                     | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(mwd fwd) 16.5d3
end_excess_function
1                                     1 site entropy model
2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 mwd
end_of_model
                      --------------------------------------------------------
begin_model

Ring
abbreviation Ring
full_name    ringwoodite

2                                 | model type: simplicial composition space
2                                 | 2 endmembers
mrw       frw
  0  0                            | endmember flags
0  1  .1   0                      | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(mrw frw) 9.1d3
end_excess_function
1                                     1 site entropy model
2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 mrw

reach_increment 4

end_of_model
                      --------------------------------------------------------
begin_model

Wus
abbreviation Wus
full_name    wuestite

2                                     model type: simplicial composition space
2                                     2 endmembers
per       fper
  0  0
0    1    .1 0

begin_excess_function
W(per fper)  13d3
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity = 1.
z(mg) = 1 per

reach_increment 4

end_of_model
                      --------------------------------------------------------
begin_model
                                  | akimotoite (ilmenite-structure) solution
Aki
abbreviation Aki
full_name    ilmenite

2                                 | model type: simplicial composition space
3                                 | 3 endmembers
cor   mak   fak
  0  0  0                         | endmember flags
0    1   .1  0                    | subdivision range, imod = 0 -> cartesian subdivision
0    1   .1  0                    | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(mak cor)  66d3
end_excess_function

2                                     2 site entropy model

3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 mak
z(fe) = 1 fak

2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model

Pv
abbreviation Pv
full_name    perovskite

2                                 | model type: simplicial composition space
3                                 | 3 endmembers
apv   mpv   fpv
  0  0  0
0  1    .1 0
0  1    .1 0

begin_excess_function
W(mpv apv)   116d3
end_excess_function

2                                     2 site entropy model
3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 mpv
z(fe) = 1 fpv
2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 apv

begin_van_laar_sizes
alpha(mpv)    1
alpha(apv)    0.39
alpha(fpv)    1
end_van_laar_sizes

reach_increment 4

end_of_model
                ------------------------------------------------
begin_model

FeSiC_liq
abbreviation Liq
full_name    liquid

2

3
Fe_LIQ
Si_LIQ
C_LIQ
0 0 0

0  1   .1 0
0  1   .1 0

begin_excess function
w(Fe_LIQ Si_LIQ C_LIQ)             995155.5667  -495.31  0.
w(Fe_LIQ C_LIQ)                    -124320        28.5   0.
w(Fe_LIQ Fe_LIQ C_LIQ)              -19300
w(Fe_LIQ C_LIQ C_LIQ)                19300
w(Fe_LIQ Fe_LIQ Fe_LIQ C_LIQ)        49260       -19.    0.
w(Fe_LIQ Fe_LIQ C_LIQ C_LIQ)        -98520        38.    0.
w(Fe_LIQ C_LIQ C_LIQ C_LIQ)          49260       -19.    0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)      -18821.542    22.07  0.
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ)       37643.084   -44.14  0.
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)      -18821.542    22.07  0.
w(Fe_LIQ Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ)  9695.8
w(Fe_LIQ Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ) -29087.4
w(Fe_LIQ Fe_LIQ Si_LIQ Si_LIQ Si_LIQ)  29087.4
w(Fe_LIQ Si_LIQ Si_LIQ Si_LIQ Si_LIQ)  -9695.8
w(Si_LIQ C_LIQ)                      -133000      30.97  0.
w(Fe_LIQ Si_LIQ)                   -164434.6    41.9773  0.
w(Fe_LIQ Fe_LIQ Si_LIQ)                   0    -21.523   0.
w(Fe_LIQ Si_LIQ Si_LIQ)                   0     21.523   0.
w(Fe_LIQ Si_LIQ C_LIQ C_LIQ)      -549415.5667   495.31  0.
w(Fe_LIQ Fe_LIQ Si_LIQ C_LIQ)  -0.1001220867d7  495.98   0.
w(Fe_LIQ Si_LIQ Si_LIQ C_LIQ)   0.1550636433d7  -955.29  0.
end_excess_function

1
3 1.
z(Fe) = 1 Fe_LIQ
z(Si) = 1 Si_LIQ

reach_increment 6

end_of_model
                      --------------------------------------------------------
begin_model
                            Sapphirine, O/D non-ideal, Taylor-Jones & Powell (JMG, 2010, 28, 615-633)

                            * requires the kel04ver.dat thermodynamic data file (for endmember spr5)

                            Entered June 26, 2013. JADC.


                                                      1      2      3
                                                      M3     M456   T
                                                     _________________

                                      Mutliplicity    1      3     1
                                                     _________________

                                      1 spr4          Mg     Mg    Si
                            Species:  2 fspr          Fe     Fe    Si
                                      3 spr5          Al     Mg    Al
                                      4 fsp5_d        Al     Fe    Al        dependent
                                      5 ospr          Fe3+   Mg    Al
                                      6 fospr_d       Fe3+   Fe    Al        dependent

                                      7 spro          Fe     Mg    Si        ordered

                                      Dependent endmember:

                                      FeMg-1_M3456 = (fspr-spro)/3

                                      fsp5_d = spr5 +  fspr - spro
                                      fospro_d = spr5 +  fspr - spro
Sapp(TP)
abbreviation Sap
full_name    sapphirine

8                            | model type, should be 9
2                            | 2 independent mixing sites, reciprocal solution

2  3                         | 2 components {Fe2+, Mg} for composition 1, 3 components {Al, Si, Fe3+} for composition 2.

                             | endmember names
spr4     fspr
spr5     fsp5_d
ospr     fospr_d

1                            | 1 ordered species:

spro = 3/4 spr4 + 1/4 fspr   delta_g_of_ordering  = -10d3

2                            | 2 dependent endmembers

fsp5_d   = 1 spr5 +  1 fspr - 1 spro
fospr_d  = 1 spr5 +  1 fspr - 1 spro

0 0 0 0 0 0                | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

                           | subdivision model for (binary) site 1 (M2):
0  1  .1   0               | range and resolution of X(Mg), subdivision scheme for site 1: imod = 0 -> cartesian

                           | subdivision model for (ternary) site 2
0  1  .1   0               | range and resolution of X(Ts), subdivision scheme for site 3, species 1: imod = 0 -> cartesian
0  1  .1   0               | range and resolution of X(un-Ts), subdivision scheme for site 3, species 2: imod = 0 -> cartesian


begin_excess_function
W(spr4 spr5)              10d3
W(spr4 fspr)              16d3
W(spr4 spro)               4d3
W(spr4 ospr)              10d3
W(spr5 fspr)              22d3
W(spr5 spro)              10d3
W(fspr spro)              12d3
W(fspr ospr)              22d3
W(spro ospr)              10d3
end_excess_function

3                          | 3 site (M3, M456, T) configurational entropy model

2 3.                       | 2 species on M46, 3 sites per formula unit
z(m456,fe) = 1 fspr

4 1                        | 4 species on M3, 1 sites per formula unit.
z(m3,Al)  = 1 spr5
z(m3,Fe3) = 1 ospr
z(m3,mg)  = 1 spr4

2 1                        | 2 species on T, 1 sites per formula unit.
z(T,si) = 1 spr4 + 1 fspr + 1 spro

begin_dqf_corrections
dqf(fspr)   -3d3
end_dqf_corrections

end_of_model

                      --------------------------------------------------------
begin_model
                                      |Calcite-Magnesite with Dolomite/Ankerite compound formation.
                                      |Franzolin, Schmidt and Poli (2011) CMP 161:213-227, DOI: 10.1007/s00410-010-0527-x

                                       NOTES/WARNINGS:

                                       This model requires the following make definitions in the thermodynamic data file for the
                                       odo and oank endmembers.

                                       odo = 1/2 mag + 1/2 cc 
                                         DQF(J/mol) = -1000

                                       oank = 1/4 sid + 1/2 cc + 1/4 mag 
                                         DQF(J/mol) = -750

                                       JADC, 3/26/2012.
oCcM(EF)
abbreviation Do
full_name    carbonate

2                                     |model type
5                                     |number of endmembers
mag      cc     odo   sid   oank
0  0  0   0   0                       |endmember flags
0  1   .1  0                          |range and increments on X(cc)
0  1   .1  0
0  1   .1  0
0  1   .1  0                          |range and increments on X(mag)

begin_excess_function
w(mag cc)  28000
w(cc odo) 11200
w(mag odo)  14000
W(cc sid)  20503
w(oank sid) 73650 -50*T
w(oank cc) 12730  -10*T
w(mag sid) 10000
w(sid odo) 51190  -30*T
w(oank odo) -5000
w(oank mag) 30000
end_excess_function

3                                     |3 site (m1  m2a  m2b) entropy model

3  .5                                 |3 species on m1, mutiplicity = 1/2
z(m1,ca) =   1 cc + 1 odo + 1 oank
z(m1,mg) =   1 mag

3 0.25                                 |3 species on m2a, mult. = 1/4
z(m2a,ca) =  1 cc
z(m2a,mg) =  1 mag + 1 odo

3 0.25                                 |3 species on m2b, mult. = 1/4
z(m2b,ca) =  1 cc
z(m2b,mg) =  1 mag + 1 odo + 1 oank

begin_van_laar_sizes
alpha(cc)     0.25 0.000929*T
alpha(mag)    1
alpha(odo)    0.95
alpha(sid)    0.01 0.000666*T
alpha(oank)   0.929
end_van_laar_sizes

end_of_model
                                  --------------------------------------------------------
begin_model
                                      |Magnesite-Siderite melt, nathan kang, 4/2015.
LIQ(NK)
abbreviation Liq
full_name    liquid

2                                     |model type
2                                     |number of endmembers
MGCO3L FECO3L
  0  0                                |endmember flags
0  1   .1  0                          |range and increments on X(Fe)

begin_excess_function
W(FECO3L MGCO3L MGCO3L)      -7600        |W_sid-mag = W12
W(MGCO3L FECO3L FECO3L)      -7600        |W_mag-sid = W21
end_excess_function

1                                     |1 site entropy model

2 1                                   |2 species, multiplicity = 1
z(fe) = 1 FECO3L
end_of_model
                      --------------------------------------------------------
begin_model

LIQ(EF)
abbreviation Liq
full_name    liquid

2                                     |model type
3                                     |number of endmembers
CACO3L MGCO3L FECO3L
  0  0  0                             |endmember flags
0  1   .1  0
0  1   .1  0                          | range and increments on X(cc)

begin_excess_function
W(CACO3L CACO3L FECO3L)  -65000
W(CACO3L FECO3L FECO3L)   2000
W(MGCO3L MGCO3L CACO3L)   491900 - 300*T
W(MGCO3L CACO3L CACO3L)  -142000         + 1.2*P
W(MGCO3L MGCO3L FECO3L)  -5594.2
W(MGCO3L FECO3L FECO3L)  -5594.2
end_excess_function

1

3 1
z(ca) = 1 CACO3L
z(fe) = 1 FECO3L

end_of_model
                           --------------------------------------------------------
begin_model
                                      |EF disordered ternary carb
dis(EF)
abbreviation Cc
full_name    carbonate

2                                     |model type
3                                     |number of endmembers
mag      cc      sid
  0  0  0                             | endmember flags
0  1   .1  0                          | range and increments on X(cc)
0  1   .1  0

begin_excess_function
w(mag cc)  28000
W(cc sid)  20503
w(mag sid) 10000
end_excess_function

1                                     |1 site entropy model

3 1                                   |3 species on m, mutiplicity = 1

z(ca) = 1 cc
z(mg) = 1 mag


begin_van_laar_sizes
alpha(cc)     0.25 0.000929*T
alpha(mag)    1
alpha(sid)    0.01 0.000666*T
end_van_laar_sizes

end_of_model
                          --------------------------------------------------------
begin_model
                                  Silicate gas, Lewis and Randal (Ideal) Mixing, the
                                  EoS used for the pure species is determined by the
                                  EoS flag specified for the species in the thermodynamic
                                  data file
Si-vapor
abbreviation gas
full_name    gas

2

7                                     number of endmembers

                                    | ENDMEMBER NAMES:
SiO2
SiO
Si
O2
O
MgO
| Mg commented out so entropy model can be read without changing parameter m11
FeO
| Fe

0 0 0 0 0 0 0 0 0                   | endmember flags.

0    1    .1 0                      | range and resolution of X(SiO2), 0 => cartesian subdivision/1 => asymmetric subdivision
0    .5   .1 0                      | range and resolution of X(SiO)
0    .5   .1 0                      | range and resolution of X(Si)
0    .5   .1 0                      | range and resolution of X(O2)
0    .5   .1 0                      | range and resolution of X(O)
0    .5   .1 0                      | range and resolution of X(MgO)
| 0    .5   .1 0                      | range and resolution of X(Mg)
|0    .5   .1 0                      | range and resolution of X(FeO)

ideal

  1                                 | molecular configurational entropy model
7 1                                 | 6 species, multiplicity 1

z(SiO2)  = 1 SiO2
z(SiO)   = 1 SiO
z(O2)   = 1 O2
z(O)   = 1 O
| z(Mg)  = 1 Mg
| z(Fe)  = 1 Fe
z(FeO) = 1 FeO
z(MgO) = 1 MgO

end_of_model
                          --------------------------------------------------------
begin_model
                                  Silicate gas, Lewis and Randal (Ideal) Mixing, the
                                  EoS used for the pure species is determined by the
                                  EoS flag specified for the species in the thermodynamic
                                  data file
CCO-vapor
abbreviation gas
full_name    gas

2

7                                    number of endmembers
                                    | ENDMEMBER NAMES:
CO2
CO
O2
| xO(g)
xMgO(g)
xMg(g)
xFeO(g)
xFe(g)

0 0 0 0 0 0 0 0 0                   | endmember flags.

0    1    .1 0                      | range and resolution of X(CO2), 0 => cartesian subdivision/1 => asymmetric subdivision
0    1    .1 0                      | range and resolution of X(CO)
0    .5   .1 1                      | range and resolution of X(O2)
|0    .5   .1 1                      | range and resolution of X(O)
0    .5   .1 1                      | range and resolution of X(MgO)
0    .5   .1 1                      | range and resolution of X(Mg)
0    .5   .1 1                      | range and resolution of X(FeO)

ideal

  1                                 | molecular configurational entropy model
7 1                                 | 6 species, multiplicity 1

z(CO2)  = 1 CO2
z(CO)   = 1 CO
z(O2)   = 1 O2
| z(O)   = 1 xO(g)
z(Mg)  = 1 xMg(g)
z(Fe)  = 1 xFe(g)
z(FeO) = 1 xFeO(g)

end_of_model
                          --------------------------------------------------------
begin_model
                                  Formally this need not be an ideal gas, but it assumes Lewis and Randall
                                  (Ideal) mixing, the EoS (e.g., ideal gas) used for the pure species is
                                  determined by the EoS flag specified for the species in the thermodynamic
                                  data file
ideal_gas
abbreviation gas
full_name    gas

2                                   | model type
9                                   | number of species
                                    | species
O2(g)
O(g)
CO
CO2
SiO(g)
Mg(g)
Fe(g)
FeO(g)
MgO(g)

0 0 0 0 0 0 0 0 0                         | endmember flags.

0    1    .1 0                      | range and resolution of X(O2), 0 => cartesian subdivision/1
0    1    .1 0                      | range and resolution of X(O)
0    1    .1 0                      | range and resolution of X(Mg)
0    1    .1 0                      | range and resolution of X(Fe)
0    1    .1 0                      | range and resolution of X(MgO)
0    1    .1 0                      | range and resolution of X(Mg)
0    1    .1 0                      | range and resolution of X(Fe)
0    1    .1 0                      | range and resolution of X(MgO)

ideal

  1                                 | molecular configurational entropy model
9 1                                 | 6 species, multiplicity 1

z(O2)  = 1 O2(g)
z(O)   = 1 O(g)
z(Mg)  = 1 Mg(g)
z(Fe)  = 1 Fe(g)
z(FeO) = 1 FeO(g)
z(CO)  = 1 CO
z(CO2) = 1 CO2
z(SiO) = 1 SiO(g)

end_of_model
                                  --------------------------------------------------------
begin_model
FeSiC-BCC
abbreviation BCC
full_name    alloy
30                                | model type: special prismatic (Lacaze & Sundman, 1991)
2                                 | number of independent mixing sites, reciprocal solution
2  2                              | Fe-Si on site 1, Vacancy-C on site 2
Fe-BCC Si-BCC                     | endmember names
FeC-BCC SiC-BCC
0                                 | number of dependent endmembers
0  0  0  0                        | endmember flags
0   1     .1  0                   | imod = 0 -> Fe fraction on site 1
0   1     .1  0                   | imod = 0 -> vacancy fraction on site 2
ideal                             | internal excess model
0                                 | 0 site entropy model -> internal model
reach_increment 3
end_of_model
                           --------------------------------------------------------
begin_model
FeSiC-FCC
abbreviation FCC
full_name    alloy
31                                | model type: special prismatic (Lacaze & Sundman, 1991)
2                                 | number of independent mixing sites, reciprocal solution
2  2                              | Fe-Si on site 1, Vacancy-C on site 2
Fe-FCC Si-FCC                     | endmember names
FeC-FCC SiC-FCC
0                                 | number of dependent endmembers
0  0  0  0                        | endmember flags
0   1     .1  0                   | imod = 0 -> Fe fraction on site 1
0   1     .1  0                   | imod = 0 -> vacancy fraction on site 2
ideal                             | internal excess model
0                                 | 0 site entropy model -> internal model
reach_increment 3
end_of_model
                           --------------------------------------------------------
begin_model
                           |FeCr-liquid solution model after Xiong et al., 2011
                           |G. Helffrich, April 2016
FeCr(liq)
abbreviation Liq
full_name    liquid
2                          |model type: simplicial composition space.
2                          |2 endmembers
Fe_LIQ
Cr_LIQ
  0  0                     |endmember flags
0      1        .1     0   |imod = 0 -> cartesian subdivision
begin_excess_function
Wk(Cr_LIQ Fe_LIQ)
w0 = 0  wT = -5.983
w0 = -384.41
end_excess_function
1                                     1 site entropy model
2 1                                   2 species, site multiplicity = 1.
z(Fe) = 1 Fe_LIQ
reach_increment 3
end_of_model
                           --------------------------------------------------------
begin_model
                           |FeCr-FCC solution model after Xiong et al., 2011
                           |G. Helffrich, April 2016
FeCr-FCC
abbreviation FCC
full_name    alloy
2                          |model type: simplicial composition space.
2                          |2 endmembers
Fe-FCC
Cr-FCC
0  0                       |endmember flags
0      1        .1     0   |imod = 0 -> cartesian subdivision
begin_excess_function
Wk(Cr-FCC Fe-FCC)
w0 = 28871.89 wT = -22.318
w0 = 32711.42 wT = -18.180
end_excess_function
1                            1 site entropy model
2 1                          2 species, site multiplicity = 1.
z(Fe) = 1 Fe-FCC

reach_increment 3

end_of_model
                           --------------------------------------------------------
begin_model
                           |BCC Fe-Cr alloy after Xiong et al., 2011, with the contribution from magnetic ordering
FeCr-BCC
abbreviation BCC
full_name    alloy
32                         |special solution model
2                          |2 end-members
Fe-BCC
Cr-BCC
0 0
0    1     .1 0            |compositional limits and subdivision scheme
ideal

0

reach_increment 3

end_of_model
                           --------------------------------------------------------
begin_model
                           |FeCr-sigma solution model after Andersson & Sundman,
                           |1987, which is based on 30 sites and mixing on 18.
                           |This source defines no excess mixing for the soln.,
                           |but it is needed to stabilize the sigma phase.  One
                           |cause might be use of the Xiong et al. (2011) for
                           |BCC Fe-Cr.  As it is, this frankenstein-like mix
                           |of parts from Andersson & Sundman '87 and Xiong
                           |et al. '11 works concisely to reproduce the
                           |subsolidus and melting relations.
                           |                        G. Helffrich, ELSI, 8 Apr. 2016.
FeCr-s
abbreviation Sigma
full_name    alloy
2                          |solution model type
2                          |2 endmembers
FeCr_sig
CrFe_sig
0  0                       |endmember flags
0      1        .1     0   |imod = 0 -> cartesian subdivision
begin_excess_function
W(FeCr_sig CrFe_sig)       -1936.273 -0.5671667 0 | original from Nastia: -11617.64  -3.403  0
end_excess_function
1                          |1 site entropy model
| Nastia's version: 2 0.5333                   |2 species, 1 site multiplicity = 16/30
2 0.6                      |2 species, 1 site, multiplicity = 18/30
z(Fe) = 1  FeCr_sig
reach_increment 3
end_of_model
                           --------------------------------------------------------
begin_model
                           |solution model parameters after Brosh, 2013
FeCliq
abbreviation Liq
full_name    liquid
2                          |solution model type: simplicial composition space
2                          |2 end-members
Feliq
Cliq
0 0                        |end-member flags
0  1   .1 0                |imod = 0 -> cartesian subdivision scheme
begin_excess_function
Wk(Feliq Cliq)
w0 = -124320  wT = 28.5  wP = -1.53d-1 wP1 = 6d4 wP2 = 2.3d-1
w0 = 19300
w0 = 49260    wT = -19.
end_excess_function
1                          |one site entropy model
2 1                        |two end-members mixing on one site and site multiplicity
z(Fe) = 1 Feliq            |site fraction of Fe on this site in terms of end-members

reach_increment 10

end_of_model
                           --------------------------------------------------------
begin_model
                           | solution model parameters after Brosh, 2013
FeCfcc
abbreviation FCC
full_name    alloy
2
2
FeA1
FeCA1
0 0
0  1   .1 0
begin_excess_function
Wk(FeA1 FeCA1)
w0 = -34671.
end_excess_function
1
2 1.
z(C) = 1 FeCA1

reach_increment 10

end_of_model
                           --------------------------------------------------------
begin_model
                           |solution model parameters after Brosh, 2013
FeCbcc
abbreviation BCC
full_name    alloy
2
2
FeA2
FeCA2
0 0
0  1   .1 0
begin_excess_function
Wk(FeA2 FeCA2)
w0 = 0  wT = -190
end_excess_function
1
2 3.
z(c) = 1 FeCA2
end_of_model
                    --------------------------------------------------------
begin_model

                    Ilmenite after White, RW, Powell, R, Holland, TJB & Worley, BA (2000, JMG), modified
                    as described by White et al (2014).

                    This version of this model is strictly for DS5, however it seems to function
                    in DS6. The version of this model that follows its current DS6 implementation as in 
                    THERMOCALC is named Ilm(DS6).

                    Green et al (2016) remark this modification "may be suspect" and use the original 2000 model,
                    i.e., that obtained by excluding geikielite.

                                                      A                B
                                                     _____________________

                                      Mutliplicity    1                1
                                                     _____________________

                                      1 oilm          Fe                Ti
                            Species:  2 dilm          TiFe              TiFe
                                      3 hem           Fe3+              Fe3+
                                      4 pnt           Mn                Ti
                                      5 geik          Mg                Ti

                     Previously present as a brute force model which did not allow the anti-ordered
                     ilmenite configuration. Re-formulated as standard o/d model to remove this
                     limitation; however, the model has been parameterized so that the ordered and
                     antiordered states are energetucally equivalent. JADC Jan 14, 2017.

                                  NOTES:

                               *  Requires that the endmember ilm_nol be created from the endmember ilm
                                  in the thermodynamic data file by eliminating the Landau transition from
                                  the ilm endmember, additionally the following make definitions must be
                                  present in the thermodynamic file.

                                  dilm = 1 ilm_nol
                                        | 1993  -2.1 0 => the TC DQF coeffecients, the values below are
                                        | smax*tc0*(q0^2-1/3*q0^6), -smax*q0^2, vmax*q0^2 + {DH,R*ln(4),0}
                                         15789.27763 -12.19977769 * T_K  .1836386612d-1 * P_bar

                               *  The ilm and ilm_nol endmembers should be excluded from calculations
                                  to avoid conflicts with this model.

                               *  For Mg and Mn solution this model differs from the Thermocalc version in
                                  that Mg and Mn are confined to the A-site, in contrast in Thermocalc the
                                  "equipartition" assumption is used to allocate Mg and Mn to the B-site in
                                  proportion to the Ferrous iron intersite partitioning. Consequently, this
                                  model predicts lower Mn and Mg solubility in ilmenite than the Thermocalc
                                  version of the model.

                                                                       JADC, Oct 29, 2011.

                               *  Added W(pnt oilm). Felix Gervais, Oct 29, 2011.

                               *  Corrected to count Ti in A-site configurational entropy. JADC, Jun 16, 2013.

                               *  Make definitions corrected from the raw thermocalc versions. JADC, Jun 19, 2013.

                               *  The geikielite and most of the pyrhophanite excess terms were accidentally deleted
                                  (by me) ca Feb 6, 2017 at the same time that the Ilm(W) and Ilm(WPH0) equivalents
                                  of Ilm(WPH) were deleted from this file. Correction courtesy of Bob Myhill and 
                                  the perplex discussion group (groups.io/g/PerpleX/topic/74420499). JADC, May 27, 2020.

Ilm(WPH)
abbreviation Ilm
full_name    ilmenite

6                          | model type
4                          | 4 endmembers
pnt
geik
hem
dilm

1                            | 1 ordered species:

oilm = 1 dilm   delta_g_of_ordering  = -15600 + 11.52565132 T_K

0 0 0  0                   | endmember flags

0    .5  .1 0              | subdivision range, X(pnt)
0    .5  .1 0              | subdivision range, X(geik)
0     1  .1 0              | subdivision range, X(hem)

begin_excess_function
W(oilm dilm)    15600
W(oilm hem)     26600
W(oilm geik)     4000
W(oilm pnt)      2000
W(dilm hem)     11000
W(dilm geik)     4000
W(dilm pnt)      2000
W(hem geik)     36000
W(hem pnt)      25000
W(geik pnt)      4000
end_excess_function

2                          | 2 site model

5 1                        | A - Fe2+ Mn Fe3+ Mg Ti
z(A,Mg)   = 1 geik
z(A,mn)   = 1 pnt
z(A,fe3+) = 1 hem
z(A,ti)   = 1/2 dilm

3 1                        | B - Fe3+ Ti4+ Fe2+
z(b,fe3+) = 1 hem
z(b,fe2+) = 1/2 dilm

refine_endmembers

end_of_model
                    --------------------------------------------------------
begin_model

                    Ilmenite after White, RW, Powell, R, Holland, TJB & Worley, BA (2000, JMG), modified
                    as described by White et al (2014).

                    As implemented in DS6, June 22, 2021.

                    Green et al (2016) remark this modification "may be suspect" and use the original 2000 model,
                    i.e., that obtained by excluding geikielite.

                                                      A                B
                                                     _____________________

                                      Mutliplicity    1                1
                                                     _____________________

                                      1 oilm          Fe                Ti
                            Species:  2 dilm          TiFe              TiFe
                                      3 hem           Fe3+              Fe3+
                                      4 pnt           Mn                Ti
                                      5 geik          Mg                Ti

                     Previously present as a brute force model which did not allow the anti-ordered
                     ilmenite configuration. Re-formulated as standard o/d model to remove this
                     limitation; however, the model has been parameterized so that the ordered and
                     antiordered states are energetucally equivalent. JADC Jan 14, 2017.

                                  NOTES:

                               *  Requires the endmembers ilm_nol and hem_nol (created from ilm and hem
                                  by eliminating their Landau transitions) be present in the thermodynamic 
                                  data file and additionally requires the following make definitions in the 
                                  the thermodynamic data file:

                                  dilm = 1 ilm_nol
                                        | 1993  -2.1 0 => the TC DQF coeffecients, the values below are
                                        | smax*tc0*(q0^2-1/3*q0^6), -smax*q0^2, vmax*q0^2 + {DH,R*ln(4),0}
                                        DQF(J/mol) = 15789.27763 -12.19977769 * T_K  .1836386612d-1 * P_bar

                                  dhem = 1 hem_nol
                                        DQF(J/mol)   = 9.5228d3   -  12.9377 T_K 

                                  at least as of 12/12/2019, this model corresponds to the THERMOCALC 
                                  implementation of Ilm(WPH) with DS6.

                                  JADC, June 23, 2021.

                               *  The ilm, hem, hem_nol and ilm_nol endmembers should be excluded from calculations
                                  to avoid conflicts with this model.

                               *  For Mg and Mn solution this model differs from the Thermocalc version in
                                  that Mg and Mn are confined to the A-site, in contrast in Thermocalc the
                                  "equipartition" assumption is used to allocate Mg and Mn to the B-site in
                                  proportion to the Ferrous iron intersite partitioning. Consequently, this
                                  model predicts lower Mn and Mg solubility in ilmenite than the Thermocalc
                                  version of the model.

                                                                       JADC, Oct 29, 2011.

                               *  Added W(pnt oilm). Felix Gervais, Oct 29, 2011.

                               *  Corrected to count Ti in A-site configurational entropy. JADC, Jun 16, 2013.

                               *  Make definitions corrected from the raw thermocalc versions. JADC, Jun 19, 2013.

                               *  The geikielite and most of the pyrhophanite excess terms were accidentally deleted
                                  (by me) ca Feb 6, 2017 at the same time that the Ilm(W) and Ilm(WPH0) equivalents
                                  of Ilm(WPH) were deleted from this file. Correction courtesy of Bob Myhill and 
                                  the perplex discussion group (groups.io/g/PerpleX/topic/74420499). JADC, May 27, 2020.

Ilm(DS6)
abbreviation Ilm
full_name    ilmenite

6                          | model type
4                          | 4 endmembers
pnt
geik
dhem
dilm

1                            | 1 ordered species:

oilm = 1 dilm   delta_g_of_ordering  = -15600 + 11.52565132 T_K

0 0 0  0                   | endmember flags

1d-3 .5  .1 1              | subdivision range, X(pnt)
1d-3 .2  .1 1              | subdivision range, X(geik)
0     1  .1 0              | subdivision range, X(hem)

begin_excess_function
W(oilm dilm)     15600
W(oilm dhem)     26600
W(oilm geik)      4000
W(oilm pnt)       2000
W(dilm dhem)     11000
W(dilm geik)      4000
W(dilm pnt)       2000
W(dhem geik)     36000
W(dhem pnt)      25000
W(geik pnt)       4000
end_excess_function

2                          | 2 site model

5 1                        | A - Fe2+ Mn Fe3+ Mg Ti
z(A,Mg)   = 1 geik
z(A,mn)   = 1 pnt
z(A,fe3+) = 1 dhem
z(A,ti)   = 1/2 dilm

3 1                        | B - Fe3+ Ti4+ Fe2+
z(b,fe3+) = 1 dhem
z(b,fe2+) = 1/2 dilm

refine_endmembers

end_of_model
                      --------------------------------------------------------
begin_model

        Majoritic garnet, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        * originally entered by Bob Myhill, 2018/02/13

        * reformulated as a prismatic + orphan (nagt) vertex model. JADC, May 10, 2018

        * added cnagt and fnagt and changed the orphan to maj. JADC, Nov 2, 2018.
        
        * Reformulated as a 2-polytope 688 format model. JADC, 9/19

                                                     ___________________
                           Prism I    5 maj           Mg           MgSi   independent
                                      7 cmmaj_d       Ca           MgSi   dependent

                                      6 fmaj_d        Fe           FeSi   dependent
                                     11 cfmaj_d       Ca           FeSi   dependent
                                                     ___________________
                           Prism II   3 gr            Ca           AlAl   independent
                                      1 py            Mg           AlAl   independent
                                      2 alm           Fe           AlAl   independent

                                      4 cnagt         Ca2/3Na1/3   AlSi   dependent
                                      4 nagt          Mg2/3Na1/3   AlSi   independent
                                      4 fnagt         Fe2/3Na1/3   AlSi   dependent
                                                     ___________________

                                     13 gfm           Mg           FeSi   ordered (same as gfm_d, above)

Gt(H)
abbreviation Gt
full_name    garnet

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and composite composition space subdivision schemes 
[maj]      0    1   .1  0 
[~maj]     by difference 
                                  | -------------------------------------------
                                  | Polytope 1
2                                 | number of simplices 
2 2                               | number of vertices on each simplex
maj      fmaj_d
cmmaj_d  cfmaj_d
                                  | First 2-simplex
X_Mg    0    1   .1  0            | X(1,1) is bulk Fe/M
X_Fe    by difference
                                  | Second 2-simplex
X_Ca    0    1   .1  0            | X(2,1) is Ca/[M+Ca] on M1
X_M     by difference
                                  | -------------------------------------------
                                  | Polytope 2
2                                 | number of simplices 
3 2                               | number of vertices on each simplex

cnagt_d  fnagt_d     nagt         | ternary 1
gr       alm         py           | ternary 2

                                  | First 3-simplex
X_Ca    0  1   .1  0              | range and resolution of X(1,1) => X(Ca) in the ternaries
X_Fe    0  1   .1  0              | range and resolution of X(1,2) => X(Fe) in the ternaries
X_Mg    by difference
                                  | second 2-simplex
X_NaGt  0  .3   .1  0             | range and resolution of X(2,1) => X(M-nagt)
X_MGt   by difference

begin_ordered_endmembers
gfm = 1 maj - 1/3 py + 1/3 alm  delta_g_of_ordering  = -10d3
end_ordered_endmembers 

begin_dependent_endmembers
fnagt_d = 1 nagt + 2/3 alm - 2/3 py
cnagt_d = 1 nagt + 2/3 gr  - 2/3 py
fmaj_d   = 1 gfm  + 1 alm   - 1 py
cmmaj_d  = 1 maj  + 1 gr    - 1 py
cfmaj_d  = 1 gfm  + 1 gr    - 1 py
end_dependent_endmembers

begin_excess_function
w(py alm)      3d3
w(py gr)      33d3
w(py maj)     15d3
w(py gfm)   13.5d3
w(py nagt)    14d3
w(alm gr)      5d3
w(alm maj)    18d3
w(alm gfm)  16.5d3
w(alm nagt) 11.2d3
w(gr maj)     48d3
w(gr gfm)   46.5d3
w(gr nagt)    30d3
w(maj gfm)   0.5d3
w(maj nagt)  8.5d3
w(gfm nagt)  7.0d3
end_excess_function

2                                     2 site entropy model

X                                   | site name
4 3 3                               | number of species, effective multiplicity, true multiplicity
z(Fe) = 1 alm
z(Ca) = 1 gr
z(Na) = 1/3 nagt
z(Mg) = 1 py + 1 maj + 1 gfm + 2/3 nagt     | added maj + gfm 7/3/20, JADC 

Y                                   | site name
4 2 2                               | number of species, effective multiplicity, true multiplicity
z(Mg) = 1/2 maj
z(Fe) = 1/2 gfm
z(Si) = 1/2 maj + 1/2 gfm + 1/2 nagt
z(Al) = 1 gr + 1 alm + 1 py + 1/2 nagt

[Si3O12]                            | formula suffix, enter "none" for no suffix.

end_of_model
                      --------------------------------------------------------
begin_model
        Ferropericlase, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035
        [Bob Myhill, 2018/02/13]

        Notes:
        This model consists of symmetric mixing of Mg-Fe on 1 site with a multiplicity of 1

Fper(H)
abbreviation Fper
full_name    ferropericlase

2                                     model type: Margules, macroscopic
2                                     2 endmembers
per       fper
  0  0
0    1    .1 0

begin_excess_function
W(per fper)  18d3
end_excess_function

1                                     1 site entropy model

2 1                                   2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model
                      --------------------------------------------------------
begin_model

        MgSi perovskite, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        [Bob Myhill, 2018/02/13]

        Notes:
        Identical to CaSi perovskite, but with different dqfs for all the endmembers

        Requires the following make definitions in the endmember data file:

             mfpv = 1 fpv
                  DQF(J/mol) = -9500
             mcpv = 1 cpv
                  DQF(J/mol) = 60000
             mnpv = 1 npv
                  DQF(J/mol) = 16000

        This model consists of symmetric mixing on 2 sites, each with a multiplicity of 1:

                                                      1           2
                                                      M1          M2
                                                     ________________

                                      Multiplicity    1           1
                                                     ________________

                                      1 mpv           Mg           Si
                            Species:  2 mfpv          Fe2+         Si
                                      3 mcpv          Ca           Si
                                      4 apv           Al           Al
                                      5 mnpv          Na1/2Al1/2   Si

Mpv(H)
abbreviation Mpv
full_name    MgSi Perovskite

2                                 | model type: Margules, macroscopic
5                                 | 5 endmembers

mpv mfpv mcpv apv mnpv
  0   0   0   0   0               | endmember flags

0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision

begin_excess_function
w(mpv mfpv)    12d3
w(mpv mcpv)    15d3
W(mpv apv)     20d3
W(mpv mnpv)    22d3
w(mfpv mcpv) 10.5d3
W(mfpv apv)    14d3
W(mfpv mnpv) 15.4d3
W(mcpv apv)     5d3
W(mcpv mnpv)  7.5d3
W(apv mnpv)   2.5d3
end_excess_function

2                                     2 site entropy model

5 1                                   5 species, M1 site multiplicity 1
z(Mg) = 1 mpv
z(Fe) = 1 mfpv
z(Ca) = 1 mcpv
z(Na) = 1/2 mnpv

2 1                                   2 species, M2 site multiplicity 1
z(Al) = 1 apv

end_of_model
                      --------------------------------------------------------
begin_model
        CaSi perovskite
        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035
        [Bob Myhill, 2018/02/13]

        Notes:
        Identical to MgSi perovskite, but with different dqfs for all the endmembers

        Requires the following make definitions in the endmember data file:
             cmpv = 1 mpv
                    DQF(J/mol) = 35000
             cfpv = 1 fpv
                    DQF(J/mol) = 24000
             capv = 1 apv
                    DQF(J/mol) = 45000
             cnpv = 1 npv
                    DQF(J/mol) = 25000

                                                      1           2
                                                      M1          M2
                                                     ________________

                                      Multiplicity    1           1
                                                     ________________

                                      1 cmpv          Mg           Si
                            Species:  2 cfpv          Fe2+         Si
                                      3 cpv           Ca           Si
                                      4 capv          Al           Al
                                      5 cnpv          Na1/2Al1/2   Si

Cpv(H)
abbreviation Cpv
full_name    CaSi Perovskite

2                                 | model type: Margules, macroscopic
5                                 | 5 endmembers

cmpv cfpv cpv capv cnpv
  0   0   0   0   0               | endmember flags

0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision

begin_excess_function
W(cmpv cfpv)    12d3
W(cmpv cpv)     15d3
W(cmpv capv)    20d3
W(cmpv cnpv)    22d3
W(cfpv cpv)   10.5d3
W(cfpv capv)    14d3
W(cfpv cnpv)  15.4d3
W(cpv capv)      5d3
W(cpv cnpv)    7.5d3
W(capv cnpv)   2.5d3
end_excess_function

2                                     2 site entropy model

5 1                                   5 species, M1 site multiplicity 1
z(Mg) = 1 cmpv
z(Fe) = 1 cfpv
z(Ca) = 1 cpv
z(Na) = 1/2 cnpv

2 1                                   2 species, M2 site multiplicity 1
z(Al) = 1 capv

end_of_model
                      --------------------------------------------------------
begin_model
        Corundum
        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035
        [Bob Myhill, 2018/02/13]

        Notes:
        Requires the following make definition in the endmember data file:
             fcor = 1 mcor + 1 fak - 1 mak
                    DQF(J/mol) = -15d3

                                                      1       2
                                                      M       T
                                                     _____________

                                      Multiplicity    1       1
                                                     _____________

                                      1 cor           Al      Al
                            Species:  2 mcor          Mg      Si
                                      3 fcor          Fe2+    Si
Cor(H)
abbreviation Cor
full_name    Corundum

2                                 | model type: Margules, macroscopic
3                                 | 3 endmembers
cor   mcor   fcor
  0  0  0
0  1    .1 0
0  1    .1 0

begin_excess_function
W(cor mcor)     12d3
W(cor fcor)     10d3
W(mcor fcor)    4d3
end_excess_function

2                                     2 site entropy model
3 1                                   3 species on M site multiplicity = 1.
z(mg) = 1 mcor
z(fe) = 1 fcor
2 1                                   2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model

        High pressure calcium-ferrite structure phase, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        Notes:

        * originally entered by Bob Myhill, 2018/02/13.

        * reformulated as a prismatic + orphan vertex model. JADC, 10/5/2018

        * eliminated ordered dependent endmembers. JADC, 10/2018

        * Requires the following make definition in the endmember data file
             nacfb = 1 nacf
                   DQF(J/mol) = -9000
          This dqf was presumably added by Holland et al. as a free parameter
          during inversion, and not reintegrated into their data table.

        * The M2 site has a fake multiplicity of 1 (true multiplicity would be 2).

                                                      M3      M2
                                                     ____________

                                      Multiplicity    1       1(2)
                                                     ____________

                        Prism I:      1 macf          Mg      AlAl  independent
                                      5 mscf          Mg      MgSi  independent
                                      7 cscf_d        Ca      MgSi  dependent

                                      2 facf_d        Fe      AlAl  dependent
                                     10 fscf          Fe      FeSi  independent
                                     11 cfscf_d       Ca      FeSi  dependent
                                                     ____________
                        Orphans:
                                      3 cacf          Ca      AlAl  independent
                                      4 nacfb         Na      AlSi  independent (orphan)
                                                     ____________

                            Ordered: 13 oscf          Fe2+    MgSi  (same as oscf_d above)

CFer(H)
abbreviation CFer
full_name    Ca-ferrite type

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and composite composition space subdivision schemes 
[~M]   0    1   .1  0             | subdivision range for X(1) = M-free
[M]    by difference
                                  | -------------------------------------------
                                  | Polytope 1 [~M]
1                                 | number of simplices 
2                                 | number of vertices on the simplex
nacfb   cacf

X_Na   0  1   .1  0               | range and resolution of X(nacfb/[nacfb+cacf])
X_Ca   by difference
                                  | -------------------------------------------
                                  | Polytope 2  [M]
2                                 | number of simplices 
3 2                               | number of vertices on each simplex
macf    cscf_d   mscf
facf_d  cfscf_d  fscf
                                  | First 3-simplex
X_Al   0  1   .1  0               | range and resolution of X(AlAl)
X_Ca   0  1   .1  0               | range and resolution of X(CaM)
X_M    by difference
                                  | second 2-simplex
X_Mg   0  1   .1  0               | range and resolution of X(Mg)
X_Fe   by difference 

begin_ordered_endmembers
oscf = 1/2 mscf + 1/2 fscf delta_g_of_ordering  = -3.5d3
end_ordered_endmembers 

begin_dependent_endmembers
facf_d  = 1 macf + 1 oscf - 1 mscf
cscf_d  = 1 cacf + 1 mscf - 1 macf
cfscf_d = 1 cacf + 1 fscf - 1 macf - 1 oscf + 1 mscf
end_dependent_endmembers

begin_excess_function
w(macf cacf)       11d3
w(macf mscf)      7.5d3
w(macf fscf)    10.75d3
w(macf oscf)     11.5d3
w(macf nacfb)    24.5d3

w(cacf mscf)     18.5d3
w(cacf fscf)    14.45d3
w(cacf oscf)     15.2d3
w(cacf nacfb)    18.5d3

w(mscf fscf)        5d3
w(mscf oscf)        4d3
w(mscf nacfb)    15.5d3

w(fscf oscf)        1d3
w(fscf nacfb)    9.95d3

w(oscf nacfb)    10.7d3
end_excess_function

2                                   | 2 site entropy model (M1, M2)

M1                                  | site name
4 1 1                               | 4 species on M1, site multiplicity of 1
z(Ca) = 1 cacf
z(Fe) = 1 fscf + 1 oscf
z(Na) = 1 nacfb
z(Mg) = 1 macf + 1 mscf

M2                                  | site name
4 1 2                               | 4 species on M2, (fake) site multiplicity of 1
z(Al) = 1 macf + 1 cacf + 1/2 nacfb
z,Mg) = 1/2 mscf + 1/2 oscf
z(Fe) = 1/2 fscf
z(Si) = 1/2 mscf + 1/2 oscf + 1/2 fscf + 1/2 nacfb

[O4]                                | formula suffix, enter "none" for no suffix.

end_of_model
                      --------------------------------------------------------
begin_model

        NAL phase, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        Notes:
                      Originally entered by Bob Myhill, 2018/02/13.

                      The M1 site has a fake multiplicity of 3 (6 apfu)

                      Eliminated ordered dependent endmembers. JADC, 10/2018.

                      Converted to 688 format. JADC, 3/7/2020.

                                                      M3      M2      M1
                                                     ___________________

                                      Multiplicity    1       2       3*(6)
                                                     ___________________

                                      1 nanal          Na      Mg     Al5/6Si1/6     independent
                                      3 canal          Ca      Mg     Al             independent
                                      5 manal          Mg      Mg     Al             independent
                                      9 msnal          Mg      Mg     Mg1/2Si1/2     independent

                                      2 nfnal_d        Na      Fe2+   Al5/6Si1/6     dependent
                                      4 cfnal_d        Ca      Fe2+   Al             dependent
                                      8 fanal_d        Fe2+    Fe2+   Al             dependent
                                     16 fsnal          Fe2+    Fe2+   Fe1/2Si1/2     independent
                                                     ___________________

                            Ordered:  9 o1nal          Fe2+    Mg     Mg1/2Si1/2      ordered
                                     10 o2nal          Fe2+    Fe2+   Mg1/2Si1/2      ordered

NAl(H)
abbreviation NAl
full_name    New aluminous phase

688                                | model type: 688 format standard model
 
1                                  | number of prisms
                                   | ----------------------------
2                                  | number of simplices in the prism
2 4                                | number of vertices on each simplex

nanal    nfnal_d
canal    cfnal_d
manal    fanal_d
msnal    fsnal

X_MgM2  0  1   .1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision
X_FeM2  by difference

X_NAM13 0  1   .1  0              | range and resolution for X(nanal) on site 2, imod = 0 -> cartesian subdivision
X_CAM13 0  1   .1  0              | range and resolution for X(canal) on site 2, imod = 0 -> cartesian subdivision
X_MAM13 0  1   .1  0              | range and resolution for X(manal) on site 2, imod = 0 -> cartesian subdivision
X_MSM13 by difference

begin_ordered_endmembers
o1nal = 5/6 msnal + 1/6 fsnal  delta_g_of_ordering  = 2d3
o2nal = 1/2 msnal + 1/2 fsnal  delta_g_of_ordering  = 6.5d3
end_ordered_endmembers

begin_dependent_endmembers
nfnal_d   = 1 nanal - 1 o1nal + 1 o2nal     | NM - FM + FF = NF
cfnal_d   = 1 canal - 1 o1nal + 1 o2nal     | CM - FM + FF = CF
fanal_d   = 1 manal - 1 msnal + 1 o2nal     | MM - MM + FF = FF
end_dependent_endmembers

begin_excess_function
W(nanal canal)          14.2d3
W(nanal manal)          20.2d3
W(nanal msnal)          20.2d3
W(nanal fsnal)          21.2d3
W(nanal o1nal)          15.4d3
W(nanal o2nal)          23.4d3
W(canal manal)            11d3
W(canal msnal)          33.5d3
W(canal fsnal)            36d3
W(canal o1nal)          30.2d3
W(canal o2nal)          38.2d3
W(manal msnal)          22.5d3
W(manal fsnal)          32.2d3
W(manal o1nal)          26.5d3
W(manal o2nal)          34.5d3
W(msnal fsnal)            15d3
W(msnal o1nal)             4d3
W(msnal o2nal)            12d3
W(fsnal o1nal)            11d3
W(fsnal o2nal)             3d3
W(o1nal o2nal)             8d3
end_excess_function

3                          | 3 site (M3, M2, M1) entropy model
                           | (note: occupancies should not include dependent endmembers,
                           |  but do include ordered endmembers)

M3
4 1 1                      | 4 species on M3, effective site multiplicity, true multiplicity
z(Na,M3)    = 1 nanal
z(Ca,M3)    = 1 canal
z(Mg,M3)    = 1 manal + 1 msnal
z(Fe,M3)    = 1 fsnal + 1 o2nal + 1 o1nal

M2
2 2 2                      | 2 species on M2, effective site multiplicity, true multiplicity
z(Fe,M2)   = 1 fsnal + 1 o2nal
z(Mg,M2)   = 1 nanal + 1 canal + 1 manal + 1 msnal + 1 o1nal

M1
4 3 6                      | 4 species on M1, effective site multiplicity, true multiplicity
z(Mg,M1)   = 1/2 msnal + 1/2 o1nal + 1/2 o2nal
z(Fe,M1)   = 1/2 fsnal
z(Al,M1)   = 5/6 nanal + 1 canal + 1 manal
z(Si,M1)   = 1/6 nanal + 1/2 fsnal + 1/2 msnal + 1/2 o1nal + 1/2 o2nal

[look-it-up]               | formula suffix, enter "none" for no suffix.

end_of_model
                      --------------------------------------------------------
begin_model

        Akimotoite, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        [Bob Myhill, 2018/02/13]

        mixing on 2 sites, each with a fake site multiplicity of 1/2 (Al-avoidance).
        Note that this is different to the corundum model, which is assumed to mix on
        two independent sites.
        The properties of the aak endmember are assumed identical to corundum (cor):

                                                      1       2
                                                      M       T
                                                     _____________

                                      Multiplicity    1/2*(1)  1/2*(1)
                                                     _____________

                                      1 cor           Al      Al
                            Species:  2 mak           Mg      Si
                                      3 fak           Fe2+    Si
Aki(H)
abbreviation Aki
full_name    Akimotoite

2                                 | model type: Margules, macroscopic
3                                 | 3 endmembers
cor   mak   fak
  0  0  0
0  1    .1 0
0  1    .1 0

begin_excess_function
W(cor mak)    8d3
W(cor fak)    6d3
W(cor fak)    4d3
end_excess_function

2                                     2 site entropy model
3  .5                                  3 species on M site with fake multiplicity = 1/2
z(mg) = 1 mak
z(fe) = 1 fak
2  .5                                  2 species on T site with fake multiplicity = 1/2
z(al) = 1 cor

end_of_model
                      --------------------------------------------------------
begin_model

        Wadsleyite

        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035
        [Bob Myhill, 2018/02/13]

        Notes:
        mixing of Mg-Fe on 1 site with a multiplicity of 2

Wad(H)
abbreviation Wad
full_name    wadsleyite

2                                     model type: Margules, macroscopic
2                                     2 endmembers
mwd       fwd
0  0                                | endmember flags

0    1    .1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(mwd fwd) 13000
end_excess_function

1                                     1 site entropy model

2 2                                   2 species, site multiplicity = 2
z(fe) = 1 fwd

end_of_model
                      --------------------------------------------------------
begin_model

        Ringwoodite

        Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035
        [Bob Myhill, 2018/02/13]

        Notes:
        mixing of Mg-Fe on 1 site with a multiplicity of 2

Ring(H)
abbreviation Ring
full_name    ringwoodite

2                                     model type: Margules, macroscopic
2                                     2 endmembers
mrw       frw
0  0                                | endmember flags

0    1    .1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(mrw frw) 4000
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(fe) = 1 frw

end_of_model
                      --------------------------------------------------------
begin_model

        High pressure C2/c clinopyroxene, Holland et al., 2013; dx.doi.org/10.1093/petrology/egt035

        Notes:

                      Originally entered by Bob Myhill, 2018/02/13

                      Eliminated ordered dependent endmembers. JADC, 10/2018.

                      To use this the following endmembers must be specified with make
                      definitions in the endmember data file

                      hmgts  = 1 mgts + 1 hen - 1 en
                            DQF = -1000
                      odi  = 1 di
                            DQF = -100 + 0.211 * T_K + 0.005 * P_bar

                                                      M1      M2     T
                                                     _____________________

                                      Multiplicity    1       1      1/2
                                                     _____________________

                                        hen           Mg      Mg     SiSi      independent
                            Species:    odi           Mg      Ca     SiSi      independent
                                        hmgts         Al      Mg     SiAl      independent

                            Species:    hfs           Fe      Fe     SiSi      independent
                                        tsfs_d        Al      Fe     SiAl      dependent
                                        ofdi_d        Fe      Ca     SiSi      dependent
                                                      _____________________

                           Internal:    hfm           Mg      Fe     SiSi

Hpx(H)
abbreviation Hpx
full_name    HP_clinopyroxene

8                          | model type: Reciprocal with speciation

2                          | 2 independent composition spaces
3 2                        | 3 dimensions on first space, 2 on second

                           | endmembers:
hen    odi      hmgts
hfs    tsfs_d   ofdi_d

1                          | ordered species definition

hfm = 1/2 hen + 1/2  hfs  Delta(enthalpy) = -6d3

2                          | dependent endmember definitions

ofdi_d  = 1 odi   + 1 hfs   - 1 hfm
tsfs_d  = 1 hmgts + 1 hfm   - 1 hen


0 0 0 0 0 0 0 0 0          | endmember flags, indicate if endmember is part of the solution (i.e. iend = 0).

0  1  .1   0               | subdivision model for (ternary) site 1 (X_en):
0  1  .1   0               | subdivision model for (ternary) site 1 (X_di):

0  1  .1   0               | subdivision model for (binary) site 2 (XMg):

begin_excess_function
W(hen hfs)        5.2d3
W(hen hfm)          4d3
W(hen odi)       32.2d3  0   0.12
W(hen hmgts)       13d3  0  -0.15

W(hfs hfm)          4d3
W(hfs odi)         24d3
W(hfs hmgts)        7d3  0  -0.15

W(hfm odi)         18d3
W(hfm hmgts)        2d3  0  -0.15

W(odi hmgts)    75.4d3  0  -0.94
end_excess_function

3                        | 3 site (M1, M2, T) configurational entropy model

3 1                      | 3 species on M1, 1 site per formula unit.
z(m1,fe)   = 1 hfs
z(m1,al)   = 1 hmgts

3 1                      | 3 species on M2, 1 site per formula unit.
z(m2,ca) = 1 odi
z(m2,fe) = 1 hfs + 1 hfm

2  .5                    | 2 species on  .5 T sites (true multiplicity = 2)
z(t,al) = 1/2 hmgts


begin_van_laar_sizes
alpha(hen)     1
alpha(hfs)     1
alpha(hfm)     1
alpha(odi)    1.2
alpha(hmgts)   1
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model

                              Pyrrhotite, Saxena & Eriksson 2015
                              ECRG, 5/2018

Po(SE)                       | solution name.
abbreviation Po
full_name    hT-pyrrhotite

2                            | model type: Compound energy formalism
2                            | number of endmembers
APyrr
SVa

0 0                          | endmember flags

0  1  .1 0                   | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
Wk(APyrr SVa)
w0 = -225830.67  wT = 26.357836  wP0 = -0.400228
end_excess_function
                             | wP0 is a coefft of P
1                            | 1 site entropy model
2 1                          | 2 species, site multiplicity of 1
z(SVa) = 1 SVa

end_of_model
                      --------------------------------------------------------
begin_model
                              FeS-S fluid, Saxena & Eriksson 2015
                              ECRG, 5/2018
FeS_liq
abbreviation Melt
full_name    liquid

42                           | model type: modified QC with composition-dependent coordination, binary only.
2                            | no. independent end-members
FeLiq SLiq                   | endmember names

0 0                          | endmember flags

0  1  .1 0                   | subdivision range, imod = 0 -> cartesian subdivision

                             | model has an excess  function and configurational entropy
ideal

0                            | entropy function is hard-wired

end_of_model
                      --------------------------------------------------------
begin_model
                             Talc, ideal.

                                                      1       2
                                                      M1      M2       T2
                                                     ______________________

                                      Mutliplicity    2       1         2
                                                     ______________________

                                      1 en            Mg      Mg       SiSi
                            Species:  2 fs            Fe      Fe       SiSi
                                      3 mgts          Mg      Al       AlSi
                                                      ______________________

                             reformulated from relict equipartion (model type 7) to simplicial
                             composition space (model type 2).

                             JADC 5/10/2018

T                          | solution name
abbreviation Tlc
full_name    talc

2                          | model type: simplicial, equipartition relict
3                          | number of independent endmembers

ta    fta    tats          | endmember names

0 0 0                      | endmember flags, indicate if the endmember is part of the solution.

0   1   .1  0              | range and resolution for ta, imod = 0 -> cartesian subdivision
0   1   .1  0              | range and resolution for fta, imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M1, M2, T2) conigurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit.

z(m1,mg) = 1 ta + 1 tats

2 2.                       | 2 species on T2, 2 sites per formula unit.

z(t2,al) = 1/2 tats

3 1                        | 3 species on M2, 1 site per formula unit.

z(m2,mg) = 1 ta
z(fe,m2) = 1 fta

end_of_model
                      --------------------------------------------------------
begin_model
                             Antigorite with Tschermak's substitution (Padrn-Navarta et al., 2013, Lithos)

                             reformulated from relict equipartion (model type 7) to simplicial
                             composition space (model type 2).

                             JADC 5/10/2018

                                                      M0      M1       T1
                                                     ______________________

                                      Mutliplicity    44       4         8
                                                     ______________________

                                      1 atg          Mg      Mg       SiSi
                            Species:  2 fatg         Fe      Fe       SiSi
                                      3 atgts        Mg      Al       AlSi
                                                      ______________________


                             This model requires the following make definition in the thermodynamic data file:

                                atgts = 4 clin + 9/17 atg - 24/17 br
                                -2e3. 46.1 0

Atg(PN)                    | solution name
abbreviation Atg
full_name    serpentine

2                          | model type: simplicial composition space, equipartition relict
3                          | number of endmembers
atg      fatg   atgts      | endmember names, this order implies:
0 0 0                      | endmember flags, indicate if the endmember is part of the solution.

0  1  .1  0                | range and resolution for atg, imod = 0 -> cartesian subdivision
0  1  .1  0                | range and resolution for ftag, imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M0, M1, T1) configurational entropy model

2 44.                      | 2 species on M0, 2 sites per formula unit.

z(m1,mg) = 1 atg + 1 atgts

2 8.                       | 2 species on T1, 2 sites per formula unit.

z(t2,al) = 1/2 atgts

3 4.                       | 3 species on M1, 1 site per formula unit.

z(m2,mg) = 1 atg
z(fe,m2) = 1 fatg

reach_increment 0

end_of_model
                      --------------------------------------------------------
begin_model
                            Amphibole from Massonne & Willner (EJM, 2008)
                            See notes for TrTsPg (above).
GlTrTsMr
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quaternary
tr       ftr
mrie     fmrie_i
ts       fts_i
gl       fgl_i

3                          | number of dependent endmembers

fmrie_i = 1 mrie + 3/5 ftr  - 3/5 tr
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr

0 0 0 0 0 0 0 0            | endmember flags.

0  1    .1 0               | range and resolution for X(Mg) on site 1

0  1    .1 0               | range and resolution for X(tr) on site 2
0  1    .1 0               | range and resolution for X(pg) on site 2
0  1    .1 0               | range and resolution for X(ts) on site 2

begin_excess_function
W(gl tr)     77d3
W(gl ftr)    83d3
W(ts tr)     20d3
W(ts ftr)   -38d3
W(tr ftr)    10d3
end_excess_function

4                          | 4 site (M1, M2, M4, T1) entropu model

2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 0 + 1 ts

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 0 + 1 tr + 1 ts + 1 mrie + 1 gl

3 2.                       | 3 species on M2, 2 sites pfu
z(m2,mg) = 0 + 1 tr
z(m2,fe) = 0 + 1 ftr

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 0 + 1 gl

begin_dqf_corrections
dqf(ts) 10000 0 0
end_dqf_corrections

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without Na, K, Ti or Mn solution.

                             See Amph(DHP) or bAmph(DHP) for Na-Ca amphibole

                                      JADC 5/5/06.

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________

                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts           Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets         Vac       Fe      Fe3+   Ca      Al_Si

                             fparg = parg + 4/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)

Ca-Amph(D)                 | solution name
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quinary
tr       ftr
parg     fparg_i
ts       fts_i
mfets    ffets_i

3                          | number of dependent endmembers

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr

0 0 0 0 0 0 0 0            | endmember flags.

0  1    .1  0             | range and resolution for X(Mg) on site 1

0  1    .1 0              | range and resolution for X(tr) on site 2
0  1    .1 0              | range and resolution for X(pg) on site 2
0  1    .1 0              | range and resolution for X(ts) on site 2

begin_excess_function
W(parg tr)  29.3d3
W(parg ts)  18.2d3
W(parg ftr) 11.4d3
W(ts tr)    20.8d3
W(tr ftr)   11.4d3
end_excess_function

4                          | 4 site (A, M1, M2, T1) entropy model

2 1                        | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg

2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg) = 1 tr + 1/2 parg
z(m2,fe) = 1 ftr
z(m2,fe3+) = 1 mfets

begin_dqf_corrections
dqf(ts) 10000
end_dqf_corrections

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without Ca, K, Ti or Mn solution.

                             This model requires a fgl endmember, created as
                             decribed by Powell's mdep paper.

                             See Amph(DHP) for Na-Ca amphibole

                                      JADC 5/5/06.

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________

                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl           Vac       Fe      Al     Na      Si_Si
                            12 mrieb         Vac       Mg      Fe3+   Na      Si_Si
                            11 rieb          Vac       Fe      Fe3+   Na      Si_Si

                             mrieb_i = 1 rieb + 3/5 tr - 3/5 ftr

Na-Amph(D)                 | solution name
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules

2                          | 2 site reciprocal solution

2 2                        | 2 binaries

gl       fgl
mrieb_i  rieb

1                          | number of dependent endmembers

mrieb_i = 1 rieb + 1 gl - 1 fgl

0 0 0 0                    | endmember flags.

0  1    .1   0             | range and resolution for X(Mg) on site 1
0  1    .1   0             | range and resolution for X(Al) on site 2

ideal

2                          | 2 site (M1, M2) entropy model

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 gl

2 2.                       | 2 species on M2, 2 sites pfu

z(m2,fe3+) = 1 rieb

site_check_override

end_of_model

begin_model
                      --------------------------------------------------------
begin_model
                             Ideal orthoamphibole, this model assumes Al is present
                             on only two tetrahedral sites and all five M2 sites.
                             I have no idea if this is correct!

                             fgedr endmember stoichiometry corrected, T. Wagner 2/18/06.


                                                      M1      M2        T
                                                     ______________________

                                      Mutliplicity    2       5         2
                                                     ______________________

                                      1 anth          Mg      Mg       SiSi
                            Species:  2 fanth         Fe      Fe       SiSi
                                      3 ged           Mg      Mg3Al2   AlAl
                                      4 fged          Fe      Fe3Al2   AlAl
                                                      ______________________


                           Dependent: fged = ged + 5/7*(fanth - anth)


o-Amph                     | solution name
abbreviation oAmph
full_name    orthoamphibole

7                          | model type: reciprocal, macroscopic

2                          | 2 site reciprocal solution

2  2                       | 2 species on each site

anth     fanth             | endmember names, this order implies:
ged      fged_i            | x(11)=x(mg); x(12) = x(fe); x(21) = x(si,t); x(22) = x(Al,t)

1                          | 1 dependent endmember:

fged_i = 1 ged + 5/7 fanth - 5/7 anth

0 0 0 0                    | endmember flags, indicate if the endmember is part of the solution.
0  1  .1             | range and resolution for X(Mg) on site 1
0                          | subdivision scheme on site 2: imod = 0 -> cartesian
0  1  .1              | range and resolution for 1-X(Tschermaks) on site 2
0                          | subdivision scheme on site 2: imod = 0 -> cartesian

ideal

3                          | 3 site (M1, M2, T) conigurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit.

z(m1,mg) = 1 anth + 1 ged

2 2.                       | 2 species on T, 2 sites per formula unit.

z(t,al) = 1 ged

3 1                        | 3 species on M2, 1 site per formula unit.

z(m2,mg) = 1 anth + 3/5 ged
z(m2,fe) = 1 fanth

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                                      tr-ts-parg non-ideal model for
                                      holland and powell. assumes 2 M2 sites are
                                      coupled to 4 T1 sites. site multiplicity
                                      of the T1 site is reduced to 2, this is
                                      suggested by HP98 to account for charge
                                      balance constraints. but doesn't make a lot
                                      of sense for the tr-parg mixing. assume
                                      Na on the A-site is coupled to Al on M2.

                                      JADC Nov, 98.

                                      HP Am Min 99, 84:1-14
                                      Oli Jagoutz revised april 9, 2002

                                      in contrast to the earlier version of TrTsPg
                                      this version assumes the A site is decoupled from M2

                                      JADC 4/03.

                             fparg = parg + 4/5 (ftr  - tr)
                             fgl   = gl   + 3/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)


GlTrTsPg                   | solution name
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quaternary
tr       ftr
parg     fparg_i
ts       fts_i
gl       fgl_i

3                          | number of dependent endmembers

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr

0 0 0 0 1 0 0 0           | endmember flags.

0  1    .1 0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0  1    .1 0              | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0  1    .1 0              | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision
0  1    .1 0              | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
                            | interaction parameters from
                            | White, Powell & Phillips (2003, JMG)
                            | and Wei, Powell, & Zhang (2003, JMG)
                            | compiled by D. Tinkham. JADC 11/03
W(parg gl)  80d3
W(parg tr)  30d3
W(parg ftr) 38d3
W(gl tr)    77d3
W(gl ftr)   83d3
W(ts tr)    20d3
W(ts ftr)  -38d3
W(tr ftr)   10d3
                            | earlier versions used (provenance unknown)

                            | W(ts parg) -25000.
                            | W(tr parg)  20000.
                            | W(tr ts)    38000
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model

2 1                        | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg

2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl

3 2.                       | 3 species on M2, 2 sites pfu
z(m2,mg) = 1 tr + 1/2 parg
z(m2,fe) = 1 ftr

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl

begin_dqf_corrections
dqf(ts) 10000
end_dqf_corrections

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________

                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts           Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl           Vac       Fe      Al     Na      Si_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets         Vac       Fe      Fe3+   Ca      Al_Si

                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without K, Ti or Mn solution.

                                      JADC 9/05.

                             fparg = parg + 4/5 (ftr  - tr)
                             fgl   = gl   + 3/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)

Amph(DHP)                  | solution name
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 5                        | 1 binary and 1 quinary
tr       ftr
parg     fparg_i
ts       fts_i
gl       fgl_i
mfets    ffets_i

4                          | number of dependent endmembers

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr

0 0 0 0 1 0 0 0 0 0        | endmember flags.

0  1    .1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0  1    .1  0              | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0  1    .1  0              | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision
0  1    .1  0              | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision
0  1    .1  0              | range and resolution for X(gl) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(parg gl)  84.5d3
W(parg tr)  29.3d3
W(parg ts)  18.2d3
W(parg ftr) 11.4d3
W(gl tr)    35.3d3
W(ts tr)    20.8d3
W(tr ftr)   11.4d3
W(gl ftr)   15d3
W(gl ts)    15d3
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model

2 1                        | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg

2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg)   = 1 tr + 1/2 parg
z(m2,fe)   = 1 ftr
z(m2,fe3+) = 1 mfets

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl

begin_dqf_corrections
dqf(ts) 10000
end_dqf_corrections

reach_increment 1

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                             Dale et al, JMG 2005 23:771-791 amphibole model.

                             JADC, 11/05.

                             Margules parameters corrected from
                                      W(gl ftr)     393d3
                                      W(gl mfets)   459d3
                                      W(ftr mfets)  125d3
                             to current values.

                             M. Racek, 2/10/06.

                                             A         M13     M2     M4      T1*
                                            _________________________________________

                             Mutliplicity    1         3       2      2       4(1)
                                            _________________________________________

                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts_d         Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg_d       Na        Fe      Fe_Al  Ca      Al_Si
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl_d         Vac       Fe      Al     Na      Si_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets_d       Vac       Fe      Fe3+   Ca      Al_Si

                             fparg_d = 1 parg + 4/5 ftr  - 4/5 tr
                             fts_d   = 1 ts   + 3/5 ftr  - 3/5 tr
                             fgl_d   = 1 gl   + 3/5 ftr  - 3/5 tr
                             ffets_d = 1 mfets + 3/5 ftr  - 3/5 tr

                           *Dale et al compute amphibole T1 site fractions assuming
                            a site multiplicity of 4, but compute activities for a
                            T1 site multiplicity of 1  In previous models H&P computed
                            activities for a T1 site multiplicity of 2.

Amph(DPW)                  | solution name
abbreviation Amph
full_name    clinoamphibole

7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 5                        | 1 binary and 1 quinary
tr       ftr
parg     fparg_i
ts       fts_i
gl       fgl_i
mfets    ffets_i

4                          | number of dependent endmembers

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr

0 0 0 0 1 0 0 0 0 0        | endmember flags.

0  1    .1 0               | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0  1    .1 0               | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0  1    .1 0               | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision
0  1    .1 0               | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision
0  1    .1 0               | range and resolution for X(gl) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(tr ts)      20d3
W(tr parg)    33d3
W(tr gl)      65d3
W(tr ftr)     10d3
W(tr mfets)   20d3
W(ts parg)   -385d2
W(ts gl)      25d3
W(ts ftr)     125d2
W(parg gl)    50d3
W(parg ftr)  -19d2
W(parg mfets) -385d2
W(gl ftr)     393d2
W(gl mfets)   459d2
W(ftr mfets)  125d2
end_excess_function

5                          | 5 site (A, M13, M2, M4, T1) entropy model

2 1                        | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg

2 1                        | 2 species on T1, fake site multiplicity of 1.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg)   = 1 tr + 1/2 parg
z(m2,fe)   = 1 ftr
z(m2,fe3+) = 1 mfets

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl


begin_van_laar_sizes
alpha(tr)     1
alpha(ts)     1.5
alpha(parg)   1.7
alpha(gl)     0.8
alpha(ftr)    1
alpha(mfets)  1.5
end_van_laar_sizes

begin_dqf_corrections
dqf(gl)   5d3
dqf(ts)   1d4
dqf(parg) 15d3
end_dqf_corrections

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                            Sapphirine, ideal, holland and powell '98

                            config entropy corrected, P Goncalves/JADC, 10/1/03

                            the corrected model assumes (after the text on TJBH's
                            saphhirine web page www.esc.cam.ac.uk/astaff/holland/ds5/sapphirines/spr.html)
                            that:

                                   1) a 14 cation unit formula
                                   2) Si occupies T2, Al occupies T5, Si and Al mix on
                                      remaining 4 sites T1 T3 T4 T6 (the T site below)
                                   3) Al occupies M7; only Fe and Mg may occupy sites
                                      M4, M5, M6 (Site MB below); Al, Mg, and Fe may occupy
                                      sites M1, M2, M3 and M8 (Site MA below)

                             N.B. This model seems to differ from the Thermocalc format version on
                             TJBH's web page in that it accounts for the configurational entropy
                             arising from mixing on MB (i.e., the Thermocalc model looks like it
                             was written for Fe-free sapphirine). Eliminate site MB to reproduce
                             the TJBH web page Thermocalc model.

                                                      1      2     3
                                                      MA     MB    T
                                                     _________________

                                      Mutliplicity    4      3     4
                                                     _________________

                                      1 spr7          MgAl7  Mg    SiAl7
                            Species:  2 fspr          FeAl7  Fe    SiAl7
                                      3 spr4          MgAl3  Mg    SiAl3
                                      4 fsp4_i        FeAl3  Fe    SiAl3

                                      Dependent endmember:

                                      fsp4_i = spr4 +  8/7 * (fspr - spr7)
Sapp(HP)
abbreviation Sap
full_name    sapphirine

7                                     model type
2                                     reciprocal solution
2 2                                   2 species on each site
spr7     fspr
spr4     fsp4_i
1                                     1 dependent endmember
fsp4_i = 1 spr4 +  8/7 fspr - 8/7 spr7

0  0  0  0                            endmember flags

0  1   .1  0               | range and resolution for X(Mg), imod = 0 -> cartesian subdivision
0  1   .1  0               | range and resolution for 1-X(Tschermaks), imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (MA, MB, T) configurational entropy model

2 3.                       | 2 species on MB, 3 sites per formula unit
z(mb,mg) = 1 spr4 + 1 spr7

3 4.                       | 3 species on MA, 4 sites per formula unit.
z(ma,Al) = 3/4 + 1/8 spr7 + 1/8 fspr
z(ma,fe) = 1/8 fspr

2 4.                       | 2 species on T, 4 sites per formula unit.
z(T,Al) = 3/4 + 1/8 spr7 + 1/8 fspr

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                            Sapphirine, non-ideal, Kelsey et al. (J. metamorphic Geol., 2004, 22, 559-578)

                            NOTE: This model should be used in conjunction with a special
                            high temperature version of the HP data base (kel04ver.dat).

                            Model originally entered by Pulak Sengupta, 7/16/05.

                            1) Site populations corrected to correspond to those of Kelsey et al
                               by P Goncalves, 10/12/2010.

                                                      1      2     3
                                                      M3     M46   T
                                                     _________________

                                      Mutliplicity    1      3     1
                                                     _________________

                                      1 spr4          Mg     Mg    Si
                            Species:  2 fspr          Fe     Fe    Si
                                      3 spr5          Al     Mg    Al
                                      4 fsp5_i        Al     Fe    Al


                                      Dependent endmember:

                                      fsp5_i = spr5 +  3/4 * (fspr - spr4)
Sapp(KWP)
abbreviation Sap
full_name    sapphirine

7                                     model type
2                                     reciprocal solution
2 2                                   2 species on each site
spr4     fspr
spr5     fsp5_i

1                                     1 dependent endmember
fsp5_i = 1 spr5 +  3/4 fspr - 3/4 spr4

0  0  0  0                | endmember flags

0  1   .1  0              | range and resolution for X(Mg), imod = 0 -> cartesian subdivision
0  1   .1  0              | range and resolution for 1-X(Tschermaks), imod = 0 -> cartesian subdivision

begin_excess_function
w(spr5 spr4) 10000
w(spr5 fspr) 12000
w(spr4 fspr)  8000
end_excess_function

3                          | 3 site (M3, M46, T) configurational entropy model

2 3.                       | 2 species on M46, 3 sites per formula unit
z(m46,mg) = 1 spr5 + 1 spr4

3 1                        | 3 species on M3, 1 sites per formula unit.
z(ma,Al) = 1 spr5
z(ma,fe) = 1 fspr

2 1                        | 2 species on T, 1 sites per formula unit.
z(T,si) = 1 spr4 + 1 fspr

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                           | CHL(HP) - CHLORITE: extended from holland et al. 1998, EJM.

                           | This model is a relict equipartition model and has been superceded 
                           | by the non-equipartition model Chl(W), which should be used in 
                           | preference to Chl(HP). JADC, 12/20.

                             NOTES:

                             * This is an oddball model because Al disorder is implicit
                               The model should be reformulated so that clin is an explicit 
                               ordered species. The current formulaton precludes the anti-ordered
                               state.

                             * This model will only function for the FASH subsystem
                               if MGO is also used as a component in VERTEX.

                             * This model was tested with the maple script complete_chl.mws

                             * For normal aluminous chlorites there is little to be gained
                               by considering the afchl endmember becuase the
                               endmember has negligible contribution to the total energy of
                               the solution (see fig 4 of holland et al). Exclude this
                               endmember to save computational resources. For Al-poor
                               systems exclude ames and retain afchl.

                             JADC 4/03

                           | Despite this models complexity it can be
                           | written as a simple ternary with one independent
                           | ordering parameter, however perplex does not
                           | yet have speciation models implemented for
                           | solutions in which multiple endmembers are
                           | characterized by a single ordering parameter.
                           | hence the model is formulated here explicitly
                           | in terms of the dependent endmembers with the
                           | site occupancy table:

                                                      1         2       3      4
                                                      M1      M2+M3     M4     T2
                                                     ________________________________

                                      Mutliplicity    1         4       1      2
                                                     ________________________________

                                      1 mame          Al        Mn      Al     Al_Al   dependent
                                      2 mafchl        Mn        Mn      Mn     Si_Si   dependent
                                      3 mnchl         Mn        Mn      Al     Al_Si
                                      4 fames         Al        Fe      Al     Al_Al   dependent
                                      5 fafchl        Fe        Fe      Fe     Si_Si   dependent
                                      6 daph          Fe        Fe      Al     Al_Si
                                      7 ames          Al        Mg      Al     Al_Al
                                      8 afchl         Mg        Mg      Mg     Si_Si
                                      9 clin          Mg        Mg      Al     Al_Si

                                          Dependent endmembers:

                                          fame = ames + 4/5 * (daph - clin)
                                          fafchl = afchl + 6/5 * (daph - clin)
                                          mame = ames + 4/5 * (mnchl - clin)
                                          mafchl = afchl + 6/5 * (mnchl - clin)

                           | For normal aluminous chlorites there is little to be gained
                           | by considering the afchl and fafchl endmembers
                           | becuase the endmember has negligible
                           | contribution to the total energy of the solution
                           | (see fig 4 of holland et al)

Chl(HP)
abbreviation Chl
full_name    chlorite

7                               | model type reciprocal, macroscopic formulation
2
3 3
mame_i   mafchl_i mnchl
fame_i   fafchl_i daph
ames     afchl    clin

4                               | 4 dependent endmembers

fame_i   = 1 ames   + 4/5 daph  - 4/5 clin
fafchl_i = 1 afchl  + 6/5 daph  - 6/5 clin
mame_i   = 1 ames   + 4/5 mnchl - 4/5 clin
mafchl_i = 1 afchl  + 6/5 mnchl - 6/5 clin

0 0 0 0 0 0 0 0 0            |endmember flags

                             | subdivision model for (ternary) site 1 (T2):
0  1  .1 0                   | range and resolution of X(Al_Si), imod = 0 -> cartesian subdivision
0  1  .1 0                   | range and resolution of X(Al_Al), imod = 0 -> cartesian subdivision
                             | subdivision model for (ternary) site 2 (M2)

0  .2  .1 0                  | range and resolution of X(Mn), imod = 1 => asymmetric subdivision
0  1   .1 0                  | range and resolution of X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function

w(clin ames)  18000.
w(clin afchl) 18000.
w(ames afchl) 20000.
w(clin daph)   2500
w(daph ames)  13500.
w(daph afchl) 14500.

end_excess_function

4                               |4 site configurational entropy model:

4 1                             |4 species on 1 M1 site

z(al,M1) = 1 ames
z(mn,M1) = 1 mnchl
z(fe,M1) = 1 daph

3 4.                            |3 species on 4 M2+M3 sites

z(mn,m2+m3)= 1 mnchl
z(fe,m2+m3)= 1 daph

2 1                             |3 species on 1 M4 site

z(mg,m4) = 1 afchl

2 2.                            |2 species on 2 T2 sites
z(al,T2)= 1 ames + 1/2 clin + 1/2 daph + 1/2 mnchl

site_check_override

| reject_bad_compositions

| see the May 15, 2020 Perple_X update for explanation of the
| reject_bad_compositions option. The option was turned off
| by commenting Dec 2, 2020. JADC.


end_of_model
                              --------------------------------------------------------
begin_model
                           | CHLORITE: extended from Holland et al. (1998) for sud substitution
                           | Entered by Thomas Wagner, 5/12.

                             LWV 7/12

                           | The reference for this model is Lanari, Wagner and Vidal,
                           | CMP 2014 167:968

                           | the model is formulated here explicitly
                           | in terms of the dependent endmembers with the
                           | site occupancy table:

                                                      1         2         3        4
                                                      M1      M2+M3       M4       T2
                                                     ________________________________

                                      Mutliplicity    1         4         1        2
                                                     ________________________________

                                      1 fames         Al        Fe        Al       Al_Al   dependent
                                      2 ames          Al        Mg        Al       Al_Al
                                      3 clin          Mg        Mg        Al       Al_Si
                                      4 daph          Fe        Fe        Al       Al_Si
                                      5 fsud          Va        Al2_Fe2   Al       Al_Si   dependent
                                      6 sud           Va        Al2_Mg2   Al       Al_Si

                                          Dependent endmembers:

                                          fames = ames + 4/5 * (daph - clin)
                                          fsud = sud + 2/5 * (daph - clin)
Chl(LWV)
abbreviation Chl
full_name    chlorite

7                               | model type reciprocal, macroscopic formulation
2
3 2
fames_i   fsud_i     daph
ames      sud_dqf    clin

2                               | 2 dependent endmembers

fames_i  = 1 ames   + 4/5 daph  - 4/5 clin
fsud_i   = 1 sud_dqf   + 2/5 daph  - 2/5 clin

0 0 0 0 0 0                  |endmember flags

                             | subdivision model for (ternary) site 1 (T2):
0  1  .1 0                   | range and resolution of X(Al_Si), imod = 0 -> cartesian subdivision
0  1  .1 0                   | range and resolution of X(Al_Al), imod = 0 -> cartesian subdivision

                             | subdivision model for (ternary) site 2 (M2)
0  1   .1 0                  | range and resolution of X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function

w(clin ames)      18000.
w(clin daph)      2500.
w(clin sud_dqf)   49100.
w(daph ames)      13500.
w(daph sud_dqf)   43400.
w(ames sud_dqf)   43300.

end_excess_function

3                               |3 site configurational entropy model:

4 1                             |4 species on 1 M1 site

z(al,M1) = 1 ames
z(mg,M1) = 1 clin
z(fe,M1) = 1 daph

3 4.                            |3 species on 4 M2+M3 sites

z(fe,m2+m3) = 1 daph
z(mg,m2+m3) = 1 clin + 1 ames + 1/2 sud_dqf

2 2.                            |2 species on 2 T2 sites

z(al,T2) = 1 ames + 1/2 clin + 1/2 daph + 1/2 sud_dqf

site_check_override

end_of_model
                      --------------------------------------------------------
begin_model
                             Olivine - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                             Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus

                             JADC, April 2019.

                                                      M1      M2
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                       fa            Fe      Fe
                                       fmont         Fe      Ca   dependent
                                       fo            Mg      Mg
                                       mont          Mg      Ca
                                                     _____________
                                       mf            Mg      Fe   ordered

O(HGP)
abbreviation Ol
full_name    olivine

8                           | model type: o/d + reciprocal quadrilateral

2                           | two simplicies 2x2
2 2
                            | endmembers on the prism vertices
fmont   mont
fa      fo

1                           | ordered species:

mf    = 1/2 fo + 1/2 fa       delta_g_of_ordering   =   0

1                           | dependent endmember

fmont  = 1 mont + 1 fa   - 1 mf

                            | see commentary in the header of this file for explanation of
                            | endmember flags and subdivision schemes.

0  0  0  0                  | endmember flags

0  1     .1   0            | subdivision scheme for Fe/(Fe+Mg)
0   .1   .1   0            | subdivision scheme for Ca/(Fe+Mg+Ca)

begin_excess_function
W(mont fa)     24d3
W(mont fo)     38d3
W(mont mf)     24d3
W(fa fo)        9d3
W(fa mf)      4.5d3
W(fo mf)      4.5d3
end_excess_function

2                           | 2 site entropy model

2 1                         | M1 2 species, site multiplicity = 1
z(M1,fe) = 1 fa

3 1                         | M2 3 species, site multiplicity = 1
z(M2,mg) = 1 fo
z(M2,ca) = 1 mont

end_of_model
                      --------------------------------------------------------
begin_model
                      Orthopyroxene - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus
                      -------------------------------------------------------- 
                      W(en odi) and the odi DQF revised to destabilize Ca-rich
                      Opx at high pressure. Eleanor Green. July 13, 2020. 
                      --------------------------------------------------------                    
                      Reformulated as a 2-polytope 688 format model. JADC, 9/19

                      The composition space of the published model corresponds to (M1, M2 site populations are 
                      indicated, remaining are dependent):     
                      
                      [M,T][A,C,M]
                        
                      T  = Al, Fe3, Cr, MTi on M1
                      C  = Ca on M2
                      M  = Mg, Fe
                      A  = Na on M2*
                      
                      *A is partially coupled to T by charge balance.
                      
                      The composition space of the model here has been simplified by eliminating
                      the [FeTi][A,C] endmembers. The retained [FeTi][Fe] endmember is probably 
                      a waste of resources.

                      NOTE: the definitions for the FeTi exchanges allowed in the full model 
                      are provided but have been commented out below.                     
                      
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                     
                      Polytope 1 = [T'][A,C]       
                      Polytope 2 = [T,M][M]+[M][C] 
                      
                      where 
                      
                      T' = Al, Fe3, MgTi on M1
                      --------------------------------------------------------
                      First coded for Perple_X by ECR Green and JRDC Aug 2018.
                      Rearranged Apr 2019, JADC.

                      NOTE: to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                      odi  = 1 di
                            DQF = 1900 + 0.005 * P | prior to 13/7/20: -100 + 0.211 * T + 0.005 * P
                      crenh = 1 mgts + 1 kos - 1 jd
                            DQF = -25900 + 15.5 * T + 0.05 * P
                      obuf = 1 mgts + 1/2 per + 1/2 ru - 1/2 cor
                            DQF = 3350 - 5.1 * T - 0.0061 * P
                      macm = 1 mgts + 1 acm - 1 jd
                            DQF = 4800 - 0.089 * P
                      ojd  = 1 jd
                            DQF = 18800
                      --------------------------------------------------------
                                                        M1     M2     T
                                                     ____________________________________

                                      Multiplicity      1      1     1/2 <- fake T multiplicity
                                                     ____________________________________
           Polytope 1:                  crjd_d          Cr     Na    Si    dependent
                                        crdi_d          Cr     Ca   AlSi   dependent
                                        ___
                                        ness_d          Fe3    Na    Si    dependent
                                        cess_d (acm)    Fe3    Ca   AlSi   dependent
                                        ___
                                        ojd             Al     Na    Si
                                        ocats_d         Al     Ca   AlSi   dependent
                                        ___
                                        mnbuf_d         MgTi   Na    Si    dependent
                                        mcbuf_d         MgTi   Ca   AlSi   dependent

                                        fnbuf_d         FeTi   Na    Si    dependent
                                        fcbuf_d         FeTi   Ca   AlSi   dependent
                                                     ____________________________________

           Polytope 2:                  crenh           Cr     Mg   AlSi
                                        crfs_d          Cr     Fe   AlSi   dependent
                                        _________

                                        macm (mess)     Fe3    Mg   AlSi
                                        facm_d (fess)   Fe3    Fe   AlSi   dependent
                                        _________

                                        mgts            Al     Mg   AlSi
                                        fts_d           Al     Fe   AlSi   dependent
                                        _________

                                        obuf            MgTi   Mg   AlSi
                                        ffbuf_d         FeTi   Fe   AlSi   dependent
                                        _________
                                        odi             Mg     Ca    Si
                                        hed_d           Fe     Ca    Si    dependent
                                        ___
                                        en              Mg     Mg    Si
                                        fs              Fe     Fe    Si
                                                      ___________________________________
                    Ordered species:

                                        fm              Mg     Fe    Si independent

                      femg-1(M2) = fm - en
                      femg-1(M1) = fs - fm
                      mgca-1(M2) = en - odi
                      feca-1(M2) = fm - odi 
                      --------------------------------------------------------
Opx(HGP)
abbreviation Opx
full_name    orthopyroxene

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and subdivision schemes for the composite composition space
[T'][A,C]  0    .2   .1  0        | subdivision range for X(1) = X([T][A,C])
TM+MC      by difference

                                  | -------------------------------------------
                                  | Polytope 1 [T'][A,C]
2                                 | number of simplices
2 3                               | change to 3 5 for full model
crjd_d   crdi_d
ness_d   cess_d
                                  |mnbuf_d  mcbuf_d
                                  |fnbuf_d  fcbuf_d
ojd      ocats_d

                                  | Simplex 1
X_K    0     1  .1  0             | X(1,1) = Na/[Na + Ca] on M2
X_Ca1  by difference              | X(1,N) = Ca/[Na + Ca] on M2 by difference

                                  | Simplex 2
X_CrTs 0     1  .1  0             | X(2,1) = Cr/T on M1
X_FeTs 0     1  .1  0             | X(2,2) = Fe3+/T on M1
                                  |0     1  .1  0                    | X(2,3) = MgTi/T on M1
                                  |0     1  .1  0                    |X(2,4)  = FeTi/T on M1
X_AlTs by difference              | X(2,N) = Al/T on M1 by difference

                                  | -------------------------------------------
                                  | Polytope 2  TM+MC

2                                 | number of simplices 
2 6                               | number of vertices on each simplex

ffbuf_d  obuf
crfs_d   crenh
facm_d   macm
fts_d    mgts
hed_d    odi
fs       en
                                  | Simplex 1
X_Fe    0  .2  .1  0              | X(1,1) => Fe/M
X_Mg    by difference             | X(1,N) = Mg/M by difference

                                  | Simplex 2
X_MTiTs 0  .2  .1  0              | X(2,1) - M-buf(MgTi)
X_MCrTs 0  .1  .1  0              | X(2,2) - M-Cr
X_MFeTs 0  .1  .1  0              | X(2,3) - M-Fe3+
X_MAlTs 0  .2  .1  0              | X(2,4) - M-Ts
X_MCPx  0   1  .1  0              | X(2,5) - M-Ca
X_MMPx  by difference

begin_ordered_endmembers
fm = 1/2 en + 1/2 fs     delta_g_of_ordering  = -6600
end_ordered_endmembers 

begin_dependent_endmembers

fts_d   = 1 mgts - 1 en + 1 fm
ocats_d = 1 mgts - 1 en + 1 odi

crjd_d  = 1 crenh - 1 mgts + 1 ojd
crfs_d  = 1 crenh - 1 en   + 1 fm
crdi_d  = 1 crenh - 1 en   + 1 odi

facm_d  = 1 macm - 1 en   + 1 fm
cess_d  = 1 macm - 1 en   + 1 odi
ness_d  = 1 macm - 1 mgts + 1 ojd

|mcbuf_d = 1 obuf + 1 odi  - 1 en
|fcbuf_d = 1 obuf + 1/2 fs - 1/2 fm + 1 odi - 1 en

ffbuf_d = 1 obuf - 1 en   + 1/2 fs + 1/2 fm

hed_d   = -1 fm + 1 fs + 1 odi

end_dependent_endmembers

begin_excess_function
W(en fs)                 7d3
W(en fm)                 4d3
W(en mgts)            12.5d3  - 0.04 * p
                                      | W(en odi) revised from 32.2d3 + 0.12 * p 
                                      | by ECRG, 13/7/20
W(en odi)             29.4d3          | changed from W(en odi) 29d3 + 0.15 * p by DB to match the ECRG 10/20 revision.
W(en crenh)              8d3
W(en obuf)               6d3          | added by DB  to match the ECRG 10/20 revision.
W(en macm)               8d3
W(en ojd)               35d3

W(fs fm)                 4d3
W(fs odi)             21.5d3   + 0.08 * p |changed from W(fs odi) 25.54d3 + 0.084 * p by DB to match the ECRG 10/20 revision.
W(fs mgts)              11d3  - 0.15 * p
W(fs crenh)             10d3
W(fs obuf)               7d3          | added by DB  to match the ECRG 10/20 revision.
W(fs macm)              10d3
W(fs ojd)               35d3

W(fm odi)               18d3  + 0.08 * p |changed from W(fm odi) 22.54d3 + 0.084 * p by DB to match the ECRG 10/20 revision.
W(fm mgts)              15d3  - 0.15 * p
W(fm crenh)             12d3
W(fm obuf)               8d3         | added by DB to match the ECRG 10/20 revision.
W(fm macm)              12d3
W(fm ojd)               35d3

W(odi mgts)           75.5d3  - 0.84 * p
W(odi crenh)            20d3
W(odi obuf)             40d3         | added by DB to match the ECRG 10/20 revision.
W(odi macm)             20d3
W(odi ojd)              35d3

W(mgts crenh)            2d3
W(mgts obuf)            10d3         | added by DB to match the ECRG 10/20 revision.
W(mgts macm)             2d3
W(mgts ojd)              7d3

W(crenh obuf)            6d3          | added by DB to match the ECRG 10/20 revision.
W(crenh macm)            2d3
W(crenh ojd)           -11d3

W(obuf macm)             6d3          | added by DB  to match the ECRG 10/20 revision.
W(obuf ojd)             20d3          | changed from W(obuf ojd) 4d3 by DB to match the ECRG 10/20 revision.

W(macm ojd)            -11d3
end_excess_function

3                                   | number of sites in entropy model (M1, M2, T)

M1                                  | site name
6 1 1                               | number of species, effective multiplicity, true multiplicity
z(fe)   = 1 fs
z(al)   = 1 mgts + 1 ojd
z(fe3+) = 1 macm
z(cr)   = 1 crenh
z(ti)   = 1/2 obuf
z(Mg)   = 1/2 obuf + 1 odi + 1 en + 1 fm

M2                                  | site name
4 1 1                               | number of species, effective multiplicity, true multiplicity
z(fe)   = 1 fs + 1 fm
z(ca)   = 1 odi
z(na)   = 1 ojd
z(Mg)   = 1 obuf + 1 en + 1 crenh + 1 macm + 1 mgts 

T                                   | site name
2 .5 2                              | number of species, effective multiplicity, true multiplicity
z(Al,T)    = 1/2 mgts + 1/2 crenh + 1/2 obuf + 1/2 macm
z(Si,T)    = 1/2 mgts + 1/2 crenh + 1/2 obuf + 1/2 macm + 1 ojd + 1 odi + 1 en + 1 fs + 1 fm

[O6]                                | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(en)        1
alpha(fs)        1
alpha(fm)        1
alpha(odi)       1.2
alpha(mgts)      1
alpha(crenh)     1
alpha(obuf)      1
alpha(macm)      1
alpha(ojd)       1.2
end_van_laar_sizes

                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

end_of_model
                      --------------------------------------------------------
begin_model
                      Spinel - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus

                      Initially coded for Perple_X by JRDC Oct 2018; reworked JADC Apr 2019.

                      NOTE: to use this model:

                      1) the endmembers nsp, nherc must be created in the
                         thermodynamic data file from sp and herc by stripping
                         off the bragg o/d model. the picr endmember here is assumed
                         to be ordered as is the case in ds6.33, but was NOT the case
                         in earlier versions of ds6, therefore if this model is to be
                         used with earlier versions of ds6, the o/d model must also
                         be stripped from picr.

                      2) the following endmembers must be specified with make
                         definitions in the thermodynamic data file

                         isp   = 1 nsp
                                DQF(J/mol) = 23.6d3  - 5.76303 * T
                         iherc = 1 nherc
                                DQF(J/mol) = 23.6d3  - 5.76303 * T
                         imt   = 1 mt
                                DQF(J/mol) = 300

                      3) the qnd endmember DQF is added in the dqf_correction section
                         at the end of this model.

                      4) if both TiO2 nor O2 are absent from the Sp(HGP), Perple_X 
                         reformulate this model as the sp-picr binary, rather than
                         the sp-herc-picr-fpcr quadrilateral. To prevent this specify
                         TiO2 or O2 as components present with zero amount. JADC, 12/20

                                                      M     T
                                                     _________
                                      Multiplicity    1     2  -> fake T-site multiplicity of 1
                                                     _________

                                        isp          Al    MgAl
                                        imgmt        Fe3   MgFe3   dependent
                                        picr         Mg    Cr
                                        qnd          Mg    MgTi

                                        iherc        Al    FeAl
                                        imt          Fe3   FeFe3
                                        fpcr         Fe    2Cr     dependent
                                        fqnd         Fe    FeTi    dependent

                                Ordered species      _________

                                        nsp          Mg     Al
                                        nherc        Fe     Al
                                        nmt          Fe     Fe3+

Sp(HGP)
abbreviation Sp
full_name    spinel

688                         | model type: prism , order-disorder
1                           | number of prisms
2                           | two simplicies
2 4                         | number of cations on independent sites forming simplices:
                            | fold prism (Al - Fe3+ - Cr - Ti) + binary simplices (Mg Fe on T)

                            | endmembers on the prism vertices
picr  fpcr
qnd   fqnd
imgmt imt
isp   iherc

X_Fe2+  0  1   .1  0        | subdivision scheme for Fe2/(Fe2+Mg)
X_Mg    by difference

Z_Cr    0  1   .1  0        | subdivision scheme for X(Cr)
Z_MTi   0  1   .1  0        | subdivision scheme for X(Ti)
Z_Fe3+  0  1   .1  0        | subdivision scheme for X(Fe3+)
Z_MAl   by difference

begin_ordered_endmembers
nmt   =    1 imt           delta_g_of_ordering   = -0.3d3   + 5.76303 * T   |changed from 5.76303 * T by DB to match the ECRG 10/20 revision.
nsp   =    1 isp           delta_g_of_ordering   = -23.6d3  + 5.76303 * T
nherc =    1 iherc         delta_g_of_ordering   = -23.6d3  + 5.76303 * T
end_ordered_endmembers 

begin_dependent_endmembers
imgmt =  1 isp - 1 iherc  + 1 imt
fpcr  = -1 nsp + 1 nherc  + 1 picr
fqnd  = -1 nsp - 1 isp    + 1 nherc + 1 iherc + 1 qnd
end_dependent_endmembers

begin_excess_function
W(nsp   isp)          -8.2d3
W(nsp   nherc)         3.5d3
W(nsp   iherc)        -13d3
W(nsp   nmt)           43.2d3
W(nsp   imt)           49.1d3
W(nsp   picr)         -5d3
W(nsp   qnd)           22.5d3
W(isp   nherc)         4.4d3
W(isp   iherc)        -6d3
W(isp   nmt)           36.8d3
W(isp   imt)           20d3
W(isp   picr)          14d3
W(isp   qnd)           21.5d3
W(nherc iherc)        -8.2d3
W(nherc nmt)           18.1d3
W(nherc imt)           49d3
W(nherc picr)         -19d3
W(nherc qnd)           35.1d3
W(iherc nmt)          -4d3
W(iherc imt)           7.6d3
W(iherc picr)         -11d3
W(iherc qnd)           9d3
W(nmt   imt)           18.1d3
W(nmt   picr)          11.9d3
W(nmt   qnd)           62.2d3
W(imt   picr)         -6.4d3
W(imt   qnd)           24.3d3
W(picr  qnd)           60d3
end_excess_function

2                                    | 2 site entropy model (M , T)
M
4  1  1                              | 4 species on M, mult. = 1
z(Fe,M)   = 1 nherc + 1 nmt
z(Fe3,M)  = 1 imt
z(Al,M)   = 1 isp + 1 iherc
z(Mg,M)  = 1 nsp   + 1 picr + 1 qnd

T
6  1  2                              | 6 species on T, effective mult. = 1, true mult = 2
z(Mg,T)   = 1/2 isp + 1/2 qnd
z(Fe,T)   = 1/2 iherc + 1/2 imt
z(Ti,T)   = 1/2 qnd
z(Fe3,T)  = 1 nmt + 1/2 imt
z(Cr,T)   = 1 picr
z(Al,T) = 1 nsp + 1/2 isp + 1 nherc + 1/2 iherc

[O4]                                 | formula suffix, enter "none" for no suffix.

begin_dqf_corrections
dqf(qnd)  = -30000
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                      Garnet - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus

                      JADC, April 2019

                      This model requires the following make definition in
                      the thermodynamic data file

                         tig   = 1 py + 1/2 per + 1/2 ru - 1/2 cor
                                DQF(J/mol) = 46.7d3  - 17.3 * T

                      Additionally, a knor endmember DQF is added in the dqf_correction section
                      at the end of this model.

                                                      X       Y
                                                     _____________

                                      Mutliplicity    3       2
                                                     _____________

                          Dependent:   fkho_d        Fe      Fe3+
                          Dependent:   kho_d         Mg      Fe3+
                                       andr          Ca      Fe3+

                          Dependent:   fkno_d        Fe      Cr
                                       knor          Mg      Cr
                          Dependent:   ckno_d        Ca      Cr

                          Dependent:   ftig_d        Fe      Al(MgTi)_0.5
                                       tig           Mg      Al(MgTi)_0.5
                          Dependent:   ctig_d        Ca      Al(MgTi)_0.5

                                       alm           Fe      Al
                                       py            Mg      Al
                                       gr            Ca      Al

Gt(HGP)
abbreviation Gt
full_name    garnet

7
2
3 4
ftig_d  tig    ctig_d
fkno_d  knor   ckno_d
fkho_d  kho_d  andr
alm     py     gr

6
fkno_d = 1 alm + 1 knor - 1 py
ckno_d = 1 gr  + 1 knor - 1 py
fkho_d = 1 alm + 1 andr - 1 gr
kho_d  = 1 py  + 1 andr - 1 gr
ftig_d = 1 alm + 1 tig  - 1 py
ctig_d = 1 gr  + 1 tig  - 1 py

                            | see commentary in the header of this file for explanation of
                            | endmember flags and subdivision schemes.

0 0 0 0 0 0 0 0 0 0 0 0     | endmember flags

0   1   .1   0              | subdivision scheme for Fe on A
0   1   .1   0              | subdivision scheme for Mg on A

0   1   .1   0              | subdivision scheme for Al(MgTi)_0.5   on B
0   1   .1   0              | subdivision scheme for Cr     on B
0   1   .1   0              | subdivision scheme for Fe3+   on B

begin_excess_function
W(py   alm)      4d3              +  .1 * P
W(py   gr)       45.4d3 - 10 * T  + 0.04 * P
W(py   andr)     107d3  - 10 * T  - 0.036 * P
W(py   knor)     2d3
W(alm  gr)       17d3   - 10 * T  +  .1 * P
W(alm  andr)     65d3   - 10 * T  + 0.039 * P
W(alm  knor)     6d3              + 0.01 * P
W(gr   andr)     2d3
W(gr   knor)     1d3    - 10 * T  + 0.180 * P
W(andr knor)     63d3   - 10 * T  + 0.10 * P
end_excess_function

2
3 3.
z(m1,fe) = 1 alm
z(m1,mg) = 1 py + 1 knor + 1 tig

5 2.
z(m2,cr)  = 1 knor
z(m2,fe3) = 1 andr
z(m2,ti)  = 1/4 tig
z(m2,mg)  = 1/4 tig


begin_van_laar_sizes
alpha(py)        1
alpha(alm)       1
alpha(gr)        2.5
alpha(andr)      2.5
alpha(knor)      1
alpha(tig)       1
end_van_laar_sizes

begin_dqf_corrections
dqf(knor)  = 18200
end_dqf_corrections

end_of_model
                      --------------------------------------------------------
begin_model
                                      Holland and Powell (2001) J.Petrol 426, 673-683 (KNCASH) +
                                      White et al (2001) JMG 19: 139-153 (FM+KNCASH).

                                      JADC 3/03

                                      * Changed DQF terms to account for modifications of faL and foL
                                        (White et al 2007). Mark Caddick, Nov, 07.

                                      * Zr8L added after Kelsey & Powell (2010). Jeff Marsh, Jan 10, 2012.

                                      * reformulated as ordinary configurational entropy model. JADC 12/18.

                                      * Zn - Wi8L (= 2 WiL [ZnSi2O4]) endmember estimated using HSC caloric data
                                        and foL volumetric properties, Wi8L interaction terms replicate fo8L. Zn
                                        is assumed to mix on the Temkin "Olivine" site. JADC, May 26, 2019.

                                      WARNING 2: the endmembers Wi8L, q8L, fa8L, fo8L, and
                                      sil8L must be "made" in the thermodynamic data
                                      file.

                                      WARNING 3: the (stabilizing) dqf corrections made
                                      to the fo8L, fa8L, and sil8L enedmembers make the
                                      haplogranite melt model inapplicable to melts where
                                      these endmembers are present in high concentrations,
                                      to model such situations or to reproduce the published
                                      fo-fa-q or sil-q melting phase relations, the dqf corrections
                                      (below) should be set to zero.

                                      WARNING 4: different versions of the HP data base
                                      may result in significant variations in the predicted
                                      position of the wet-solidus (Powell, pers comm.).

                                      WARNING 5: The melt model incorrectly predicts a high
                                      pressure-low temperature stability field for water-silica
                                      rich melts. at 10 kb this field extends to ca 750 K and
                                      at 3 kb to ca 550 K. To eliminate this artifact set T_melt
melt(HP)
abbreviation Melt
full_name    liquid

2                                     model type: simplicial composition space

10                                    number of endmembers

fo8L     fa8L     zr8L
abL      sil8L    anL
kspL     wi8L     q8L
h2oL

0 0 0 0 0 0 0 0 0 0                 | endmember flags.

                                    | RESTRICTED(!) subdivision ranges and model
                                    | the ranges must be extended if calculations
                                    | are to be done in subsystems like fo-fa-h2o,
                                    | Ab-H2O etc etc; these numbers seem about right
                                    | for pelite melting.

0      .1    .1 0                   | range and resolution of X(fo),  0 => cartesian subdivision
0      .2    .1 0                   | range and resolution of X(fa),  0 => cartesian subdivision
1e-4  1e-2   .1 1                   | range and resolution of X(zrL), 1 => asymmetric subdivision
0      .4    .1 0                   | range and resolution of X(ab),  0 => cartesian subdivision
0      .4    .1 0                   | range and resolution of X(sil), 0 => cartesian subdivision
0      .1    .1 0                   | range and resolution of X(an),  0 => cartesian subdivision
0      .4    .1 0                   | range and resolution of X(ksp), 0 => cartesian subdivision
1e-4  1e-2   .1 1                   | range and resolution of X(wiL), 1 => asymmetric subdivision
0      .7    .1 0                   | range and resolution of X(q),   0 => cartesian subdivision

begin_excess_function
                                    | the excess parameters used for the haplo-
                                    | granite melt model vary between papers (notably w(an-sil)),
                                    | the values here are from the thermocalc
                                    | model file 'thdmloss.txt' and appear largely
                                    | consistent with the white et al paper.
w(q8L    anL) -10d3
w(q8L  sil8L) 12d3
w(q8L    abL) 12d3    -0.4 * P_bar
w(q8L   kspL) -2d3    -0.5 * P_bar
w(q8L   h2oL) 15d3
w(q8L   fo8L) 12d3    -0.4 * P_bar
w(q8L   fa8L) 14d3
w(abL  sil8L) 12d3
w(abL   kspL) -6d3     3. * P_bar
w(abL   fo8L) 10d3
w(abL   fa8L)  2d3
w(abL   h2oL)  1d3    -0.2 * P_bar
w(kspL   anL)   0     -1. * P_bar
w(kspL sil8L) 12d3
w(kspL  h2oL) 11d3    -0.45 * P_bar
w(kspL  fo8L) 12d3
w(kspL  fa8L) 12d3
                                    | w(anL sil8) is 12 kJ in the Holland & Powell J Pet paper
                                    | but appears to have accidentally been set to zero
                                    | for the calculations published in the White et al. JMG
                                    | paper. To restore this parameter delete the comment
                                    | marker "|" on the following line:
                                    | w(anL sil8) 12d3
w(anL   h2oL)  9d3   -0.85 * P_bar
w(sil8L fo8L) 12d3
w(sil8L fa8L) 12d3
w(sil8L h2oL) 16d3
w(fo8L  fa8L) 18d3
w(fo8L  h2oL) 11d3   -0.5 * P_bar
w(fa8L  h2oL) 12d3

w(q8L   wi8L) 14d3
w(abL   wi8L) 10d3
w(kspL  wi8L) 12d3
w(wi8L  fo8L) 18d3
w(wi8L  fa8L) 18d3
w(wi8L  h2oL) 11d3   -0.5 * P_bar

w(q8L   zr8L) 14d3
w(abL   zr8L) 12d3
w(kspL  zr8L) 12d3
w(zr8L  fo8L) 12d3
w(zr8L  fa8L) 12d3
w(zr8L  h2oL) 25d3

end_excess_function

3                           | Configurational entropy: two non-temkin sites (Water, Melt)
                            | and one temkin site (olvine). hp assume a fsp = ab + or "molecule""
                            | with mixing on a temkin M site, but the math works out the same as
                            | the endmembers are treated as separate endmembers and the M site
                            | dropped.

2 1                         | water-vacancy site
z(H) = 1 h2oL

3 0                         | temkin olivine site
n(Mg) = 4 fo8L
n(Fe) = 4 fa8L
n(Zn) = 4 wi8L

8 0                         | silicate species site
z(w)     = 1 h2oL
z(q)     = 1 q8L
z(ksp)   = 1 kspL
z(ab)    = 1 abL
z(sil)   = 1 sil8L
z(an)    = 1 anL
z(zr)    = 1 zr8L
z(ol)    = 1 fo8L + 1 fa8L + 1 wi8L

begin_dqf_corrections
dqf(fo8L)  -10d3
dqf(fa8L)  -9d3 0 -1.3
dqf(sil8L) -10d3
                                     | pre-white et al '07 value: dqf(fo8L)  -15d3 0 0
                                     | pre-white et al '07 value: dqf(fa8L)  -15d3 0 0
                                     | pre-white et al '07 value: dqf(sil8L) -10d3 0 0
end_dqf_corrections

end_of_model

                      --------------------------------------------------------
begin_model
                                      HP '98 quaternary garnet model

                                      Zr-endmember (zrg, Ca3Al2[Si2Zr]O12) after Kelsey & Powell '10
                                      - Jeff Marsh, Jan 10, 2012.

                                      Zn-endmember (zngt,Zn3Al3Si3O12) estimated by octahedral
                                      metasilicate (HSC) Zn-Mn exchange from spss, Zn excess terms
                                      replicate Mn.
                                      - JADC, 5/26/2019.

ZrGt(KP)
abbreviation Gt
full_name    garnet

2                                     model type: simplicial composition space
6                                     number of endmembers
zrg    zngt   spss
py     gr     alm                     endmember names

1  1  1  0  0  0                        | endmember flags

1e-5  1e-4  .1 1           | imod = 1 -> non-linear subdivision
1d-4 0.2 .1 1              | zngt
0   .2   .1 0              |
0  1     .1 0              | imod = 0 -> cartesian subdivision
0  1     .1 0              | imod = 0 -> cartesian subdivision
                           | NOTE restricted subdivision range on Mn (Species 1)!

begin_excess_function
w(py gr) 33000
w(alm py)  2500                | hp '98 give 2.4 kJ
w(py spss) 4500
w(alm spss)  240
w(py  zngt) 4500
w(alm zngt)  240
end_excess_function

2                                   | 1 site entropy model

5 3                                 | 5 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Zn) = 1 zngt
z(Zr) = 1 zrg

2 3                                 | 2 species, site multiplicity 3
                                    | was 2 2, zr = 1 zrg, Zr goes on the
                                    | the Si site as Si2Zr
                                    | corrected(?) May 5, 2019, JADC.
z(Zr) = 1/3 zrg

end_of_model
                      --------------------------------------------------------
begin_model
                             Ideal hydrous wadleysite, extracted from Komabayashi & 
                             Omori 2006 who indicate the H4SiO4 substituion 
                             mechanism, the h2o_wd endmember estimated as in 
                             komabayashi_water_endmembers.mws

                             JADC, July 2019.

                                                      M
                                                     _____________

                                      Mutliplicity    2
                                                     _____________

                                       wd            Mg
                                       h2o_wd        H2

hWd
abbreviation Wd
full_name    wadleysite

2                           | model type: simplicial

2                           | endmembers
h2o_wd  wd 

                            | see commentary in the header of this file for explanation of
                            | endmember flags and subdivision schemes.

0  0                        | endmember flags

0  1     .1   0             | H2O/(H2O+MgO)

ideal 

1                           | 1 site entropy model

2 2                         | M 2 species, site multiplicity = 1
z(M,mg) = 1 wd

end_of_model
                      --------------------------------------------------------
begin_model
                             Ideal hydrous ringwoodite, extracted from Komabayashi & 
                             Omori 2006 who infer that both the H4SiO4 and MgH4O4 
                             substituion mechanisms, but summarize these in a single
                             hydrous species (Mg(1.91)Si(0.99)O(3.78)[OH](0.22). This choice
                             obviates the extraction of endmembers for both exchanges
                             from their data. Here the two exchanges are coupled by the
                             the partially disordered endmember h2o_rg H(4)Si(0.7777.)H(0.8888.)O(4)
                             estimated as in komabayashi_water_endmembers.mws

                             JADC, July 2019.

                                                      M      T
                                                     _____________

                                      Mutliplicity    2      1
                                                     _____________

                                       wd            Mg      Si
                                       h2o_rg        H2      H4

hRg
abbreviation Rg
full_name    ringwoodite

2                           | model type: simplicial

2                           | endmembers

h2o_rg  rg 

                            | see commentary in the header of this file for explanation of
                            | endmember flags and subdivision schemes.

0  0                        | endmember flags

0  1     .1   0             | glug

ideal 

2                           | 2 site entropy model

2 2                         | M, 2 species, site multiplicity = 2
z(M,mg) = 1 rg

2 1                         | T, 2 species, site multiplicity = 1
z(T,H4) = 2/9 h2o_rg

end_of_model
                      --------------------------------------------------------
begin_model
                      Peridotite melting - Tomlinson and Holland; Journal of Petrology, 2021, 10.1093/petrology/egab012

                      Entered by DB Sept 2022. modified JADC, Oct 2022

                      This model requires the following make definitions in the
                      thermodynamic data file make_definitions section:

                      qTHL = 3 qL
                         dqf =  0.47d3   - 0.078*Pbar
                      foTHL = 2 foL
                         dqf = 9.73d3    - 0.176*Pbar
                      faTHL = 2 faL
                         dqf = 16.52d3    - 0.034*Pbar
                      neTHL = 1 abL - 2 qL
                         dqf =  33.11d3  + 0.306*Pbar
                      hmTHL = 1/2 hemL
                         dqf =  3.76d3    - 0.027*Pbar
                      ekTHL = 1/2 eskL
                         dqf =  24.98d3  + 0.170*Pbar
                      tiTHL = 1 ruL
                         dqf =  0.42d3   - 0.257*Pbar
                      kjTHL = 1 kspL - 1 qL
                         dqf =  22.93d3  + 0.292*Pbar

                      to avoid cluttering thermodynamic data files with the new plague of TC
                      DQF "corrections", the following simple DQF's are specified in the
                      make_definition section at the end of this model:

                      dqf(silL) = 6.35d3  -0.320*Pbar
                          updated to DQF   7.86d3  - 0.337*Pbar
                      dqf(woL)  = -0.18d3  -0.118*Pbar
                          updated to DQF  -0.09d3  - 0.102*Pbar

                      For (nonsensical, but common) negative DFQ's this approach may lead to
                      interference between the phase relations of the solution model and the
                      un-DQF'd endmember. If such interference occurs: the DQF'd endmember must
                      be renamed; its definition placed in the thermodynamic data file;
                      and the un-DQF'd endmember excluded from the calculation.

                      WARNING 0: DQF'd endmembers (e.g., sil8L, ctjL) created for other thermocalc
                      melt models (e.g., melt(W), melt(JH), melt(HGP)) should be excluded (or deleted from the
                      thermodynamic data file) from calculations with this model.

melt(TH)
abbreviation Melt
full_name    liquid

688                                | model type: 688 format standard model

1                                  | number of polytopes
1                                  | number of simplices
12                                 | number of vertices (endmembers) on each simplex

foTHL     faTHL
abL       kspL
neTHL     silL     kjTHL
woL       ekTHL    hmTHL
tiTHL     qTHL


0     1   .1  0                    | range and resolution of X(fo)
0     1   .1  0                    | range and resolution of X(fa)
0     1   .1  0                    | range and resolution of X(ab)
0     1   .1  0                    | range and resolution of X(ksp)
0     1   .1  0                    | range and resolution of X(ne)
0     1   .1  0                    | range and resolution of X(sil)
0     1   .1  0                    | range and resolution of X(kj)
0     1   .1  0                    | range and resolution of X(wo)
0     1   .1  0                    | range and resolution of X(ek)
0     1   .1  0                    | range and resolution of X(hm)
0     1   .1  0                    | range and resolution of X(ti)


begin_ordered_endmembers
                         | H(anTHL) = -102.8d3  + 55*TK + 0.031 *Pbar - dqfwoL - dqfsilL
                         | dqf(silL) = 7.86d3  - 0.337*Pbar
                         | dqf(woL)  = -0.09d3  - 0.102*Pbar

anTHL  = 1 woL + 1 silL          Delta(enthalpy) =  -110.57d3  + 55*TK + 0.47 *Pbar

                         | H(enTHL)   = -19.80d3  - 0.371*Pbar - 1/2 dqffoTHL - 1/3 dqfqTHL
                         | dqf(qTHL)  = 0.47d3    - 0.078*Pbar
                         | dqf(foTHL) = 9.73d3    - 0.176*Pbar

enTHL  = 1/2 foTHL + 1/3 qTHL    Delta(enthalpy) =  -24822 - 0.257*Pbar

end_ordered_endmembers

begin_excess_function

W(qTHL  silL)    10.7d3   -0.1 * Pbar
W(qTHL  woL)     14.7d3
W(qTHL  foTHL)   45.6d3   -0.54 * Pbar
W(qTHL  faTHL)    4.9d3   -0.56 * Pbar
W(qTHL  neTHL)   12.4d3
W(qTHL  hmTHL)     20d3
W(qTHL  ekTHL)     -4d3   -0.02 * Pbar
W(qTHL  tiTHL)   31.6d3
W(qTHL  kjTHL)    2.3d3   +0.07 * Pbar
W(qTHL  anTHL)  -14.1d3   +0.02 * Pbar
W(qTHL  abL)     -0.1d3
W(qTHL  enTHL)   33.3d3   -0.41 * Pbar
W(qTHL  kspL)    -3.4d3   -0.44 * Pbar

W(silL  woL)    -24.1d3   +0.84 * Pbar
W(silL  foTHL)    6.2d3   -0.15 * Pbar
W(silL  faTHL)    2.7d3
W(silL  neTHL)   16.8d3
W(silL  hmTHL)     -5d3
W(silL  ekTHL)     -3d3
W(silL  tiTHL)   14.2d3   -0.03 * Pbar
W(silL  kjTHL)    6.9d3   +0.02 * Pbar
W(silL  anTHL)    4.6d3
W(silL  enTHL)    2.5d3   +0.01 * Pbar
W(silL  kspL)       4d3

W(woL  foTHL)      33d3   +0.04 * Pbar
W(woL  faTHL)      26d3
W(woL  neTHL)    -2.1d3   -0.02 * Pbar
W(woL  ekTHL)     -10d3
W(woL  tiTHL)     7.8d3   +0.03 * Pbar
W(woL  kjTHL)    -1.1d3   +0.03 * Pbar
W(woL  anTHL)     9.8d3
W(woL  abL)       4.1d3
W(woL  enTHL)    13.3d3   +0.09 * Pbar
W(woL  kspL)      9.8d3

W(foTHL  faTHL)  17.7d3   -0.21 * Pbar
W(foTHL  neTHL)   1.2d3   +0.02 * Pbar
W(foTHL  ekTHL)    -3d3
W(foTHL  tiTHL)   2.2d3   -0.16 * Pbar
W(foTHL  kjTHL)   2.3d3
W(foTHL  anTHL)  -5.2d3   -0.02 * Pbar
W(foTHL  abL)     1.9d3
W(foTHL  enTHL)   1.4d3   +0.36 * Pbar
W(foTHL  kspL)   -5.6d3

W(faTHL  neTHL)   7.7d3   -0.05 * Pbar
W(faTHL  hmTHL)   -30d3
W(faTHL  tiTHL)  -9.5d3   +0.02 * Pbar
W(faTHL  kjTHL)   8.9d3
W(faTHL  anTHL)  -6.5d3
W(faTHL  abL)     0.6d3
W(faTHL  enTHL)   2.9d3
W(faTHL  kspL)   -6.5d3

W(neTHL  hmTHL)    10d3
W(neTHL  tiTHL)  10.4d3   +0.14 * Pbar
W(neTHL  kjTHL)  -5.2d3
W(neTHL  anTHL)   7.6d3
W(neTHL  abL)     0.5d3   +0.12 * Pbar
W(neTHL  enTHL)   2.6d3
W(neTHL  kspL)   -2.2d3   +0.09 * Pbar

W(hmTHL  tiTHL)  -2.8d3
W(hmTHL  kjTHL)    10d3

W(ekTHL  tiTHL)  -2.1d3

W(tiTHL  kjTHL)     3d3
W(tiTHL  anTHL)  -4.8d3
W(tiTHL  abL)    -2.3d3
W(tiTHL  enTHL)  17.2d3
W(tiTHL  kspL)   -8.1d3

W(kjTHL  anTHL)  -5.6d3
W(kjTHL  abL)    -2.9d3
W(kjTHL  enTHL)    -3d3
W(kjTHL  kspL)   15.3d3   +0.32 * Pbar

W(anTHL  abL)   0.2d3

W(abL  kspL)   10d3

end_excess_function

2

M
4 0 0                       | Temkin M-site
n(Mg) = 4 foTHL
n(Fe) = 4 faTHL
n(Ca) = 1 woL
n(Al) = 1 silL

F
13 0 0                      | Temkin F-site
n(ne)    = 1 neTHL
n(kjL)   = 1 kjTHL
n(ksp)   = 1 kspL 
n(ab)    = 1 abL 
n(an)    = 1 anTHL
n(en)    = 1 enTHL
n(alsi)  = 1 silL
n(si0)   = 1 woL
n(ol)    = 1 faTHL + 1 foTHL
n(q)     = 1 qTHL
n(ek)    = 1 ekTHL
n(tiL)   = 1 tiTHL
n(hem)   = 1 hmTHL

none                              | formula suffix, enter "none" for no suffix. 

begin_dqf_corrections

dqf(silL)  =  7.86d3  - 0.337 *Pbar
dqf(woL)   = -0.09d3  - 0.102 *Pbar
dqf(abL)   =  5.02d3  - 0.082 *Pbar
dqf(kspL)  =  5.22d3  - 0.086 *Pbar

end_dqf_corrections


begin_van_laar_sizes

alpha(qTHL)    = 1
alpha(silL)    = 1.45
alpha(woL)     = 1.45
alpha(foTHL)   = 2
alpha(faTHL)   = 1
alpha(neTHL)   = 1
alpha(hmTHL)   = 1
alpha(ekTHL)   = 1
alpha(tiTHL)   = 1
alpha(kjTHL)   = 1
alpha(anTHL)   = 1
alpha(abL)     = 1
alpha(kspL)    = 1
alpha(enTHL)   = 1

end_van_laar_sizes

begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name. This
                                    | may be useful for testing purposes for systems in which the 
                                    | the endmember compositions are not expected to be stabLe, i.e., 
                                    | the stability of pure h2oL would alert the user to unexpected 
                                    | behaviour. if/when endmember compositions of the solution are 
                                    | expected, those endmembers should be removed from the list of
                                    | flagged endmembers. 
foTHL     
faTHL
neTHL      
silL     
kjTHL
woL      
ekTHL      
hmTHL
tiTHL      
qTHL      
abL
kspL
anTHL
enTHL
end_flagged_endmembers

end_of_model
                      --------------------------------------------------------
begin_model
                      Spinel - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus

                      as revised by Tomlinson and Holland; Journal of Petrology, 2021, 10.1093/petrology/egab012

                      Initially coded for Perple_X by JRDC Oct 2018; reworked JADC Apr 2019.

                      Modified parameters entered by DB Sept 2022.

                      NOTE: to use this model:

                      1) the endmembers nsp, nherc must be created in the
                         thermodynamic data file from sp and herc by stripping
                         off the bragg o/d model. the picr endmember here is assumed
                         to be ordered as is the case in ds6.33, but was NOT the case
                         in earlier versions of ds6, therefore if this model is to be
                         used with earlier versions of ds6, the o/d model must also
                         be stripped from picr.

                      2) the following endmembers must be specified with make
                         definitions in the thermodynamic data file

                         ispTH   = 1 nsp
                                DQF(J/mol) = 23.5d3  - 5.76303 * T |in Sp(HGP) isp DQF(J/mol) = 23.6d3  - 5.76303 * T, so made new ispTH 
                         iherc = 1 nherc
                                DQF(J/mol) = 23.6d3  - 5.76303 * T |HGP values
                         imt   = 1 mt
                                DQF(J/mol) = 300                   |HGP values

                      3) if both TiO2 nor O2 are absent from Sp(HGP), Perple_X 
                         reformulate this model as the sp-picr binary, rather than
                         the sp-herc-picr-fpcr quadrilateral. To prevent this specify
                         TiO2 or O2 as components present with zero amount. JADC, 12/20

                                                      M     T
                                                     _________
                                      Multiplicity    1     2  -> fake T-site multiplicity of 1
                                                     _________

                                        ispTH        Al    MgAl
                                        imgmt        Fe3   MgFe3   dependent
                                        picr         Mg    Cr
                                        qndTH        Mg    MgTi    dependent

                                        iherc        Al    FeAl
                                        imt          Fe3   FeFe3
                                        fpcr         Fe    2Cr     dependent
                                        usp          Fe    FeTi

                                Ordered species      _________

                                        nsp          Mg     Al
                                        nherc        Fe     Al
                                        nmt          Fe     Fe3+

Sp(TH)
abbreviation Sp
full_name    spinel

688                         | model type: prism , order-disorder
1                           | number of prisms
2                           | two simplicies
2 4                         | number of cations on independent sites forming simplices:
                            | fold prism (Al - Fe3+ - Cr - Ti) + binary simplices (Mg Fe on T)

                            | endmembers on the prism vertices
picr    fpcr
qndTH   usp
imgmt   imt  
ispTH   iherc  

X_Fe2+  0  1   .1  0        | subdivision scheme for Fe2/(Fe2+Mg)
X_Mg    by difference

Z_Cr    0  1   .1  0        | subdivision scheme for X(Cr)
Z_MTi   0  1   .1  0        | subdivision scheme for X(Ti)
Z_Fe3+  0  1   .1  0        | subdivision scheme for X(Fe3+)
Z_MAl   by difference

begin_ordered_endmembers
nmt   =    1 imt             delta_g_of_ordering   = -0.3d3   + 5.76303 * T   |changed from 5.76303 * T by DB to match the ECRG 10/20 revision.
nsp   =    1 ispTH           delta_g_of_ordering   = -23.5d3  + 5.76303 * T
nherc =    1 iherc           delta_g_of_ordering   = -23.6d3  + 5.76303 * T
end_ordered_endmembers 

begin_dependent_endmembers
imgmt =  1 ispTH - 1 iherc    + 1 imt  
fpcr  = -1 nsp + 1 nherc  + 1 picr
qndTH  = 1 nsp + 1 ispTH    - 1 nherc - 1 iherc   + 1 usp
end_dependent_endmembers

begin_excess_function
W(nsp   ispTH)          -6.7d3
W(nsp   nherc)           3.6d3
W(nsp   iherc)          -9.8d3
W(nsp   nmt)            43.2d3
W(nsp   imt)            49.5d3
W(nsp   picr)          -38.4d3 - 0.08*Pbar
W(nsp   usp)              40d3
W(ispTH   nherc)         2.7d3
W(ispTH   iherc)        -3.5d3
W(ispTH   nmt)          36.8d3
W(ispTH   imt)          20.7d3
W(ispTH   picr)        -21.6d3 - 0.08*Pbar
W(ispTH   usp)          38.2d3
W(nherc iherc)          -6.0d3
W(nherc nmt)            17.5d3
W(nherc imt)            51.6d3
W(nherc picr)          -53.8d3
W(nherc usp)            25.7d3
W(iherc   nmt)          -4.1d3
W(iherc   imt)            10d3
W(iherc   picr)        -38.8d3
W(iherc   usp)            21d3
W(nmt   imt)            18.1d3
W(nmt   picr)           12.1d3
W(nmt   usp)             5.2d3
W(imt     picr)         -8.7d3
W(imt     usp)          21.5d3
W(picr  usp)              15d3
end_excess_function

2                                    | 2 site entropy model (M , T)
M
4  1  1                              | 4 species on M, mult. = 1
z(Fe,M)   = 1 nherc + 1 nmt + 1 usp
z(Fe3,M)  = 1 imt  
z(Al,M)   = 1 ispTH + 1 iherc  
z(Mg,M)   = 1 nsp   + 1 picr

T
6  1  2                              | 6 species on T, effective mult. = 1, true mult = 2
z(Mg,T)   = 1/2 ispTH
z(Fe,T)   = 1/2 iherc   + 1/2 imt   + 1/2 usp
z(Ti,T)   = 1/2 usp
z(Fe3,T)  = 1 nmt + 1/2 imt  
z(Cr,T)   = 1 picr
z(Al,T)   = 1 nsp + 1/2 ispTH + 1 nherc + 1/2 iherc  

[O4]                                 | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(nsp)      = 1
alpha(ispTH)    = 1
alpha(nherc)    = 1
alpha(iherc)    = 1
alpha(nmt)      = 1
alpha(imt)      = 1
alpha(picr)     = 1
alpha(usp)      = 0.9
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                      Garnet - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus

                      Revised by Tomlinson and Holland; Journal of Petrology, 2021, 10.1093/petrology/egab012

                      Revised parameters entered by DB Sept 2022.

                      JADC, Oct 2022

                      This model requires the following make definition in
                      the thermodynamic data file

                         tigTH   = 1 py + 1/2 per + 1/2 ru - 1/2 cor
                                DQF(J/mol) = 53.5d3  - 17.3 * T

                      Additionally, a knor endmember DQF is added in the dqf_correction section
                      at the end of this model.

                                                      X       Y
                                                     _____________

                                      Mutliplicity    3       2
                                                     _____________

                          Dependent:   fkho_d        Fe      Fe3+
                          Dependent:   kho_d         Mg      Fe3+
                                       andr          Ca      Fe3+

                          Dependent:   fkno_d        Fe      Cr
                                       knor          Mg      Cr
                          Dependent:   ckno_d        Ca      Cr

                          Dependent:   ftig_d        Fe      Al(MgTi)_0.5
                                       tigTH         Mg      Al(MgTi)_0.5
                          Dependent:   ctig_d        Ca      Al(MgTi)_0.5

                                       alm           Fe      Al
                                       py            Mg      Al
                                       gr            Ca      Al

Gt(TH)
abbreviation Gt
full_name    garnet

7
2
3 4
ftig_d  tigTH    ctig_d
fkno_d  knor   ckno_d
fkho_d  kho_d  andr
alm     py     gr

6
fkno_d = 1 alm + 1 knor - 1 py
ckno_d = 1 gr  + 1 knor - 1 py
fkho_d = 1 alm + 1 andr - 1 gr
kho_d  = 1 py  + 1 andr - 1 gr
ftig_d = 1 alm + 1 tigTH  - 1 py
ctig_d = 1 gr  + 1 tigTH  - 1 py

                            | see commentary in the header of this file for explanation of
                            | endmember flags and subdivision schemes.

0 0 0 0 0 0 0 0 0 0 0 0     | endmember flags

0   1   .1   0              | subdivision scheme for Fe on A
0   1   .1   0              | subdivision scheme for Mg on A

0   1   .1   0              | subdivision scheme for Al(MgTi)_0.5   on B
0   1   .1   0              | subdivision scheme for Cr     on B
0   1   .1   0              | subdivision scheme for Fe3+   on B

begin_excess_function
W(py   alm)        4d3            + 0.1 * P
W(py   gr)      45.4d3  - 10 * T  + 0.04 * P
W(py   andr)     107d3  - 10 * T  - 0.036 * P
W(py   knor)       2d3
W(alm  gr)        17d3  - 10 * T  + 0.1 * P
W(alm  andr)      65d3  - 10 * T  + 0.039 * P
W(alm  knor)     8.2d3            + 0.01 * P
W(gr   andr)       2d3
W(gr   knor)       5d3  - 10 * T  + 0.180 * P
W(andr knor)      63d3  - 10 * T  + 0.10 * P
end_excess_function

2
3 3.
z(m1,fe) = 1 alm
z(m1,mg) = 1 py + 1 knor + 1 tigTH

5 2.
z(m2,cr)  = 1 knor
z(m2,fe3) = 1 andr
z(m2,ti)  = 1/4 tigTH
z(m2,mg)  = 1/4 tigTH


begin_van_laar_sizes
alpha(py)        1
alpha(alm)       1
alpha(gr)        2.5
alpha(andr)      2.5
alpha(knor)      1
alpha(tigTH)     1
end_van_laar_sizes

end_of_model
                      --------------------------------------------------------
begin_model
                      Orthopyroxene - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus

                      Revised by Tomlinson and Holland; Journal of Petrology, 2021, 10.1093/petrology/egab012

                      Revised parameters entered by DB Sept 2022.

                      JADC, Oct 2022

                      Reformulated as a 2-polytope 688 format model. JADC, 9/19

                      The composition space of the published model corresponds to (M1, M2 site populations are 
                      indicated, remaining are dependent):     
                      
                      [M,T][A,C,M]
                        
                      T  = Al, Fe3, Cr, MTi on M1
                      C  = Ca on M2
                      M  = Mg, Fe
                      A  = Na on M2*
                      
                      *A is partially coupled to T by charge balance.
                      
                      The composition space of the model here has been simplified by eliminating
                      the [FeTi][A,C] endmembers. The retained [FeTi][Fe] endmember is probably 
                      a waste of resources.

                      NOTE: the definitions for the FeTi exchanges allowed in the full model 
                      are provided but have been commented out below.                     
                      
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                     
                      Polytope 1 = [T'][A,C]       
                      Polytope 2 = [T,M][M]+[M][C] 
                      
                      where 
                      
                      T' = Al, Fe3, MgTi on M1
                      --------------------------------------------------------
                      First coded for Perple_X by ECR Green and JRDC Aug 2018.
                      Rearranged Apr 2019, JADC.

                      NOTE: to use this the following endmembers must be specified with make
                      definitions in the thermodynamic data file

                      odi    = 1 di
                            DQF = 1900 + 0.005 * P 
                      crenTH = 1 mgts + 1 kos - 1 jd
                            DQF = -31850 + 15.5 * T + 0.05 * P
                      obufTH = 1 mgts + 1/2 per + 1/2 ru - 1/2 cor
                            DQF = 4350 - 5.1 * T - 0.0061 * P
                      macmTH = 1 mgts + 1 acm - 1 jd
                            DQF = 2630 - 0.089 * P
                      ojdTH  = 1 jd
                            DQF = 18840 - 0.043 * P
                      --------------------------------------------------------
                                                        M1     M2     T
                                                     ____________________________________

                                      Multiplicity      1      1     1/2 <- fake T multiplicity
                                                     ____________________________________
           Polytope 1:                  crjd_d          Cr     Na    Si    dependent
                                        crdi_d          Cr     Ca   AlSi   dependent
                                        ___
                                        ness_d          Fe3    Na    Si    dependent
                                        cess_d (acm)    Fe3    Ca   AlSi   dependent
                                        ___
                                        ojdTH           Al     Na    Si
                                        ocats_d         Al     Ca   AlSi   dependent
                                        ___
                                        mnbuf_d         MgTi   Na    Si    dependent
                                        mcbuf_d         MgTi   Ca   AlSi   dependent

                                        fnbuf_d         FeTi   Na    Si    dependent
                                        fcbuf_d         FeTi   Ca   AlSi   dependent
                                                     ____________________________________

           Polytope 2:                  crenTH          Cr     Mg   AlSi
                                        crfs_d          Cr     Fe   AlSi   dependent
                                        _________

                                        macmTH (mess)     Fe3    Mg   AlSi
                                        facm_d (fess)   Fe3    Fe   AlSi   dependent
                                        _________

                                        mgts            Al     Mg   AlSi
                                        fts_d           Al     Fe   AlSi   dependent
                                        _________

                                        obufTH          MgTi   Mg   AlSi
                                        ffbuf_d         FeTi   Fe   AlSi   dependent
                                        _________
                                        odi             Mg     Ca    Si
                                        hed_d           Fe     Ca    Si    dependent
                                        ___
                                        en              Mg     Mg    Si
                                        fs              Fe     Fe    Si
                                                      ___________________________________
                    Ordered species:

                                        fm              Mg     Fe    Si independent

                      femg-1(M2) = fm - en
                      femg-1(M1) = fs - fm
                      mgca-1(M2) = en - odi  
                      feca-1(M2) = fm - odi   
                      --------------------------------------------------------
Opx(TH)
abbreviation Opx
full_name    orthopyroxene

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and subdivision schemes for the composite composition space
[T'][A,C]  0    .2   .1  0        | subdivision range for X(1) = X([T][A,C])
TM+MC      by difference

                                  | -------------------------------------------
                                  | Polytope 1 [T'][A,C]
2                                 | number of simplices
2 3                               | change to 3 5 for full model
crjd_d   crdi_d
ness_d   cess_d
                                  |mnbuf_d  mcbuf_d
                                  |fnbuf_d  fcbuf_d
ojdTH      ocats_d

                                  | Simplex 1
X_K    0     1  .1  0             | X(1,1) = Na/[Na + Ca] on M2
X_Ca1  by difference              | X(1,N) = Ca/[Na + Ca] on M2 by difference

                                  | Simplex 2
X_CrTs 0     1  .1  0             | X(2,1) = Cr/T on M1
X_FeTs 0     1  .1  0             | X(2,2) = Fe3+/T on M1
                                  |0     1  .1  0                    | X(2,3) = MgTi/T on M1
                                  |0     1  .1  0                    |X(2,4)  = FeTi/T on M1
X_AlTs by difference              | X(2,N) = Al/T on M1 by difference

                                  | -------------------------------------------
                                  | Polytope 2  TM+MC

2                                 | number of simplices 
2 6                               | number of vertices on each simplex

ffbuf_d  obufTH
crfs_d   crenTH
facm_d   macmTH
fts_d    mgts
hed_d    odi  
fs       en
                                  | Simplex 1
X_Fe    0  .2  .1  0              | X(1,1) => Fe/M
X_Mg    by difference             | X(1,N) = Mg/M by difference

                                  | Simplex 2
X_MTiTs 0  .2  .1  0              | X(2,1) - M-buf(MgTi)
X_MCrTs 0  .1  .1  0              | X(2,2) - M-Cr
X_MFeTs 0  .1  .1  0              | X(2,3) - M-Fe3+
X_MAlTs 0  .2  .1  0              | X(2,4) - M-Ts
X_MCPx  0   1  .1  0              | X(2,5) - M-Ca
X_MMPx  by difference

begin_ordered_endmembers
fm = 1/2 en + 1/2 fs     delta_g_of_ordering  = -6600
end_ordered_endmembers 

begin_dependent_endmembers

fts_d   = 1 mgts - 1 en + 1 fm
ocats_d = 1 mgts - 1 en + 1 odi  

crjd_d  = 1 crenTH - 1 mgts + 1 ojdTH
crfs_d  = 1 crenTH - 1 en   + 1 fm
crdi_d  = 1 crenTH - 1 en   + 1 odi  

facm_d  = 1 macmTH - 1 en   + 1 fm
cess_d  = 1 macmTH - 1 en   + 1 odi  
ness_d  = 1 macmTH - 1 mgts + 1 ojdTH

|mcbuf_d = 1 obufTH + 1 odi    - 1 en
|fcbuf_d = 1 obufTH + 1/2 fs - 1/2 fm + 1 odi   - 1 en

ffbuf_d = 1 obufTH - 1 en   + 1/2 fs + 1/2 fm

hed_d   = -1 fm + 1 fs + 1 odi  

end_dependent_endmembers

begin_excess_function
W(en fs)               5.2d3
W(en fm)               1.7d3
W(en odi)               29d3  + 0.15 * p
W(en mgts)            12.5d3  - 0.04 * p
W(en crenTH)             8d3
W(en macmTH)             8d3
W(en ojdTH)             35d3

W(fs fm)                 5d3
W(fs odi)            25.54d3  + 0.084 * p 
W(fs mgts)              11d3  - 0.15 * p
W(fs crenTH)             8d3
W(fs macmTH)            10d3
W(fs ojdTH)             35d3

W(fm odi  )          22.54d3  + 0.084 * p
W(fm mgts)              15d3  - 0.15 * p
W(fm crenTH)            10d3
W(fm macmTH)            12d3
W(fm ojdTH)             35d3

W(odi mgts)           75.5d3  - 0.84 * p
W(odi crenTH)           20d3
W(odi macmTH)           20d3
W(odi ojdTH)            35d3

W(mgts crenTH)           2d3
W(mgts macmTH)           2d3
W(mgts ojdTH)            7d3

W(crenTH macmTH)         2d3
W(crenTH ojdTH)        -11d3

W(obufTH ojdTH)          4d3

W(macmTH ojdTH)        -11d3
end_excess_function

3                                   | number of sites in entropy model (M1, M2, T)

M1                                  | site name
6 1 1                               | number of species, effective multiplicity, true multiplicity
z(fe)   = 1 fs
z(al)   = 1 mgts + 1 ojdTH
z(fe3+) = 1 macmTH
z(cr)   = 1 crenTH
z(ti)   = 1/2 obufTH
z(Mg)   = 1/2 obufTH + 1 odi   + 1 en + 1 fm

M2                                  | site name
4 1 1                               | number of species, effective multiplicity, true multiplicity
z(fe)   = 1 fs + 1 fm
z(ca)   = 1 odi  
z(na)   = 1 ojdTH
z(Mg)   = 1 obufTH + 1 en + 1 crenTH + 1 macmTH + 1 mgts 

T                                   | site name
2 .5 2                              | number of species, effective multiplicity, true multiplicity
z(Al,T)    = 1/2 mgts + 1/2 crenTH + 1/2 obufTH + 1/2 macmTH
z(Si,T)    = 1/2 mgts + 1/2 crenTH + 1/2 obufTH + 1/2 macmTH + 1 ojdTH + 1 odi   + 1 en + 1 fs + 1 fm

[O6]                                | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(en)        1
alpha(fs)        1
alpha(fm)        1
alpha(odi)       1.2
alpha(mgts)      1
alpha(crenTH)    1
alpha(obufTH)    1
alpha(macmTH)    1
alpha(ojdTH)     1.2
end_van_laar_sizes

                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

end_of_model
                      --------------------------------------------------------
begin_model
                      Clinopyroxene - Holland, Green, and Powell; Journal of Petrology, 2018, Vol. 59, 881900.
                      Intended for pressure to 7 GPa, 923 K < T < peridotite liquidus

                      Revised by Tomlinson and Holland; Journal of Petrology, 2021, 10.1093/petrology/egab012

                      Revised parameters entered by DB Sept 2022.

                      JADC, Oct 2022

                      Reformulated as a 2-polytope 688 format model. JADC, 9/19

                      The composition space of the published model corresponds to (M1, M2 site populations are 
                      indicated, remaining are dependent):     
                      
                      [M,T][A,C,M]
                        
                      T  = Al, Fe3, Cr, MTi on M1
                      C  = Ca on M2
                      M  = Mg, Fe
                      A  = Na, K on M2*
                      
                      *A is partially coupled to T by charge balance.
                      
                      The composition space of the model here has been simplified by eliminating
                      the [FeTi][A,C] endmembers. The retained [FeTi][Fe] endmember is probably 
                      a waste of resources.

                      NOTE: the definitions for the FeTi exchanges allowed in the full model 
                      are provided but have been commented out below.                     
                      
                      The composition space of the model is formed as a mixture of two polytopes (dropping 
                      the dependent A site notation):
                     
                      Polytope 1 = [T'][A,C]       
                      Polytope 2 = [T,M][M]+[M][C] 
                      
                      where 
                      
                      T' = Al, Fe3, MgTi on M1
                      ---------------------------------------------------------   
                      First coded for Perple_X by Julien Cornet Sept 2018.

                      Re-formulated as a triple simplex prism. JADC, Dec 11, 2018.

                      Corrected cfm enthalpy and site limit expression for z(Mg,M1). JADC, April 29, 2019.

                      NOTES:

                      this model requires that the following endmembers are specified by make
                      definitions in the thermodynamic data file

                      cenjh  = 1 en
                        DQF  = 3500 - 2 * T + 0.048 * P
                      cfsg   = 1 fs
                        DQF  = 2100 - 2 * T + 0.045 * P
                      cessTH = cats + acm - jd
                        DQF  = -5810
                      crdiTH = cats + kos - jd
                        DQF  = -5660
                     mcbufTH = cats + 1/2 per + 1/2 ru -1/2 cor
                        DQF  = -6.47d3 - 1.2 * T + 0.078 * P 
                       kjdTH = jd + san - abh
                        DQF  = -4d3 + 1.35 * P  
                      ---------------------------------------------------------   

                                           M1     M2     T
                                        ____________________________________

                         Multiplicity      1      1     2 -> fake T multiplicity = 1/2
                                        ____________________________________
           Polytope 1:     mkbuf_d         MgTi   K     Si    dependent
                           mnbuf_d         MgTi   Na    Si    dependent
                           mcbufTH         MgTi   Ca   AlSi
                           _________
                           fkbuf_d         FeTi   K     Si    dependent
                           fnbuf_d         FeTi   Na    Si    dependent
                           fcbuf_d         FeTi   Ca   AlSi   dependent
                           _________
                           crkjd_d         Cr     K     Si    dependent
                           crjd_d          Cr     Na    Si    dependent
                           crdiTH          Cr     Ca   AlSi
                           _________
                           kess_d          Fe3+   K     Si    dependent
                           ness_d          Fe3+   Na    Si    dependent
                           cessTH          Fe3    Ca   AlSi
                           _________
                           kjdTH           Al     K     Si
                           jd              Al     Na    Si
                           cats            Al     Ca   AlSi
                                        ____________________________________
           Polytope 2:     mmbuf_d         MgTi   Mg   AlSi   dependent
                           ffbuf_d         FeTi   Fe   AlSi   dependent

                           cren_d          Cr     Mg   AlSi   dependent
                           crfs_d          Cr     Fe   AlSi   dependent

                           mess_d          Fe3    Mg   AlSi   dependent
                           fess_d          Fe3    Fe   AlSi   dependent

                           mats_d          Al     Mg   AlSi   dependent
                           fats_d          Al     Fe   AlSi   dependent

                           di              Mg     Ca    Si
                           hed_d           Fe     Ca    Si    dependent

                           cenjh           Mg     Mg    Si
                           cfsg            Fe     Fe    Si
                           _______________________________________________

                    Ordered species:

                           cfm             Mg     Fe     Si independent

                      femg-1(M2) = cfm - cenjh
                      femg-1(M1) = cfsg - cfm
                      mgca-1(M2) = cenjh - di
                      feca-1(M2) = cfm - di 
                      ---------------------------------------------------------   

Cpx(TH)
abbreviation Cpx
full_name    clinopyroxene

688                               | model type: 688 format standard model

2                                 | number of polytopes
                                  | polytope names and composite composition space subdivision schemes 
[T'][A,C]   0    .25  .1  0
TM+MC       by difference

                                  | -------------------------------------------
                                  | Polytope 1 [T'][A,C]
2                                 | number of simplices
3 4                               | number of vertices on each simplex, change to 3 5 for full model
mkbuf_d   mnbuf_d   mcbufTH
crkjd_d   crjd_d    crdiTH
kess_d    ness_d    cessTH
                                  |fkbuf_d   fnbuf_d   fcbuf_d
kjdTH      jd        cats
                                  | Simplex 1
X_K    0     1  .1  0             | X(1,1) = Na/[A + Ca] on M2
X_Na   0     1  .1  0             | X(1,2) = K /[A + Ca] on M2
X_Ca   by difference              | X(1,N) = Ca/[A + Ca] on M2 

                                  | Simplex 2
X_TiTs 0     1  .1  0             | X(2,1) = MgTi/T on M1
X_CrTs 0     1  .1  0             | X(2,2) = Cr/T on M1
X_FeTs 0     1  .1  0             | X(2,3)  = Fe3+/T on M1
                                  |0     1  .1  0                    |X(2,4)  = FeTi/T on M1
X_AlTs by difference              | X(2,N) = Al/T on M1 
                                  | -------------------------------------------
                                  | Polytope 2  TM+MC
2                                 | number of simplices 
2 6                               | number of vertices on each simplex

ffbuf_d  mmbuf_d
crfs_d   cren_d
fess_d   mess_d
fats_d   mats_d
cfsg     cenjh
hed_d    di
                                  | Simplex 1
X_Fe 0  .2  .1  0                 | X(1,1) => Fe/M
X_Mg by difference                | X(1,N) = Mg/M

                                  | Simplex 2
X_MTiTs 0  .1  .1  0              | X(2,1) - M-buf(MgTi)
X_MCrTs 0  .1  .1  0              | X(2,2) - M-Cr
X_MFeTs 0  .1  .1  0              | X(2,3) - M-Fe3+
X_MAlTs 0  .2  .1  0              | X(2,4) - M-Ts
X_MMPx  0   1  .1  0              | X(2,5) - M-M
X_MCPx  by difference             | X(2,6) - M-Ca

begin_ordered_endmembers
cfm   = 1/2 cenjh + 1/2 cfsg  delta_g_of_ordering   =  -4400 | DQF(cfm) - (DQF(cenjh) + DQF(cfsg ))/2
end_ordered_endmembers 

begin_dependent_endmembers
mkbuf_d   = -1 cats  + 1 mcbufTH + 1 kjdTH
mnbuf_d   = -1 cats  + 1 mcbufTH + 1 jd

|fcbuf_d   = 1/2 cfsg  + 1 mcbufTH  - 1/2 cfm
|fkbuf_d   = 1/2 cfsg  - cats + mcbufTH - 1/2 cfm + kjdh
|fnbuf_d   = 1/2 cfsg  - 1 cats  + 1 mcbufTH + jd - 1/2 cfm

ffbuf_d   = -1 di    + 1/2 cfsg  + 1 mcbufTH + 1/2 cfm
mmbuf_d   = -1 di    + 1 mcbufTH  + 1 cenjh

crkjd_d   = -1 cats  + 1 crdiTH + 1 kjdTH
crjd_d    = -1 cats  + 1 crdiTH + 1 jd
cren_d    = -1 di    + 1 crdiTH + 1 cenjh
crfs_d    = -1 di    + 1 crdiTH + 1 cfm

kess_d    = -1 cats  + 1 cessTH + 1 kjdTH
ness_d    = -1 cats  + 1 cessTH + 1 jd
mess_d    = -1 di    + 1 cessTH + 1 cenjh
fess_d    = -1 di    + 1 cessTH + 1 cfm

mats_d    = -1 di    + 1 cats  + 1 cenjh
fats_d    = -1 di    + 1 cats  + 1 cfm

hed_d     =  1 di    + 1 cfsg   - 1 cfm
end_dependent_endmembers

begin_excess_function
W(di cfsg )      25.8d3 - 0.03 * p 
W(di cats)         13d3 - 0.06 * p
W(di crdiTH)        8d3
W(di cessTH)        8d3
W(di jd)           26d3
W(di cenjh)      29.8d3 - 0.03 * p
W(di cfm)        20.6d3 - 0.03 * p
W(di kjdTH)        26d3

W(cfsg  cats)      25d3 -  .1 * p
W(cfsg  crdiTH)  38.3d3
W(cfsg  cessTH)  43.3d3
W(cfsg  jd)        24d3
W(cfsg  cenjh)    2.3d3
W(cfsg  cfm)      3.5d3
W(cfsg  kjdTH)     24d3

W(cats crdiTH)     2d3
W(cats cessTH)     2d3
W(cats jd)         6d3
W(cats cenjh)   45.2d3 - 0.35 * p
W(cats cfm)       27d3 -  .1 * p
W(cats kjdTH)      6d3

W(crdiTH cessTH)   2d3
W(crdiTH jd)       3d3
W(crdiTH cenjh) 52.3d3
W(crdiTH cfm)   40.3d3
W(crdiTH kjdTH)    3d3

W(cessTH jd)       3d3
W(cessTH cenjh) 57.3d3
W(cessTH cfm)   45.3d3
W(cessTH kjdTH)    3d3

W(jd cenjh)       40d3
W(jd cfm)         40d3
W(jd kjdTH)       10d3

W(cenjh cfm)       4d3
W(cenjh kjdTH)    40d3

W(cfm kjdTH)      40d3
end_excess_function

3                                   | number of sites in configurational entropy model (M1, M2, T)

M1                                  | site name
6 1 1                               | number of species, effective multiplicity, true multiplicity
z(Fe)   = 1 cfsg 
z(Mg)   = 1 di + 1 cenjh + 1/2 mcbufTH + 1 cfm
z(Fe3+) = 1 cessTH
z(Ti)   = 1/2 mcbufTH
z(Cr)   = 1 crdiTH
z(Al)   = 1 cats + 1 jd + 1 kjdTH

M2                                  | site name
5 1 1                               | number of species, effective multiplicity, true multiplicity
z(Na)   = 1 jd
z(K)    = 1 kjdTH
z(Mg)   = 1 cenjh
z(Fe)   = 1 cfm  + 1 cfsg 
z(Ca)   = 1 di + 1 cats + 1 cessTH + 1 crdiTH + 1 mcbufTH

T                                   | site name
2 .5 2                              | number of species, effective multiplicity, true multiplicity
z(Al,T) = 1/2 cats + 1/2 mcbufTH + 1/2 crdiTH + 1/2 cessTH
z(Si,T) = 1/2 cats + 1/2 mcbufTH + 1/2 crdiTH + 1/2 cessTH + 1 cfsg   + 1 cenjh + 1 di + 1 cfm + 1 jd + 1 kjdTH

[O6]                                | formula suffix, enter "none" for no suffix.

begin_van_laar_sizes
alpha(di)      1.2
alpha(cenjh)   1
alpha(cfsg )   1
alpha(jd)      1.2
alpha(kjdTH)   1.2
alpha(cats)    1.9
alpha(mcbufTH) 1.9
alpha(cessTH)  1.9
alpha(crdiTH)  1.9
alpha(cfm)     1
end_van_laar_sizes
                                    | solution model specific computational options:
begin_flagged_endmembers
                                    | endmembers listed in this section are not associated with the
                                    | solution on output and are identified by endmember name.
end_flagged_endmembers

end_of_model
                      --------------------------------------------------------
